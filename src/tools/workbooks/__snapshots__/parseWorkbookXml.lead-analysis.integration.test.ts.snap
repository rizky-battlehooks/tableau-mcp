// Vitest Snapshot v1, https://vitest.dev/guide/snapshot.html

exports[`parseWorkbookXml - Lead Analysis.twb (real workbook) > parses real workbook and matches snapshot 1`] = `
[
  {
    "caption": "D2",
    "datatype": "integer",
    "formula": "0",
    "name": "[D1 (copy 2)_1113233589196361731]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "D3",
    "datatype": "integer",
    "formula": "0",
    "name": "[D1 (copy 3)_1113233589196374020]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "D5",
    "datatype": "integer",
    "formula": "0",
    "name": "[D1 (copy) (copy)_1113233589196361730]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "D3 1",
    "datatype": "integer",
    "formula": "0",
    "name": "[D1 (copy) (copy)_6374000853573136390 1]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "D4",
    "datatype": "integer",
    "formula": "0",
    "name": "[D1 (copy)_1113233589196333057]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "D2 1",
    "datatype": "integer",
    "formula": "0",
    "name": "[D1 (copy)_6374000853573115909]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "End Date Comp",
    "datatype": "date",
    "formula": "#2025-08-20#",
    "name": "[End Date (copy)_1152077103892365314]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Leads Upload End Date",
    "datatype": "date",
    "formula": "#2025-07-30#",
    "name": "[End Date (copy)_767300789999759379]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Date 1",
    "datatype": "string",
    "formula": ""quarter"",
    "name": "[Parameter 1 1]",
    "role": "measure",
    "type": "nominal",
  },
  {
    "caption": "D1 1",
    "datatype": "integer",
    "formula": "0",
    "name": "[Parameter 10 1]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "D1",
    "datatype": "integer",
    "formula": "0",
    "name": "[Parameter 10]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Helper Date",
    "datatype": "string",
    "formula": ""default"",
    "name": "[Parameter 11]",
    "role": "measure",
    "type": "nominal",
  },
  {
    "caption": "User Identifier",
    "datatype": "integer",
    "formula": "0",
    "name": "[Parameter 12]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Date Bucket",
    "datatype": "string",
    "formula": ""day"",
    "name": "[Parameter 1]",
    "role": "measure",
    "type": "nominal",
  },
  {
    "caption": "Phone",
    "datatype": "string",
    "formula": ""0"",
    "name": "[Parameter 2]",
    "role": "measure",
    "type": "nominal",
  },
  {
    "caption": "5% Cutoff",
    "datatype": "real",
    "formula": "0.2",
    "name": "[Parameter 3]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Min Threshold",
    "datatype": "integer",
    "formula": "2",
    "name": "[Parameter 4]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Start Date",
    "datatype": "date",
    "formula": "#2025-07-30#",
    "name": "[Parameter 5]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "End Date",
    "datatype": "date",
    "formula": "#2025-08-27#",
    "name": "[Parameter 6]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Missing Fields",
    "datatype": "string",
    "formula": ""All"",
    "name": "[Parameter 7]",
    "role": "measure",
    "type": "nominal",
  },
  {
    "caption": "Lead vs Spend",
    "datatype": "string",
    "formula": ""1"",
    "name": "[Parameter 8]",
    "role": "measure",
    "type": "nominal",
  },
  {
    "caption": "Date Selected",
    "datatype": "string",
    "formula": ""Post Date"",
    "name": "[Parameter 9]",
    "role": "measure",
    "type": "nominal",
  },
  {
    "caption": "Show Source",
    "datatype": "string",
    "formula": ""1"",
    "name": "[Phone (copy)_1255659924007981058]",
    "role": "measure",
    "type": "nominal",
  },
  {
    "caption": "Subid",
    "datatype": "string",
    "formula": ""0"",
    "name": "[Phone (copy)_1255659924008312836]",
    "role": "measure",
    "type": "nominal",
  },
  {
    "caption": "Show Age Range",
    "datatype": "string",
    "formula": ""0"",
    "name": "[Phone (copy)_1255659924008513542]",
    "role": "measure",
    "type": "nominal",
  },
  {
    "caption": "Show Site Source",
    "datatype": "string",
    "formula": ""0"",
    "name": "[Show Source (copy)_3999970530356424704]",
    "role": "measure",
    "type": "nominal",
  },
  {
    "caption": "Start Date Comp",
    "datatype": "date",
    "formula": "#2025-08-20#",
    "name": "[Start Date (copy)_1152077103891697665]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Leads Upload Start Date",
    "datatype": "date",
    "formula": "#2024-10-31#",
    "name": "[Start Date (copy)_767300789999747090]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "% <5s",
    "datatype": "real",
    "formula": "//Updated Date: 18 May 2022
//Updated By: Manish
//Description: Calculating the percentage of ping age <5s

[Calculation_172262731327561728]/[Calculation_2399292755836653580]",
    "name": "[% <5s (copy)_2399292755838119952]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "% Posted Wk2",
    "datatype": "real",
    "formula": "ifnull([Last Week Leads (copy)_535928404290809858]/{exclude [Sub Id]: countD(if [Date]< dateadd('day',-7,datetrunc('week',today(),'sunday')) then [User Id] end)},0)",
    "name": "[% Last week Leads (copy)_535928404325892101]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "<005",
    "datatype": "integer",
    "formula": "//Updated Date: 18 May 2022
//Updated By: Manish
//Description: Calculating the unique count of userid when ping age is <=5s

COUNTD(IF [Ping Age (s)]>0 and [Ping Age (s)]<=5 then [User Id] end)",
    "name": "[0 (copy)_2399292755834134533]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "30 Day Window Apps #",
    "datatype": "integer",
    "formula": "//IF {include:sum({fixed [CZ Project Name],[Source]: countd(if [Last 15 to 45 day Window]= true and CONTAINS(LOWER([Status]),'ap') then [User Id] end)})} !=0

//THEN
{include:sum({fixed [CZ Project Name],[Source]: countd(if [Calculation_2006635132526440448]= true and CONTAINS(LOWER([Status]),'ap') then [User Id] end)})}
//ELSE

//{exclude [Day of Post Date],[Source] :sum({fixed [CZ Project Name],[Source]: countd(if [Last 15 to 45 day Window]= true and CONTAINS(LOWER([Status]),'ap') then [User Id] end)})}

//END",
    "name": "[30 Day Window Leads # (copy)_2006635132547117058]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "MinThreshold Filter",
    "datatype": "string",
    "formula": "//Updated Date: 18 May 2022
//Updated By: Manish
//Description: Filtering data to exclude minimum threshold of total value


IF ZN([Calculation_2399292755836653580])<=[Parameters].[Parameter 4] THEN "Hide"
ELSE "Show" END",
    "name": "[5% Cutoff Filter (copy)_2399292755843940370]",
    "role": "measure",
    "type": "nominal",
  },
  {
    "caption": "<010",
    "datatype": "integer",
    "formula": "//Updated Date: 18 May 2022
//Updated By: Manish
//Description: Calculating the unique count of userid when ping age is between 5 and 10s

COUNTD(IF [Ping Age (s)]>5 and [Ping Age (s)]<=10 then [User Id] end)",
    "name": "[<005 (copy)_2399292755834429446]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "<025",
    "datatype": "integer",
    "formula": "//Updated Date: 18 May 2022
//Updated By: Manish
//Description: Calculating the unique count of userid when ping age is between 10 and 25s

COUNTD(IF [Ping Age (s)]>10 and [Ping Age (s)]<=25 then [User Id] end)",
    "name": "[<005 (copy)_2399292755835043847]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "<100",
    "datatype": "integer",
    "formula": "//Updated Date: 18 May 2022
//Updated By: Manish
//Description: Calculating the unique count of userid when ping age is between 25 and 100s

COUNTD(IF [Ping Age (s)]>25 and [Ping Age (s)]<=100 then [User Id] end)",
    "name": "[<010 (copy)_2399292755836125192]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "<200",
    "datatype": "integer",
    "formula": "//Updated Date: 18 May 2022
//Updated By: Manish
//Description: Calculating the unique count of userid when ping age is between 100 and 200s

COUNTD(IF [Ping Age (s)]>100 and [Ping Age (s)]<=200 then [User Id] end)",
    "name": "[<100 (copy)_2399292755836203017]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": ">200",
    "datatype": "integer",
    "formula": "//Updated Date: 18 May 2022
//Updated By: Manish
//Description: Calculating the unique count of userid when ping age is greater than 200s

COUNTD(IF [Ping Age (s)]>200 then [User Id] end)",
    "name": "[<200 (copy)_2399292755836375050]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "<10s Cumulative",
    "datatype": "integer",
    "formula": "//Updated Date: 18 May 2022
//Updated By: Manish
//Description: Calculating the sum of userid when ping age is between 0 and 10s

[Ping age (copy)_2399292755833638916]+[0 (copy)_2399292755834134533]+[<005 (copy)_2399292755834429446]",
    "name": "[<5s Cumulative (copy)_2399292755837362190]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Rejected",
    "datatype": "integer",
    "formula": "//Updated Date: 18 May 2022
//Updated By: Manish
//Description: Calculating the unique count of user id when scrub status is rejected

COUNTD(IF [Calculation_7746824680806834178] = 'Rejected' THEN [User Id] END)",
    "name": "[Accepted (copy)_7746824680807407620]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "CTC Leads %",
    "datatype": "real",
    "formula": "[Calculation_8421379501118734337]/[Calculation_99712551082803223]",
    "name": "[CTC # (copy)_1880252886120472578]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "TTW Grade",
    "datatype": "string",
    "formula": "IF [ttw_qualstatus] = 'ttw-qualified' then 'Grade A'
ELSEIF  [ttw_qualstatus] = 'ttw-nonqualified' and [TTW Explore Work Form] = 'yes' THEN 'Grade B'
ELSEIF [ttw_qualstatus] = 'ttw-nonqualified' and [TTW Explore Work Form] != 'yes' THEN 'Grade C'
ELSEIF ISNULL([ttw_qualstatus]) and [Stage3 Response] = 'Between 2 and 4 years' then 'Grade D'
ELSE 'Rest'
END",
    "name": "[Calculation_1006061976934187009]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Missing LastName",
    "datatype": "integer",
    "formula": "COUNT(IF ISNULL([Last Name]) OR [Last Name] = '' THEN [User Id] END)",
    "name": "[Calculation_1022317140785389568]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Missing Fields Mapping",
    "datatype": "integer",
    "formula": "IF [Parameters].[Parameter 7] = 'First Name' THEN [Missing LastName (copy)_1022317140785614849]
ELSEIF [Parameters].[Parameter 7] = 'Last Name' THEN [Calculation_1022317140785389568]
ELSEIF [Parameters].[Parameter 7] = 'City' THEN [Missing LastName (copy)_1022317140785823746]
ELSEIF [Parameters].[Parameter 7] = 'State' THEN [Missing City (copy)_1022317140786008067]
ELSEIF [Parameters].[Parameter 7] = 'IP' THEN [Missing City (copy)_1022317140786180100]
ELSEIF [Parameters].[Parameter 7] = 'Subid' THEN [Missing Zip Code (copy)_1022317140786438149]
ELSEIF [Parameters].[Parameter 7] = 'TF' THEN [Missing Subid (copy)_1022317140787544070]
ELSEIF [Parameters].[Parameter 7] = 'ZipCode' THEN [Missing TF (copy)_1022317140793171977]
ELSEIF [Parameters].[Parameter 7] = 'DOB' THEN [Missing TF (copy)_1022317140793491466]
ELSE [Calculation_2489223969907380226 1]
END",
    "name": "[Calculation_1022317140793761803]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Hour of Day",
    "datatype": "string",
    "formula": "IF LEN(STR(DATEPART('hour', [Calculation_1916563181826678784]))) = 1
THEN "0" + STR(DATEPART('hour', [Calculation_1916563181826678784]))
ELSE STR(DATEPART('hour', [Calculation_1916563181826678784]))
END",
    "name": "[Calculation_1113233589182521344]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "20hrs Disqual",
    "datatype": "integer",
    "formula": "IF [Stage6 Response] = "More than 20 hours per week" THEN 1 ELSE 0 END",
    "name": "[Calculation_1133007210546622464]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Age Disqual",
    "datatype": "integer",
    "formula": "IF INT([Age]) < 40 OR INT([Age]) > 62 THEN 1 ELSE 0 END",
    "name": "[Calculation_1133007210553298946]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Attorney Disqual",
    "datatype": "integer",
    "formula": "IF [Stage5 Response] = "Yes" THEN 1 ELSE 0 END",
    "name": "[Calculation_1133007210553425923]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Ben Disqual",
    "datatype": "integer",
    "formula": "IF IFNULL([Stage1 Response], "") != "I am not receiving any disability benefits (SSD or SSI)"
THEN 1 ELSE 0 END",
    "name": "[Calculation_1133007210553487364]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Doctor Visit Disqual",
    "datatype": "integer",
    "formula": "IF [Stage4 Response] = "No" THEN 1 ELSE 0 END",
    "name": "[Calculation_1133007210553540613]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Five Year Work Disqual",
    "datatype": "integer",
    "formula": "IF [Stage3 Response] = "Less than 2 years"
OR [Stage3 Response] = "Between 2 and 4 years"
THEN 1 ELSE 0 END",
    "name": "[Calculation_1133007210553618438]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Out of Work Disqual",
    "datatype": "integer",
    "formula": "IF [Stage2 Response] = "No" THEN 1 ELSE 0 END",
    "name": "[Calculation_1133007210553663495]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "# of Disqual",
    "datatype": "integer",
    "formula": "ZN([Calculation_1133007210553487364]) +
ZN([Calculation_1133007210553663495]) +
ZN([Calculation_1133007210553618438]) +
ZN([Calculation_1133007210553540613]) +
ZN([Calculation_1133007210553425923]) +
ZN([Calculation_1133007210546622464]) +
ZN([Calculation_1133007210553298946])",
    "name": "[Calculation_1133007210553765896]",
    "role": "dimension",
    "type": "ordinal",
  },
  {
    "caption": "Date Filter Last 3 Days",
    "datatype": "boolean",
    "formula": "IF DATE([Post Date])>= TODAY()-3 AND DATE([Post Date])< TODAY() THEN TRUE ELSE FALSE END",
    "name": "[Calculation_1141381032181731330]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Row #",
    "datatype": "integer",
    "formula": "size()",
    "name": "[Calculation_1147573533293101059]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Selected Posts & Spends",
    "datatype": "real",
    "formula": "IF [Parameters].[Parameter 8] = '1' THEN 
countd(IF [Date]>=[Parameters].[Parameter 5] AND [Date]<=[Parameters].[Parameter 6] THEN
([User Id]) END)
ELSE 
sum({include [Source]: ZN(countd(IF [Date]>=[Parameters].[Parameter 5] AND [Date]<=[Parameters].[Parameter 6] THEN
([User Id]) END)*MAX([Calculation_6314891106343211008]))})

 END",
    "name": "[Calculation_1152077103901933571]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Mod Orig User Id",
    "datatype": "string",
    "formula": "if CONTAINS([CZ Project Name],'Aged') then [Orig User Id]
ELSE [User Id]
END",
    "name": "[Calculation_1189020709117038593]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "User Id ('orig_')",
    "datatype": "string",
    "formula": "'orig_' + [User Id]",
    "name": "[Calculation_1189020709117194242]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Row No",
    "datatype": "integer",
    "formula": "index()",
    "name": "[Calculation_1232578966339391490]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Month - Year",
    "datatype": "string",
    "formula": "DATENAME('month',[Post Date])+' '+ STR(YEAR([Post Date]))",
    "name": "[Calculation_1232578966341357571]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Levine States ",
    "datatype": "string",
    "formula": "IF ISNULL([Levine States]) THEN 'Other'
ELSE [Levine States] END",
    "name": "[Calculation_1277614987429064704]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "PD Dimensions  Combination",
    "datatype": "string",
    "formula": "IFNULL([Calculation_1232578966341357571],'')+
IFNULL([Calculation_6374000853571039236],'')+
IFNULL([D1 (copy)_6374000853573341191],'')+
IFNULL([D1 (copy) (copy)_6374000853573369864],'')+
IFNULL([D3 (copy)_6208563937532035081],'')+
IFNULL([D4 (copy)_6208563937532350475],'')",
    "name": "[Calculation_1341228293759967232]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "LM Combination",
    "datatype": "string",
    "formula": "IFNULL(STR([Post Date]),'')+
IFNULL([Phone],'')",
    "name": "[Calculation_1341228293760880641]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "MF Combination",
    "datatype": "string",
    "formula": "IFNULL(STR([Date]),'')+
IFNULL([User Id],'')+
IFNULL([Phone],'')",
    "name": "[Calculation_1341228293762342914]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "LD Combination",
    "datatype": "string",
    "formula": "IFNULL(STR([Post Date]), '')+
IFNULL([Project Id],'')+
IFNULL([Phone],'')",
    "name": "[Calculation_1341228293763407875]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Missing Leads in Vici %",
    "datatype": "real",
    "formula": "[Calculation_1419196839344672769]/sum({exclude [CZ Project Name]:[Calculation_97320012564762668]})",
    "name": "[Calculation_1419196839322677248]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Leads Missing in Vici #",
    "datatype": "integer",
    "formula": "COUNTD(if isnull([Vici User Flag]) 
and [Status] != "CONVERTED" 
and [Status] != "STOP" then [User Id] end)",
    "name": "[Calculation_1419196839344672769]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "DP Leak",
    "datatype": "string",
    "formula": "IF CONTAINS([clientname], 'disabilitypath')
AND [Calculation_7573084309404708864] in ('Grade A', 'Grade B')
THEN 'Yes'
ELSE 'No'
END",
    "name": "[Calculation_1460573688699854848]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Unresolved SSA Leads",
    "datatype": "string",
    "formula": "IF { FIXED [Phone] : MAX([Resolved Lead]) } = 0 THEN "SSA Unresolved Lead"
ELSEIF { FIXED [Phone] : MAX([Resolved Lead]) } = 1 THEN "SSA Resolved Lead"
END",
    "name": "[Calculation_1467962419029331969]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Leads Age",
    "datatype": "integer",
    "formula": "If (DATEDIFF('day',[Calculation_767300790176440343],TODAY()))>=0 Then 
(DATEDIFF('day',[Calculation_767300790176440343],TODAY()))
ELSE 0
END",
    "name": "[Calculation_1621014427239342104]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Text Response",
    "datatype": "string",
    "formula": "str(IF SUM([Inbound Messages]) >= 1 THEN 1 else 0 end)",
    "name": "[Calculation_1717560316595126272]",
    "role": "measure",
    "type": "nominal",
  },
  {
    "caption": "<5s Cumulative",
    "datatype": "integer",
    "formula": "//Updated Date: 18 May 2022
//Updated By: Manish
//Description: Calculating the sum of userid when ping age is between 0 and 5s

[Ping age (copy)_2399292755833638916]+[0 (copy)_2399292755834134533]",
    "name": "[Calculation_172262731327561728]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Sample Phone 20-39",
    "datatype": "boolean",
    "formula": "int(right([Phone],2))>=20 and int(right([Phone],2))<=39
//right([Phone],2)",
    "name": "[Calculation_1773010889799946240]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Email ",
    "datatype": "string",
    "formula": "lower([Email])",
    "name": "[Calculation_1773010889807245313]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "CTC Lead Flag",
    "datatype": "string",
    "formula": "if [CTC Lead] = 1 then "Yes" else "No" END",
    "name": "[Calculation_1880252886088871936]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "QL Leadbuy CTC Flag",
    "datatype": "boolean",
    "formula": "{fixed [Phone]: COUNTD(IF [sgmt]='ql-leadbuy' then [Phone] end)
+COUNTD(IF CONTAINS(LOWER([Transfer Info Label]),'cxer') then [Phone] end) } >1",
    "name": "[Calculation_1880252886119006209]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "CZ Post Hour Group",
    "datatype": "string",
    "formula": "IF DATEPART('hour', [Post Date]) >= 0 AND DATEPART('hour', [Post Date]) < 6 THEN 'Pre CC Hours'
ELSEIF DATEPART('hour', [Post Date]) >= 6 AND DATEPART('hour', [Post Date]) < 16 THEN 'CC Hours'
ELSEIF DATEPART('hour', [Post Date]) >= 16 AND DATEPART('hour', [Post Date]) < 24 THEN 'Post CC Hours'
END",
    "name": "[Calculation_1880252886125215747]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Post Date ",
    "datatype": "datetime",
    "formula": "//Updated Date: 18 May 2022
//Updated By: Manish
//Description: Formula to calculate UTC date

DATEADD("hour",0,[Post Date])",
    "name": "[Calculation_1916563181826678784]",
    "role": "dimension",
    "type": "ordinal",
  },
  {
    "caption": "PD Dimensions",
    "datatype": "string",
    "formula": "IFNULL(STR([Calculation_97320012552925214]),'')+
IFNULL([Calculation_6374000853571039236],'')+
IFNULL([D1 (copy)_6374000853573341191],'')+
IFNULL([D1 (copy) (copy)_6374000853573369864],'')+
IFNULL([D3 (copy)_6208563937532035081],'')+
IFNULL([D4 (copy)_6208563937532350475],'')",
    "name": "[Calculation_1999879738529857536]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Last 15 to 45 day Window",
    "datatype": "boolean",
    "formula": "if [Date]<= [Parameters].[Parameter 5]-15 AND [Date]>=[Parameters].[Parameter 5]-45 then true else false end",
    "name": "[Calculation_2006635132526440448]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "30 Day Window Leads #",
    "datatype": "integer",
    "formula": "IF {include :sum({fixed [CZ Project Name],[Source]: countd(if [Calculation_2006635132526440448]= true then [User Id] end)})} >= 10 then 

{include :sum({fixed [CZ Project Name],[Source]: countd(if [Calculation_2006635132526440448]= true then [User Id] end)})}

ELSE 

{exclude [Source],[Date] :sum({fixed [CZ Project Name]: countd(if [Calculation_2006635132526440448]= true then [User Id] end)})}

END",
    "name": "[Calculation_2006635132542951425]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "30 day Conv %",
    "datatype": "real",
    "formula": "ZN(sum([30 Day Window Leads # (copy)_2006635132547117058])/sum([Calculation_2006635132542951425]))",
    "name": "[Calculation_2006635132553568259]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Predicted Apps (1)",
    "datatype": "real",
    "formula": "COUNTD([User Id])*[Calculation_2006635132553568259]",
    "name": "[Calculation_2006635132591812613 1]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Predicted Apps",
    "datatype": "integer",
    "formula": "CEILING(COUNTD([User Id])*[Calculation_2006635132553568259])",
    "name": "[Calculation_2006635132591812613]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Data Updated On",
    "datatype": "datetime",
    "formula": "{fixed :max([Post Date])}",
    "name": "[Calculation_2010857255412854784]",
    "role": "dimension",
    "type": "ordinal",
  },
  {
    "caption": "{exclude [Source]:[Posted]}",
    "datatype": "integer",
    "formula": "{exclude [Source]:[Calculation_99712551082803223]}",
    "name": "[Calculation_2010857255441080325]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "% Scrub ",
    "datatype": "real",
    "formula": "//Updated Date: 18 May 2022
//Updated By: Manish
//Description: Calculating the percentage of scrub rejected

[Scrub Accept (copy)_7975100929064427530]/([Calculation_7975100929064054793]+[Scrub Accept (copy)_7975100929064427530])",
    "name": "[Calculation_2120632528679034884]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Last 7 Days",
    "datatype": "integer",
    "formula": "//Updated Date: 18 May 2022
//Updated By: Manish
//Description: Counting the unique count of user id in the last 7 days

COUNTD(IF [Date]>=DATEADD('day',-7,TODAY()) THEN [User Id] END)",
    "name": "[Calculation_2120632528687255559]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Phone (without area code)",
    "datatype": "string",
    "formula": "//Updated Date: 18 May 2022
//Updated By: Manish
//Description: Removing the area code from phone numbers

MID([Phone],3,10)",
    "name": "[Calculation_2120632528695742472]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "rowid",
    "datatype": "integer",
    "formula": "INDEX()",
    "name": "[Calculation_2146317124280909824]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Month",
    "datatype": "string",
    "formula": "//Updated Date: 18 May 2022
//Updated By: Manish
//Description: Concatinating the month and year name from post name

//DATENAME('month', [Post Time])

Left(DATENAME('month',[Calculation_8176144444085592065]), 3)+"-"+DATENAME('year',[Calculation_8176144444085592065])",
    "name": "[Calculation_2146317124290002947]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "ConcatText",
    "datatype": "integer",
    "formula": "//Updated Date: 18 May 2022
//Updated By: Manish
//Description: Concating the first 2 characters of first name, last name, city, state, postal code, DOB, ip, subid and trusted form columns and checking if the length of this text is equal to 18 or not

IF LEN(LEFT([First Name],2) + LEFT([Last Name],2) + LEFT([City],2) + LEFT([State],2) + LEFT([Postal Code],2) + LEFT([DOB],2) + LEFT([IP],2)  + LEFT([Sub Id],2) + LEFT([Trusted Form],2))
 = 18 THEN 0 ELSE 1 END",
    "name": "[Calculation_2370019326410940416]",
    "role": "dimension",
    "type": "ordinal",
  },
  {
    "caption": "Total",
    "datatype": "integer",
    "formula": "//Updated Date: 18 May 2022
//Updated By: Manish
//Description: Calculating the total of ping age

[0 (copy)_2399292755834134533]+[<005 (copy)_2399292755834429446]+[<005 (copy)_2399292755835043847]+[<010 (copy)_2399292755836125192]+[<100 (copy)_2399292755836203017]+[<200 (copy)_2399292755836375050]+[Ping age (copy)_2399292755833638916]",
    "name": "[Calculation_2399292755836653580]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "% <10s",
    "datatype": "real",
    "formula": "//Updated Date: 18 May 2022
//Updated By: Manish
//Description: Calculating the percentage of ping age <10s

[<5s Cumulative (copy)_2399292755837362190]/[Calculation_2399292755836653580]",
    "name": "[Calculation_2399292755837702159]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "5% Cutoff Filter",
    "datatype": "string",
    "formula": "//Updated Date: 18 May 2022
//Updated By: Manish
//Description: Filtering date based on 5% of ping age as cut off 

IF ZN([% <5s (copy)_2399292755838119952])<=[Parameters].[Parameter 3] THEN "Hide"
ELSE "Show" END",
    "name": "[Calculation_2399292755839614993]",
    "role": "measure",
    "type": "nominal",
  },
  {
    "caption": "Missing Fields with Trusted Form",
    "datatype": "integer",
    "formula": "//Last name, Subid, Zip, City, State by source.


COUNT(IF ISNULL([Last Name]) OR [Last Name] = ''
OR ISNULL([First Name]) OR [First Name] = ''
OR ISNULL([Sub Id]) OR [Sub Id] = '' 
OR ISNULL([Postal Code]) OR [Postal Code] = ''
OR ISNULL([IP]) OR [IP] = ''
OR ISNULL([Trusted Form]) OR [Trusted Form] = ''
OR ISNULL([DOB]) OR [DOB] = ''
OR ISNULL([City]) OR [City] = ''
OR ISNULL([State]) OR [State] = '' THEN [User Id] END)",
    "name": "[Calculation_2489223969907380226 1]",
    "role": "measure",
    "type": "ordinal",
  },
  {
    "caption": "Missing Fields",
    "datatype": "integer",
    "formula": "//Updated Date: 18 May 2022
//Updated By: Manish
//Description: Formula to include the missing fields in filters

//Last name, Subid, Zip, City, State by source.


COUNT(IF ISNULL([Last Name]) OR [Last Name] = ''
OR ISNULL([Sub Id]) OR [Sub Id] = '' 
OR ISNULL([Postal Code]) OR [Postal Code] = ''
OR ISNULL([City]) OR [City] = ''
OR ISNULL([State]) OR [State] = '' THEN [User Id] END)",
    "name": "[Calculation_2489223969907380226]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "RET Time ",
    "datatype": "datetime",
    "formula": "DATETIME([RET Time])",
    "name": "[Calculation_2490912847470878721]",
    "role": "dimension",
    "type": "ordinal",
  },
  {
    "caption": "Sl No",
    "datatype": "integer",
    "formula": "Index()",
    "name": "[Calculation_2490912847471489026]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "RET Date",
    "datatype": "string",
    "formula": "//Updated Date: 2 June 2022
//Updated By: Sree
//Description: Calculation to apply date bucket

CASE [Parameters].[Parameter 1]
WHEN 'year' THEN str(datepart('year', [Calculation_2490912847470878721]))
WHEN 'quarter' THEN "Q" + str(datepart('quarter', [Calculation_2490912847470878721])) + " " + str(datepart('year', [Calculation_2490912847470878721]))
WHEN 'month' THEN str(datepart('month', [Calculation_2490912847470878721])) + "-" + str(datepart('year', [Calculation_2490912847470878721]))
WHEN 'day' THEN str(datepart('day', [Calculation_2490912847470878721]))+ "-" + str(DATENAME('month', [Calculation_2490912847470878721]))+ "-" + str(datepart('year', [Calculation_2490912847470878721]))
WHEN 'week' THEN "W" + str(datepart('week', [Calculation_2490912847470878721])-1) + "-" + str(datepart('year', [Calculation_2490912847470878721]))
WHEN "hour" THEN str(DATETRUNC('hour', [Calculation_2490912847470878721]))
WHEN "minute" THEN str(DATETRUNC('minute', [Calculation_2490912847470878721]))
END",
    "name": "[Calculation_2490912847471951875]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Masked Email",
    "datatype": "string",
    "formula": "Replace(Email,SPLIT([Email],'@',1),'******')",
    "name": "[Calculation_2902429233285222401]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Masked Address",
    "datatype": "string",
    "formula": "//Replace([Address],SPLIT([Address],' ',1),'******')
'***********' + ' ' + SPLIT([Address],' ',-1)",
    "name": "[Calculation_2902429233286373378]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "TOTAL([Missing Leads in CRM])",
    "datatype": "integer",
    "formula": "TOTAL([Missing Leads in Vici (copy)_336081184380698624])",
    "name": "[Calculation_336081184382418945]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Lead Sell Type",
    "datatype": "string",
    "formula": "if contains([Transfer Info Label],'CXER') then 'Sold: Call' 
elseif 
contains([sgmt],'ql-leadbuy') or 
contains([ATA Work],'ql-leadbuy')
then 'Sold: Lead'
else 'Internal'
end",
    "name": "[Calculation_3435894714053935109]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Exclude Aged",
    "datatype": "boolean",
    "formula": "if CONTAINS([CZ Project Name],'Aged') then false else true end",
    "name": "[Calculation_3490641600574599172]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Campaign + Post Time",
    "datatype": "string",
    "formula": "//Updated Date: 18 May 2022
//Updated By: Manish
//Description: Concatinating campaign and post date

[CZ Project Name]+' - '+[Calculation_97320012552925214]",
    "name": "[Calculation_3528218480124293121]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "L15D Dupes #",
    "datatype": "integer",
    "formula": "COUNTD(
  IF [appearance_l15d] > 0
  THEN [Calculation_906349454594166784]
  END)",
    "name": "[Calculation_3545951403000930304]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "L3D Dupes #",
    "datatype": "integer",
    "formula": "COUNTD(
  IF [appearance_l3d] > 0
  THEN [Calculation_906349454594166784]
  END)",
    "name": "[Calculation_3545951403001835522]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "L7D Dupes #",
    "datatype": "integer",
    "formula": "COUNTD(
  IF [appearance_l7d] > 0
  THEN [Calculation_906349454594166784]
  END)",
    "name": "[Calculation_3545951403002036227]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "L30D Dupes #",
    "datatype": "integer",
    "formula": "COUNTD(
  IF [appearance_l30d] > 0
  THEN [Calculation_906349454594166784]
  END)",
    "name": "[Calculation_3545951403002183684]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "L60D Dupes #",
    "datatype": "integer",
    "formula": "COUNTD(
  IF [appearance_l60d] > 0
  THEN [Calculation_906349454594166784]
  END)",
    "name": "[Calculation_3545951403002527749]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "L90D Dupes #",
    "datatype": "integer",
    "formula": "COUNTD(
  IF [appearance_l90d] > 0
  THEN [Calculation_906349454594166784]
  END)",
    "name": "[Calculation_3545951403003084806]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Site Source ",
    "datatype": "string",
    "formula": "If [Parameters].[Show Source (copy)_3999970530356424704] = "1" then [Site Source]
else "Agg" end",
    "name": "[Calculation_3999970530356551681]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "WEB Filter",
    "datatype": "boolean",
    "formula": "if isnull([User Id (WEB)]) then FALSE else TRUE end",
    "name": "[Calculation_4158652048189837312]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "APRET (WEB)",
    "datatype": "integer",
    "formula": "if isnull([ Status (AGT)]) then 0 else 1 end",
    "name": "[Calculation_4158652048191238145]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Conv % ",
    "datatype": "real",
    "formula": "sum([Calculation_4158652048191238145])/[Calculation_99712551082803223]",
    "name": "[Calculation_4158652048191483906]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Site Source Filter",
    "datatype": "boolean",
    "formula": "if isnull([Site Source]) OR [Site Source] = "" then FALSE else TRUE end",
    "name": "[Calculation_4158652048200994819]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Leads_userid",
    "datatype": "integer",
    "formula": "//Updated Date: 18 May 2022
//Updated By: Manish
//Description: Calculating the unique count of user ids

COUNTD([User Id])",
    "name": "[Calculation_4201436298028802048]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Seg4 Control vs. Treatment",
    "datatype": "string",
    "formula": "IF [CZ Project Name] = "Mass Tort - High Intent SSDI" AND [Calculation_1880252886088871936] = "No" AND [qual_status] != "all-steps" THEN
    IF INT(RIGHT([phone masked], 3)) % 2 = 0 THEN "Control"
    ELSEIF INT(RIGHT([phone masked], 3)) % 2 != 0 THEN "Treatment"
    END
END",
    "name": "[Calculation_4531465651676315649]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Seg4 Cohort",
    "datatype": "string",
    "formula": "LOWER(IFNULL([seg4_cohort], [Calculation_4531465651676315649]))",
    "name": "[Calculation_4531465651676438530]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "SourceId Flag",
    "datatype": "string",
    "formula": "//Updated Date: 18 May 2022
//Updated By: Manish//Description: Calculating max of todays date for including it in the default values of end date
//Description: Flagging sourceid as null or not null based on orig source id column

IF [Calculation_8402872493470011392] = '' OR ISNULL([Calculation_8402872493470011392]) THEN 'Null' ELSE 'Not Null' END",
    "name": "[Calculation_470907651847188482]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Date Str of Post Date",
    "datatype": "string",
    "formula": "//Updated Date: 18 May 2022
//Updated By: Manish
//Description: Extracting the date part of post time

LEFT(str([Calculation_8176144444085592065]),10)",
    "name": "[Calculation_4794996655180886018]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Campaign & Day of Post Date",
    "datatype": "string",
    "formula": "//Updated Date: 18 May 2022
//Updated By: Manish
//Description: Concatinating campaigna and date in UTC

[CZ Project Name]+":"+ STR([Calculation_1916563181826678784])",
    "name": "[Calculation_4891401821032828929]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Avg CPL",
    "datatype": "real",
    "formula": "//Updated Date: 18 May 2022
//Updated By: Manish
//Description: Calculating the avg CPL

ZN(SUM(ZN(CPL))/ZN([Calculation_99712551082803223]))",
    "name": "[Calculation_4891401821037686787]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Posted ",
    "datatype": "string",
    "formula": "//Updated Date: 18 May 2022
//Updated By: Manish
//Description: blank column

""",
    "name": "[Calculation_4891401821043871748]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Time to Call (Minute)",
    "datatype": "real",
    "formula": "IF [Calculation_1880252886088871936] = 'Yes'
THEN ROUND(([CTC Time] - [Post Date]) * 24 * 60, 2)
END",
    "name": "[Calculation_499055157752631296]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Time to Call Bucket",
    "datatype": "string",
    "formula": "IF  [Calculation_499055157752631296] < 0
THEN '<0 Mins'
ELSEIF [Calculation_499055157752631296] <= 2 AND [Calculation_499055157752631296] >= 0
THEN '0-2 Mins'
ELSEIF [Calculation_499055157752631296] <= 5 AND [Calculation_499055157752631296] > 0
THEN '2-5 Mins'
ELSEIF [Calculation_499055157752631296] <= 10 AND [Calculation_499055157752631296] > 0
THEN '5-10 Mins'
ELSEIF [Calculation_499055157752631296] <= 30 AND [Calculation_499055157752631296] > 0 
THEN '10-30 Mins'
ELSEIF [Calculation_499055157752631296] <= 60 AND [Calculation_499055157752631296] > 0
THEN '30Mins-1 Hour'
ELSEIF [Calculation_499055157752631296] <= 300 AND [Calculation_499055157752631296] > 0
THEN '1-5 Hours'
ELSEIF [Calculation_499055157752631296] <= 600 AND [Calculation_499055157752631296] > 0
THEN '5-10 Hours'
ELSEIF [Calculation_499055157752631296] <= 1440 AND [Calculation_499055157752631296] > 0
THEN '10-24 Hours'
ELSEIF [Calculation_499055157752631296] <= 4320 AND [Calculation_499055157752631296] > 0
THEN '24-72 Hours'
ELSEIF [Calculation_499055157752631296] > 4320 AND [Calculation_499055157752631296] > 0
THEN '>72 Hours'
END",
    "name": "[Calculation_499055157754740737]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Date Filter last 2 weeks",
    "datatype": "boolean",
    "formula": "IF [Date]>= dateadd('day',-14,datetrunc('week',today(),'sunday')) then true else false end",
    "name": "[Calculation_535928404275974144]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Posted Wk1",
    "datatype": "integer",
    "formula": "({include [Sub Id]: countD(if [Date]>= dateadd('day',-7,datetrunc('week',today(),'sunday')) then [User Id] end)})",
    "name": "[Calculation_535928404288794625]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "% Posted Wk1",
    "datatype": "real",
    "formula": "ifnull([Calculation_535928404288794625]/{exclude [Sub Id]: countD(if [Date]>= dateadd('day',-7,datetrunc('week',today(),'sunday')) then [User Id] end)},0)",
    "name": "[Calculation_535928404317847556]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Square of Diff",
    "datatype": "real",
    "formula": "SQUARE([% Last week Leads (copy)_535928404325892101]-[Calculation_535928404317847556])",
    "name": "[Calculation_535928404326711302]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "SubID Counts",
    "datatype": "integer",
    "formula": "{include : COUNTD([Sub Id])}",
    "name": "[Calculation_535928404328525831]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "RMSD Score",
    "datatype": "real",
    "formula": "SQRT(SUM([Calculation_535928404326711302])/COUNTD([Sub Id]))",
    "name": "[Calculation_535928404332609544]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "RSMD",
    "datatype": "string",
    "formula": "'RMSD Score'",
    "name": "[Calculation_535928404338208781]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Source-Month",
    "datatype": "string",
    "formula": "//Updated Date: 18 May 2022
//Updated By: Manish//Description: Calculating max of todays date for including it in the default values of end date
//Description: Concatinating source and month column

[Source]+[Calculation_2146317124290002947]",
    "name": "[Calculation_5504876552026787843]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "% Missing in Vici",
    "datatype": "real",
    "formula": "[Calculation_1419196839344672769]/sum({exclude [CZ Project Name]:[Calculation_97320012564762668]})",
    "name": "[Calculation_5751800461652443136]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Excluded States",
    "datatype": "string",
    "formula": "//Updated Date: 18 May 2022
//Updated By: Manish
//Description: Calculating the excluded states

IF ISNULL([Excluded States]) THEN 'Included States'
ELSE [Campaign]+' - '+[Excluded States] END",
    "name": "[Calculation_5805843619105710080]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Lead Count Color ",
    "datatype": "string",
    "formula": "IF DATE([Post Date]) = today()-1 THEN
    IF {Fixed [Campaign & Date (copy)_1141381032179245056]: [Calculation_585749428084588551]}<={Fixed [Campaign & Date (copy)_1141381032179245056]: [Today Lead Count (copy)_585749428086071304]} 
    //AND {Fixed [Campaign & Source]: [Today-2 Lead Count]}>=20
    THEN 'Red'
    ELSE 'Green' END
ELSE 'Grey'
END",
    "name": "[Calculation_585749428081770502]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Today Lead Count",
    "datatype": "integer",
    "formula": "COUNTD(IF DATE([Post Date])= today()-1 then [User Id]  END)",
    "name": "[Calculation_585749428084588551]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Project Type",
    "datatype": "string",
    "formula": "IF CONTAINS([CZ Project Name],'Aged') THEN 'Aged'
ELSE 'Live' END",
    "name": "[Calculation_5872834692856524810]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Date filter for 301-Days",
    "datatype": "boolean",
    "formula": "//Updated Date: 18 May 2022
//Updated By: Manish
//Description: Filtering data based from 28th day to got back 300 days based on start time


[Calculation_767300790176440343]>=today()-301 AND [Calculation_767300790176440343]<=today()",
    "name": "[Calculation_6274992047113019392]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "CPL New",
    "datatype": "real",
    "formula": "//Updated Date: 18 May 2022
//Updated By: Manish
//Description: Considering CPL if outcome is initialised

IF [Outcome] = 'initialized' THEN [CPL]ELSE 0 END",
    "name": "[Calculation_6314891106343211008]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Missing Leads in CRM Flag",
    "datatype": "integer",
    "formula": "IF isnull([CRM Flag]) THEN  1 else 0 END",
    "name": "[Calculation_632192798363463680]",
    "role": "dimension",
    "type": "ordinal",
  },
  {
    "caption": "BLA Status",
    "datatype": "string",
    "formula": "IF [bla_blacklisted] = 'true' THEN 'Blacklisted'
ELSEIF [bla_blacklisted] = 'false' THEN 'Passed'
ELSE NULL
END",
    "name": "[Calculation_6374000853565702144]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "BLA Code",
    "datatype": "string",
    "formula": "[bla_rejectcodes]",
    "name": "[Calculation_6374000853566275585]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Line Type",
    "datatype": "string",
    "formula": "[Phone Type]",
    "name": "[Calculation_6374000853570142211]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "D1 ('+' to add dim)",
    "datatype": "string",
    "formula": "IF [Parameters].[Parameter 10] = 1 THEN [Calculation_6374000853566275585]
ELSEIF [Parameters].[Parameter 10] = 2 THEN [bla_carrierdata_type]
ELSEIF [Parameters].[Parameter 10] = 3 THEN [Calculation_6374000853565702144]
ELSEIF [Parameters].[Parameter 10] = 4 THEN [Phone Carrier]
ELSEIF [Parameters].[Parameter 10] = 5 THEN [CZ Project Name]
ELSEIF [Parameters].[Parameter 10] = 6 THEN [Phone Type]
ELSEIF [Parameters].[Parameter 10] = 7 THEN [normalized carrier]
ELSEIF [Parameters].[Parameter 10] = 8 THEN [Outcome]
ELSEIF [Parameters].[Parameter 10] = 9 THEN [qual_status]
ELSEIF [Parameters].[Parameter 10] = 10 THEN [Source]
ELSEIF [Parameters].[Parameter 10] = 11 THEN [Sub Id]
ELSEIF [Parameters].[Parameter 10] = 12 THEN [gender (copy)_2399292755830108162]
ELSEIF [Parameters].[Parameter 10] = 13 THEN [Creative]
ELSEIF [Parameters].[Parameter 10] = 14 THEN [CL Diagnosis Injury Tiers]
ELSEIF [Parameters].[Parameter 10] = 15 THEN [Calculation_935059914517495808]
ELSEIF [Parameters].[Parameter 10] = 16 THEN [Ad Name]
ELSEIF [Parameters].[Parameter 10] = 17 THEN [Adset Name]
ELSEIF [Parameters].[Parameter 10] = 18 THEN [campaign_id]
ELSEIF [Parameters].[Parameter 10] = 19 THEN [Labels]
ELSEIF [Parameters].[Parameter 10] = 20 THEN [Calculation_5872834692856524810]
ELSEIF [Parameters].[Parameter 10] = 21 THEN [State]
ELSEIF [Parameters].[Parameter 10] = 22 THEN [Phone]
// ELSEIF [D1] = 23 THEN [Tier]
ELSEIF [Parameters].[Parameter 10] = 23 THEN [Calculation_1277614987429064704]
ELSEIF [Parameters].[Parameter 10] = 25 THEN [Result Type]
ELSEIF [Parameters].[Parameter 10] = 26 THEN [placement]
ELSEIF [Parameters].[Parameter 10] = 27 THEN [Calculation_7690318609259716608]
ELSEIF [Parameters].[Parameter 10] = 28 THEN [label]
ELSEIF [Parameters].[Parameter 10] = 29 THEN STR([Calculation_1880252886088871936])
ELSEIF [Parameters].[Parameter 10] = 30 THEN [clientname]
ELSEIF [Parameters].[Parameter 10] = 31 THEN [page_path]
ELSEIF [Parameters].[Parameter 10] = 32 THEN [sgmt]
ELSEIF [Parameters].[Parameter 10] = 33 THEN [ctcphone]
ELSEIF [Parameters].[Parameter 10] = 34 THEN [Calculation_3435894714053935109]
ELSEIF [Parameters].[Parameter 10] = 35 THEN [ltdinoworkmedicalconditions]
ELSEIF [Parameters].[Parameter 10] = 36 THEN [ds_qualstatus]
ELSEIF [Parameters].[Parameter 10] = 37 THEN [ad_id]
ELSEIF [Parameters].[Parameter 10] = 38 THEN [adset_id]
ELSEIF [Parameters].[Parameter 10] = 39 THEN [Calculation_1113233589182521344]
ELSEIF [Parameters].[Parameter 10] = 40 THEN [Calculation_1880252886125215747]
ELSEIF [Parameters].[Parameter 10] = 41 THEN [SubSegment]
ELSEIF [Parameters].[Parameter 10] = 42 THEN STR([Calculation_1133007210553765896])
ELSEIF [Parameters].[Parameter 10] = 43 THEN [Calculation_7573084309404708864]
ELSEIF [Parameters].[Parameter 10] = 44 THEN [Calculation_4531465651676438530]
ELSEIF [Parameters].[Parameter 10] = 45 THEN IF LEN(STR([appearance_l30d])) < 2 AND NOT ISNULL(STR([appearance_l30d])) THEN '0' + STR([appearance_l30d]) ELSE STR([appearance_l30d]) END
ELSEIF [Parameters].[Parameter 10] = 46 THEN IF LEN(STR([appearance_l60d])) < 2 AND NOT ISNULL(STR([appearance_l60d])) THEN '0' + STR([appearance_l60d]) ELSE STR([appearance_l60d]) END
ELSEIF [Parameters].[Parameter 10] = 47 THEN IF LEN(STR([appearance_l90d])) < 2 AND NOT ISNULL(STR([appearance_l90d])) THEN '0' + STR([appearance_l90d]) ELSE STR([appearance_l90d]) END
ELSEIF [Parameters].[Parameter 10] = 48 THEN [ATA Work]
ELSEIF [Parameters].[Parameter 10] = 49 THEN [Calculation_499055157754740737]
ELSEIF [Parameters].[Parameter 10] = 50 THEN IF LEN(STR([CIIC Appearance in L30D])) < 2 AND NOT ISNULL(STR([CIIC Appearance in L30D])) THEN '0' + STR([CIIC Appearance in L30D]) ELSE STR([CIIC Appearance in L30D]) END
ELSEIF [Parameters].[Parameter 10] = 51 THEN IF LEN(STR([CIIC Appearance in L60D])) < 2 AND NOT ISNULL(STR([CIIC Appearance in L60D])) THEN '0' + STR([CIIC Appearance in L60D]) ELSE STR([CIIC Appearance in L60D]) END
ELSEIF [Parameters].[Parameter 10] = 52 THEN IF LEN(STR([CIIC Appearance in L90D])) < 2 AND NOT ISNULL(STR([CIIC Appearance in L90D])) THEN '0' + STR([CIIC Appearance in L90D]) ELSE STR([CIIC Appearance in L90D]) END
ELSEIF [Parameters].[Parameter 10] = 53 THEN STR([Calculation_989947527401095169])
ELSEIF [Parameters].[Parameter 10] = 54 THEN [Calculation_1460573688699854848]
ELSEIF [Parameters].[Parameter 10] = 55 THEN [Calculation_1006061976934187009]
ELSE 'Agg'
END",
    "name": "[Calculation_6374000853571039236]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "project",
    "datatype": "string",
    "formula": "//Updated Date: 18 May 2022
//Updated By: Manish
//Description: Extracting the project name from campaign name

SPLIT([CZ Project Name],'.',1)",
    "name": "[Calculation_7568580651781812254]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Grade",
    "datatype": "string",
    "formula": "// Grade A
IF [qual_status] = 'all-steps' THEN 'Grade A'

// Grade B
ELSEIF 
    [qual_status] IN ('fiveyrwrk-disqual','outofwrk-disqual','doc-disqual')
    AND [Calculation_1133007210553765896] = 1
THEN 'Grade B'

// Grade C
ELSEIF 
    [qual_status] <> 'age-disqual'
    AND NOT [Stage3 Response] IN ('Less than 2 years', 'Between 2 and 4 years')
    AND [Stage1 Response] <> 'Social Security Disability (SSD) Benefits'
    AND [Stage6 Response] = 'Not working'
THEN 'Grade C'

// Grade D
ELSEIF 
    // 1) Not age-disqual, Stage3 NOT in those two, Stage1 not SSD, Stage6 ≠ Not working, disqual ≤ 1
    (
      [qual_status] <> 'age-disqual'
      AND NOT [Stage3 Response] IN ('Less than 2 years', 'Between 2 and 4 years')
      AND [Stage1 Response] <> 'Social Security Disability (SSD) Benefits'
      AND [Stage6 Response] <> 'Not working'
      AND [Calculation_1133007210553765896] <= 1
    )
    // 2) Not age-disqual, Stage3 in those two, Qual Status = outofwrk-disqual
    OR
    (
      [qual_status] <> 'age-disqual'
      AND [Stage3 Response] IN ('Less than 2 years', 'Between 2 and 4 years')
      AND [qual_status] = 'outofwrk-disqual'
    )
    // 3) Not age-disqual, Stage3 in those two, Qual Status ≠ outofwrk-disqual, Stage7 = Yes
    OR
    (
      [qual_status] <> 'age-disqual'
      AND [Stage3 Response] IN ('Less than 2 years', 'Between 2 and 4 years')
      AND [qual_status] <> 'outofwrk-disqual'
      AND [Stage7 Response] = 'Yes'
    )
THEN 'Grade D'

// Rest (including age-disqual or anything else)
ELSE 'Rest'
END",
    "name": "[Calculation_7573084309404708864]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Hours Since Sat",
    "datatype": "integer",
    "formula": "//Updated Date: 18 May 2022
//Updated By: Manish
//Description: Calculating the differnce in hours since the previous saturday

//date_part(h, getdate()) + ((date_part(dow, getdate())+1)*24) +7

{MAX(DATEDIFF('hour',DATEADD('day',-1,Datetrunc('week',today())),now()))}",
    "name": "[Calculation_767300789949067266]",
    "role": "dimension",
    "type": "ordinal",
  },
  {
    "caption": "hours since now",
    "datatype": "integer",
    "formula": "//Updated Date: 18 May 2022
//Updated By: Manish
//Description: Calculating the difference in hours between today and post date

datediff("hour",[Post Date],datetime(now()))",
    "name": "[Calculation_767300789951021059]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Date diff from Saturday",
    "datatype": "boolean",
    "formula": "//Updated Date: 18 May 2022
//Updated By: Manish
//Description: Calculating the differnce in hours from saturday to today

[Calculation_767300789951021059]<=[Calculation_767300789949067266]",
    "name": "[Calculation_767300789951361028]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "CPL is Null?",
    "datatype": "boolean",
    "formula": "//Updated Date: 18 May 2022
//Updated By: Manish
//Description: Checking if CPL column is null or not

NOT ISNULL([CPL])",
    "name": "[Calculation_767300789958365193]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Date filter with Start Date",
    "datatype": "boolean",
    "formula": "//Updated Date: 18 May 2022
//Updated By: Manish
//Description: Calculation to apply date filter with respect to leads upload start date

DATE([Calculation_767300790176440343]) >= [Parameters].[Start Date (copy)_767300789999747090] AND  DATE([Calculation_767300790176440343])<=[Parameters].[End Date (copy)_767300789999759379] AND DATE([Calculation_767300790176440343])<=today()-21",
    "name": "[Calculation_767300789999640593]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Today-28",
    "datatype": "date",
    "formula": "//Updated Date: 18 May 2022
//Updated By: Manish
//Description: Going back 28 days from today

({MAX(today()-28)})",
    "name": "[Calculation_767300790172184597]",
    "role": "dimension",
    "type": "ordinal",
  },
  {
    "caption": "Today-300",
    "datatype": "date",
    "formula": "//Updated Date: 18 May 2022
//Updated By: Manish
//Description: Going back 300 days from today

({MAX(today()-300)})",
    "name": "[Calculation_767300790172483606]",
    "role": "dimension",
    "type": "ordinal",
  },
  {
    "caption": "Start Time",
    "datatype": "date",
    "formula": "//DATEADD('hour',0,DATEPARSE('MMM dd, yyyy hh:mm:ss',TRIM(SPLIT([LED].[Start Time],' UTC',1))))
DATE([Calculation_1916563181826678784])",
    "name": "[Calculation_767300790176440343]",
    "role": "dimension",
    "type": "ordinal",
  },
  {
    "caption": "SSD Age Range",
    "datatype": "string",
    "formula": "IF DATE([Calculation_1916563181826678784]) >= #18/08/2025#
THEN
    IF INT([Age]) < 40 THEN "U40"
    ELSEIF INT([Age]) >= 40 AND INT([Age]) <= 49 THEN "40 - 49"
	ELSEIF INT([Age]) >= 50 AND INT([Age]) <= 54 THEN "50 - 54"
    ELSEIF INT([Age]) >= 55 AND INT([Age]) <= 63 THEN "55 - 63"
    ELSEIF INT([Age]) >= 64 THEN "O64+"
    END
ELSEIF INT([Age]) < 40 THEN "*U40"
ELSEIF INT([Age]) >= 40 AND INT([Age]) <= 48 THEN "*40-48"
ELSEIF INT([Age]) = 49 THEN "*49"
ELSEIF INT([Age]) >= 50 AND INT([Age]) <= 62 THEN "*50-62"
ELSEIF INT([Age]) >= 63 THEN "*O63+" 
END",
    "name": "[Calculation_7690318609259716608]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Lead Posted #",
    "datatype": "integer",
    "formula": "COUNTD([Calculation_906349454594166784])",
    "name": "[Calculation_7711781056550006784]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Scrub status",
    "datatype": "string",
    "formula": "//Updated Date: 18 May 2022
//Updated By: Manish
//Description: Calculating the status based on outcome

IF [Outcome]='initialized' then 'Accepted'
            else 'Rejected'
        end",
    "name": "[Calculation_7746824680806834178]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Accepted",
    "datatype": "integer",
    "formula": "//Updated Date: 18 May 2022
//Updated By: Manish
//Description: Calculating the unique count of userid when scrub status is accepted

COUNTD(IF [Calculation_7746824680806834178] = 'Accepted' THEN [User Id] END)",
    "name": "[Calculation_7746824680806989827]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Scrub %",
    "datatype": "real",
    "formula": "//Updated Date: 18 May 2022
//Updated By: Manish
//Description: Calculating the 5 of rejected scrub status

([Accepted (copy)_7746824680807407620]*1.00)/([Calculation_7746824680806989827]+[Accepted (copy)_7746824680807407620])",
    "name": "[Calculation_7746824680807591941]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Time-Source-Subid",
    "datatype": "string",
    "formula": "//Updated Date: 18 May 2022
//Updated By: Manish
//Description: Changing the data type to string of Time-Source-Subid column

STR([Date])+'-'+[Source]+'-'+[Sub Id]",
    "name": "[Calculation_7746824680808361990]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "FirstName #",
    "datatype": "integer",
    "formula": "//Updated Date: 18 May 2022
//Updated By: Manish
//Description: Checking if first name is null or not

IF ISNULL([First Name]) THEN 1 ELSE 0 END",
    "name": "[Calculation_7848437147364691990]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Scrub Accept",
    "datatype": "integer",
    "formula": "//Updated Date: 18 May 2022
//Updated By: Manish
//Description: Calculating the unique count of user id when outcome is initialised

COUNTD(IF [Outcome]='initialized' THEN [User Id] END)",
    "name": "[Calculation_7975100929064054793]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Missing Leads in Vici",
    "datatype": "integer",
    "formula": "//Updated Date: 18 May 2022
//Updated By: Manish
//Description: Calculating the unique count of Phone

COUNT(IF ISNULL([Vici User Flag]) THEN [Phone] END)",
    "name": "[Calculation_7975100929080872974]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Dupe Count",
    "datatype": "integer",
    "formula": "//Updated Date: 18 May 2022
//Updated By: Manish
//Description: Counting unique count of user id when outcome is initialzed

COUNTD(IF [Outcome]="initialized" THEN [User Id] END)",
    "name": "[Calculation_7975100929094058002]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Day of Post Date (Copy)",
    "datatype": "date",
    "formula": "//Updated Date: 18 May 2022
//Updated By: Manish
//Description: Formula to include date conversion from UTC to PT

DATE(DATEADD("hour",0,[Post Date]))",
    "name": "[Calculation_8176144444085592065]",
    "role": "dimension",
    "type": "ordinal",
  },
  {
    "caption": "Phone (w/o area code)",
    "datatype": "string",
    "formula": "//Updated Date: 18 May 2022
//Updated By: Manish
//Description: Removing the area code from phone numbers

MID([Phone],4)",
    "name": "[Calculation_8176144444085837826]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Orig Source Id",
    "datatype": "string",
    "formula": "//Updated Date: 18 May 2022
//Updated By: Manish
//Description: Extracting the orig source id from source id column

IF CONTAINS([CZ Project Name],'Aged') Then [Aged Orig Source Id]
ELSE ifnull(MID([Source Id],FINDNTH([Source Id],'|',2)+1),"")
END",
    "name": "[Calculation_8402872493470011392]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "CTC Leads #",
    "datatype": "integer",
    "formula": "countd(if [CTC Lead] = 1 then [Calculation_906349454594166784] end)",
    "name": "[Calculation_8421379501118734337]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Min Date",
    "datatype": "date",
    "formula": "//Updated Date: 18 May 2022
//Updated By: Manish
//Description: Calculating max of todays date for including it in the default values of start date

{MAX(today()-7)}",
    "name": "[Calculation_843580506575257602]",
    "role": "dimension",
    "type": "ordinal",
  },
  {
    "caption": "Date Filter",
    "datatype": "boolean",
    "formula": "//Updated Date: 18 May 2022
//Updated By: Manish
//Description: Filtering data based on date

IF [Parameters].[Parameter 11] = 'default'
THEN [Date]>=[Parameters].[Parameter 5] AND [Date]<=[Parameters].[Parameter 6]
ELSEIF [Parameters].[Parameter 11] = 'weekly'
THEN [Date] >= TODAY()-8 AND [Date] <= TODAY()-1
END",
    "name": "[Calculation_843580506575679492]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Dial R",
    "datatype": "string",
    "formula": "IF  [Called Count] < 4 then "<=3" 
elseif [Called Count] < 8 then "4-7"
elseif [Called Count] < 11 then "8-10"
elseif [Called Count] < 16 then "11-15"
elseif [Called Count] < 20 then "16-19"
elseif [Called Count] < 26 then "20-25"
elseif [Called Count] < 31 then "25-30"
elseif [Called Count] < 36 then "30-35"
else "35+" 
END",
    "name": "[Calculation_847802666706034688]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Dial R (detail)",
    "datatype": "string",
    "formula": "STR([Called Count])",
    "name": "[Calculation_847802666706186241]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "LtdiNoWorkMedicalConditions Flag",
    "datatype": "integer",
    "formula": "IF [ltdinoworkmedicalconditions] IN ('yes', 'no') THEN 1 ELSE 0 END",
    "name": "[Calculation_866661498626928640]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "LtdiNoWorkMedicalConditions #",
    "datatype": "integer",
    "formula": "SUM([Calculation_866661498626928640])",
    "name": "[Calculation_866661498627473409]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Max Date",
    "datatype": "date",
    "formula": "//Updated Date: 18 May 2022
//Updated By: Manish
//Description: Calculating max of todays date for including it in the default values of end date

{MAX(today())}",
    "name": "[Calculation_882424053213511680]",
    "role": "dimension",
    "type": "ordinal",
  },
  {
    "caption": "User Identifier",
    "datatype": "string",
    "formula": "IF [Parameters].[Parameter 12] = 0 THEN [User Id]
ELSEIF [Parameters].[Parameter 12] = 1 THEN [Phone]
END",
    "name": "[Calculation_906349454594166784]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "CTC L30D Dupes #",
    "datatype": "integer",
    "formula": "COUNTD(
  IF [CIIC Appearance in L30D] > 0
    AND [CTC Lead] = 1
  THEN [Calculation_906349454594166784]
  END)",
    "name": "[Calculation_906349454597083138]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "CTC L60D Dupes #",
    "datatype": "integer",
    "formula": "COUNTD(
  IF [CIIC Appearance in L60D] > 0
    AND [CTC Lead] = 1
  THEN [Calculation_906349454594166784]
  END)",
    "name": "[Calculation_906349454597230595]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "CTC L90D Dupes #",
    "datatype": "integer",
    "formula": "COUNTD(
  IF [CIIC Appearance in L90D] > 0
    AND [CTC Lead] = 1
  THEN [Calculation_906349454594166784]
  END)",
    "name": "[Calculation_906349454597341188]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Alt. Branding",
    "datatype": "string",
    "formula": "If int(Right([Phone],2))<30 and [Calculation_5872834692856524810]= 'Live' then 'Yes' else 'No' End",
    "name": "[Calculation_935059914517495808]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Duplicate Rejects",
    "datatype": "string",
    "formula": "if [Outcome]='rejected' and { FIXED [Phone], [Outcome]: COUNTD([User Id])}>1 then 'Yes' else 'No' end",
    "name": "[Calculation_943222690415542272]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Post Date  ",
    "datatype": "string",
    "formula": "//Updated Date: 18 May 2022
//Updated By: Manish
//Description: Calculation to apply date bucket

CASE [Parameters].[Parameter 1]
WHEN 'year' THEN str(datepart('year', [Calculation_1916563181826678784]))
WHEN 'quarter' THEN "Q" + str(datepart('quarter', [Calculation_1916563181826678784])) + " " + str(datepart('year', [Calculation_1916563181826678784]))
WHEN 'month' THEN str(datepart('month', [Calculation_1916563181826678784])) + "-" + str(datepart('year', [Calculation_1916563181826678784]))
WHEN 'day' THEN str(DATENAME('month', [Calculation_1916563181826678784]))+ "-" +str(datepart('day', [Calculation_1916563181826678784]))+ "-" + str(datepart('year', [Calculation_1916563181826678784]))
WHEN 'week' THEN "W" + str(datepart('week', [Calculation_1916563181826678784])) + "-" + str(datepart('year', [Calculation_1916563181826678784]))
WHEN "hour" THEN str(DATETRUNC('hour', [Calculation_1916563181826678784]))
WHEN "minute" THEN str(DATETRUNC('minute', [Calculation_1916563181826678784]))
END",
    "name": "[Calculation_97320012552925214]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "8th and 9th digit",
    "datatype": "string",
    "formula": "//Updated Date: 18 May 2022
//Updated By: Manish
//Description: Extracting the 7th and 8thdigit from phone column

MID(RIGHT([phone masked],3),1,2)",
    "name": "[Calculation_97320012553556001]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Row Id",
    "datatype": "integer",
    "formula": "INDEX()",
    "name": "[Calculation_97320012553666594]",
    "role": "measure",
    "type": "ordinal",
  },
  {
    "caption": "Ping age",
    "datatype": "string",
    "formula": "//Updated Date: 18 May 2022
//Updated By: Manish
//Description: Bucketing the ping age column wrt seconds

IF [Ping Age (s)]= 0 then '0'
ELSEIF [Ping Age (s)]>0 and [Ping Age (s)]<=5 then '<005'
ELSEIF [Ping Age (s)]>5 and [Ping Age (s)]<=10 then '<010'
ELSEIF [Ping Age (s)]>10 and [Ping Age (s)]<=25 then '<025'
ELSEIF [Ping Age (s)]>25 and [Ping Age (s)]<=100 then '<100'
ELSEIF [Ping Age (s)]>100 and [Ping Age (s)]<=200 then '<200'
else '>200'
end",
    "name": "[Calculation_97320012553744419]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "TF present",
    "datatype": "integer",
    "formula": "//Updated Date: 18 May 2022
//Updated By: Manish//Description: Calculating max of todays date for including it in the default values of end date
//Description: Checking if trusted form link is present or not

If len([Trusted Form])>0 then 1
else 0
end",
    "name": "[Calculation_97320012555014180]",
    "role": "dimension",
    "type": "ordinal",
  },
  {
    "caption": "TF URL Valid",
    "datatype": "integer",
    "formula": "//Updated Date: 18 May 2022
//Updated By: Manish
//Description: Checking if the tf link is valid or not

if MID([Trusted Form],1,29)='https://cert.trustedform.com/'
AND len([Trusted Form])>29 then 1
else 0
end",
    "name": "[Calculation_97320012555231269]",
    "role": "dimension",
    "type": "ordinal",
  },
  {
    "caption": "Campaign & Date",
    "datatype": "string",
    "formula": "//Updated Date: 18 May 2022
//Updated By: Manish
//Description: Concatinating campaign and date

[CZ Project Name]+":"+[Calculation_97320012552925214]",
    "name": "[Calculation_97320012555808806]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Cost",
    "datatype": "real",
    "formula": "//Updated Date: 2 June 2022
//Updated By: Sree
//Description: Calculating the sum of CPL per source and per user. THIS NEEDS TO BE COUNTD ONLY


SUM(
//IF [outcome] = 'initialized' THEN 
{include [Source]: ZN(countD([User Id])*MAX([Calculation_6314891106343211008]))}
//ELSE 0 END
)",
    "name": "[Calculation_97320012556025895]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Posted Cum %",
    "datatype": "real",
    "formula": "//Updated Date: 18 May 2022
//Updated By: Manish
//Description: Calculating the cumulative % of posted

RUNNING_SUM([Calculation_99712551082803223])/TOTAL([Calculation_99712551082803223])",
    "name": "[Calculation_97320012556873768]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Blank",
    "datatype": "string",
    "formula": "//Updated Date: 18 May 2022
//Updated By: Manish
//Description: Blank column

""",
    "name": "[Calculation_97320012562538539]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Lead",
    "datatype": "integer",
    "formula": "//Updated Date: 18 May 2022
//Updated By: Manish
//Description: Calculating the unique count of user ids

COUNTD([User Id])",
    "name": "[Calculation_97320012564762668]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Lead Cum %",
    "datatype": "real",
    "formula": "//Updated Date: 18 May 2022
//Updated By: Manish
//Description: Calculating the cumulative % of user ids

RUNNING_SUM([Calculation_97320012564762668])/TOTAL([Calculation_97320012564762668])",
    "name": "[Calculation_97320012564901933]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Filter to Remove Dup Leads",
    "datatype": "boolean",
    "formula": "[Calculation_767300790176440343]={fixed [Phone],[CZ Project Name],[Outcome],[Status]:max([Calculation_767300790176440343])}",
    "name": "[Calculation_987132781714386944]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "CZ Leads #",
    "datatype": "integer",
    "formula": "COUNTD(IF
{ FIXED [Lead Id] : MAX(
IF ISNULL([CZ Lead Post Date])
THEN 0 ELSE 1
END)} = 1
THEN [Lead Id]
END)",
    "name": "[Calculation_989947527400824832]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Vici Post Delay (Days)",
    "datatype": "integer",
    "formula": "DATEDIFF('day', [Post Date], [Entry Time])",
    "name": "[Calculation_989947527401095169]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Vici Leads #",
    "datatype": "integer",
    "formula": "COUNTD(IF
{ FIXED [User Id] : MAX(IF ISNULL([Entry Time])
THEN 0 ELSE 1
END)} = 1
THEN [User Id]
END)",
    "name": "[Calculation_989947527401988098]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Vici Post %",
    "datatype": "real",
    "formula": "[Calculation_989947527401988098] / [Calculation_99712551082803223]",
    "name": "[Calculation_989947527403532291]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Posted #",
    "datatype": "integer",
    "formula": "//Updated Date: 18 May 2022
//Updated By: Manish
//Description: Calculating the sum of user id wrt to source

countd([Calculation_906349454594166784])",
    "name": "[Calculation_99712551082803223]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Source - Date",
    "datatype": "string",
    "formula": "//Updated Date: 18 May 2022
//Updated By: Manish//Description: Calculating max of todays date for including it in the default values of end date
//Description: Concatinating source and date column

[Source]+":"+[Calculation_97320012552925214]",
    "name": "[Calculation_99712551088799768]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Source-Subid",
    "datatype": "string",
    "formula": "//Updated Date: 18 May 2022
//Updated By: Manish//Description: Calculating max of todays date for including it in the default values of end date
//Description: Concatinating source and subid column

[Source]+" : "+[Sub Id]",
    "name": "[Calculation_99712551105503258]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Campaign & Source",
    "datatype": "string",
    "formula": "//Updated Date: 24 Aug 2022
//Updated By: Nithin
//Description: Concatinating campaign and Source

[CZ Project Name]+":"+[Source]",
    "name": "[Campaign & Date (copy)_1141381032179245056]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "State #",
    "datatype": "integer",
    "formula": "//Updated Date: 18 May 2022
//Updated By: Manish
//Description: Checking if the state is null

IF ISNULL([State]) THEN 1 ELSE 0 END",
    "name": "[City #  (copy)_7848437147365756953]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "D3",
    "datatype": "string",
    "formula": "IF [Parameters].[D1 (copy 3)_1113233589196374020] = 1 THEN [Calculation_6374000853566275585]
ELSEIF [Parameters].[D1 (copy 3)_1113233589196374020] = 2 THEN [bla_carrierdata_type]
ELSEIF [Parameters].[D1 (copy 3)_1113233589196374020] = 3 THEN [Calculation_6374000853565702144]
ELSEIF [Parameters].[D1 (copy 3)_1113233589196374020] = 4 THEN [Phone Carrier]
ELSEIF [Parameters].[D1 (copy 3)_1113233589196374020] = 5 THEN [CZ Project Name]
ELSEIF [Parameters].[D1 (copy 3)_1113233589196374020] = 6 THEN [Phone Type]
ELSEIF [Parameters].[D1 (copy 3)_1113233589196374020] = 7 THEN [normalized carrier]
ELSEIF [Parameters].[D1 (copy 3)_1113233589196374020] = 8 THEN [Outcome]
ELSEIF [Parameters].[D1 (copy 3)_1113233589196374020] = 9 THEN [qual_status]
ELSEIF [Parameters].[D1 (copy 3)_1113233589196374020] = 10 THEN [Source]
ELSEIF [Parameters].[D1 (copy 3)_1113233589196374020] = 11 THEN [Sub Id]
ELSEIF [Parameters].[D1 (copy 3)_1113233589196374020] = 12 THEN [gender (copy)_2399292755830108162]
ELSEIF [Parameters].[D1 (copy 3)_1113233589196374020] = 13 THEN [Creative]
ELSEIF [Parameters].[D1 (copy 3)_1113233589196374020] = 14 THEN [CL Diagnosis Injury Tiers]
ELSEIF [Parameters].[D1 (copy 3)_1113233589196374020] = 15 THEN [Calculation_935059914517495808]
ELSEIF [Parameters].[D1 (copy 3)_1113233589196374020] = 16 THEN [Ad Name]
ELSEIF [Parameters].[D1 (copy 3)_1113233589196374020] = 17 THEN [Adset Name]
ELSEIF [Parameters].[D1 (copy 3)_1113233589196374020] = 18 THEN [campaign_id]
ELSEIF [Parameters].[D1 (copy 3)_1113233589196374020] = 19 THEN [Labels]
ELSEIF [Parameters].[D1 (copy 3)_1113233589196374020] = 20 THEN [Calculation_5872834692856524810]
ELSEIF [Parameters].[D1 (copy 3)_1113233589196374020] = 21 THEN [State]
ELSEIF [Parameters].[D1 (copy 3)_1113233589196374020] = 22 THEN [Phone]
// ELSEIF [Parameters].[D3] = 23 THEN [Tier]
ELSEIF [Parameters].[D1 (copy 3)_1113233589196374020] = 23 THEN [Calculation_1277614987429064704]
ELSEIF [Parameters].[D1 (copy 3)_1113233589196374020] = 25 THEN [Result Type]
ELSEIF [Parameters].[D1 (copy 3)_1113233589196374020] = 26 THEN [placement]
ELSEIF [Parameters].[D1 (copy 3)_1113233589196374020] = 27 THEN [Calculation_7690318609259716608]
ELSEIF [Parameters].[D1 (copy 3)_1113233589196374020] = 28 THEN [label]
ELSEIF [Parameters].[D1 (copy 3)_1113233589196374020] = 29 THEN STR([Calculation_1880252886088871936])
ELSEIF [Parameters].[D1 (copy 3)_1113233589196374020] = 30 THEN [clientname]
ELSEIF [Parameters].[D1 (copy 3)_1113233589196374020] = 31 THEN [page_path]
ELSEIF [Parameters].[D1 (copy 3)_1113233589196374020] = 32 THEN [sgmt]
ELSEIF [Parameters].[D1 (copy 3)_1113233589196374020] = 33 THEN [ctcphone]
ELSEIF [Parameters].[D1 (copy 3)_1113233589196374020] = 34 THEN [Calculation_3435894714053935109]
ELSEIF [Parameters].[D1 (copy 3)_1113233589196374020] = 35 THEN [ltdinoworkmedicalconditions]
ELSEIF [Parameters].[D1 (copy 3)_1113233589196374020] = 36 THEN [ds_qualstatus]
ELSEIF [Parameters].[D1 (copy 3)_1113233589196374020] = 37 THEN [ad_id]
ELSEIF [Parameters].[D1 (copy 3)_1113233589196374020] = 38 THEN [adset_id]
ELSEIF [Parameters].[D1 (copy 3)_1113233589196374020] = 39 THEN [Calculation_1113233589182521344]
ELSEIF [Parameters].[D1 (copy 3)_1113233589196374020] = 40 THEN [Calculation_1880252886125215747]
ELSEIF [Parameters].[D1 (copy 3)_1113233589196374020] = 41 THEN [SubSegment]
ELSEIF [Parameters].[D1 (copy 3)_1113233589196374020] = 42 THEN STR([Calculation_1133007210553765896])
ELSEIF [Parameters].[D1 (copy 3)_1113233589196374020] = 43 THEN [Calculation_7573084309404708864]
ELSEIF [Parameters].[D1 (copy 3)_1113233589196374020] = 44 THEN [Calculation_4531465651676438530]
ELSEIF [Parameters].[D1 (copy 3)_1113233589196374020] = 45 THEN IF LEN(STR([appearance_l30d])) < 2 AND NOT ISNULL(STR([appearance_l30d])) THEN '0' + STR([appearance_l30d]) ELSE STR([appearance_l30d]) END
ELSEIF [Parameters].[D1 (copy 3)_1113233589196374020] = 46 THEN IF LEN(STR([appearance_l60d])) < 2 AND NOT ISNULL(STR([appearance_l60d])) THEN '0' + STR([appearance_l60d]) ELSE STR([appearance_l60d]) END
ELSEIF [Parameters].[D1 (copy 3)_1113233589196374020] = 47 THEN IF LEN(STR([appearance_l90d])) < 2 AND NOT ISNULL(STR([appearance_l90d])) THEN '0' + STR([appearance_l90d]) ELSE STR([appearance_l90d]) END
ELSEIF [Parameters].[D1 (copy 3)_1113233589196374020] = 48 THEN [ATA Work]
ELSEIF [Parameters].[D1 (copy 3)_1113233589196374020] = 49 THEN [Calculation_499055157754740737]
ELSEIF [Parameters].[D1 (copy 3)_1113233589196374020] = 50 THEN IF LEN(STR([CIIC Appearance in L30D])) < 2 AND NOT ISNULL(STR([CIIC Appearance in L30D])) THEN '0' + STR([CIIC Appearance in L30D]) ELSE STR([CIIC Appearance in L30D]) END
ELSEIF [Parameters].[D1 (copy 3)_1113233589196374020] = 51 THEN IF LEN(STR([CIIC Appearance in L60D])) < 2 AND NOT ISNULL(STR([CIIC Appearance in L60D])) THEN '0' + STR([CIIC Appearance in L60D]) ELSE STR([CIIC Appearance in L60D]) END
ELSEIF [Parameters].[D1 (copy 3)_1113233589196374020] = 52 THEN IF LEN(STR([CIIC Appearance in L90D])) < 2 AND NOT ISNULL(STR([CIIC Appearance in L90D])) THEN '0' + STR([CIIC Appearance in L90D]) ELSE STR([CIIC Appearance in L90D]) END
ELSEIF [Parameters].[D1 (copy 3)_1113233589196374020] = 53 THEN STR([Calculation_989947527401095169])
ELSEIF [Parameters].[D1 (copy 3)_1113233589196374020] = 54 THEN [Calculation_1460573688699854848]
ELSEIF [Parameters].[D1 (copy 3)_1113233589196374020] = 55 THEN [Calculation_1006061976934187009]
ELSE 'Agg'
END",
    "name": "[D1 (copy) (copy)_6374000853573369864]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "D2",
    "datatype": "string",
    "formula": "IF [Parameters].[D1 (copy 2)_1113233589196361731] = 1 THEN [Calculation_6374000853566275585]
ELSEIF [Parameters].[D1 (copy 2)_1113233589196361731]  = 2 THEN [bla_carrierdata_type]
ELSEIF [Parameters].[D1 (copy 2)_1113233589196361731]  = 3 THEN [Calculation_6374000853565702144]
ELSEIF [Parameters].[D1 (copy 2)_1113233589196361731]  = 4 THEN [Phone Carrier]
ELSEIF [Parameters].[D1 (copy 2)_1113233589196361731]  = 5 THEN [CZ Project Name]
ELSEIF [Parameters].[D1 (copy 2)_1113233589196361731]  = 6 THEN [Phone Type]
ELSEIF [Parameters].[D1 (copy 2)_1113233589196361731]  = 7 THEN [normalized carrier]
ELSEIF [Parameters].[D1 (copy 2)_1113233589196361731]  = 8 THEN [Outcome]
ELSEIF [Parameters].[D1 (copy 2)_1113233589196361731]  = 9 THEN [qual_status]
ELSEIF [Parameters].[D1 (copy 2)_1113233589196361731]  = 10 THEN [Source]
ELSEIF [Parameters].[D1 (copy 2)_1113233589196361731]  = 11 THEN [Sub Id]
ELSEIF [Parameters].[D1 (copy 2)_1113233589196361731]  = 12 THEN [gender (copy)_2399292755830108162]
ELSEIF [Parameters].[D1 (copy 2)_1113233589196361731]  = 13 THEN [Creative]
ELSEIF [Parameters].[D1 (copy 2)_1113233589196361731]  = 14 THEN [CL Diagnosis Injury Tiers]
ELSEIF [Parameters].[D1 (copy 2)_1113233589196361731]  = 15 THEN [Calculation_935059914517495808]
ELSEIF [Parameters].[D1 (copy 2)_1113233589196361731]  = 16 THEN [Ad Name]
ELSEIF [Parameters].[D1 (copy 2)_1113233589196361731]  = 17 THEN [Adset Name]
ELSEIF [Parameters].[D1 (copy 2)_1113233589196361731]  = 18 THEN [campaign_id]
ELSEIF [Parameters].[D1 (copy 2)_1113233589196361731]  = 19 THEN [Labels]
ELSEIF [Parameters].[D1 (copy 2)_1113233589196361731]  = 20 THEN [Calculation_5872834692856524810]
ELSEIF [Parameters].[D1 (copy 2)_1113233589196361731]  = 21 THEN [State]
ELSEIF [Parameters].[D1 (copy 2)_1113233589196361731]  = 22 THEN [Phone]
// ELSEIF [Parameters].[D2] = 23 THEN [Tier]
ELSEIF [Parameters].[D1 (copy 2)_1113233589196361731]  = 23 THEN [Calculation_1277614987429064704]
ELSEIF [Parameters].[D1 (copy 2)_1113233589196361731]  = 25 THEN [Result Type]
ELSEIF [Parameters].[D1 (copy 2)_1113233589196361731]  = 26 THEN [placement]
ELSEIF [Parameters].[D1 (copy 2)_1113233589196361731]  = 27 THEN [Calculation_7690318609259716608]
ELSEIF [Parameters].[D1 (copy 2)_1113233589196361731]  = 28 THEN [label]
ELSEIF [Parameters].[D1 (copy 2)_1113233589196361731]  = 29 THEN STR([Calculation_1880252886088871936])
ELSEIF [Parameters].[D1 (copy 2)_1113233589196361731]  = 30 THEN [clientname]
ELSEIF [Parameters].[D1 (copy 2)_1113233589196361731]  = 31 THEN [page_path]
ELSEIF [Parameters].[D1 (copy 2)_1113233589196361731]  = 32 THEN [sgmt]
ELSEIF [Parameters].[D1 (copy 2)_1113233589196361731]  = 33 THEN [ctcphone]
ELSEIF [Parameters].[D1 (copy 2)_1113233589196361731]  = 34 THEN [Calculation_3435894714053935109]
ELSEIF [Parameters].[D1 (copy 2)_1113233589196361731]  = 35 THEN [ltdinoworkmedicalconditions]
ELSEIF [Parameters].[D1 (copy 2)_1113233589196361731]  = 36 THEN [ds_qualstatus]
ELSEIF [Parameters].[D1 (copy 2)_1113233589196361731]  = 37 THEN [ad_id]
ELSEIF [Parameters].[D1 (copy 2)_1113233589196361731]  = 38 THEN [adset_id]
ELSEIF [Parameters].[D1 (copy 2)_1113233589196361731]  = 39 THEN [Calculation_1113233589182521344]
ELSEIF [Parameters].[D1 (copy 2)_1113233589196361731]  = 40 THEN [Calculation_1880252886125215747]
ELSEIF [Parameters].[D1 (copy 2)_1113233589196361731]  = 41 THEN [SubSegment]
ELSEIF [Parameters].[D1 (copy 2)_1113233589196361731] = 42 THEN STR([Calculation_1133007210553765896])
ELSEIF [Parameters].[D1 (copy 2)_1113233589196361731] = 43 THEN [Calculation_7573084309404708864]
ELSEIF [Parameters].[D1 (copy 2)_1113233589196361731] = 44 THEN [Calculation_4531465651676438530]
ELSEIF [Parameters].[D1 (copy 2)_1113233589196361731] = 45 THEN IF LEN(STR([appearance_l30d])) < 2 AND NOT ISNULL(STR([appearance_l30d])) THEN '0' + STR([appearance_l30d]) ELSE STR([appearance_l30d]) END
ELSEIF [Parameters].[D1 (copy 2)_1113233589196361731] = 46 THEN IF LEN(STR([appearance_l60d])) < 2 AND NOT ISNULL(STR([appearance_l60d])) THEN '0' + STR([appearance_l60d]) ELSE STR([appearance_l60d]) END
ELSEIF [Parameters].[D1 (copy 2)_1113233589196361731] = 47 THEN IF LEN(STR([appearance_l90d])) < 2 AND NOT ISNULL(STR([appearance_l90d])) THEN '0' + STR([appearance_l90d]) ELSE STR([appearance_l90d]) END
ELSEIF [Parameters].[D1 (copy 2)_1113233589196361731] = 48 THEN [ATA Work]
ELSEIF [Parameters].[D1 (copy 2)_1113233589196361731] = 49 THEN [Calculation_499055157754740737]
ELSEIF [Parameters].[D1 (copy 2)_1113233589196361731] = 50 THEN IF LEN(STR([CIIC Appearance in L30D])) < 2 AND NOT ISNULL(STR([CIIC Appearance in L30D])) THEN '0' + STR([CIIC Appearance in L30D]) ELSE STR([CIIC Appearance in L30D]) END
ELSEIF [Parameters].[D1 (copy 2)_1113233589196361731] = 51 THEN IF LEN(STR([CIIC Appearance in L60D])) < 2 AND NOT ISNULL(STR([CIIC Appearance in L60D])) THEN '0' + STR([CIIC Appearance in L60D]) ELSE STR([CIIC Appearance in L60D]) END
ELSEIF [Parameters].[D1 (copy 2)_1113233589196361731] = 52 THEN IF LEN(STR([CIIC Appearance in L90D])) < 2 AND NOT ISNULL(STR([CIIC Appearance in L90D])) THEN '0' + STR([CIIC Appearance in L90D]) ELSE STR([CIIC Appearance in L90D]) END
ELSEIF [Parameters].[D1 (copy 2)_1113233589196361731] = 53 THEN STR([Calculation_989947527401095169])
ELSEIF [Parameters].[D1 (copy 2)_1113233589196361731] = 54 THEN [Calculation_1460573688699854848]
ELSEIF [Parameters].[D1 (copy 2)_1113233589196361731] = 55 THEN [Calculation_1006061976934187009]
ELSE 'Agg'
END",
    "name": "[D1 (copy)_6374000853573341191]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "D4",
    "datatype": "string",
    "formula": "IF [Parameters].[D1 (copy)_1113233589196333057] = 1 THEN [Calculation_6374000853566275585]
ELSEIF [Parameters].[D1 (copy)_1113233589196333057] = 2 THEN [bla_carrierdata_type]
ELSEIF [Parameters].[D1 (copy)_1113233589196333057] = 3 THEN [Calculation_6374000853565702144]
ELSEIF [Parameters].[D1 (copy)_1113233589196333057] = 4 THEN [Phone Carrier]
ELSEIF [Parameters].[D1 (copy)_1113233589196333057] = 5 THEN [CZ Project Name]
ELSEIF [Parameters].[D1 (copy)_1113233589196333057] = 6 THEN [Phone Type]
ELSEIF [Parameters].[D1 (copy)_1113233589196333057] = 7 THEN [normalized carrier]
ELSEIF [Parameters].[D1 (copy)_1113233589196333057] = 8 THEN [Outcome]
ELSEIF [Parameters].[D1 (copy)_1113233589196333057] = 9 THEN [qual_status]
ELSEIF [Parameters].[D1 (copy)_1113233589196333057] = 10 THEN [Source]
ELSEIF [Parameters].[D1 (copy)_1113233589196333057] = 11 THEN [Sub Id]
ELSEIF [Parameters].[D1 (copy)_1113233589196333057] = 12 THEN [gender (copy)_2399292755830108162]
ELSEIF [Parameters].[D1 (copy)_1113233589196333057] = 13 THEN [Creative]
ELSEIF [Parameters].[D1 (copy)_1113233589196333057] = 14 THEN [CL Diagnosis Injury Tiers]
ELSEIF [Parameters].[D1 (copy)_1113233589196333057] = 15 THEN [Calculation_935059914517495808]
ELSEIF [Parameters].[D1 (copy)_1113233589196333057] = 16 THEN [Ad Name]
ELSEIF [Parameters].[D1 (copy)_1113233589196333057] = 17 THEN [Adset Name]
ELSEIF [Parameters].[D1 (copy)_1113233589196333057] = 18 THEN [campaign_id]
ELSEIF [Parameters].[D1 (copy)_1113233589196333057] = 19 THEN [Labels]
ELSEIF [Parameters].[D1 (copy)_1113233589196333057] = 20 THEN [Calculation_5872834692856524810]
ELSEIF [Parameters].[D1 (copy)_1113233589196333057] = 21 THEN [State]
ELSEIF [Parameters].[D1 (copy)_1113233589196333057] = 22 THEN [Phone]
// ELSEIF [Parameters].[D4] = 23 THEN [Tier]
ELSEIF [Parameters].[D1 (copy)_1113233589196333057] = 23 THEN [Calculation_1277614987429064704]
ELSEIF [Parameters].[D1 (copy)_1113233589196333057] = 25 THEN [Result Type]
ELSEIF [Parameters].[D1 (copy)_1113233589196333057] = 26 THEN [placement]
ELSEIF [Parameters].[D1 (copy)_1113233589196333057] = 27 THEN [Calculation_7690318609259716608]
ELSEIF [Parameters].[D1 (copy)_1113233589196333057] = 28 THEN [label]
ELSEIF [Parameters].[D1 (copy)_1113233589196333057] = 29 THEN STR([Calculation_1880252886088871936])
ELSEIF [Parameters].[D1 (copy)_1113233589196333057] = 30 THEN [clientname]
ELSEIF [Parameters].[D1 (copy)_1113233589196333057] = 31 THEN [page_path]
ELSEIF [Parameters].[D1 (copy)_1113233589196333057] = 32 THEN [sgmt]
ELSEIF [Parameters].[D1 (copy)_1113233589196333057] = 33 THEN [ctcphone]
ELSEIF [Parameters].[D1 (copy)_1113233589196333057] = 34 THEN [Calculation_3435894714053935109]
ELSEIF [Parameters].[D1 (copy)_1113233589196333057] = 35 THEN [ltdinoworkmedicalconditions]
ELSEIF [Parameters].[D1 (copy)_1113233589196333057] = 36 THEN [ds_qualstatus]
ELSEIF [Parameters].[D1 (copy)_1113233589196333057] = 37 THEN [ad_id]
ELSEIF [Parameters].[D1 (copy)_1113233589196333057] = 38 THEN [adset_id]
ELSEIF [Parameters].[D1 (copy)_1113233589196333057] = 39 THEN [Calculation_1113233589182521344]
ELSEIF [Parameters].[D1 (copy)_1113233589196333057] = 40 THEN [Calculation_1880252886125215747]
ELSEIF [Parameters].[D1 (copy)_1113233589196333057] = 41 THEN [SubSegment]
ELSEIF [Parameters].[D1 (copy)_1113233589196333057] = 42 THEN STR([Calculation_1133007210553765896])
ELSEIF [Parameters].[D1 (copy)_1113233589196333057] = 43 THEN [Calculation_7573084309404708864]
ELSEIF [Parameters].[D1 (copy)_1113233589196333057] = 44 THEN [Calculation_4531465651676438530]
ELSEIF [Parameters].[D1 (copy)_1113233589196333057] = 45 THEN IF LEN(STR([appearance_l30d])) < 2 AND NOT ISNULL(STR([appearance_l30d])) THEN '0' + STR([appearance_l30d]) ELSE STR([appearance_l30d]) END
ELSEIF [Parameters].[D1 (copy)_1113233589196333057] = 46 THEN IF LEN(STR([appearance_l60d])) < 2 AND NOT ISNULL(STR([appearance_l60d])) THEN '0' + STR([appearance_l60d]) ELSE STR([appearance_l60d]) END
ELSEIF [Parameters].[D1 (copy)_1113233589196333057] = 47 THEN IF LEN(STR([appearance_l90d])) < 2 AND NOT ISNULL(STR([appearance_l90d])) THEN '0' + STR([appearance_l90d]) ELSE STR([appearance_l90d]) END
ELSEIF [Parameters].[D1 (copy)_1113233589196333057] = 48 THEN [ATA Work]
ELSEIF [Parameters].[D1 (copy)_1113233589196333057] = 49 THEN [Calculation_499055157754740737]
ELSEIF [Parameters].[D1 (copy)_1113233589196333057] = 50 THEN IF LEN(STR([CIIC Appearance in L30D])) < 2 AND NOT ISNULL(STR([CIIC Appearance in L30D])) THEN '0' + STR([CIIC Appearance in L30D]) ELSE STR([CIIC Appearance in L30D]) END
ELSEIF [Parameters].[D1 (copy)_1113233589196333057] = 51 THEN IF LEN(STR([CIIC Appearance in L60D])) < 2 AND NOT ISNULL(STR([CIIC Appearance in L60D])) THEN '0' + STR([CIIC Appearance in L60D]) ELSE STR([CIIC Appearance in L60D]) END
ELSEIF [Parameters].[D1 (copy)_1113233589196333057] = 52 THEN IF LEN(STR([CIIC Appearance in L90D])) < 2 AND NOT ISNULL(STR([CIIC Appearance in L90D])) THEN '0' + STR([CIIC Appearance in L90D]) ELSE STR([CIIC Appearance in L90D]) END
ELSEIF [Parameters].[D1 (copy)_1113233589196333057] = 53 THEN STR([Calculation_989947527401095169])
ELSEIF [Parameters].[D1 (copy)_1113233589196333057] = 54 THEN [Calculation_1460573688699854848]
ELSEIF [Parameters].[D1 (copy)_1113233589196333057] = 55 THEN [Calculation_1006061976934187009]
ELSE 'Agg'
END",
    "name": "[D3 (copy)_6208563937532035081]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "D5",
    "datatype": "string",
    "formula": "IF [Parameters].[D1 (copy) (copy)_1113233589196361730] = 1 THEN [Calculation_6374000853566275585]
ELSEIF [Parameters].[D1 (copy) (copy)_1113233589196361730] = 2 THEN [bla_carrierdata_type]
ELSEIF [Parameters].[D1 (copy) (copy)_1113233589196361730] = 3 THEN [Calculation_6374000853565702144]
ELSEIF [Parameters].[D1 (copy) (copy)_1113233589196361730] = 4 THEN [Phone Carrier]
ELSEIF [Parameters].[D1 (copy) (copy)_1113233589196361730] = 5 THEN [CZ Project Name]
ELSEIF [Parameters].[D1 (copy) (copy)_1113233589196361730] = 6 THEN [Phone Type]
ELSEIF [Parameters].[D1 (copy) (copy)_1113233589196361730] = 7 THEN [normalized carrier]
ELSEIF [Parameters].[D1 (copy) (copy)_1113233589196361730] = 8 THEN [Outcome]
ELSEIF [Parameters].[D1 (copy) (copy)_1113233589196361730] = 9 THEN [qual_status]
ELSEIF [Parameters].[D1 (copy) (copy)_1113233589196361730] = 10 THEN [Source]
ELSEIF [Parameters].[D1 (copy) (copy)_1113233589196361730] = 11 THEN [Sub Id]
ELSEIF [Parameters].[D1 (copy) (copy)_1113233589196361730] = 12 THEN [gender (copy)_2399292755830108162]
ELSEIF [Parameters].[D1 (copy) (copy)_1113233589196361730] = 13 THEN [Creative]
ELSEIF [Parameters].[D1 (copy) (copy)_1113233589196361730] = 14 THEN [CL Diagnosis Injury Tiers]
ELSEIF [Parameters].[D1 (copy) (copy)_1113233589196361730] = 15 THEN [Calculation_935059914517495808]
ELSEIF [Parameters].[D1 (copy) (copy)_1113233589196361730] = 16 THEN [Ad Name]
ELSEIF [Parameters].[D1 (copy) (copy)_1113233589196361730] = 17 THEN [Adset Name]
ELSEIF [Parameters].[D1 (copy) (copy)_1113233589196361730] = 18 THEN [campaign_id]
ELSEIF [Parameters].[D1 (copy) (copy)_1113233589196361730] = 19 THEN [Labels]
ELSEIF [Parameters].[D1 (copy) (copy)_1113233589196361730] = 20 THEN [Calculation_5872834692856524810]
ELSEIF [Parameters].[D1 (copy) (copy)_1113233589196361730] = 21 THEN [State]
ELSEIF [Parameters].[D1 (copy) (copy)_1113233589196361730] = 22 THEN [Phone]
// ELSEIF [Parameters].[D5] = 23 THEN [Tier]
ELSEIF [Parameters].[D1 (copy) (copy)_1113233589196361730] = 23 THEN [Calculation_1277614987429064704]
ELSEIF [Parameters].[D1 (copy) (copy)_1113233589196361730] = 25 THEN [Result Type]
ELSEIF [Parameters].[D1 (copy) (copy)_1113233589196361730] = 26 THEN [placement]
ELSEIF [Parameters].[D1 (copy) (copy)_1113233589196361730] = 27 THEN [Calculation_7690318609259716608]
ELSEIF [Parameters].[D1 (copy) (copy)_1113233589196361730] = 28 THEN [label]
ELSEIF [Parameters].[D1 (copy) (copy)_1113233589196361730] = 29 THEN STR([Calculation_1880252886088871936])
ELSEIF [Parameters].[D1 (copy) (copy)_1113233589196361730] = 30 THEN [clientname]
ELSEIF [Parameters].[D1 (copy) (copy)_1113233589196361730] = 31 THEN [page_path]
ELSEIF [Parameters].[D1 (copy) (copy)_1113233589196361730] = 32 THEN [sgmt]
ELSEIF [Parameters].[D1 (copy) (copy)_1113233589196361730] = 33 THEN [ctcphone]
ELSEIF [Parameters].[D1 (copy) (copy)_1113233589196361730] = 34 THEN [Calculation_3435894714053935109]
ELSEIF [Parameters].[D1 (copy) (copy)_1113233589196361730] = 35 THEN [ltdinoworkmedicalconditions]
ELSEIF [Parameters].[D1 (copy) (copy)_1113233589196361730] = 36 THEN [ds_qualstatus]
ELSEIF [Parameters].[D1 (copy) (copy)_1113233589196361730] = 37 THEN [ad_id]
ELSEIF [Parameters].[D1 (copy) (copy)_1113233589196361730] = 38 THEN [adset_id]
ELSEIF [Parameters].[D1 (copy) (copy)_1113233589196361730] = 39 THEN [Calculation_1113233589182521344]
ELSEIF [Parameters].[D1 (copy) (copy)_1113233589196361730] = 40 THEN [Calculation_1880252886125215747]
ELSEIF [Parameters].[D1 (copy) (copy)_1113233589196361730] = 41 THEN [SubSegment]
ELSEIF [Parameters].[D1 (copy) (copy)_1113233589196361730] = 42 THEN STR([Calculation_1133007210553765896])
ELSEIF [Parameters].[D1 (copy) (copy)_1113233589196361730] = 43 THEN [Calculation_7573084309404708864]
ELSEIF [Parameters].[D1 (copy) (copy)_1113233589196361730] = 44 THEN [Calculation_4531465651676438530]
ELSEIF [Parameters].[D1 (copy) (copy)_1113233589196361730] = 45 THEN IF LEN(STR([appearance_l30d])) < 2 AND NOT ISNULL(STR([appearance_l30d])) THEN '0' + STR([appearance_l30d]) ELSE STR([appearance_l30d]) END
ELSEIF [Parameters].[D1 (copy) (copy)_1113233589196361730] = 46 THEN IF LEN(STR([appearance_l60d])) < 2 AND NOT ISNULL(STR([appearance_l60d])) THEN '0' + STR([appearance_l60d]) ELSE STR([appearance_l60d]) END
ELSEIF [Parameters].[D1 (copy) (copy)_1113233589196361730] = 47 THEN IF LEN(STR([appearance_l90d])) < 2 AND NOT ISNULL(STR([appearance_l90d])) THEN '0' + STR([appearance_l90d]) ELSE STR([appearance_l90d]) END
ELSEIF [Parameters].[D1 (copy) (copy)_1113233589196361730] = 48 THEN [ATA Work]
ELSEIF [Parameters].[D1 (copy) (copy)_1113233589196361730] = 49 THEN [Calculation_499055157754740737]
ELSEIF [Parameters].[D1 (copy) (copy)_1113233589196361730] = 50 THEN IF LEN(STR([CIIC Appearance in L30D])) < 2 AND NOT ISNULL(STR([CIIC Appearance in L30D])) THEN '0' + STR([CIIC Appearance in L30D]) ELSE STR([CIIC Appearance in L30D]) END
ELSEIF [Parameters].[D1 (copy) (copy)_1113233589196361730] = 51 THEN IF LEN(STR([CIIC Appearance in L60D])) < 2 AND NOT ISNULL(STR([CIIC Appearance in L60D])) THEN '0' + STR([CIIC Appearance in L60D]) ELSE STR([CIIC Appearance in L60D]) END
ELSEIF [Parameters].[D1 (copy) (copy)_1113233589196361730] = 52 THEN IF LEN(STR([CIIC Appearance in L90D])) < 2 AND NOT ISNULL(STR([CIIC Appearance in L90D])) THEN '0' + STR([CIIC Appearance in L90D]) ELSE STR([CIIC Appearance in L90D]) END
ELSEIF [Parameters].[D1 (copy) (copy)_1113233589196361730] = 53 THEN STR([Calculation_989947527401095169])
ELSEIF [Parameters].[D1 (copy) (copy)_1113233589196361730] = 54 THEN [Calculation_1460573688699854848]
ELSEIF [Parameters].[D1 (copy) (copy)_1113233589196361730] = 55 THEN [Calculation_1006061976934187009]
ELSE 'Agg'
END",
    "name": "[D4 (copy)_6208563937532350475]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Date Filter with Comparision Dates",
    "datatype": "boolean",
    "formula": "//Updated Date: 27 Oct 2022
//Updated By: Nithin
//Description: Filtering data based on date

[Date]>=min([Parameters].[Parameter 5],[Parameters].[Start Date (copy)_1152077103891697665]) AND [Date]<=max([Parameters].[Parameter 6],[Parameters].[End Date (copy)_1152077103892365314])",
    "name": "[Date Filter (copy)_1152077103885066240]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Date Filter with Post Date",
    "datatype": "boolean",
    "formula": "//Updated Date: 18 May 2022
//Updated By: Manish
//Description: Calculation to apply date filter with respect to post time

DATE([Post Date])>=[Parameters].[Parameter 5] AND DATE([Post Date])<=[Parameters].[Parameter 6]",
    "name": "[Date Filter (copy)_1300414413503598592]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Date Filter to swap Modify Date",
    "datatype": "boolean",
    "formula": "//Updated Date: 18 May 2022
//Updated By: Manish
//Description: Filtering data based on date
IF [Parameters].[Parameter 9] = 'Post Date' THEN

[Date]>=[Parameters].[Parameter 5] AND [Date]<=[Parameters].[Parameter 6]
ELSE DATE([Modify Date])>=[Parameters].[Parameter 5] AND DATE([Modify Date])<=[Parameters].[Parameter 6] END",
    "name": "[Date Filter (copy)_1968354565469626368]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Date Filter for RET Time",
    "datatype": "boolean",
    "formula": "//Updated Date: 03 June 2022
//Updated By: Nithin
//Description: Filtering data based on RET 

DATE([Calculation_2490912847470878721])>=[Parameters].[Parameter 5] AND DATE([Calculation_2490912847470878721])<=[Parameters].[Parameter 6]",
    "name": "[Date Filter (copy)_5762144658223964161]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Date Filter Yeaterday",
    "datatype": "boolean",
    "formula": "//Updated Date: 18 May 2022
//Updated By: Manish
//Description: Filtering the date wrt yesterday

[Date]=today()-1",
    "name": "[Date Filter (copy)_7495186061619691521]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Exclude 2 days before Today",
    "datatype": "string",
    "formula": "IF DATE([Post Date])= TODAY()-1  THEN 'Today'
ELSEIF DATE([Post Date]) = TODAY()-2 THEN 'Yesterday'
ELSEIF DATE([Post Date]) = TODAY()-3 THEN 'Day Before Yesterday'
END",
    "name": "[Date Filter Last 3 Days (copy)_1141381032257052686]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Ip #",
    "datatype": "integer",
    "formula": "//Updated Date: 18 May 2022
//Updated By: Manish
//Description: Checking if ip is null or not

IF ISNULL([IP]) THEN 1 ELSE 0 END",
    "name": "[Dob # (copy)_7848437147366694940]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Subid #",
    "datatype": "integer",
    "formula": "//Updated Date: 18 May 2022
//Updated By: Manish
//Description: Checking if the subid is null

IF ISNULL([Sub Id]) THEN 1 ELSE 0 END",
    "name": "[Dob # (copy)_7848437147366932509]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "LastName # ",
    "datatype": "integer",
    "formula": "//Updated Date: 18 May 2022
//Updated By: Manish
//Description: Checking if last name is null

IF ISNULL([Last Name]) THEN 1 ELSE 0 END",
    "name": "[FirstName # (copy)_7848437147365089303]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Trusted Form # ",
    "datatype": "integer",
    "formula": "//Updated Date: 18 May 2022
//Updated By: Manish
//Description: Checking if the trusted form is null

IF ([Trusted Form]) = '' THEN 1 ELSE 0 END",
    "name": "[FirstName # (copy)_7848437147367211038]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Posted Wk2",
    "datatype": "integer",
    "formula": "({include [Sub Id]: countD(if [Date]< dateadd('day',-7,datetrunc('week',today(),'sunday')) then [User Id] end)})",
    "name": "[Last Week Leads (copy)_535928404290809858]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "City # ",
    "datatype": "integer",
    "formula": "//Updated Date: 18 May 2022
//Updated By: Manish
//Description: Checking if city is null

IF ([City])='' THEN 1 ELSE 0 END",
    "name": "[LastName #  (copy)_7848437147365244952]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Missing State",
    "datatype": "integer",
    "formula": "COUNT(IF ISNULL([State]) OR [State] = '' THEN [User Id] END)


//COUNT(IF ISNULL([lastname]) OR [lastname] = ''
//OR ISNULL([subid]) OR [subid] = '' 
//OR ISNULL([postalcode]) OR [postalcode] = ''
//OR ISNULL([city]) OR [city] = ''
//OR ISNULL([state]) OR [state] = '' THEN [userid] END)",
    "name": "[Missing City (copy)_1022317140786008067]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Missing IP",
    "datatype": "integer",
    "formula": "COUNT(IF ISNULL([IP]) OR [IP] = '' THEN [User Id] END)


//COUNT(IF ISNULL([lastname]) OR [lastname] = ''
//OR ISNULL([subid]) OR [subid] = '' 
//OR ISNULL([postalcode]) OR [postalcode] = ''
//OR ISNULL([city]) OR [city] = ''
//OR ISNULL([state]) OR [state] = '' THEN [userid] END)",
    "name": "[Missing City (copy)_1022317140786180100]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Missing First Name",
    "datatype": "integer",
    "formula": "COUNT(IF ISNULL([First Name]) OR [First Name] = '' THEN [User Id] END)


//COUNT(IF ISNULL([lastname]) OR [lastname] = ''
//OR ISNULL([subid]) OR [subid] = '' 
//OR ISNULL([postalcode]) OR [postalcode] = ''
//OR ISNULL([city]) OR [city] = ''
//OR ISNULL([state]) OR [state] = '' THEN [userid] END)",
    "name": "[Missing LastName (copy)_1022317140785614849]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Missing City",
    "datatype": "integer",
    "formula": "COUNT(IF ISNULL([City]) OR [City] = '' THEN [User Id] END)


//COUNT(IF ISNULL([lastname]) OR [lastname] = ''
//OR ISNULL([subid]) OR [subid] = '' 
//OR ISNULL([postalcode]) OR [postalcode] = ''
//OR ISNULL([city]) OR [city] = ''
//OR ISNULL([state]) OR [state] = '' THEN [userid] END)",
    "name": "[Missing LastName (copy)_1022317140785823746]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Missing Leads in CRM",
    "datatype": "integer",
    "formula": "//Updated Date: 18 May 2022
//Updated By: Manish
//Description: Calculating the unique count of Phone

COUNTD(IF isnull([CRM Flag]) THEN  [Phone] END)",
    "name": "[Missing Leads in Vici (copy)_336081184380698624]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Missing TF",
    "datatype": "integer",
    "formula": "COUNT(IF ISNULL([Calculation_97320012555014180]) or [Calculation_97320012555014180] = 0 THEN [User Id] END)


//COUNT(IF ISNULL([lastname]) OR [lastname] = ''
//OR ISNULL([subid]) OR [subid] = '' 
//OR ISNULL([postalcode]) OR [postalcode] = ''
//OR ISNULL([city]) OR [city] = ''
//OR ISNULL([state]) OR [state] = '' THEN [userid] END)",
    "name": "[Missing Subid (copy)_1022317140787544070]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Missing PostalCode",
    "datatype": "integer",
    "formula": "COUNT(IF ISNULL([Postal Code]) or [Postal Code] = '' THEN [User Id] END)


//COUNT(IF ISNULL([lastname]) OR [lastname] = ''
//OR ISNULL([subid]) OR [subid] = '' 
//OR ISNULL([postalcode]) OR [postalcode] = ''
//OR ISNULL([city]) OR [city] = ''
//OR ISNULL([state]) OR [state] = '' THEN [userid] END)",
    "name": "[Missing TF (copy)_1022317140793171977]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Missing DOB",
    "datatype": "integer",
    "formula": "COUNT(IF ISNULL([DOB]) or [DOB] = '' THEN [User Id] END)


//COUNT(IF ISNULL([lastname]) OR [lastname] = ''
//OR ISNULL([subid]) OR [subid] = '' 
//OR ISNULL([postalcode]) OR [postalcode] = ''
//OR ISNULL([city]) OR [city] = ''
//OR ISNULL([state]) OR [state] = '' THEN [userid] END)",
    "name": "[Missing TF (copy)_1022317140793491466]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Missing Subid",
    "datatype": "integer",
    "formula": "COUNT(IF ISNULL([Sub Id]) OR [Sub Id] = '' THEN [User Id] END)


//COUNT(IF ISNULL([lastname]) OR [lastname] = ''
//OR ISNULL([subid]) OR [subid] = '' 
//OR ISNULL([postalcode]) OR [postalcode] = ''
//OR ISNULL([city]) OR [city] = ''
//OR ISNULL([state]) OR [state] = '' THEN [userid] END)",
    "name": "[Missing Zip Code (copy)_1022317140786438149]",
    "role": "measure",
    "type": "ordinal",
  },
  {
    "caption": "Source ",
    "datatype": "string",
    "formula": "CASE [Parameters].[Phone (copy)_1255659924007981058]
WHEN "0" THEN "Agg"
WHEN "1" THEN [Source]
END",
    "name": "[Phone (copy)_1255659924007964673]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Subid",
    "datatype": "string",
    "formula": "//Updated Date: 18 May 2022
//Updated By: Manish//Description: Calculating max of todays date for including it in the default values of end date
//Description: Using aggregation of subid column

CASE [Parameters].[Phone (copy)_1255659924008312836]
WHEN "0" THEN "Agg"
WHEN "1" THEN [Sub Id]
END",
    "name": "[Phone (copy)_1255659924008292355]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "0",
    "datatype": "integer",
    "formula": "COUNTD(IF [Ping Age (s)]= 0 then [User Id] end)",
    "name": "[Ping age (copy)_2399292755833638916]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Dob #",
    "datatype": "integer",
    "formula": "//Updated Date: 18 May 2022
//Updated By: Manish
//Description: Checking if DOB is null or not

IF ISNULL([DOB]) THEN 1 ELSE 0 END",
    "name": "[PostalCode # (copy)_7848437147366457371]",
    "role": "dimension",
    "type": "ordinal",
  },
  {
    "caption": "Projected Cost",
    "datatype": "real",
    "formula": "//Updated Date: 18 May 2022
//Updated By: Manish
//Description: Calculating the sum of CPL for each day from saturday excluding campaign and datetime

{EXCLUDE [Calculation_4891401821032828929]:SUM(ZN(CPL))}*(24*7)/[Calculation_767300789949067266]",
    "name": "[Running Cost (copy)_450922980938579970]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Scrub Rejected",
    "datatype": "integer",
    "formula": "//Updated Date: 18 May 2022
//Updated By: Manish
//Description: Calculating the unique count of user id when outcome is rejected

COUNTD(IF [Outcome]='rejected' THEN [User Id] END)",
    "name": "[Scrub Accept (copy)_7975100929064427530]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Compared Posts & Spends",
    "datatype": "real",
    "formula": "//countd(IF [Day of Post Date]>=[Start Date Comp] AND [Day of Post Date]<=[End Date Comp] then ([User Id]) end)



IF [Parameters].[Parameter 8] = '1' THEN 
countd(IF [Date]>=[Parameters].[Start Date (copy)_1152077103891697665] AND [Date]<=[Parameters].[End Date (copy)_1152077103892365314] THEN
([User Id]) END)
ELSE 
sum({include [Source]: ZN(countd(IF [Date]>=[Parameters].[Start Date (copy)_1152077103891697665] AND [Date]<=[Parameters].[End Date (copy)_1152077103892365314] THEN
([User Id]) END)*MAX([Calculation_6314891106343211008]))})

 END",
    "name": "[Selected Posts (copy)_1152077103904321540]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Source-subid ",
    "datatype": "string",
    "formula": "//Updated Date: 18 May 2022
//Updated By: Manish//Description: Calculating max of todays date for including it in the default values of end date
//Description: Concatinating source and subid column

[Source]+" : "+[Sub Id]",
    "name": "[Source-Subid (copy)_2399292755892068371]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Source-Subid-Date",
    "datatype": "string",
    "formula": "//Updated Date: 18 May 2022
//Updated By: Manish//Description: Calculating max of todays date for including it in the default values of end date
//Description: Concatinating source, subid and date column

[Phone (copy)_1255659924007964673]+":"+[Sub Id]+":"+[Calculation_97320012552925214]",
    "name": "[Source-Subid (copy)_99712551118721055]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "PostalCode #",
    "datatype": "integer",
    "formula": "//Updated Date: 18 May 2022
//Updated By: Manish
//Description: Checking if postal code is null or not

IF ISNULL([Postal Code]) THEN 1 ELSE 0 END",
    "name": "[State # (copy)_7848437147366141978]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Status For Context Filter",
    "datatype": "string",
    "formula": "[Status]",
    "name": "[Status (copy)_1621014427209760791]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "IP Valid ",
    "datatype": "integer",
    "formula": "//Updated Date: 18 May 2022
//Updated By: Manish
//Description: Boolean values of IP - 0 if null 


if ISNULL([IP]) OR [IP] = '' THEN 0 

else 1
end",
    "name": "[TF URL Valid (copy)_2489223969889640448]",
    "role": "dimension",
    "type": "ordinal",
  },
  {
    "caption": "Today-1 Lead Count",
    "datatype": "integer",
    "formula": "COUNTD(IF DATE([Post Date])= today()-2 then [User Id] END)",
    "name": "[Today Lead Count (copy)_585749428086071304]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Today-2 Lead Count",
    "datatype": "integer",
    "formula": "COUNTD(IF DATE([Post Date])= today()-3 then [User Id]  END)",
    "name": "[Today-1 Lead Count (copy)_585749428091252745]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Total concatinated",
    "datatype": "integer",
    "formula": "//Updated Date: 18 May 2022
//Updated By: Manish
//Description: Calculating the sum of text excluding the source

{EXCLUDE [Phone (copy)_1255659924007964673]:sum([Calculation_2370019326410940416])}",
    "name": "[Total (copy)_2370019326411395073]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Age Exclusions",
    "datatype": "string",
    "formula": "[Age Range]",
    "name": "[age range (copy)_99712551094624281]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "campaign name (copy)",
    "datatype": "string",
    "formula": "[CZ Project Name]",
    "name": "[campaign name (copy)_2703707902190374912]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Gender",
    "datatype": "string",
    "formula": "//Updated Date: 18 May 2022
//Updated By: Manish
//Description: Converting gnder values to upper case

UPPER([Gender])",
    "name": "[gender (copy)_2399292755830108162]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "State Exclusions",
    "datatype": "string",
    "formula": "[State]",
    "name": "[state (copy)_2399292755821703168]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Disallowed States",
    "datatype": "string",
    "formula": "[State]",
    "name": "[state (copy)_3014878530503516162]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "D2",
    "datatype": "integer",
    "formula": "0",
    "name": "[D1 (copy 2)_1113233589196361731]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "D3",
    "datatype": "integer",
    "formula": "0",
    "name": "[D1 (copy 3)_1113233589196374020]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "D5",
    "datatype": "integer",
    "formula": "0",
    "name": "[D1 (copy) (copy)_1113233589196361730]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "D4",
    "datatype": "integer",
    "formula": "0",
    "name": "[D1 (copy)_1113233589196333057]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "End Date Comp",
    "datatype": "date",
    "formula": "#2025-08-20#",
    "name": "[End Date (copy)_1152077103892365314]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Leads Upload End Date",
    "datatype": "date",
    "formula": "#2025-07-30#",
    "name": "[End Date (copy)_767300789999759379]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "D1",
    "datatype": "integer",
    "formula": "0",
    "name": "[Parameter 10]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Helper Date",
    "datatype": "string",
    "formula": ""default"",
    "name": "[Parameter 11]",
    "role": "measure",
    "type": "nominal",
  },
  {
    "caption": "User Identifier",
    "datatype": "integer",
    "formula": "0",
    "name": "[Parameter 12]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Date Bucket",
    "datatype": "string",
    "formula": ""day"",
    "name": "[Parameter 1]",
    "role": "measure",
    "type": "nominal",
  },
  {
    "caption": "5% Cutoff",
    "datatype": "real",
    "formula": "0.2",
    "name": "[Parameter 3]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Min Threshold",
    "datatype": "integer",
    "formula": "2",
    "name": "[Parameter 4]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Start Date",
    "datatype": "date",
    "formula": "#2025-07-30#",
    "name": "[Parameter 5]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "End Date",
    "datatype": "date",
    "formula": "#2025-08-27#",
    "name": "[Parameter 6]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Missing Fields",
    "datatype": "string",
    "formula": ""All"",
    "name": "[Parameter 7]",
    "role": "measure",
    "type": "nominal",
  },
  {
    "caption": "Lead vs Spend",
    "datatype": "string",
    "formula": ""1"",
    "name": "[Parameter 8]",
    "role": "measure",
    "type": "nominal",
  },
  {
    "caption": "Date Selected",
    "datatype": "string",
    "formula": ""Post Date"",
    "name": "[Parameter 9]",
    "role": "measure",
    "type": "nominal",
  },
  {
    "caption": "Show Source",
    "datatype": "string",
    "formula": ""1"",
    "name": "[Phone (copy)_1255659924007981058]",
    "role": "measure",
    "type": "nominal",
  },
  {
    "caption": "Subid",
    "datatype": "string",
    "formula": ""0"",
    "name": "[Phone (copy)_1255659924008312836]",
    "role": "measure",
    "type": "nominal",
  },
  {
    "caption": "Show Site Source",
    "datatype": "string",
    "formula": ""0"",
    "name": "[Show Source (copy)_3999970530356424704]",
    "role": "measure",
    "type": "nominal",
  },
  {
    "caption": "Start Date Comp",
    "datatype": "date",
    "formula": "#2025-08-20#",
    "name": "[Start Date (copy)_1152077103891697665]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Leads Upload Start Date",
    "datatype": "date",
    "formula": "#2024-10-31#",
    "name": "[Start Date (copy)_767300789999747090]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Unresolved SSA Leads",
    "datatype": "string",
    "formula": "IF { FIXED [Phone] : MAX([Resolved Lead]) } = 0 THEN "SSA Unresolved Lead"
ELSEIF { FIXED [Phone] : MAX([Resolved Lead]) } = 1 THEN "SSA Resolved Lead"
END",
    "name": "[Calculation_1467962419029331969]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Dial R",
    "datatype": "string",
    "formula": "IF  [Called Count] < 4 then "<=3" 
elseif [Called Count] < 8 then "4-7"
elseif [Called Count] < 11 then "8-10"
elseif [Called Count] < 16 then "11-15"
elseif [Called Count] < 20 then "16-19"
elseif [Called Count] < 26 then "20-25"
elseif [Called Count] < 31 then "25-30"
elseif [Called Count] < 36 then "30-35"
else "35+" 
END",
    "name": "[Calculation_847802666706034688]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Dial R (detail)",
    "datatype": "string",
    "formula": "STR([Called Count])",
    "name": "[Calculation_847802666706186241]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Hour of Day",
    "datatype": "string",
    "formula": "IF LEN(STR(DATEPART('hour', [Calculation_1916563181826678784]))) = 1
THEN "0" + STR(DATEPART('hour', [Calculation_1916563181826678784]))
ELSE STR(DATEPART('hour', [Calculation_1916563181826678784]))
END",
    "name": "[Calculation_1113233589182521344]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "# of Disqual",
    "datatype": "integer",
    "formula": "ZN([Calculation_1133007210553487364]) +
ZN([Calculation_1133007210553663495]) +
ZN([Calculation_1133007210553618438]) +
ZN([Calculation_1133007210553540613]) +
ZN([Calculation_1133007210553425923]) +
ZN([Calculation_1133007210546622464]) +
ZN([Calculation_1133007210553298946])",
    "name": "[Calculation_1133007210553765896]",
    "role": "dimension",
    "type": "ordinal",
  },
  {
    "caption": "DP Leak",
    "datatype": "string",
    "formula": "IF CONTAINS([clientname], 'disabilitypath')
AND [Calculation_7573084309404708864] in ('Grade A', 'Grade B')
THEN 'Yes'
ELSE 'No'
END",
    "name": "[Calculation_1460573688699854848]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "CTC Lead Flag",
    "datatype": "string",
    "formula": "if [CTC Lead] = 1 then "Yes" else "No" END",
    "name": "[Calculation_1880252886088871936]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "CZ Post Hour Group",
    "datatype": "string",
    "formula": "IF DATEPART('hour', [Post Date]) >= 0 AND DATEPART('hour', [Post Date]) < 6 THEN 'Pre CC Hours'
ELSEIF DATEPART('hour', [Post Date]) >= 6 AND DATEPART('hour', [Post Date]) < 16 THEN 'CC Hours'
ELSEIF DATEPART('hour', [Post Date]) >= 16 AND DATEPART('hour', [Post Date]) < 24 THEN 'Post CC Hours'
END",
    "name": "[Calculation_1880252886125215747]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Lead Sell Type",
    "datatype": "string",
    "formula": "if contains([Transfer Info Label],'CXER') then 'Sold: Call' 
elseif 
contains([sgmt],'ql-leadbuy') or 
contains([ATA Work],'ql-leadbuy')
then 'Sold: Lead'
else 'Internal'
end",
    "name": "[Calculation_3435894714053935109]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Seg4 Cohort",
    "datatype": "string",
    "formula": "LOWER(IFNULL([seg4_cohort], [Calculation_4531465651676315649]))",
    "name": "[Calculation_4531465651676438530]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Time to Call Bucket",
    "datatype": "string",
    "formula": "IF  [Calculation_499055157752631296] < 0
THEN '<0 Mins'
ELSEIF [Calculation_499055157752631296] <= 2 AND [Calculation_499055157752631296] >= 0
THEN '0-2 Mins'
ELSEIF [Calculation_499055157752631296] <= 5 AND [Calculation_499055157752631296] > 0
THEN '2-5 Mins'
ELSEIF [Calculation_499055157752631296] <= 10 AND [Calculation_499055157752631296] > 0
THEN '5-10 Mins'
ELSEIF [Calculation_499055157752631296] <= 30 AND [Calculation_499055157752631296] > 0 
THEN '10-30 Mins'
ELSEIF [Calculation_499055157752631296] <= 60 AND [Calculation_499055157752631296] > 0
THEN '30Mins-1 Hour'
ELSEIF [Calculation_499055157752631296] <= 300 AND [Calculation_499055157752631296] > 0
THEN '1-5 Hours'
ELSEIF [Calculation_499055157752631296] <= 600 AND [Calculation_499055157752631296] > 0
THEN '5-10 Hours'
ELSEIF [Calculation_499055157752631296] <= 1440 AND [Calculation_499055157752631296] > 0
THEN '10-24 Hours'
ELSEIF [Calculation_499055157752631296] <= 4320 AND [Calculation_499055157752631296] > 0
THEN '24-72 Hours'
ELSEIF [Calculation_499055157752631296] > 4320 AND [Calculation_499055157752631296] > 0
THEN '>72 Hours'
END",
    "name": "[Calculation_499055157754740737]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Project Type",
    "datatype": "string",
    "formula": "IF CONTAINS([CZ Project Name],'Aged') THEN 'Aged'
ELSE 'Live' END",
    "name": "[Calculation_5872834692856524810]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Grade",
    "datatype": "string",
    "formula": "// Grade A
IF [qual_status] = 'all-steps' THEN 'Grade A'

// Grade B
ELSEIF 
    [qual_status] IN ('fiveyrwrk-disqual','outofwrk-disqual','doc-disqual')
    AND [Calculation_1133007210553765896] = 1
THEN 'Grade B'

// Grade C
ELSEIF 
    [qual_status] <> 'age-disqual'
    AND NOT [Stage3 Response] IN ('Less than 2 years', 'Between 2 and 4 years')
    AND [Stage1 Response] <> 'Social Security Disability (SSD) Benefits'
    AND [Stage6 Response] = 'Not working'
THEN 'Grade C'

// Grade D
ELSEIF 
    // 1) Not age-disqual, Stage3 NOT in those two, Stage1 not SSD, Stage6 ≠ Not working, disqual ≤ 1
    (
      [qual_status] <> 'age-disqual'
      AND NOT [Stage3 Response] IN ('Less than 2 years', 'Between 2 and 4 years')
      AND [Stage1 Response] <> 'Social Security Disability (SSD) Benefits'
      AND [Stage6 Response] <> 'Not working'
      AND [Calculation_1133007210553765896] <= 1
    )
    // 2) Not age-disqual, Stage3 in those two, Qual Status = outofwrk-disqual
    OR
    (
      [qual_status] <> 'age-disqual'
      AND [Stage3 Response] IN ('Less than 2 years', 'Between 2 and 4 years')
      AND [qual_status] = 'outofwrk-disqual'
    )
    // 3) Not age-disqual, Stage3 in those two, Qual Status ≠ outofwrk-disqual, Stage7 = Yes
    OR
    (
      [qual_status] <> 'age-disqual'
      AND [Stage3 Response] IN ('Less than 2 years', 'Between 2 and 4 years')
      AND [qual_status] <> 'outofwrk-disqual'
      AND [Stage7 Response] = 'Yes'
    )
THEN 'Grade D'

// Rest (including age-disqual or anything else)
ELSE 'Rest'
END",
    "name": "[Calculation_7573084309404708864]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "SSD Age Range",
    "datatype": "string",
    "formula": "IF DATE([Calculation_1916563181826678784]) >= #18/08/2025#
THEN
    IF INT([Age]) < 40 THEN "U40"
    ELSEIF INT([Age]) >= 40 AND INT([Age]) <= 49 THEN "40 - 49"
	ELSEIF INT([Age]) >= 50 AND INT([Age]) <= 54 THEN "50 - 54"
    ELSEIF INT([Age]) >= 55 AND INT([Age]) <= 63 THEN "55 - 63"
    ELSEIF INT([Age]) >= 64 THEN "O64+"
    END
ELSEIF INT([Age]) < 40 THEN "*U40"
ELSEIF INT([Age]) >= 40 AND INT([Age]) <= 48 THEN "*40-48"
ELSEIF INT([Age]) = 49 THEN "*49"
ELSEIF INT([Age]) >= 50 AND INT([Age]) <= 62 THEN "*50-62"
ELSEIF INT([Age]) >= 63 THEN "*O63+" 
END",
    "name": "[Calculation_7690318609259716608]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Alt. Branding",
    "datatype": "string",
    "formula": "If int(Right([Phone],2))<30 and [Calculation_5872834692856524810]= 'Live' then 'Yes' else 'No' End",
    "name": "[Calculation_935059914517495808]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Duplicate Rejects",
    "datatype": "string",
    "formula": "if [Outcome]='rejected' and { FIXED [Phone], [Outcome]: COUNTD([User Id])}>1 then 'Yes' else 'No' end",
    "name": "[Calculation_943222690415542272]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Vici Post Delay (Days)",
    "datatype": "integer",
    "formula": "DATEDIFF('day', [Post Date], [Entry Time])",
    "name": "[Calculation_989947527401095169]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Gender",
    "datatype": "string",
    "formula": "//Updated Date: 18 May 2022
//Updated By: Manish
//Description: Converting gnder values to upper case

UPPER([Gender])",
    "name": "[gender (copy)_2399292755830108162]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Helper Date",
    "datatype": "string",
    "formula": ""default"",
    "name": "[Parameter 11]",
    "role": "measure",
    "type": "nominal",
  },
  {
    "caption": "Start Date",
    "datatype": "date",
    "formula": "#2025-07-30#",
    "name": "[Parameter 5]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "End Date",
    "datatype": "date",
    "formula": "#2025-08-27#",
    "name": "[Parameter 6]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Rejected",
    "datatype": "integer",
    "formula": "//Updated Date: 18 May 2022
//Updated By: Manish
//Description: Calculating the unique count of user id when scrub status is rejected

COUNTD(IF [Calculation_7746824680806834178] = 'Rejected' THEN [User Id] END)",
    "name": "[Accepted (copy)_7746824680807407620]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "TTW Grade",
    "datatype": "string",
    "formula": "IF [ttw_qualstatus] = 'ttw-qualified' then 'Grade A'
ELSEIF  [ttw_qualstatus] = 'ttw-nonqualified' and [TTW Explore Work Form] = 'yes' THEN 'Grade B'
ELSEIF [ttw_qualstatus] = 'ttw-nonqualified' and [TTW Explore Work Form] != 'yes' THEN 'Grade C'
ELSEIF ISNULL([ttw_qualstatus]) and [Stage3 Response] = 'Between 2 and 4 years' then 'Grade D'
ELSE 'Rest'
END",
    "name": "[Calculation_1006061976934187009]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "20hrs Disqual",
    "datatype": "integer",
    "formula": "IF [Stage6 Response] = "More than 20 hours per week" THEN 1 ELSE 0 END",
    "name": "[Calculation_1133007210546622464]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Age Disqual",
    "datatype": "integer",
    "formula": "IF INT([Age]) < 40 OR INT([Age]) > 62 THEN 1 ELSE 0 END",
    "name": "[Calculation_1133007210553298946]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Attorney Disqual",
    "datatype": "integer",
    "formula": "IF [Stage5 Response] = "Yes" THEN 1 ELSE 0 END",
    "name": "[Calculation_1133007210553425923]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Ben Disqual",
    "datatype": "integer",
    "formula": "IF IFNULL([Stage1 Response], "") != "I am not receiving any disability benefits (SSD or SSI)"
THEN 1 ELSE 0 END",
    "name": "[Calculation_1133007210553487364]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Doctor Visit Disqual",
    "datatype": "integer",
    "formula": "IF [Stage4 Response] = "No" THEN 1 ELSE 0 END",
    "name": "[Calculation_1133007210553540613]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Five Year Work Disqual",
    "datatype": "integer",
    "formula": "IF [Stage3 Response] = "Less than 2 years"
OR [Stage3 Response] = "Between 2 and 4 years"
THEN 1 ELSE 0 END",
    "name": "[Calculation_1133007210553618438]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Out of Work Disqual",
    "datatype": "integer",
    "formula": "IF [Stage2 Response] = "No" THEN 1 ELSE 0 END",
    "name": "[Calculation_1133007210553663495]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "# of Disqual",
    "datatype": "integer",
    "formula": "ZN([Calculation_1133007210553487364]) +
ZN([Calculation_1133007210553663495]) +
ZN([Calculation_1133007210553618438]) +
ZN([Calculation_1133007210553540613]) +
ZN([Calculation_1133007210553425923]) +
ZN([Calculation_1133007210546622464]) +
ZN([Calculation_1133007210553298946])",
    "name": "[Calculation_1133007210553765896]",
    "role": "dimension",
    "type": "ordinal",
  },
  {
    "caption": "Unresolved SSA Leads",
    "datatype": "string",
    "formula": "IF { FIXED [Phone] : MAX([Resolved Lead]) } = 0 THEN "SSA Unresolved Lead"
ELSEIF { FIXED [Phone] : MAX([Resolved Lead]) } = 1 THEN "SSA Resolved Lead"
END",
    "name": "[Calculation_1467962419029331969]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Post Date ",
    "datatype": "datetime",
    "formula": "//Updated Date: 18 May 2022
//Updated By: Manish
//Description: Formula to calculate UTC date

DATEADD("hour",0,[Post Date])",
    "name": "[Calculation_1916563181826678784]",
    "role": "dimension",
    "type": "ordinal",
  },
  {
    "caption": "Data Updated On",
    "datatype": "datetime",
    "formula": "{fixed :max([Post Date])}",
    "name": "[Calculation_2010857255412854784]",
    "role": "dimension",
    "type": "ordinal",
  },
  {
    "caption": "Grade",
    "datatype": "string",
    "formula": "// Grade A
IF [qual_status] = 'all-steps' THEN 'Grade A'

// Grade B
ELSEIF 
    [qual_status] IN ('fiveyrwrk-disqual','outofwrk-disqual','doc-disqual')
    AND [Calculation_1133007210553765896] = 1
THEN 'Grade B'

// Grade C
ELSEIF 
    [qual_status] <> 'age-disqual'
    AND NOT [Stage3 Response] IN ('Less than 2 years', 'Between 2 and 4 years')
    AND [Stage1 Response] <> 'Social Security Disability (SSD) Benefits'
    AND [Stage6 Response] = 'Not working'
THEN 'Grade C'

// Grade D
ELSEIF 
    // 1) Not age-disqual, Stage3 NOT in those two, Stage1 not SSD, Stage6 ≠ Not working, disqual ≤ 1
    (
      [qual_status] <> 'age-disqual'
      AND NOT [Stage3 Response] IN ('Less than 2 years', 'Between 2 and 4 years')
      AND [Stage1 Response] <> 'Social Security Disability (SSD) Benefits'
      AND [Stage6 Response] <> 'Not working'
      AND [Calculation_1133007210553765896] <= 1
    )
    // 2) Not age-disqual, Stage3 in those two, Qual Status = outofwrk-disqual
    OR
    (
      [qual_status] <> 'age-disqual'
      AND [Stage3 Response] IN ('Less than 2 years', 'Between 2 and 4 years')
      AND [qual_status] = 'outofwrk-disqual'
    )
    // 3) Not age-disqual, Stage3 in those two, Qual Status ≠ outofwrk-disqual, Stage7 = Yes
    OR
    (
      [qual_status] <> 'age-disqual'
      AND [Stage3 Response] IN ('Less than 2 years', 'Between 2 and 4 years')
      AND [qual_status] <> 'outofwrk-disqual'
      AND [Stage7 Response] = 'Yes'
    )
THEN 'Grade D'

// Rest (including age-disqual or anything else)
ELSE 'Rest'
END",
    "name": "[Calculation_7573084309404708864]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Today-28",
    "datatype": "date",
    "formula": "//Updated Date: 18 May 2022
//Updated By: Manish
//Description: Going back 28 days from today

({MAX(today()-28)})",
    "name": "[Calculation_767300790172184597]",
    "role": "dimension",
    "type": "ordinal",
  },
  {
    "caption": "Scrub status",
    "datatype": "string",
    "formula": "//Updated Date: 18 May 2022
//Updated By: Manish
//Description: Calculating the status based on outcome

IF [Outcome]='initialized' then 'Accepted'
            else 'Rejected'
        end",
    "name": "[Calculation_7746824680806834178]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Accepted",
    "datatype": "integer",
    "formula": "//Updated Date: 18 May 2022
//Updated By: Manish
//Description: Calculating the unique count of userid when scrub status is accepted

COUNTD(IF [Calculation_7746824680806834178] = 'Accepted' THEN [User Id] END)",
    "name": "[Calculation_7746824680806989827]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Scrub %",
    "datatype": "real",
    "formula": "//Updated Date: 18 May 2022
//Updated By: Manish
//Description: Calculating the 5 of rejected scrub status

([Accepted (copy)_7746824680807407620]*1.00)/([Calculation_7746824680806989827]+[Accepted (copy)_7746824680807407620])",
    "name": "[Calculation_7746824680807591941]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Time-Source-Subid",
    "datatype": "string",
    "formula": "//Updated Date: 18 May 2022
//Updated By: Manish
//Description: Changing the data type to string of Time-Source-Subid column

STR([Date])+'-'+[Source]+'-'+[Sub Id]",
    "name": "[Calculation_7746824680808361990]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Date Filter",
    "datatype": "boolean",
    "formula": "//Updated Date: 18 May 2022
//Updated By: Manish
//Description: Filtering data based on date

IF [Parameters].[Parameter 11] = 'default'
THEN [Date]>=[Parameters].[Parameter 5] AND [Date]<=[Parameters].[Parameter 6]
ELSEIF [Parameters].[Parameter 11] = 'weekly'
THEN [Date] >= TODAY()-8 AND [Date] <= TODAY()-1
END",
    "name": "[Calculation_843580506575679492]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Dial R",
    "datatype": "string",
    "formula": "IF  [Called Count] < 4 then "<=3" 
elseif [Called Count] < 8 then "4-7"
elseif [Called Count] < 11 then "8-10"
elseif [Called Count] < 16 then "11-15"
elseif [Called Count] < 20 then "16-19"
elseif [Called Count] < 26 then "20-25"
elseif [Called Count] < 31 then "25-30"
elseif [Called Count] < 36 then "30-35"
else "35+" 
END",
    "name": "[Calculation_847802666706034688]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Dial R (detail)",
    "datatype": "string",
    "formula": "STR([Called Count])",
    "name": "[Calculation_847802666706186241]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Max Date",
    "datatype": "date",
    "formula": "//Updated Date: 18 May 2022
//Updated By: Manish
//Description: Calculating max of todays date for including it in the default values of end date

{MAX(today())}",
    "name": "[Calculation_882424053213511680]",
    "role": "dimension",
    "type": "ordinal",
  },
  {
    "caption": "D2",
    "datatype": "integer",
    "formula": "0",
    "name": "[D1 (copy 2)_1113233589196361731]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "D3",
    "datatype": "integer",
    "formula": "0",
    "name": "[D1 (copy 3)_1113233589196374020]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "D5",
    "datatype": "integer",
    "formula": "0",
    "name": "[D1 (copy) (copy)_1113233589196361730]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "D4",
    "datatype": "integer",
    "formula": "0",
    "name": "[D1 (copy)_1113233589196333057]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "D1",
    "datatype": "integer",
    "formula": "0",
    "name": "[Parameter 10]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Helper Date",
    "datatype": "string",
    "formula": ""default"",
    "name": "[Parameter 11]",
    "role": "measure",
    "type": "nominal",
  },
  {
    "caption": "User Identifier",
    "datatype": "integer",
    "formula": "0",
    "name": "[Parameter 12]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Date Bucket",
    "datatype": "string",
    "formula": ""day"",
    "name": "[Parameter 1]",
    "role": "measure",
    "type": "nominal",
  },
  {
    "caption": "Start Date",
    "datatype": "date",
    "formula": "#2025-07-30#",
    "name": "[Parameter 5]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "End Date",
    "datatype": "date",
    "formula": "#2025-08-27#",
    "name": "[Parameter 6]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "TTW Grade",
    "datatype": "string",
    "formula": "IF [ttw_qualstatus] = 'ttw-qualified' then 'Grade A'
ELSEIF  [ttw_qualstatus] = 'ttw-nonqualified' and [TTW Explore Work Form] = 'yes' THEN 'Grade B'
ELSEIF [ttw_qualstatus] = 'ttw-nonqualified' and [TTW Explore Work Form] != 'yes' THEN 'Grade C'
ELSEIF ISNULL([ttw_qualstatus]) and [Stage3 Response] = 'Between 2 and 4 years' then 'Grade D'
ELSE 'Rest'
END",
    "name": "[Calculation_1006061976934187009]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Hour of Day",
    "datatype": "string",
    "formula": "IF LEN(STR(DATEPART('hour', [Calculation_1916563181826678784]))) = 1
THEN "0" + STR(DATEPART('hour', [Calculation_1916563181826678784]))
ELSE STR(DATEPART('hour', [Calculation_1916563181826678784]))
END",
    "name": "[Calculation_1113233589182521344]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "20hrs Disqual",
    "datatype": "integer",
    "formula": "IF [Stage6 Response] = "More than 20 hours per week" THEN 1 ELSE 0 END",
    "name": "[Calculation_1133007210546622464]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Age Disqual",
    "datatype": "integer",
    "formula": "IF INT([Age]) < 40 OR INT([Age]) > 62 THEN 1 ELSE 0 END",
    "name": "[Calculation_1133007210553298946]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Attorney Disqual",
    "datatype": "integer",
    "formula": "IF [Stage5 Response] = "Yes" THEN 1 ELSE 0 END",
    "name": "[Calculation_1133007210553425923]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Ben Disqual",
    "datatype": "integer",
    "formula": "IF IFNULL([Stage1 Response], "") != "I am not receiving any disability benefits (SSD or SSI)"
THEN 1 ELSE 0 END",
    "name": "[Calculation_1133007210553487364]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Doctor Visit Disqual",
    "datatype": "integer",
    "formula": "IF [Stage4 Response] = "No" THEN 1 ELSE 0 END",
    "name": "[Calculation_1133007210553540613]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Five Year Work Disqual",
    "datatype": "integer",
    "formula": "IF [Stage3 Response] = "Less than 2 years"
OR [Stage3 Response] = "Between 2 and 4 years"
THEN 1 ELSE 0 END",
    "name": "[Calculation_1133007210553618438]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Out of Work Disqual",
    "datatype": "integer",
    "formula": "IF [Stage2 Response] = "No" THEN 1 ELSE 0 END",
    "name": "[Calculation_1133007210553663495]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "# of Disqual",
    "datatype": "integer",
    "formula": "ZN([Calculation_1133007210553487364]) +
ZN([Calculation_1133007210553663495]) +
ZN([Calculation_1133007210553618438]) +
ZN([Calculation_1133007210553540613]) +
ZN([Calculation_1133007210553425923]) +
ZN([Calculation_1133007210546622464]) +
ZN([Calculation_1133007210553298946])",
    "name": "[Calculation_1133007210553765896]",
    "role": "dimension",
    "type": "ordinal",
  },
  {
    "caption": "Month - Year",
    "datatype": "string",
    "formula": "DATENAME('month',[Post Date])+' '+ STR(YEAR([Post Date]))",
    "name": "[Calculation_1232578966341357571]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Levine States ",
    "datatype": "string",
    "formula": "IF ISNULL([Levine States]) THEN 'Other'
ELSE [Levine States] END",
    "name": "[Calculation_1277614987429064704]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "PD Dimensions  Combination",
    "datatype": "string",
    "formula": "IFNULL([Calculation_1232578966341357571],'')+
IFNULL([Calculation_6374000853571039236],'')+
IFNULL([D1 (copy)_6374000853573341191],'')+
IFNULL([D1 (copy) (copy)_6374000853573369864],'')+
IFNULL([D3 (copy)_6208563937532035081],'')+
IFNULL([D4 (copy)_6208563937532350475],'')",
    "name": "[Calculation_1341228293759967232]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "DP Leak",
    "datatype": "string",
    "formula": "IF CONTAINS([clientname], 'disabilitypath')
AND [Calculation_7573084309404708864] in ('Grade A', 'Grade B')
THEN 'Yes'
ELSE 'No'
END",
    "name": "[Calculation_1460573688699854848]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Unresolved SSA Leads",
    "datatype": "string",
    "formula": "IF { FIXED [Phone] : MAX([Resolved Lead]) } = 0 THEN "SSA Unresolved Lead"
ELSEIF { FIXED [Phone] : MAX([Resolved Lead]) } = 1 THEN "SSA Resolved Lead"
END",
    "name": "[Calculation_1467962419029331969]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "CTC Lead Flag",
    "datatype": "string",
    "formula": "if [CTC Lead] = 1 then "Yes" else "No" END",
    "name": "[Calculation_1880252886088871936]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "CZ Post Hour Group",
    "datatype": "string",
    "formula": "IF DATEPART('hour', [Post Date]) >= 0 AND DATEPART('hour', [Post Date]) < 6 THEN 'Pre CC Hours'
ELSEIF DATEPART('hour', [Post Date]) >= 6 AND DATEPART('hour', [Post Date]) < 16 THEN 'CC Hours'
ELSEIF DATEPART('hour', [Post Date]) >= 16 AND DATEPART('hour', [Post Date]) < 24 THEN 'Post CC Hours'
END",
    "name": "[Calculation_1880252886125215747]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Post Date ",
    "datatype": "datetime",
    "formula": "//Updated Date: 18 May 2022
//Updated By: Manish
//Description: Formula to calculate UTC date

DATEADD("hour",0,[Post Date])",
    "name": "[Calculation_1916563181826678784]",
    "role": "dimension",
    "type": "ordinal",
  },
  {
    "caption": "Data Updated On",
    "datatype": "datetime",
    "formula": "{fixed :max([Post Date])}",
    "name": "[Calculation_2010857255412854784]",
    "role": "dimension",
    "type": "ordinal",
  },
  {
    "caption": "Lead Sell Type",
    "datatype": "string",
    "formula": "if contains([Transfer Info Label],'CXER') then 'Sold: Call' 
elseif 
contains([sgmt],'ql-leadbuy') or 
contains([ATA Work],'ql-leadbuy')
then 'Sold: Lead'
else 'Internal'
end",
    "name": "[Calculation_3435894714053935109]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Seg4 Control vs. Treatment",
    "datatype": "string",
    "formula": "IF [CZ Project Name] = "Mass Tort - High Intent SSDI" AND [Calculation_1880252886088871936] = "No" AND [qual_status] != "all-steps" THEN
    IF INT(RIGHT([phone masked], 3)) % 2 = 0 THEN "Control"
    ELSEIF INT(RIGHT([phone masked], 3)) % 2 != 0 THEN "Treatment"
    END
END",
    "name": "[Calculation_4531465651676315649]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Seg4 Cohort",
    "datatype": "string",
    "formula": "LOWER(IFNULL([seg4_cohort], [Calculation_4531465651676315649]))",
    "name": "[Calculation_4531465651676438530]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Time to Call (Minute)",
    "datatype": "real",
    "formula": "IF [Calculation_1880252886088871936] = 'Yes'
THEN ROUND(([CTC Time] - [Post Date]) * 24 * 60, 2)
END",
    "name": "[Calculation_499055157752631296]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Time to Call Bucket",
    "datatype": "string",
    "formula": "IF  [Calculation_499055157752631296] < 0
THEN '<0 Mins'
ELSEIF [Calculation_499055157752631296] <= 2 AND [Calculation_499055157752631296] >= 0
THEN '0-2 Mins'
ELSEIF [Calculation_499055157752631296] <= 5 AND [Calculation_499055157752631296] > 0
THEN '2-5 Mins'
ELSEIF [Calculation_499055157752631296] <= 10 AND [Calculation_499055157752631296] > 0
THEN '5-10 Mins'
ELSEIF [Calculation_499055157752631296] <= 30 AND [Calculation_499055157752631296] > 0 
THEN '10-30 Mins'
ELSEIF [Calculation_499055157752631296] <= 60 AND [Calculation_499055157752631296] > 0
THEN '30Mins-1 Hour'
ELSEIF [Calculation_499055157752631296] <= 300 AND [Calculation_499055157752631296] > 0
THEN '1-5 Hours'
ELSEIF [Calculation_499055157752631296] <= 600 AND [Calculation_499055157752631296] > 0
THEN '5-10 Hours'
ELSEIF [Calculation_499055157752631296] <= 1440 AND [Calculation_499055157752631296] > 0
THEN '10-24 Hours'
ELSEIF [Calculation_499055157752631296] <= 4320 AND [Calculation_499055157752631296] > 0
THEN '24-72 Hours'
ELSEIF [Calculation_499055157752631296] > 4320 AND [Calculation_499055157752631296] > 0
THEN '>72 Hours'
END",
    "name": "[Calculation_499055157754740737]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Project Type",
    "datatype": "string",
    "formula": "IF CONTAINS([CZ Project Name],'Aged') THEN 'Aged'
ELSE 'Live' END",
    "name": "[Calculation_5872834692856524810]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "BLA Status",
    "datatype": "string",
    "formula": "IF [bla_blacklisted] = 'true' THEN 'Blacklisted'
ELSEIF [bla_blacklisted] = 'false' THEN 'Passed'
ELSE NULL
END",
    "name": "[Calculation_6374000853565702144]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "BLA Code",
    "datatype": "string",
    "formula": "[bla_rejectcodes]",
    "name": "[Calculation_6374000853566275585]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "D1 ('+' to add dim)",
    "datatype": "string",
    "formula": "IF [Parameters].[Parameter 10] = 1 THEN [Calculation_6374000853566275585]
ELSEIF [Parameters].[Parameter 10] = 2 THEN [bla_carrierdata_type]
ELSEIF [Parameters].[Parameter 10] = 3 THEN [Calculation_6374000853565702144]
ELSEIF [Parameters].[Parameter 10] = 4 THEN [Phone Carrier]
ELSEIF [Parameters].[Parameter 10] = 5 THEN [CZ Project Name]
ELSEIF [Parameters].[Parameter 10] = 6 THEN [Phone Type]
ELSEIF [Parameters].[Parameter 10] = 7 THEN [normalized carrier]
ELSEIF [Parameters].[Parameter 10] = 8 THEN [Outcome]
ELSEIF [Parameters].[Parameter 10] = 9 THEN [qual_status]
ELSEIF [Parameters].[Parameter 10] = 10 THEN [Source]
ELSEIF [Parameters].[Parameter 10] = 11 THEN [Sub Id]
ELSEIF [Parameters].[Parameter 10] = 12 THEN [gender (copy)_2399292755830108162]
ELSEIF [Parameters].[Parameter 10] = 13 THEN [Creative]
ELSEIF [Parameters].[Parameter 10] = 14 THEN [CL Diagnosis Injury Tiers]
ELSEIF [Parameters].[Parameter 10] = 15 THEN [Calculation_935059914517495808]
ELSEIF [Parameters].[Parameter 10] = 16 THEN [Ad Name]
ELSEIF [Parameters].[Parameter 10] = 17 THEN [Adset Name]
ELSEIF [Parameters].[Parameter 10] = 18 THEN [campaign_id]
ELSEIF [Parameters].[Parameter 10] = 19 THEN [Labels]
ELSEIF [Parameters].[Parameter 10] = 20 THEN [Calculation_5872834692856524810]
ELSEIF [Parameters].[Parameter 10] = 21 THEN [State]
ELSEIF [Parameters].[Parameter 10] = 22 THEN [Phone]
// ELSEIF [D1] = 23 THEN [Tier]
ELSEIF [Parameters].[Parameter 10] = 23 THEN [Calculation_1277614987429064704]
ELSEIF [Parameters].[Parameter 10] = 25 THEN [Result Type]
ELSEIF [Parameters].[Parameter 10] = 26 THEN [placement]
ELSEIF [Parameters].[Parameter 10] = 27 THEN [Calculation_7690318609259716608]
ELSEIF [Parameters].[Parameter 10] = 28 THEN [label]
ELSEIF [Parameters].[Parameter 10] = 29 THEN STR([Calculation_1880252886088871936])
ELSEIF [Parameters].[Parameter 10] = 30 THEN [clientname]
ELSEIF [Parameters].[Parameter 10] = 31 THEN [page_path]
ELSEIF [Parameters].[Parameter 10] = 32 THEN [sgmt]
ELSEIF [Parameters].[Parameter 10] = 33 THEN [ctcphone]
ELSEIF [Parameters].[Parameter 10] = 34 THEN [Calculation_3435894714053935109]
ELSEIF [Parameters].[Parameter 10] = 35 THEN [ltdinoworkmedicalconditions]
ELSEIF [Parameters].[Parameter 10] = 36 THEN [ds_qualstatus]
ELSEIF [Parameters].[Parameter 10] = 37 THEN [ad_id]
ELSEIF [Parameters].[Parameter 10] = 38 THEN [adset_id]
ELSEIF [Parameters].[Parameter 10] = 39 THEN [Calculation_1113233589182521344]
ELSEIF [Parameters].[Parameter 10] = 40 THEN [Calculation_1880252886125215747]
ELSEIF [Parameters].[Parameter 10] = 41 THEN [SubSegment]
ELSEIF [Parameters].[Parameter 10] = 42 THEN STR([Calculation_1133007210553765896])
ELSEIF [Parameters].[Parameter 10] = 43 THEN [Calculation_7573084309404708864]
ELSEIF [Parameters].[Parameter 10] = 44 THEN [Calculation_4531465651676438530]
ELSEIF [Parameters].[Parameter 10] = 45 THEN IF LEN(STR([appearance_l30d])) < 2 AND NOT ISNULL(STR([appearance_l30d])) THEN '0' + STR([appearance_l30d]) ELSE STR([appearance_l30d]) END
ELSEIF [Parameters].[Parameter 10] = 46 THEN IF LEN(STR([appearance_l60d])) < 2 AND NOT ISNULL(STR([appearance_l60d])) THEN '0' + STR([appearance_l60d]) ELSE STR([appearance_l60d]) END
ELSEIF [Parameters].[Parameter 10] = 47 THEN IF LEN(STR([appearance_l90d])) < 2 AND NOT ISNULL(STR([appearance_l90d])) THEN '0' + STR([appearance_l90d]) ELSE STR([appearance_l90d]) END
ELSEIF [Parameters].[Parameter 10] = 48 THEN [ATA Work]
ELSEIF [Parameters].[Parameter 10] = 49 THEN [Calculation_499055157754740737]
ELSEIF [Parameters].[Parameter 10] = 50 THEN IF LEN(STR([CIIC Appearance in L30D])) < 2 AND NOT ISNULL(STR([CIIC Appearance in L30D])) THEN '0' + STR([CIIC Appearance in L30D]) ELSE STR([CIIC Appearance in L30D]) END
ELSEIF [Parameters].[Parameter 10] = 51 THEN IF LEN(STR([CIIC Appearance in L60D])) < 2 AND NOT ISNULL(STR([CIIC Appearance in L60D])) THEN '0' + STR([CIIC Appearance in L60D]) ELSE STR([CIIC Appearance in L60D]) END
ELSEIF [Parameters].[Parameter 10] = 52 THEN IF LEN(STR([CIIC Appearance in L90D])) < 2 AND NOT ISNULL(STR([CIIC Appearance in L90D])) THEN '0' + STR([CIIC Appearance in L90D]) ELSE STR([CIIC Appearance in L90D]) END
ELSEIF [Parameters].[Parameter 10] = 53 THEN STR([Calculation_989947527401095169])
ELSEIF [Parameters].[Parameter 10] = 54 THEN [Calculation_1460573688699854848]
ELSEIF [Parameters].[Parameter 10] = 55 THEN [Calculation_1006061976934187009]
ELSE 'Agg'
END",
    "name": "[Calculation_6374000853571039236]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Grade",
    "datatype": "string",
    "formula": "// Grade A
IF [qual_status] = 'all-steps' THEN 'Grade A'

// Grade B
ELSEIF 
    [qual_status] IN ('fiveyrwrk-disqual','outofwrk-disqual','doc-disqual')
    AND [Calculation_1133007210553765896] = 1
THEN 'Grade B'

// Grade C
ELSEIF 
    [qual_status] <> 'age-disqual'
    AND NOT [Stage3 Response] IN ('Less than 2 years', 'Between 2 and 4 years')
    AND [Stage1 Response] <> 'Social Security Disability (SSD) Benefits'
    AND [Stage6 Response] = 'Not working'
THEN 'Grade C'

// Grade D
ELSEIF 
    // 1) Not age-disqual, Stage3 NOT in those two, Stage1 not SSD, Stage6 ≠ Not working, disqual ≤ 1
    (
      [qual_status] <> 'age-disqual'
      AND NOT [Stage3 Response] IN ('Less than 2 years', 'Between 2 and 4 years')
      AND [Stage1 Response] <> 'Social Security Disability (SSD) Benefits'
      AND [Stage6 Response] <> 'Not working'
      AND [Calculation_1133007210553765896] <= 1
    )
    // 2) Not age-disqual, Stage3 in those two, Qual Status = outofwrk-disqual
    OR
    (
      [qual_status] <> 'age-disqual'
      AND [Stage3 Response] IN ('Less than 2 years', 'Between 2 and 4 years')
      AND [qual_status] = 'outofwrk-disqual'
    )
    // 3) Not age-disqual, Stage3 in those two, Qual Status ≠ outofwrk-disqual, Stage7 = Yes
    OR
    (
      [qual_status] <> 'age-disqual'
      AND [Stage3 Response] IN ('Less than 2 years', 'Between 2 and 4 years')
      AND [qual_status] <> 'outofwrk-disqual'
      AND [Stage7 Response] = 'Yes'
    )
THEN 'Grade D'

// Rest (including age-disqual or anything else)
ELSE 'Rest'
END",
    "name": "[Calculation_7573084309404708864]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Today-28",
    "datatype": "date",
    "formula": "//Updated Date: 18 May 2022
//Updated By: Manish
//Description: Going back 28 days from today

({MAX(today()-28)})",
    "name": "[Calculation_767300790172184597]",
    "role": "dimension",
    "type": "ordinal",
  },
  {
    "caption": "SSD Age Range",
    "datatype": "string",
    "formula": "IF DATE([Calculation_1916563181826678784]) >= #18/08/2025#
THEN
    IF INT([Age]) < 40 THEN "U40"
    ELSEIF INT([Age]) >= 40 AND INT([Age]) <= 49 THEN "40 - 49"
	ELSEIF INT([Age]) >= 50 AND INT([Age]) <= 54 THEN "50 - 54"
    ELSEIF INT([Age]) >= 55 AND INT([Age]) <= 63 THEN "55 - 63"
    ELSEIF INT([Age]) >= 64 THEN "O64+"
    END
ELSEIF INT([Age]) < 40 THEN "*U40"
ELSEIF INT([Age]) >= 40 AND INT([Age]) <= 48 THEN "*40-48"
ELSEIF INT([Age]) = 49 THEN "*49"
ELSEIF INT([Age]) >= 50 AND INT([Age]) <= 62 THEN "*50-62"
ELSEIF INT([Age]) >= 63 THEN "*O63+" 
END",
    "name": "[Calculation_7690318609259716608]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Lead Posted #",
    "datatype": "integer",
    "formula": "COUNTD([Calculation_906349454594166784])",
    "name": "[Calculation_7711781056550006784]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Date Filter",
    "datatype": "boolean",
    "formula": "//Updated Date: 18 May 2022
//Updated By: Manish
//Description: Filtering data based on date

IF [Parameters].[Parameter 11] = 'default'
THEN [Date]>=[Parameters].[Parameter 5] AND [Date]<=[Parameters].[Parameter 6]
ELSEIF [Parameters].[Parameter 11] = 'weekly'
THEN [Date] >= TODAY()-8 AND [Date] <= TODAY()-1
END",
    "name": "[Calculation_843580506575679492]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Dial R",
    "datatype": "string",
    "formula": "IF  [Called Count] < 4 then "<=3" 
elseif [Called Count] < 8 then "4-7"
elseif [Called Count] < 11 then "8-10"
elseif [Called Count] < 16 then "11-15"
elseif [Called Count] < 20 then "16-19"
elseif [Called Count] < 26 then "20-25"
elseif [Called Count] < 31 then "25-30"
elseif [Called Count] < 36 then "30-35"
else "35+" 
END",
    "name": "[Calculation_847802666706034688]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Dial R (detail)",
    "datatype": "string",
    "formula": "STR([Called Count])",
    "name": "[Calculation_847802666706186241]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Max Date",
    "datatype": "date",
    "formula": "//Updated Date: 18 May 2022
//Updated By: Manish
//Description: Calculating max of todays date for including it in the default values of end date

{MAX(today())}",
    "name": "[Calculation_882424053213511680]",
    "role": "dimension",
    "type": "ordinal",
  },
  {
    "caption": "User Identifier",
    "datatype": "string",
    "formula": "IF [Parameters].[Parameter 12] = 0 THEN [User Id]
ELSEIF [Parameters].[Parameter 12] = 1 THEN [Phone]
END",
    "name": "[Calculation_906349454594166784]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Alt. Branding",
    "datatype": "string",
    "formula": "If int(Right([Phone],2))<30 and [Calculation_5872834692856524810]= 'Live' then 'Yes' else 'No' End",
    "name": "[Calculation_935059914517495808]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Post Date  ",
    "datatype": "string",
    "formula": "//Updated Date: 18 May 2022
//Updated By: Manish
//Description: Calculation to apply date bucket

CASE [Parameters].[Parameter 1]
WHEN 'year' THEN str(datepart('year', [Calculation_1916563181826678784]))
WHEN 'quarter' THEN "Q" + str(datepart('quarter', [Calculation_1916563181826678784])) + " " + str(datepart('year', [Calculation_1916563181826678784]))
WHEN 'month' THEN str(datepart('month', [Calculation_1916563181826678784])) + "-" + str(datepart('year', [Calculation_1916563181826678784]))
WHEN 'day' THEN str(DATENAME('month', [Calculation_1916563181826678784]))+ "-" +str(datepart('day', [Calculation_1916563181826678784]))+ "-" + str(datepart('year', [Calculation_1916563181826678784]))
WHEN 'week' THEN "W" + str(datepart('week', [Calculation_1916563181826678784])) + "-" + str(datepart('year', [Calculation_1916563181826678784]))
WHEN "hour" THEN str(DATETRUNC('hour', [Calculation_1916563181826678784]))
WHEN "minute" THEN str(DATETRUNC('minute', [Calculation_1916563181826678784]))
END",
    "name": "[Calculation_97320012552925214]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Vici Post Delay (Days)",
    "datatype": "integer",
    "formula": "DATEDIFF('day', [Post Date], [Entry Time])",
    "name": "[Calculation_989947527401095169]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "D3",
    "datatype": "string",
    "formula": "IF [Parameters].[D1 (copy 3)_1113233589196374020] = 1 THEN [Calculation_6374000853566275585]
ELSEIF [Parameters].[D1 (copy 3)_1113233589196374020] = 2 THEN [bla_carrierdata_type]
ELSEIF [Parameters].[D1 (copy 3)_1113233589196374020] = 3 THEN [Calculation_6374000853565702144]
ELSEIF [Parameters].[D1 (copy 3)_1113233589196374020] = 4 THEN [Phone Carrier]
ELSEIF [Parameters].[D1 (copy 3)_1113233589196374020] = 5 THEN [CZ Project Name]
ELSEIF [Parameters].[D1 (copy 3)_1113233589196374020] = 6 THEN [Phone Type]
ELSEIF [Parameters].[D1 (copy 3)_1113233589196374020] = 7 THEN [normalized carrier]
ELSEIF [Parameters].[D1 (copy 3)_1113233589196374020] = 8 THEN [Outcome]
ELSEIF [Parameters].[D1 (copy 3)_1113233589196374020] = 9 THEN [qual_status]
ELSEIF [Parameters].[D1 (copy 3)_1113233589196374020] = 10 THEN [Source]
ELSEIF [Parameters].[D1 (copy 3)_1113233589196374020] = 11 THEN [Sub Id]
ELSEIF [Parameters].[D1 (copy 3)_1113233589196374020] = 12 THEN [gender (copy)_2399292755830108162]
ELSEIF [Parameters].[D1 (copy 3)_1113233589196374020] = 13 THEN [Creative]
ELSEIF [Parameters].[D1 (copy 3)_1113233589196374020] = 14 THEN [CL Diagnosis Injury Tiers]
ELSEIF [Parameters].[D1 (copy 3)_1113233589196374020] = 15 THEN [Calculation_935059914517495808]
ELSEIF [Parameters].[D1 (copy 3)_1113233589196374020] = 16 THEN [Ad Name]
ELSEIF [Parameters].[D1 (copy 3)_1113233589196374020] = 17 THEN [Adset Name]
ELSEIF [Parameters].[D1 (copy 3)_1113233589196374020] = 18 THEN [campaign_id]
ELSEIF [Parameters].[D1 (copy 3)_1113233589196374020] = 19 THEN [Labels]
ELSEIF [Parameters].[D1 (copy 3)_1113233589196374020] = 20 THEN [Calculation_5872834692856524810]
ELSEIF [Parameters].[D1 (copy 3)_1113233589196374020] = 21 THEN [State]
ELSEIF [Parameters].[D1 (copy 3)_1113233589196374020] = 22 THEN [Phone]
// ELSEIF [Parameters].[D3] = 23 THEN [Tier]
ELSEIF [Parameters].[D1 (copy 3)_1113233589196374020] = 23 THEN [Calculation_1277614987429064704]
ELSEIF [Parameters].[D1 (copy 3)_1113233589196374020] = 25 THEN [Result Type]
ELSEIF [Parameters].[D1 (copy 3)_1113233589196374020] = 26 THEN [placement]
ELSEIF [Parameters].[D1 (copy 3)_1113233589196374020] = 27 THEN [Calculation_7690318609259716608]
ELSEIF [Parameters].[D1 (copy 3)_1113233589196374020] = 28 THEN [label]
ELSEIF [Parameters].[D1 (copy 3)_1113233589196374020] = 29 THEN STR([Calculation_1880252886088871936])
ELSEIF [Parameters].[D1 (copy 3)_1113233589196374020] = 30 THEN [clientname]
ELSEIF [Parameters].[D1 (copy 3)_1113233589196374020] = 31 THEN [page_path]
ELSEIF [Parameters].[D1 (copy 3)_1113233589196374020] = 32 THEN [sgmt]
ELSEIF [Parameters].[D1 (copy 3)_1113233589196374020] = 33 THEN [ctcphone]
ELSEIF [Parameters].[D1 (copy 3)_1113233589196374020] = 34 THEN [Calculation_3435894714053935109]
ELSEIF [Parameters].[D1 (copy 3)_1113233589196374020] = 35 THEN [ltdinoworkmedicalconditions]
ELSEIF [Parameters].[D1 (copy 3)_1113233589196374020] = 36 THEN [ds_qualstatus]
ELSEIF [Parameters].[D1 (copy 3)_1113233589196374020] = 37 THEN [ad_id]
ELSEIF [Parameters].[D1 (copy 3)_1113233589196374020] = 38 THEN [adset_id]
ELSEIF [Parameters].[D1 (copy 3)_1113233589196374020] = 39 THEN [Calculation_1113233589182521344]
ELSEIF [Parameters].[D1 (copy 3)_1113233589196374020] = 40 THEN [Calculation_1880252886125215747]
ELSEIF [Parameters].[D1 (copy 3)_1113233589196374020] = 41 THEN [SubSegment]
ELSEIF [Parameters].[D1 (copy 3)_1113233589196374020] = 42 THEN STR([Calculation_1133007210553765896])
ELSEIF [Parameters].[D1 (copy 3)_1113233589196374020] = 43 THEN [Calculation_7573084309404708864]
ELSEIF [Parameters].[D1 (copy 3)_1113233589196374020] = 44 THEN [Calculation_4531465651676438530]
ELSEIF [Parameters].[D1 (copy 3)_1113233589196374020] = 45 THEN IF LEN(STR([appearance_l30d])) < 2 AND NOT ISNULL(STR([appearance_l30d])) THEN '0' + STR([appearance_l30d]) ELSE STR([appearance_l30d]) END
ELSEIF [Parameters].[D1 (copy 3)_1113233589196374020] = 46 THEN IF LEN(STR([appearance_l60d])) < 2 AND NOT ISNULL(STR([appearance_l60d])) THEN '0' + STR([appearance_l60d]) ELSE STR([appearance_l60d]) END
ELSEIF [Parameters].[D1 (copy 3)_1113233589196374020] = 47 THEN IF LEN(STR([appearance_l90d])) < 2 AND NOT ISNULL(STR([appearance_l90d])) THEN '0' + STR([appearance_l90d]) ELSE STR([appearance_l90d]) END
ELSEIF [Parameters].[D1 (copy 3)_1113233589196374020] = 48 THEN [ATA Work]
ELSEIF [Parameters].[D1 (copy 3)_1113233589196374020] = 49 THEN [Calculation_499055157754740737]
ELSEIF [Parameters].[D1 (copy 3)_1113233589196374020] = 50 THEN IF LEN(STR([CIIC Appearance in L30D])) < 2 AND NOT ISNULL(STR([CIIC Appearance in L30D])) THEN '0' + STR([CIIC Appearance in L30D]) ELSE STR([CIIC Appearance in L30D]) END
ELSEIF [Parameters].[D1 (copy 3)_1113233589196374020] = 51 THEN IF LEN(STR([CIIC Appearance in L60D])) < 2 AND NOT ISNULL(STR([CIIC Appearance in L60D])) THEN '0' + STR([CIIC Appearance in L60D]) ELSE STR([CIIC Appearance in L60D]) END
ELSEIF [Parameters].[D1 (copy 3)_1113233589196374020] = 52 THEN IF LEN(STR([CIIC Appearance in L90D])) < 2 AND NOT ISNULL(STR([CIIC Appearance in L90D])) THEN '0' + STR([CIIC Appearance in L90D]) ELSE STR([CIIC Appearance in L90D]) END
ELSEIF [Parameters].[D1 (copy 3)_1113233589196374020] = 53 THEN STR([Calculation_989947527401095169])
ELSEIF [Parameters].[D1 (copy 3)_1113233589196374020] = 54 THEN [Calculation_1460573688699854848]
ELSEIF [Parameters].[D1 (copy 3)_1113233589196374020] = 55 THEN [Calculation_1006061976934187009]
ELSE 'Agg'
END",
    "name": "[D1 (copy) (copy)_6374000853573369864]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "D2",
    "datatype": "string",
    "formula": "IF [Parameters].[D1 (copy 2)_1113233589196361731] = 1 THEN [Calculation_6374000853566275585]
ELSEIF [Parameters].[D1 (copy 2)_1113233589196361731]  = 2 THEN [bla_carrierdata_type]
ELSEIF [Parameters].[D1 (copy 2)_1113233589196361731]  = 3 THEN [Calculation_6374000853565702144]
ELSEIF [Parameters].[D1 (copy 2)_1113233589196361731]  = 4 THEN [Phone Carrier]
ELSEIF [Parameters].[D1 (copy 2)_1113233589196361731]  = 5 THEN [CZ Project Name]
ELSEIF [Parameters].[D1 (copy 2)_1113233589196361731]  = 6 THEN [Phone Type]
ELSEIF [Parameters].[D1 (copy 2)_1113233589196361731]  = 7 THEN [normalized carrier]
ELSEIF [Parameters].[D1 (copy 2)_1113233589196361731]  = 8 THEN [Outcome]
ELSEIF [Parameters].[D1 (copy 2)_1113233589196361731]  = 9 THEN [qual_status]
ELSEIF [Parameters].[D1 (copy 2)_1113233589196361731]  = 10 THEN [Source]
ELSEIF [Parameters].[D1 (copy 2)_1113233589196361731]  = 11 THEN [Sub Id]
ELSEIF [Parameters].[D1 (copy 2)_1113233589196361731]  = 12 THEN [gender (copy)_2399292755830108162]
ELSEIF [Parameters].[D1 (copy 2)_1113233589196361731]  = 13 THEN [Creative]
ELSEIF [Parameters].[D1 (copy 2)_1113233589196361731]  = 14 THEN [CL Diagnosis Injury Tiers]
ELSEIF [Parameters].[D1 (copy 2)_1113233589196361731]  = 15 THEN [Calculation_935059914517495808]
ELSEIF [Parameters].[D1 (copy 2)_1113233589196361731]  = 16 THEN [Ad Name]
ELSEIF [Parameters].[D1 (copy 2)_1113233589196361731]  = 17 THEN [Adset Name]
ELSEIF [Parameters].[D1 (copy 2)_1113233589196361731]  = 18 THEN [campaign_id]
ELSEIF [Parameters].[D1 (copy 2)_1113233589196361731]  = 19 THEN [Labels]
ELSEIF [Parameters].[D1 (copy 2)_1113233589196361731]  = 20 THEN [Calculation_5872834692856524810]
ELSEIF [Parameters].[D1 (copy 2)_1113233589196361731]  = 21 THEN [State]
ELSEIF [Parameters].[D1 (copy 2)_1113233589196361731]  = 22 THEN [Phone]
// ELSEIF [Parameters].[D2] = 23 THEN [Tier]
ELSEIF [Parameters].[D1 (copy 2)_1113233589196361731]  = 23 THEN [Calculation_1277614987429064704]
ELSEIF [Parameters].[D1 (copy 2)_1113233589196361731]  = 25 THEN [Result Type]
ELSEIF [Parameters].[D1 (copy 2)_1113233589196361731]  = 26 THEN [placement]
ELSEIF [Parameters].[D1 (copy 2)_1113233589196361731]  = 27 THEN [Calculation_7690318609259716608]
ELSEIF [Parameters].[D1 (copy 2)_1113233589196361731]  = 28 THEN [label]
ELSEIF [Parameters].[D1 (copy 2)_1113233589196361731]  = 29 THEN STR([Calculation_1880252886088871936])
ELSEIF [Parameters].[D1 (copy 2)_1113233589196361731]  = 30 THEN [clientname]
ELSEIF [Parameters].[D1 (copy 2)_1113233589196361731]  = 31 THEN [page_path]
ELSEIF [Parameters].[D1 (copy 2)_1113233589196361731]  = 32 THEN [sgmt]
ELSEIF [Parameters].[D1 (copy 2)_1113233589196361731]  = 33 THEN [ctcphone]
ELSEIF [Parameters].[D1 (copy 2)_1113233589196361731]  = 34 THEN [Calculation_3435894714053935109]
ELSEIF [Parameters].[D1 (copy 2)_1113233589196361731]  = 35 THEN [ltdinoworkmedicalconditions]
ELSEIF [Parameters].[D1 (copy 2)_1113233589196361731]  = 36 THEN [ds_qualstatus]
ELSEIF [Parameters].[D1 (copy 2)_1113233589196361731]  = 37 THEN [ad_id]
ELSEIF [Parameters].[D1 (copy 2)_1113233589196361731]  = 38 THEN [adset_id]
ELSEIF [Parameters].[D1 (copy 2)_1113233589196361731]  = 39 THEN [Calculation_1113233589182521344]
ELSEIF [Parameters].[D1 (copy 2)_1113233589196361731]  = 40 THEN [Calculation_1880252886125215747]
ELSEIF [Parameters].[D1 (copy 2)_1113233589196361731]  = 41 THEN [SubSegment]
ELSEIF [Parameters].[D1 (copy 2)_1113233589196361731] = 42 THEN STR([Calculation_1133007210553765896])
ELSEIF [Parameters].[D1 (copy 2)_1113233589196361731] = 43 THEN [Calculation_7573084309404708864]
ELSEIF [Parameters].[D1 (copy 2)_1113233589196361731] = 44 THEN [Calculation_4531465651676438530]
ELSEIF [Parameters].[D1 (copy 2)_1113233589196361731] = 45 THEN IF LEN(STR([appearance_l30d])) < 2 AND NOT ISNULL(STR([appearance_l30d])) THEN '0' + STR([appearance_l30d]) ELSE STR([appearance_l30d]) END
ELSEIF [Parameters].[D1 (copy 2)_1113233589196361731] = 46 THEN IF LEN(STR([appearance_l60d])) < 2 AND NOT ISNULL(STR([appearance_l60d])) THEN '0' + STR([appearance_l60d]) ELSE STR([appearance_l60d]) END
ELSEIF [Parameters].[D1 (copy 2)_1113233589196361731] = 47 THEN IF LEN(STR([appearance_l90d])) < 2 AND NOT ISNULL(STR([appearance_l90d])) THEN '0' + STR([appearance_l90d]) ELSE STR([appearance_l90d]) END
ELSEIF [Parameters].[D1 (copy 2)_1113233589196361731] = 48 THEN [ATA Work]
ELSEIF [Parameters].[D1 (copy 2)_1113233589196361731] = 49 THEN [Calculation_499055157754740737]
ELSEIF [Parameters].[D1 (copy 2)_1113233589196361731] = 50 THEN IF LEN(STR([CIIC Appearance in L30D])) < 2 AND NOT ISNULL(STR([CIIC Appearance in L30D])) THEN '0' + STR([CIIC Appearance in L30D]) ELSE STR([CIIC Appearance in L30D]) END
ELSEIF [Parameters].[D1 (copy 2)_1113233589196361731] = 51 THEN IF LEN(STR([CIIC Appearance in L60D])) < 2 AND NOT ISNULL(STR([CIIC Appearance in L60D])) THEN '0' + STR([CIIC Appearance in L60D]) ELSE STR([CIIC Appearance in L60D]) END
ELSEIF [Parameters].[D1 (copy 2)_1113233589196361731] = 52 THEN IF LEN(STR([CIIC Appearance in L90D])) < 2 AND NOT ISNULL(STR([CIIC Appearance in L90D])) THEN '0' + STR([CIIC Appearance in L90D]) ELSE STR([CIIC Appearance in L90D]) END
ELSEIF [Parameters].[D1 (copy 2)_1113233589196361731] = 53 THEN STR([Calculation_989947527401095169])
ELSEIF [Parameters].[D1 (copy 2)_1113233589196361731] = 54 THEN [Calculation_1460573688699854848]
ELSEIF [Parameters].[D1 (copy 2)_1113233589196361731] = 55 THEN [Calculation_1006061976934187009]
ELSE 'Agg'
END",
    "name": "[D1 (copy)_6374000853573341191]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "D4",
    "datatype": "string",
    "formula": "IF [Parameters].[D1 (copy)_1113233589196333057] = 1 THEN [Calculation_6374000853566275585]
ELSEIF [Parameters].[D1 (copy)_1113233589196333057] = 2 THEN [bla_carrierdata_type]
ELSEIF [Parameters].[D1 (copy)_1113233589196333057] = 3 THEN [Calculation_6374000853565702144]
ELSEIF [Parameters].[D1 (copy)_1113233589196333057] = 4 THEN [Phone Carrier]
ELSEIF [Parameters].[D1 (copy)_1113233589196333057] = 5 THEN [CZ Project Name]
ELSEIF [Parameters].[D1 (copy)_1113233589196333057] = 6 THEN [Phone Type]
ELSEIF [Parameters].[D1 (copy)_1113233589196333057] = 7 THEN [normalized carrier]
ELSEIF [Parameters].[D1 (copy)_1113233589196333057] = 8 THEN [Outcome]
ELSEIF [Parameters].[D1 (copy)_1113233589196333057] = 9 THEN [qual_status]
ELSEIF [Parameters].[D1 (copy)_1113233589196333057] = 10 THEN [Source]
ELSEIF [Parameters].[D1 (copy)_1113233589196333057] = 11 THEN [Sub Id]
ELSEIF [Parameters].[D1 (copy)_1113233589196333057] = 12 THEN [gender (copy)_2399292755830108162]
ELSEIF [Parameters].[D1 (copy)_1113233589196333057] = 13 THEN [Creative]
ELSEIF [Parameters].[D1 (copy)_1113233589196333057] = 14 THEN [CL Diagnosis Injury Tiers]
ELSEIF [Parameters].[D1 (copy)_1113233589196333057] = 15 THEN [Calculation_935059914517495808]
ELSEIF [Parameters].[D1 (copy)_1113233589196333057] = 16 THEN [Ad Name]
ELSEIF [Parameters].[D1 (copy)_1113233589196333057] = 17 THEN [Adset Name]
ELSEIF [Parameters].[D1 (copy)_1113233589196333057] = 18 THEN [campaign_id]
ELSEIF [Parameters].[D1 (copy)_1113233589196333057] = 19 THEN [Labels]
ELSEIF [Parameters].[D1 (copy)_1113233589196333057] = 20 THEN [Calculation_5872834692856524810]
ELSEIF [Parameters].[D1 (copy)_1113233589196333057] = 21 THEN [State]
ELSEIF [Parameters].[D1 (copy)_1113233589196333057] = 22 THEN [Phone]
// ELSEIF [Parameters].[D4] = 23 THEN [Tier]
ELSEIF [Parameters].[D1 (copy)_1113233589196333057] = 23 THEN [Calculation_1277614987429064704]
ELSEIF [Parameters].[D1 (copy)_1113233589196333057] = 25 THEN [Result Type]
ELSEIF [Parameters].[D1 (copy)_1113233589196333057] = 26 THEN [placement]
ELSEIF [Parameters].[D1 (copy)_1113233589196333057] = 27 THEN [Calculation_7690318609259716608]
ELSEIF [Parameters].[D1 (copy)_1113233589196333057] = 28 THEN [label]
ELSEIF [Parameters].[D1 (copy)_1113233589196333057] = 29 THEN STR([Calculation_1880252886088871936])
ELSEIF [Parameters].[D1 (copy)_1113233589196333057] = 30 THEN [clientname]
ELSEIF [Parameters].[D1 (copy)_1113233589196333057] = 31 THEN [page_path]
ELSEIF [Parameters].[D1 (copy)_1113233589196333057] = 32 THEN [sgmt]
ELSEIF [Parameters].[D1 (copy)_1113233589196333057] = 33 THEN [ctcphone]
ELSEIF [Parameters].[D1 (copy)_1113233589196333057] = 34 THEN [Calculation_3435894714053935109]
ELSEIF [Parameters].[D1 (copy)_1113233589196333057] = 35 THEN [ltdinoworkmedicalconditions]
ELSEIF [Parameters].[D1 (copy)_1113233589196333057] = 36 THEN [ds_qualstatus]
ELSEIF [Parameters].[D1 (copy)_1113233589196333057] = 37 THEN [ad_id]
ELSEIF [Parameters].[D1 (copy)_1113233589196333057] = 38 THEN [adset_id]
ELSEIF [Parameters].[D1 (copy)_1113233589196333057] = 39 THEN [Calculation_1113233589182521344]
ELSEIF [Parameters].[D1 (copy)_1113233589196333057] = 40 THEN [Calculation_1880252886125215747]
ELSEIF [Parameters].[D1 (copy)_1113233589196333057] = 41 THEN [SubSegment]
ELSEIF [Parameters].[D1 (copy)_1113233589196333057] = 42 THEN STR([Calculation_1133007210553765896])
ELSEIF [Parameters].[D1 (copy)_1113233589196333057] = 43 THEN [Calculation_7573084309404708864]
ELSEIF [Parameters].[D1 (copy)_1113233589196333057] = 44 THEN [Calculation_4531465651676438530]
ELSEIF [Parameters].[D1 (copy)_1113233589196333057] = 45 THEN IF LEN(STR([appearance_l30d])) < 2 AND NOT ISNULL(STR([appearance_l30d])) THEN '0' + STR([appearance_l30d]) ELSE STR([appearance_l30d]) END
ELSEIF [Parameters].[D1 (copy)_1113233589196333057] = 46 THEN IF LEN(STR([appearance_l60d])) < 2 AND NOT ISNULL(STR([appearance_l60d])) THEN '0' + STR([appearance_l60d]) ELSE STR([appearance_l60d]) END
ELSEIF [Parameters].[D1 (copy)_1113233589196333057] = 47 THEN IF LEN(STR([appearance_l90d])) < 2 AND NOT ISNULL(STR([appearance_l90d])) THEN '0' + STR([appearance_l90d]) ELSE STR([appearance_l90d]) END
ELSEIF [Parameters].[D1 (copy)_1113233589196333057] = 48 THEN [ATA Work]
ELSEIF [Parameters].[D1 (copy)_1113233589196333057] = 49 THEN [Calculation_499055157754740737]
ELSEIF [Parameters].[D1 (copy)_1113233589196333057] = 50 THEN IF LEN(STR([CIIC Appearance in L30D])) < 2 AND NOT ISNULL(STR([CIIC Appearance in L30D])) THEN '0' + STR([CIIC Appearance in L30D]) ELSE STR([CIIC Appearance in L30D]) END
ELSEIF [Parameters].[D1 (copy)_1113233589196333057] = 51 THEN IF LEN(STR([CIIC Appearance in L60D])) < 2 AND NOT ISNULL(STR([CIIC Appearance in L60D])) THEN '0' + STR([CIIC Appearance in L60D]) ELSE STR([CIIC Appearance in L60D]) END
ELSEIF [Parameters].[D1 (copy)_1113233589196333057] = 52 THEN IF LEN(STR([CIIC Appearance in L90D])) < 2 AND NOT ISNULL(STR([CIIC Appearance in L90D])) THEN '0' + STR([CIIC Appearance in L90D]) ELSE STR([CIIC Appearance in L90D]) END
ELSEIF [Parameters].[D1 (copy)_1113233589196333057] = 53 THEN STR([Calculation_989947527401095169])
ELSEIF [Parameters].[D1 (copy)_1113233589196333057] = 54 THEN [Calculation_1460573688699854848]
ELSEIF [Parameters].[D1 (copy)_1113233589196333057] = 55 THEN [Calculation_1006061976934187009]
ELSE 'Agg'
END",
    "name": "[D3 (copy)_6208563937532035081]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "D5",
    "datatype": "string",
    "formula": "IF [Parameters].[D1 (copy) (copy)_1113233589196361730] = 1 THEN [Calculation_6374000853566275585]
ELSEIF [Parameters].[D1 (copy) (copy)_1113233589196361730] = 2 THEN [bla_carrierdata_type]
ELSEIF [Parameters].[D1 (copy) (copy)_1113233589196361730] = 3 THEN [Calculation_6374000853565702144]
ELSEIF [Parameters].[D1 (copy) (copy)_1113233589196361730] = 4 THEN [Phone Carrier]
ELSEIF [Parameters].[D1 (copy) (copy)_1113233589196361730] = 5 THEN [CZ Project Name]
ELSEIF [Parameters].[D1 (copy) (copy)_1113233589196361730] = 6 THEN [Phone Type]
ELSEIF [Parameters].[D1 (copy) (copy)_1113233589196361730] = 7 THEN [normalized carrier]
ELSEIF [Parameters].[D1 (copy) (copy)_1113233589196361730] = 8 THEN [Outcome]
ELSEIF [Parameters].[D1 (copy) (copy)_1113233589196361730] = 9 THEN [qual_status]
ELSEIF [Parameters].[D1 (copy) (copy)_1113233589196361730] = 10 THEN [Source]
ELSEIF [Parameters].[D1 (copy) (copy)_1113233589196361730] = 11 THEN [Sub Id]
ELSEIF [Parameters].[D1 (copy) (copy)_1113233589196361730] = 12 THEN [gender (copy)_2399292755830108162]
ELSEIF [Parameters].[D1 (copy) (copy)_1113233589196361730] = 13 THEN [Creative]
ELSEIF [Parameters].[D1 (copy) (copy)_1113233589196361730] = 14 THEN [CL Diagnosis Injury Tiers]
ELSEIF [Parameters].[D1 (copy) (copy)_1113233589196361730] = 15 THEN [Calculation_935059914517495808]
ELSEIF [Parameters].[D1 (copy) (copy)_1113233589196361730] = 16 THEN [Ad Name]
ELSEIF [Parameters].[D1 (copy) (copy)_1113233589196361730] = 17 THEN [Adset Name]
ELSEIF [Parameters].[D1 (copy) (copy)_1113233589196361730] = 18 THEN [campaign_id]
ELSEIF [Parameters].[D1 (copy) (copy)_1113233589196361730] = 19 THEN [Labels]
ELSEIF [Parameters].[D1 (copy) (copy)_1113233589196361730] = 20 THEN [Calculation_5872834692856524810]
ELSEIF [Parameters].[D1 (copy) (copy)_1113233589196361730] = 21 THEN [State]
ELSEIF [Parameters].[D1 (copy) (copy)_1113233589196361730] = 22 THEN [Phone]
// ELSEIF [Parameters].[D5] = 23 THEN [Tier]
ELSEIF [Parameters].[D1 (copy) (copy)_1113233589196361730] = 23 THEN [Calculation_1277614987429064704]
ELSEIF [Parameters].[D1 (copy) (copy)_1113233589196361730] = 25 THEN [Result Type]
ELSEIF [Parameters].[D1 (copy) (copy)_1113233589196361730] = 26 THEN [placement]
ELSEIF [Parameters].[D1 (copy) (copy)_1113233589196361730] = 27 THEN [Calculation_7690318609259716608]
ELSEIF [Parameters].[D1 (copy) (copy)_1113233589196361730] = 28 THEN [label]
ELSEIF [Parameters].[D1 (copy) (copy)_1113233589196361730] = 29 THEN STR([Calculation_1880252886088871936])
ELSEIF [Parameters].[D1 (copy) (copy)_1113233589196361730] = 30 THEN [clientname]
ELSEIF [Parameters].[D1 (copy) (copy)_1113233589196361730] = 31 THEN [page_path]
ELSEIF [Parameters].[D1 (copy) (copy)_1113233589196361730] = 32 THEN [sgmt]
ELSEIF [Parameters].[D1 (copy) (copy)_1113233589196361730] = 33 THEN [ctcphone]
ELSEIF [Parameters].[D1 (copy) (copy)_1113233589196361730] = 34 THEN [Calculation_3435894714053935109]
ELSEIF [Parameters].[D1 (copy) (copy)_1113233589196361730] = 35 THEN [ltdinoworkmedicalconditions]
ELSEIF [Parameters].[D1 (copy) (copy)_1113233589196361730] = 36 THEN [ds_qualstatus]
ELSEIF [Parameters].[D1 (copy) (copy)_1113233589196361730] = 37 THEN [ad_id]
ELSEIF [Parameters].[D1 (copy) (copy)_1113233589196361730] = 38 THEN [adset_id]
ELSEIF [Parameters].[D1 (copy) (copy)_1113233589196361730] = 39 THEN [Calculation_1113233589182521344]
ELSEIF [Parameters].[D1 (copy) (copy)_1113233589196361730] = 40 THEN [Calculation_1880252886125215747]
ELSEIF [Parameters].[D1 (copy) (copy)_1113233589196361730] = 41 THEN [SubSegment]
ELSEIF [Parameters].[D1 (copy) (copy)_1113233589196361730] = 42 THEN STR([Calculation_1133007210553765896])
ELSEIF [Parameters].[D1 (copy) (copy)_1113233589196361730] = 43 THEN [Calculation_7573084309404708864]
ELSEIF [Parameters].[D1 (copy) (copy)_1113233589196361730] = 44 THEN [Calculation_4531465651676438530]
ELSEIF [Parameters].[D1 (copy) (copy)_1113233589196361730] = 45 THEN IF LEN(STR([appearance_l30d])) < 2 AND NOT ISNULL(STR([appearance_l30d])) THEN '0' + STR([appearance_l30d]) ELSE STR([appearance_l30d]) END
ELSEIF [Parameters].[D1 (copy) (copy)_1113233589196361730] = 46 THEN IF LEN(STR([appearance_l60d])) < 2 AND NOT ISNULL(STR([appearance_l60d])) THEN '0' + STR([appearance_l60d]) ELSE STR([appearance_l60d]) END
ELSEIF [Parameters].[D1 (copy) (copy)_1113233589196361730] = 47 THEN IF LEN(STR([appearance_l90d])) < 2 AND NOT ISNULL(STR([appearance_l90d])) THEN '0' + STR([appearance_l90d]) ELSE STR([appearance_l90d]) END
ELSEIF [Parameters].[D1 (copy) (copy)_1113233589196361730] = 48 THEN [ATA Work]
ELSEIF [Parameters].[D1 (copy) (copy)_1113233589196361730] = 49 THEN [Calculation_499055157754740737]
ELSEIF [Parameters].[D1 (copy) (copy)_1113233589196361730] = 50 THEN IF LEN(STR([CIIC Appearance in L30D])) < 2 AND NOT ISNULL(STR([CIIC Appearance in L30D])) THEN '0' + STR([CIIC Appearance in L30D]) ELSE STR([CIIC Appearance in L30D]) END
ELSEIF [Parameters].[D1 (copy) (copy)_1113233589196361730] = 51 THEN IF LEN(STR([CIIC Appearance in L60D])) < 2 AND NOT ISNULL(STR([CIIC Appearance in L60D])) THEN '0' + STR([CIIC Appearance in L60D]) ELSE STR([CIIC Appearance in L60D]) END
ELSEIF [Parameters].[D1 (copy) (copy)_1113233589196361730] = 52 THEN IF LEN(STR([CIIC Appearance in L90D])) < 2 AND NOT ISNULL(STR([CIIC Appearance in L90D])) THEN '0' + STR([CIIC Appearance in L90D]) ELSE STR([CIIC Appearance in L90D]) END
ELSEIF [Parameters].[D1 (copy) (copy)_1113233589196361730] = 53 THEN STR([Calculation_989947527401095169])
ELSEIF [Parameters].[D1 (copy) (copy)_1113233589196361730] = 54 THEN [Calculation_1460573688699854848]
ELSEIF [Parameters].[D1 (copy) (copy)_1113233589196361730] = 55 THEN [Calculation_1006061976934187009]
ELSE 'Agg'
END",
    "name": "[D4 (copy)_6208563937532350475]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Gender",
    "datatype": "string",
    "formula": "//Updated Date: 18 May 2022
//Updated By: Manish
//Description: Converting gnder values to upper case

UPPER([Gender])",
    "name": "[gender (copy)_2399292755830108162]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Helper Date",
    "datatype": "string",
    "formula": ""default"",
    "name": "[Parameter 11]",
    "role": "measure",
    "type": "nominal",
  },
  {
    "caption": "User Identifier",
    "datatype": "integer",
    "formula": "0",
    "name": "[Parameter 12]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Date Bucket",
    "datatype": "string",
    "formula": ""day"",
    "name": "[Parameter 1]",
    "role": "measure",
    "type": "nominal",
  },
  {
    "caption": "Start Date",
    "datatype": "date",
    "formula": "#2025-07-30#",
    "name": "[Parameter 5]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "End Date",
    "datatype": "date",
    "formula": "#2025-08-27#",
    "name": "[Parameter 6]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "TTW Grade",
    "datatype": "string",
    "formula": "IF [ttw_qualstatus] = 'ttw-qualified' then 'Grade A'
ELSEIF  [ttw_qualstatus] = 'ttw-nonqualified' and [TTW Explore Work Form] = 'yes' THEN 'Grade B'
ELSEIF [ttw_qualstatus] = 'ttw-nonqualified' and [TTW Explore Work Form] != 'yes' THEN 'Grade C'
ELSEIF ISNULL([ttw_qualstatus]) and [Stage3 Response] = 'Between 2 and 4 years' then 'Grade D'
ELSE 'Rest'
END",
    "name": "[Calculation_1006061976934187009]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Hour of Day",
    "datatype": "string",
    "formula": "IF LEN(STR(DATEPART('hour', [Calculation_1916563181826678784]))) = 1
THEN "0" + STR(DATEPART('hour', [Calculation_1916563181826678784]))
ELSE STR(DATEPART('hour', [Calculation_1916563181826678784]))
END",
    "name": "[Calculation_1113233589182521344]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "20hrs Disqual",
    "datatype": "integer",
    "formula": "IF [Stage6 Response] = "More than 20 hours per week" THEN 1 ELSE 0 END",
    "name": "[Calculation_1133007210546622464]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Age Disqual",
    "datatype": "integer",
    "formula": "IF INT([Age]) < 40 OR INT([Age]) > 62 THEN 1 ELSE 0 END",
    "name": "[Calculation_1133007210553298946]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Attorney Disqual",
    "datatype": "integer",
    "formula": "IF [Stage5 Response] = "Yes" THEN 1 ELSE 0 END",
    "name": "[Calculation_1133007210553425923]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Ben Disqual",
    "datatype": "integer",
    "formula": "IF IFNULL([Stage1 Response], "") != "I am not receiving any disability benefits (SSD or SSI)"
THEN 1 ELSE 0 END",
    "name": "[Calculation_1133007210553487364]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Doctor Visit Disqual",
    "datatype": "integer",
    "formula": "IF [Stage4 Response] = "No" THEN 1 ELSE 0 END",
    "name": "[Calculation_1133007210553540613]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Five Year Work Disqual",
    "datatype": "integer",
    "formula": "IF [Stage3 Response] = "Less than 2 years"
OR [Stage3 Response] = "Between 2 and 4 years"
THEN 1 ELSE 0 END",
    "name": "[Calculation_1133007210553618438]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Out of Work Disqual",
    "datatype": "integer",
    "formula": "IF [Stage2 Response] = "No" THEN 1 ELSE 0 END",
    "name": "[Calculation_1133007210553663495]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "# of Disqual",
    "datatype": "integer",
    "formula": "ZN([Calculation_1133007210553487364]) +
ZN([Calculation_1133007210553663495]) +
ZN([Calculation_1133007210553618438]) +
ZN([Calculation_1133007210553540613]) +
ZN([Calculation_1133007210553425923]) +
ZN([Calculation_1133007210546622464]) +
ZN([Calculation_1133007210553298946])",
    "name": "[Calculation_1133007210553765896]",
    "role": "dimension",
    "type": "ordinal",
  },
  {
    "caption": "Levine States ",
    "datatype": "string",
    "formula": "IF ISNULL([Levine States]) THEN 'Other'
ELSE [Levine States] END",
    "name": "[Calculation_1277614987429064704]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "DP Leak",
    "datatype": "string",
    "formula": "IF CONTAINS([clientname], 'disabilitypath')
AND [Calculation_7573084309404708864] in ('Grade A', 'Grade B')
THEN 'Yes'
ELSE 'No'
END",
    "name": "[Calculation_1460573688699854848]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Unresolved SSA Leads",
    "datatype": "string",
    "formula": "IF { FIXED [Phone] : MAX([Resolved Lead]) } = 0 THEN "SSA Unresolved Lead"
ELSEIF { FIXED [Phone] : MAX([Resolved Lead]) } = 1 THEN "SSA Resolved Lead"
END",
    "name": "[Calculation_1467962419029331969]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "CTC Lead Flag",
    "datatype": "string",
    "formula": "if [CTC Lead] = 1 then "Yes" else "No" END",
    "name": "[Calculation_1880252886088871936]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "CZ Post Hour Group",
    "datatype": "string",
    "formula": "IF DATEPART('hour', [Post Date]) >= 0 AND DATEPART('hour', [Post Date]) < 6 THEN 'Pre CC Hours'
ELSEIF DATEPART('hour', [Post Date]) >= 6 AND DATEPART('hour', [Post Date]) < 16 THEN 'CC Hours'
ELSEIF DATEPART('hour', [Post Date]) >= 16 AND DATEPART('hour', [Post Date]) < 24 THEN 'Post CC Hours'
END",
    "name": "[Calculation_1880252886125215747]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Post Date ",
    "datatype": "datetime",
    "formula": "//Updated Date: 18 May 2022
//Updated By: Manish
//Description: Formula to calculate UTC date

DATEADD("hour",0,[Post Date])",
    "name": "[Calculation_1916563181826678784]",
    "role": "dimension",
    "type": "ordinal",
  },
  {
    "caption": "Data Updated On",
    "datatype": "datetime",
    "formula": "{fixed :max([Post Date])}",
    "name": "[Calculation_2010857255412854784]",
    "role": "dimension",
    "type": "ordinal",
  },
  {
    "caption": "ATTR({ EXCLUDE [Buyer]:[Posted #]})",
    "datatype": "integer",
    "formula": "ATTR({ EXCLUDE [clientname]:[Calculation_99712551082803223]})",
    "name": "[Calculation_3435894714052657156]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Lead Sell Type",
    "datatype": "string",
    "formula": "if contains([Transfer Info Label],'CXER') then 'Sold: Call' 
elseif 
contains([sgmt],'ql-leadbuy') or 
contains([ATA Work],'ql-leadbuy')
then 'Sold: Lead'
else 'Internal'
end",
    "name": "[Calculation_3435894714053935109]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Seg4 Control vs. Treatment",
    "datatype": "string",
    "formula": "IF [CZ Project Name] = "Mass Tort - High Intent SSDI" AND [Calculation_1880252886088871936] = "No" AND [qual_status] != "all-steps" THEN
    IF INT(RIGHT([phone masked], 3)) % 2 = 0 THEN "Control"
    ELSEIF INT(RIGHT([phone masked], 3)) % 2 != 0 THEN "Treatment"
    END
END",
    "name": "[Calculation_4531465651676315649]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Seg4 Cohort",
    "datatype": "string",
    "formula": "LOWER(IFNULL([seg4_cohort], [Calculation_4531465651676315649]))",
    "name": "[Calculation_4531465651676438530]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Time to Call (Minute)",
    "datatype": "real",
    "formula": "IF [Calculation_1880252886088871936] = 'Yes'
THEN ROUND(([CTC Time] - [Post Date]) * 24 * 60, 2)
END",
    "name": "[Calculation_499055157752631296]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Time to Call Bucket",
    "datatype": "string",
    "formula": "IF  [Calculation_499055157752631296] < 0
THEN '<0 Mins'
ELSEIF [Calculation_499055157752631296] <= 2 AND [Calculation_499055157752631296] >= 0
THEN '0-2 Mins'
ELSEIF [Calculation_499055157752631296] <= 5 AND [Calculation_499055157752631296] > 0
THEN '2-5 Mins'
ELSEIF [Calculation_499055157752631296] <= 10 AND [Calculation_499055157752631296] > 0
THEN '5-10 Mins'
ELSEIF [Calculation_499055157752631296] <= 30 AND [Calculation_499055157752631296] > 0 
THEN '10-30 Mins'
ELSEIF [Calculation_499055157752631296] <= 60 AND [Calculation_499055157752631296] > 0
THEN '30Mins-1 Hour'
ELSEIF [Calculation_499055157752631296] <= 300 AND [Calculation_499055157752631296] > 0
THEN '1-5 Hours'
ELSEIF [Calculation_499055157752631296] <= 600 AND [Calculation_499055157752631296] > 0
THEN '5-10 Hours'
ELSEIF [Calculation_499055157752631296] <= 1440 AND [Calculation_499055157752631296] > 0
THEN '10-24 Hours'
ELSEIF [Calculation_499055157752631296] <= 4320 AND [Calculation_499055157752631296] > 0
THEN '24-72 Hours'
ELSEIF [Calculation_499055157752631296] > 4320 AND [Calculation_499055157752631296] > 0
THEN '>72 Hours'
END",
    "name": "[Calculation_499055157754740737]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Project Type",
    "datatype": "string",
    "formula": "IF CONTAINS([CZ Project Name],'Aged') THEN 'Aged'
ELSE 'Live' END",
    "name": "[Calculation_5872834692856524810]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Grade",
    "datatype": "string",
    "formula": "// Grade A
IF [qual_status] = 'all-steps' THEN 'Grade A'

// Grade B
ELSEIF 
    [qual_status] IN ('fiveyrwrk-disqual','outofwrk-disqual','doc-disqual')
    AND [Calculation_1133007210553765896] = 1
THEN 'Grade B'

// Grade C
ELSEIF 
    [qual_status] <> 'age-disqual'
    AND NOT [Stage3 Response] IN ('Less than 2 years', 'Between 2 and 4 years')
    AND [Stage1 Response] <> 'Social Security Disability (SSD) Benefits'
    AND [Stage6 Response] = 'Not working'
THEN 'Grade C'

// Grade D
ELSEIF 
    // 1) Not age-disqual, Stage3 NOT in those two, Stage1 not SSD, Stage6 ≠ Not working, disqual ≤ 1
    (
      [qual_status] <> 'age-disqual'
      AND NOT [Stage3 Response] IN ('Less than 2 years', 'Between 2 and 4 years')
      AND [Stage1 Response] <> 'Social Security Disability (SSD) Benefits'
      AND [Stage6 Response] <> 'Not working'
      AND [Calculation_1133007210553765896] <= 1
    )
    // 2) Not age-disqual, Stage3 in those two, Qual Status = outofwrk-disqual
    OR
    (
      [qual_status] <> 'age-disqual'
      AND [Stage3 Response] IN ('Less than 2 years', 'Between 2 and 4 years')
      AND [qual_status] = 'outofwrk-disqual'
    )
    // 3) Not age-disqual, Stage3 in those two, Qual Status ≠ outofwrk-disqual, Stage7 = Yes
    OR
    (
      [qual_status] <> 'age-disqual'
      AND [Stage3 Response] IN ('Less than 2 years', 'Between 2 and 4 years')
      AND [qual_status] <> 'outofwrk-disqual'
      AND [Stage7 Response] = 'Yes'
    )
THEN 'Grade D'

// Rest (including age-disqual or anything else)
ELSE 'Rest'
END",
    "name": "[Calculation_7573084309404708864]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Today-28",
    "datatype": "date",
    "formula": "//Updated Date: 18 May 2022
//Updated By: Manish
//Description: Going back 28 days from today

({MAX(today()-28)})",
    "name": "[Calculation_767300790172184597]",
    "role": "dimension",
    "type": "ordinal",
  },
  {
    "caption": "SSD Age Range",
    "datatype": "string",
    "formula": "IF DATE([Calculation_1916563181826678784]) >= #18/08/2025#
THEN
    IF INT([Age]) < 40 THEN "U40"
    ELSEIF INT([Age]) >= 40 AND INT([Age]) <= 49 THEN "40 - 49"
	ELSEIF INT([Age]) >= 50 AND INT([Age]) <= 54 THEN "50 - 54"
    ELSEIF INT([Age]) >= 55 AND INT([Age]) <= 63 THEN "55 - 63"
    ELSEIF INT([Age]) >= 64 THEN "O64+"
    END
ELSEIF INT([Age]) < 40 THEN "*U40"
ELSEIF INT([Age]) >= 40 AND INT([Age]) <= 48 THEN "*40-48"
ELSEIF INT([Age]) = 49 THEN "*49"
ELSEIF INT([Age]) >= 50 AND INT([Age]) <= 62 THEN "*50-62"
ELSEIF INT([Age]) >= 63 THEN "*O63+" 
END",
    "name": "[Calculation_7690318609259716608]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Date Filter",
    "datatype": "boolean",
    "formula": "//Updated Date: 18 May 2022
//Updated By: Manish
//Description: Filtering data based on date

IF [Parameters].[Parameter 11] = 'default'
THEN [Date]>=[Parameters].[Parameter 5] AND [Date]<=[Parameters].[Parameter 6]
ELSEIF [Parameters].[Parameter 11] = 'weekly'
THEN [Date] >= TODAY()-8 AND [Date] <= TODAY()-1
END",
    "name": "[Calculation_843580506575679492]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Dial R",
    "datatype": "string",
    "formula": "IF  [Called Count] < 4 then "<=3" 
elseif [Called Count] < 8 then "4-7"
elseif [Called Count] < 11 then "8-10"
elseif [Called Count] < 16 then "11-15"
elseif [Called Count] < 20 then "16-19"
elseif [Called Count] < 26 then "20-25"
elseif [Called Count] < 31 then "25-30"
elseif [Called Count] < 36 then "30-35"
else "35+" 
END",
    "name": "[Calculation_847802666706034688]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Dial R (detail)",
    "datatype": "string",
    "formula": "STR([Called Count])",
    "name": "[Calculation_847802666706186241]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Max Date",
    "datatype": "date",
    "formula": "//Updated Date: 18 May 2022
//Updated By: Manish
//Description: Calculating max of todays date for including it in the default values of end date

{MAX(today())}",
    "name": "[Calculation_882424053213511680]",
    "role": "dimension",
    "type": "ordinal",
  },
  {
    "caption": "User Identifier",
    "datatype": "string",
    "formula": "IF [Parameters].[Parameter 12] = 0 THEN [User Id]
ELSEIF [Parameters].[Parameter 12] = 1 THEN [Phone]
END",
    "name": "[Calculation_906349454594166784]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Alt. Branding",
    "datatype": "string",
    "formula": "If int(Right([Phone],2))<30 and [Calculation_5872834692856524810]= 'Live' then 'Yes' else 'No' End",
    "name": "[Calculation_935059914517495808]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Duplicate Rejects",
    "datatype": "string",
    "formula": "if [Outcome]='rejected' and { FIXED [Phone], [Outcome]: COUNTD([User Id])}>1 then 'Yes' else 'No' end",
    "name": "[Calculation_943222690415542272]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Post Date  ",
    "datatype": "string",
    "formula": "//Updated Date: 18 May 2022
//Updated By: Manish
//Description: Calculation to apply date bucket

CASE [Parameters].[Parameter 1]
WHEN 'year' THEN str(datepart('year', [Calculation_1916563181826678784]))
WHEN 'quarter' THEN "Q" + str(datepart('quarter', [Calculation_1916563181826678784])) + " " + str(datepart('year', [Calculation_1916563181826678784]))
WHEN 'month' THEN str(datepart('month', [Calculation_1916563181826678784])) + "-" + str(datepart('year', [Calculation_1916563181826678784]))
WHEN 'day' THEN str(DATENAME('month', [Calculation_1916563181826678784]))+ "-" +str(datepart('day', [Calculation_1916563181826678784]))+ "-" + str(datepart('year', [Calculation_1916563181826678784]))
WHEN 'week' THEN "W" + str(datepart('week', [Calculation_1916563181826678784])) + "-" + str(datepart('year', [Calculation_1916563181826678784]))
WHEN "hour" THEN str(DATETRUNC('hour', [Calculation_1916563181826678784]))
WHEN "minute" THEN str(DATETRUNC('minute', [Calculation_1916563181826678784]))
END",
    "name": "[Calculation_97320012552925214]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Vici Post Delay (Days)",
    "datatype": "integer",
    "formula": "DATEDIFF('day', [Post Date], [Entry Time])",
    "name": "[Calculation_989947527401095169]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Posted #",
    "datatype": "integer",
    "formula": "//Updated Date: 18 May 2022
//Updated By: Manish
//Description: Calculating the sum of user id wrt to source

countd([Calculation_906349454594166784])",
    "name": "[Calculation_99712551082803223]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "State Exclusions",
    "datatype": "string",
    "formula": "[State]",
    "name": "[state (copy)_2399292755821703168]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "D2",
    "datatype": "integer",
    "formula": "0",
    "name": "[D1 (copy 2)_1113233589196361731]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "D3",
    "datatype": "integer",
    "formula": "0",
    "name": "[D1 (copy 3)_1113233589196374020]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "D5",
    "datatype": "integer",
    "formula": "0",
    "name": "[D1 (copy) (copy)_1113233589196361730]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "D4",
    "datatype": "integer",
    "formula": "0",
    "name": "[D1 (copy)_1113233589196333057]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "D1",
    "datatype": "integer",
    "formula": "0",
    "name": "[Parameter 10]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Helper Date",
    "datatype": "string",
    "formula": ""default"",
    "name": "[Parameter 11]",
    "role": "measure",
    "type": "nominal",
  },
  {
    "caption": "User Identifier",
    "datatype": "integer",
    "formula": "0",
    "name": "[Parameter 12]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Date Bucket",
    "datatype": "string",
    "formula": ""day"",
    "name": "[Parameter 1]",
    "role": "measure",
    "type": "nominal",
  },
  {
    "caption": "Start Date",
    "datatype": "date",
    "formula": "#2025-07-30#",
    "name": "[Parameter 5]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "End Date",
    "datatype": "date",
    "formula": "#2025-08-27#",
    "name": "[Parameter 6]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "CTC Leads %",
    "datatype": "real",
    "formula": "[Calculation_8421379501118734337]/[Calculation_99712551082803223]",
    "name": "[CTC # (copy)_1880252886120472578]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "TTW Grade",
    "datatype": "string",
    "formula": "IF [ttw_qualstatus] = 'ttw-qualified' then 'Grade A'
ELSEIF  [ttw_qualstatus] = 'ttw-nonqualified' and [TTW Explore Work Form] = 'yes' THEN 'Grade B'
ELSEIF [ttw_qualstatus] = 'ttw-nonqualified' and [TTW Explore Work Form] != 'yes' THEN 'Grade C'
ELSEIF ISNULL([ttw_qualstatus]) and [Stage3 Response] = 'Between 2 and 4 years' then 'Grade D'
ELSE 'Rest'
END",
    "name": "[Calculation_1006061976934187009]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Hour of Day",
    "datatype": "string",
    "formula": "IF LEN(STR(DATEPART('hour', [Calculation_1916563181826678784]))) = 1
THEN "0" + STR(DATEPART('hour', [Calculation_1916563181826678784]))
ELSE STR(DATEPART('hour', [Calculation_1916563181826678784]))
END",
    "name": "[Calculation_1113233589182521344]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "20hrs Disqual",
    "datatype": "integer",
    "formula": "IF [Stage6 Response] = "More than 20 hours per week" THEN 1 ELSE 0 END",
    "name": "[Calculation_1133007210546622464]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Age Disqual",
    "datatype": "integer",
    "formula": "IF INT([Age]) < 40 OR INT([Age]) > 62 THEN 1 ELSE 0 END",
    "name": "[Calculation_1133007210553298946]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Attorney Disqual",
    "datatype": "integer",
    "formula": "IF [Stage5 Response] = "Yes" THEN 1 ELSE 0 END",
    "name": "[Calculation_1133007210553425923]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Ben Disqual",
    "datatype": "integer",
    "formula": "IF IFNULL([Stage1 Response], "") != "I am not receiving any disability benefits (SSD or SSI)"
THEN 1 ELSE 0 END",
    "name": "[Calculation_1133007210553487364]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Doctor Visit Disqual",
    "datatype": "integer",
    "formula": "IF [Stage4 Response] = "No" THEN 1 ELSE 0 END",
    "name": "[Calculation_1133007210553540613]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Five Year Work Disqual",
    "datatype": "integer",
    "formula": "IF [Stage3 Response] = "Less than 2 years"
OR [Stage3 Response] = "Between 2 and 4 years"
THEN 1 ELSE 0 END",
    "name": "[Calculation_1133007210553618438]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Out of Work Disqual",
    "datatype": "integer",
    "formula": "IF [Stage2 Response] = "No" THEN 1 ELSE 0 END",
    "name": "[Calculation_1133007210553663495]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "# of Disqual",
    "datatype": "integer",
    "formula": "ZN([Calculation_1133007210553487364]) +
ZN([Calculation_1133007210553663495]) +
ZN([Calculation_1133007210553618438]) +
ZN([Calculation_1133007210553540613]) +
ZN([Calculation_1133007210553425923]) +
ZN([Calculation_1133007210546622464]) +
ZN([Calculation_1133007210553298946])",
    "name": "[Calculation_1133007210553765896]",
    "role": "dimension",
    "type": "ordinal",
  },
  {
    "caption": "Levine States ",
    "datatype": "string",
    "formula": "IF ISNULL([Levine States]) THEN 'Other'
ELSE [Levine States] END",
    "name": "[Calculation_1277614987429064704]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "DP Leak",
    "datatype": "string",
    "formula": "IF CONTAINS([clientname], 'disabilitypath')
AND [Calculation_7573084309404708864] in ('Grade A', 'Grade B')
THEN 'Yes'
ELSE 'No'
END",
    "name": "[Calculation_1460573688699854848]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Unresolved SSA Leads",
    "datatype": "string",
    "formula": "IF { FIXED [Phone] : MAX([Resolved Lead]) } = 0 THEN "SSA Unresolved Lead"
ELSEIF { FIXED [Phone] : MAX([Resolved Lead]) } = 1 THEN "SSA Resolved Lead"
END",
    "name": "[Calculation_1467962419029331969]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "CTC Lead Flag",
    "datatype": "string",
    "formula": "if [CTC Lead] = 1 then "Yes" else "No" END",
    "name": "[Calculation_1880252886088871936]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "CZ Post Hour Group",
    "datatype": "string",
    "formula": "IF DATEPART('hour', [Post Date]) >= 0 AND DATEPART('hour', [Post Date]) < 6 THEN 'Pre CC Hours'
ELSEIF DATEPART('hour', [Post Date]) >= 6 AND DATEPART('hour', [Post Date]) < 16 THEN 'CC Hours'
ELSEIF DATEPART('hour', [Post Date]) >= 16 AND DATEPART('hour', [Post Date]) < 24 THEN 'Post CC Hours'
END",
    "name": "[Calculation_1880252886125215747]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Post Date ",
    "datatype": "datetime",
    "formula": "//Updated Date: 18 May 2022
//Updated By: Manish
//Description: Formula to calculate UTC date

DATEADD("hour",0,[Post Date])",
    "name": "[Calculation_1916563181826678784]",
    "role": "dimension",
    "type": "ordinal",
  },
  {
    "caption": "PD Dimensions",
    "datatype": "string",
    "formula": "IFNULL(STR([Calculation_97320012552925214]),'')+
IFNULL([Calculation_6374000853571039236],'')+
IFNULL([D1 (copy)_6374000853573341191],'')+
IFNULL([D1 (copy) (copy)_6374000853573369864],'')+
IFNULL([D3 (copy)_6208563937532035081],'')+
IFNULL([D4 (copy)_6208563937532350475],'')",
    "name": "[Calculation_1999879738529857536]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Data Updated On",
    "datatype": "datetime",
    "formula": "{fixed :max([Post Date])}",
    "name": "[Calculation_2010857255412854784]",
    "role": "dimension",
    "type": "ordinal",
  },
  {
    "caption": "Lead Sell Type",
    "datatype": "string",
    "formula": "if contains([Transfer Info Label],'CXER') then 'Sold: Call' 
elseif 
contains([sgmt],'ql-leadbuy') or 
contains([ATA Work],'ql-leadbuy')
then 'Sold: Lead'
else 'Internal'
end",
    "name": "[Calculation_3435894714053935109]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Seg4 Control vs. Treatment",
    "datatype": "string",
    "formula": "IF [CZ Project Name] = "Mass Tort - High Intent SSDI" AND [Calculation_1880252886088871936] = "No" AND [qual_status] != "all-steps" THEN
    IF INT(RIGHT([phone masked], 3)) % 2 = 0 THEN "Control"
    ELSEIF INT(RIGHT([phone masked], 3)) % 2 != 0 THEN "Treatment"
    END
END",
    "name": "[Calculation_4531465651676315649]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Seg4 Cohort",
    "datatype": "string",
    "formula": "LOWER(IFNULL([seg4_cohort], [Calculation_4531465651676315649]))",
    "name": "[Calculation_4531465651676438530]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Time to Call (Minute)",
    "datatype": "real",
    "formula": "IF [Calculation_1880252886088871936] = 'Yes'
THEN ROUND(([CTC Time] - [Post Date]) * 24 * 60, 2)
END",
    "name": "[Calculation_499055157752631296]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Time to Call Bucket",
    "datatype": "string",
    "formula": "IF  [Calculation_499055157752631296] < 0
THEN '<0 Mins'
ELSEIF [Calculation_499055157752631296] <= 2 AND [Calculation_499055157752631296] >= 0
THEN '0-2 Mins'
ELSEIF [Calculation_499055157752631296] <= 5 AND [Calculation_499055157752631296] > 0
THEN '2-5 Mins'
ELSEIF [Calculation_499055157752631296] <= 10 AND [Calculation_499055157752631296] > 0
THEN '5-10 Mins'
ELSEIF [Calculation_499055157752631296] <= 30 AND [Calculation_499055157752631296] > 0 
THEN '10-30 Mins'
ELSEIF [Calculation_499055157752631296] <= 60 AND [Calculation_499055157752631296] > 0
THEN '30Mins-1 Hour'
ELSEIF [Calculation_499055157752631296] <= 300 AND [Calculation_499055157752631296] > 0
THEN '1-5 Hours'
ELSEIF [Calculation_499055157752631296] <= 600 AND [Calculation_499055157752631296] > 0
THEN '5-10 Hours'
ELSEIF [Calculation_499055157752631296] <= 1440 AND [Calculation_499055157752631296] > 0
THEN '10-24 Hours'
ELSEIF [Calculation_499055157752631296] <= 4320 AND [Calculation_499055157752631296] > 0
THEN '24-72 Hours'
ELSEIF [Calculation_499055157752631296] > 4320 AND [Calculation_499055157752631296] > 0
THEN '>72 Hours'
END",
    "name": "[Calculation_499055157754740737]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Project Type",
    "datatype": "string",
    "formula": "IF CONTAINS([CZ Project Name],'Aged') THEN 'Aged'
ELSE 'Live' END",
    "name": "[Calculation_5872834692856524810]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "BLA Status",
    "datatype": "string",
    "formula": "IF [bla_blacklisted] = 'true' THEN 'Blacklisted'
ELSEIF [bla_blacklisted] = 'false' THEN 'Passed'
ELSE NULL
END",
    "name": "[Calculation_6374000853565702144]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "BLA Code",
    "datatype": "string",
    "formula": "[bla_rejectcodes]",
    "name": "[Calculation_6374000853566275585]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "D1 ('+' to add dim)",
    "datatype": "string",
    "formula": "IF [Parameters].[Parameter 10] = 1 THEN [Calculation_6374000853566275585]
ELSEIF [Parameters].[Parameter 10] = 2 THEN [bla_carrierdata_type]
ELSEIF [Parameters].[Parameter 10] = 3 THEN [Calculation_6374000853565702144]
ELSEIF [Parameters].[Parameter 10] = 4 THEN [Phone Carrier]
ELSEIF [Parameters].[Parameter 10] = 5 THEN [CZ Project Name]
ELSEIF [Parameters].[Parameter 10] = 6 THEN [Phone Type]
ELSEIF [Parameters].[Parameter 10] = 7 THEN [normalized carrier]
ELSEIF [Parameters].[Parameter 10] = 8 THEN [Outcome]
ELSEIF [Parameters].[Parameter 10] = 9 THEN [qual_status]
ELSEIF [Parameters].[Parameter 10] = 10 THEN [Source]
ELSEIF [Parameters].[Parameter 10] = 11 THEN [Sub Id]
ELSEIF [Parameters].[Parameter 10] = 12 THEN [gender (copy)_2399292755830108162]
ELSEIF [Parameters].[Parameter 10] = 13 THEN [Creative]
ELSEIF [Parameters].[Parameter 10] = 14 THEN [CL Diagnosis Injury Tiers]
ELSEIF [Parameters].[Parameter 10] = 15 THEN [Calculation_935059914517495808]
ELSEIF [Parameters].[Parameter 10] = 16 THEN [Ad Name]
ELSEIF [Parameters].[Parameter 10] = 17 THEN [Adset Name]
ELSEIF [Parameters].[Parameter 10] = 18 THEN [campaign_id]
ELSEIF [Parameters].[Parameter 10] = 19 THEN [Labels]
ELSEIF [Parameters].[Parameter 10] = 20 THEN [Calculation_5872834692856524810]
ELSEIF [Parameters].[Parameter 10] = 21 THEN [State]
ELSEIF [Parameters].[Parameter 10] = 22 THEN [Phone]
// ELSEIF [D1] = 23 THEN [Tier]
ELSEIF [Parameters].[Parameter 10] = 23 THEN [Calculation_1277614987429064704]
ELSEIF [Parameters].[Parameter 10] = 25 THEN [Result Type]
ELSEIF [Parameters].[Parameter 10] = 26 THEN [placement]
ELSEIF [Parameters].[Parameter 10] = 27 THEN [Calculation_7690318609259716608]
ELSEIF [Parameters].[Parameter 10] = 28 THEN [label]
ELSEIF [Parameters].[Parameter 10] = 29 THEN STR([Calculation_1880252886088871936])
ELSEIF [Parameters].[Parameter 10] = 30 THEN [clientname]
ELSEIF [Parameters].[Parameter 10] = 31 THEN [page_path]
ELSEIF [Parameters].[Parameter 10] = 32 THEN [sgmt]
ELSEIF [Parameters].[Parameter 10] = 33 THEN [ctcphone]
ELSEIF [Parameters].[Parameter 10] = 34 THEN [Calculation_3435894714053935109]
ELSEIF [Parameters].[Parameter 10] = 35 THEN [ltdinoworkmedicalconditions]
ELSEIF [Parameters].[Parameter 10] = 36 THEN [ds_qualstatus]
ELSEIF [Parameters].[Parameter 10] = 37 THEN [ad_id]
ELSEIF [Parameters].[Parameter 10] = 38 THEN [adset_id]
ELSEIF [Parameters].[Parameter 10] = 39 THEN [Calculation_1113233589182521344]
ELSEIF [Parameters].[Parameter 10] = 40 THEN [Calculation_1880252886125215747]
ELSEIF [Parameters].[Parameter 10] = 41 THEN [SubSegment]
ELSEIF [Parameters].[Parameter 10] = 42 THEN STR([Calculation_1133007210553765896])
ELSEIF [Parameters].[Parameter 10] = 43 THEN [Calculation_7573084309404708864]
ELSEIF [Parameters].[Parameter 10] = 44 THEN [Calculation_4531465651676438530]
ELSEIF [Parameters].[Parameter 10] = 45 THEN IF LEN(STR([appearance_l30d])) < 2 AND NOT ISNULL(STR([appearance_l30d])) THEN '0' + STR([appearance_l30d]) ELSE STR([appearance_l30d]) END
ELSEIF [Parameters].[Parameter 10] = 46 THEN IF LEN(STR([appearance_l60d])) < 2 AND NOT ISNULL(STR([appearance_l60d])) THEN '0' + STR([appearance_l60d]) ELSE STR([appearance_l60d]) END
ELSEIF [Parameters].[Parameter 10] = 47 THEN IF LEN(STR([appearance_l90d])) < 2 AND NOT ISNULL(STR([appearance_l90d])) THEN '0' + STR([appearance_l90d]) ELSE STR([appearance_l90d]) END
ELSEIF [Parameters].[Parameter 10] = 48 THEN [ATA Work]
ELSEIF [Parameters].[Parameter 10] = 49 THEN [Calculation_499055157754740737]
ELSEIF [Parameters].[Parameter 10] = 50 THEN IF LEN(STR([CIIC Appearance in L30D])) < 2 AND NOT ISNULL(STR([CIIC Appearance in L30D])) THEN '0' + STR([CIIC Appearance in L30D]) ELSE STR([CIIC Appearance in L30D]) END
ELSEIF [Parameters].[Parameter 10] = 51 THEN IF LEN(STR([CIIC Appearance in L60D])) < 2 AND NOT ISNULL(STR([CIIC Appearance in L60D])) THEN '0' + STR([CIIC Appearance in L60D]) ELSE STR([CIIC Appearance in L60D]) END
ELSEIF [Parameters].[Parameter 10] = 52 THEN IF LEN(STR([CIIC Appearance in L90D])) < 2 AND NOT ISNULL(STR([CIIC Appearance in L90D])) THEN '0' + STR([CIIC Appearance in L90D]) ELSE STR([CIIC Appearance in L90D]) END
ELSEIF [Parameters].[Parameter 10] = 53 THEN STR([Calculation_989947527401095169])
ELSEIF [Parameters].[Parameter 10] = 54 THEN [Calculation_1460573688699854848]
ELSEIF [Parameters].[Parameter 10] = 55 THEN [Calculation_1006061976934187009]
ELSE 'Agg'
END",
    "name": "[Calculation_6374000853571039236]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Grade",
    "datatype": "string",
    "formula": "// Grade A
IF [qual_status] = 'all-steps' THEN 'Grade A'

// Grade B
ELSEIF 
    [qual_status] IN ('fiveyrwrk-disqual','outofwrk-disqual','doc-disqual')
    AND [Calculation_1133007210553765896] = 1
THEN 'Grade B'

// Grade C
ELSEIF 
    [qual_status] <> 'age-disqual'
    AND NOT [Stage3 Response] IN ('Less than 2 years', 'Between 2 and 4 years')
    AND [Stage1 Response] <> 'Social Security Disability (SSD) Benefits'
    AND [Stage6 Response] = 'Not working'
THEN 'Grade C'

// Grade D
ELSEIF 
    // 1) Not age-disqual, Stage3 NOT in those two, Stage1 not SSD, Stage6 ≠ Not working, disqual ≤ 1
    (
      [qual_status] <> 'age-disqual'
      AND NOT [Stage3 Response] IN ('Less than 2 years', 'Between 2 and 4 years')
      AND [Stage1 Response] <> 'Social Security Disability (SSD) Benefits'
      AND [Stage6 Response] <> 'Not working'
      AND [Calculation_1133007210553765896] <= 1
    )
    // 2) Not age-disqual, Stage3 in those two, Qual Status = outofwrk-disqual
    OR
    (
      [qual_status] <> 'age-disqual'
      AND [Stage3 Response] IN ('Less than 2 years', 'Between 2 and 4 years')
      AND [qual_status] = 'outofwrk-disqual'
    )
    // 3) Not age-disqual, Stage3 in those two, Qual Status ≠ outofwrk-disqual, Stage7 = Yes
    OR
    (
      [qual_status] <> 'age-disqual'
      AND [Stage3 Response] IN ('Less than 2 years', 'Between 2 and 4 years')
      AND [qual_status] <> 'outofwrk-disqual'
      AND [Stage7 Response] = 'Yes'
    )
THEN 'Grade D'

// Rest (including age-disqual or anything else)
ELSE 'Rest'
END",
    "name": "[Calculation_7573084309404708864]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Today-28",
    "datatype": "date",
    "formula": "//Updated Date: 18 May 2022
//Updated By: Manish
//Description: Going back 28 days from today

({MAX(today()-28)})",
    "name": "[Calculation_767300790172184597]",
    "role": "dimension",
    "type": "ordinal",
  },
  {
    "caption": "SSD Age Range",
    "datatype": "string",
    "formula": "IF DATE([Calculation_1916563181826678784]) >= #18/08/2025#
THEN
    IF INT([Age]) < 40 THEN "U40"
    ELSEIF INT([Age]) >= 40 AND INT([Age]) <= 49 THEN "40 - 49"
	ELSEIF INT([Age]) >= 50 AND INT([Age]) <= 54 THEN "50 - 54"
    ELSEIF INT([Age]) >= 55 AND INT([Age]) <= 63 THEN "55 - 63"
    ELSEIF INT([Age]) >= 64 THEN "O64+"
    END
ELSEIF INT([Age]) < 40 THEN "*U40"
ELSEIF INT([Age]) >= 40 AND INT([Age]) <= 48 THEN "*40-48"
ELSEIF INT([Age]) = 49 THEN "*49"
ELSEIF INT([Age]) >= 50 AND INT([Age]) <= 62 THEN "*50-62"
ELSEIF INT([Age]) >= 63 THEN "*O63+" 
END",
    "name": "[Calculation_7690318609259716608]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "CTC Leads #",
    "datatype": "integer",
    "formula": "countd(if [CTC Lead] = 1 then [Calculation_906349454594166784] end)",
    "name": "[Calculation_8421379501118734337]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Date Filter",
    "datatype": "boolean",
    "formula": "//Updated Date: 18 May 2022
//Updated By: Manish
//Description: Filtering data based on date

IF [Parameters].[Parameter 11] = 'default'
THEN [Date]>=[Parameters].[Parameter 5] AND [Date]<=[Parameters].[Parameter 6]
ELSEIF [Parameters].[Parameter 11] = 'weekly'
THEN [Date] >= TODAY()-8 AND [Date] <= TODAY()-1
END",
    "name": "[Calculation_843580506575679492]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Dial R",
    "datatype": "string",
    "formula": "IF  [Called Count] < 4 then "<=3" 
elseif [Called Count] < 8 then "4-7"
elseif [Called Count] < 11 then "8-10"
elseif [Called Count] < 16 then "11-15"
elseif [Called Count] < 20 then "16-19"
elseif [Called Count] < 26 then "20-25"
elseif [Called Count] < 31 then "25-30"
elseif [Called Count] < 36 then "30-35"
else "35+" 
END",
    "name": "[Calculation_847802666706034688]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Dial R (detail)",
    "datatype": "string",
    "formula": "STR([Called Count])",
    "name": "[Calculation_847802666706186241]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Max Date",
    "datatype": "date",
    "formula": "//Updated Date: 18 May 2022
//Updated By: Manish
//Description: Calculating max of todays date for including it in the default values of end date

{MAX(today())}",
    "name": "[Calculation_882424053213511680]",
    "role": "dimension",
    "type": "ordinal",
  },
  {
    "caption": "User Identifier",
    "datatype": "string",
    "formula": "IF [Parameters].[Parameter 12] = 0 THEN [User Id]
ELSEIF [Parameters].[Parameter 12] = 1 THEN [Phone]
END",
    "name": "[Calculation_906349454594166784]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "CTC L30D Dupes #",
    "datatype": "integer",
    "formula": "COUNTD(
  IF [CIIC Appearance in L30D] > 0
    AND [CTC Lead] = 1
  THEN [Calculation_906349454594166784]
  END)",
    "name": "[Calculation_906349454597083138]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "CTC L60D Dupes #",
    "datatype": "integer",
    "formula": "COUNTD(
  IF [CIIC Appearance in L60D] > 0
    AND [CTC Lead] = 1
  THEN [Calculation_906349454594166784]
  END)",
    "name": "[Calculation_906349454597230595]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "CTC L90D Dupes #",
    "datatype": "integer",
    "formula": "COUNTD(
  IF [CIIC Appearance in L90D] > 0
    AND [CTC Lead] = 1
  THEN [Calculation_906349454594166784]
  END)",
    "name": "[Calculation_906349454597341188]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Alt. Branding",
    "datatype": "string",
    "formula": "If int(Right([Phone],2))<30 and [Calculation_5872834692856524810]= 'Live' then 'Yes' else 'No' End",
    "name": "[Calculation_935059914517495808]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Duplicate Rejects",
    "datatype": "string",
    "formula": "if [Outcome]='rejected' and { FIXED [Phone], [Outcome]: COUNTD([User Id])}>1 then 'Yes' else 'No' end",
    "name": "[Calculation_943222690415542272]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Post Date  ",
    "datatype": "string",
    "formula": "//Updated Date: 18 May 2022
//Updated By: Manish
//Description: Calculation to apply date bucket

CASE [Parameters].[Parameter 1]
WHEN 'year' THEN str(datepart('year', [Calculation_1916563181826678784]))
WHEN 'quarter' THEN "Q" + str(datepart('quarter', [Calculation_1916563181826678784])) + " " + str(datepart('year', [Calculation_1916563181826678784]))
WHEN 'month' THEN str(datepart('month', [Calculation_1916563181826678784])) + "-" + str(datepart('year', [Calculation_1916563181826678784]))
WHEN 'day' THEN str(DATENAME('month', [Calculation_1916563181826678784]))+ "-" +str(datepart('day', [Calculation_1916563181826678784]))+ "-" + str(datepart('year', [Calculation_1916563181826678784]))
WHEN 'week' THEN "W" + str(datepart('week', [Calculation_1916563181826678784])) + "-" + str(datepart('year', [Calculation_1916563181826678784]))
WHEN "hour" THEN str(DATETRUNC('hour', [Calculation_1916563181826678784]))
WHEN "minute" THEN str(DATETRUNC('minute', [Calculation_1916563181826678784]))
END",
    "name": "[Calculation_97320012552925214]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Vici Post Delay (Days)",
    "datatype": "integer",
    "formula": "DATEDIFF('day', [Post Date], [Entry Time])",
    "name": "[Calculation_989947527401095169]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Posted #",
    "datatype": "integer",
    "formula": "//Updated Date: 18 May 2022
//Updated By: Manish
//Description: Calculating the sum of user id wrt to source

countd([Calculation_906349454594166784])",
    "name": "[Calculation_99712551082803223]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "D3",
    "datatype": "string",
    "formula": "IF [Parameters].[D1 (copy 3)_1113233589196374020] = 1 THEN [Calculation_6374000853566275585]
ELSEIF [Parameters].[D1 (copy 3)_1113233589196374020] = 2 THEN [bla_carrierdata_type]
ELSEIF [Parameters].[D1 (copy 3)_1113233589196374020] = 3 THEN [Calculation_6374000853565702144]
ELSEIF [Parameters].[D1 (copy 3)_1113233589196374020] = 4 THEN [Phone Carrier]
ELSEIF [Parameters].[D1 (copy 3)_1113233589196374020] = 5 THEN [CZ Project Name]
ELSEIF [Parameters].[D1 (copy 3)_1113233589196374020] = 6 THEN [Phone Type]
ELSEIF [Parameters].[D1 (copy 3)_1113233589196374020] = 7 THEN [normalized carrier]
ELSEIF [Parameters].[D1 (copy 3)_1113233589196374020] = 8 THEN [Outcome]
ELSEIF [Parameters].[D1 (copy 3)_1113233589196374020] = 9 THEN [qual_status]
ELSEIF [Parameters].[D1 (copy 3)_1113233589196374020] = 10 THEN [Source]
ELSEIF [Parameters].[D1 (copy 3)_1113233589196374020] = 11 THEN [Sub Id]
ELSEIF [Parameters].[D1 (copy 3)_1113233589196374020] = 12 THEN [gender (copy)_2399292755830108162]
ELSEIF [Parameters].[D1 (copy 3)_1113233589196374020] = 13 THEN [Creative]
ELSEIF [Parameters].[D1 (copy 3)_1113233589196374020] = 14 THEN [CL Diagnosis Injury Tiers]
ELSEIF [Parameters].[D1 (copy 3)_1113233589196374020] = 15 THEN [Calculation_935059914517495808]
ELSEIF [Parameters].[D1 (copy 3)_1113233589196374020] = 16 THEN [Ad Name]
ELSEIF [Parameters].[D1 (copy 3)_1113233589196374020] = 17 THEN [Adset Name]
ELSEIF [Parameters].[D1 (copy 3)_1113233589196374020] = 18 THEN [campaign_id]
ELSEIF [Parameters].[D1 (copy 3)_1113233589196374020] = 19 THEN [Labels]
ELSEIF [Parameters].[D1 (copy 3)_1113233589196374020] = 20 THEN [Calculation_5872834692856524810]
ELSEIF [Parameters].[D1 (copy 3)_1113233589196374020] = 21 THEN [State]
ELSEIF [Parameters].[D1 (copy 3)_1113233589196374020] = 22 THEN [Phone]
// ELSEIF [Parameters].[D3] = 23 THEN [Tier]
ELSEIF [Parameters].[D1 (copy 3)_1113233589196374020] = 23 THEN [Calculation_1277614987429064704]
ELSEIF [Parameters].[D1 (copy 3)_1113233589196374020] = 25 THEN [Result Type]
ELSEIF [Parameters].[D1 (copy 3)_1113233589196374020] = 26 THEN [placement]
ELSEIF [Parameters].[D1 (copy 3)_1113233589196374020] = 27 THEN [Calculation_7690318609259716608]
ELSEIF [Parameters].[D1 (copy 3)_1113233589196374020] = 28 THEN [label]
ELSEIF [Parameters].[D1 (copy 3)_1113233589196374020] = 29 THEN STR([Calculation_1880252886088871936])
ELSEIF [Parameters].[D1 (copy 3)_1113233589196374020] = 30 THEN [clientname]
ELSEIF [Parameters].[D1 (copy 3)_1113233589196374020] = 31 THEN [page_path]
ELSEIF [Parameters].[D1 (copy 3)_1113233589196374020] = 32 THEN [sgmt]
ELSEIF [Parameters].[D1 (copy 3)_1113233589196374020] = 33 THEN [ctcphone]
ELSEIF [Parameters].[D1 (copy 3)_1113233589196374020] = 34 THEN [Calculation_3435894714053935109]
ELSEIF [Parameters].[D1 (copy 3)_1113233589196374020] = 35 THEN [ltdinoworkmedicalconditions]
ELSEIF [Parameters].[D1 (copy 3)_1113233589196374020] = 36 THEN [ds_qualstatus]
ELSEIF [Parameters].[D1 (copy 3)_1113233589196374020] = 37 THEN [ad_id]
ELSEIF [Parameters].[D1 (copy 3)_1113233589196374020] = 38 THEN [adset_id]
ELSEIF [Parameters].[D1 (copy 3)_1113233589196374020] = 39 THEN [Calculation_1113233589182521344]
ELSEIF [Parameters].[D1 (copy 3)_1113233589196374020] = 40 THEN [Calculation_1880252886125215747]
ELSEIF [Parameters].[D1 (copy 3)_1113233589196374020] = 41 THEN [SubSegment]
ELSEIF [Parameters].[D1 (copy 3)_1113233589196374020] = 42 THEN STR([Calculation_1133007210553765896])
ELSEIF [Parameters].[D1 (copy 3)_1113233589196374020] = 43 THEN [Calculation_7573084309404708864]
ELSEIF [Parameters].[D1 (copy 3)_1113233589196374020] = 44 THEN [Calculation_4531465651676438530]
ELSEIF [Parameters].[D1 (copy 3)_1113233589196374020] = 45 THEN IF LEN(STR([appearance_l30d])) < 2 AND NOT ISNULL(STR([appearance_l30d])) THEN '0' + STR([appearance_l30d]) ELSE STR([appearance_l30d]) END
ELSEIF [Parameters].[D1 (copy 3)_1113233589196374020] = 46 THEN IF LEN(STR([appearance_l60d])) < 2 AND NOT ISNULL(STR([appearance_l60d])) THEN '0' + STR([appearance_l60d]) ELSE STR([appearance_l60d]) END
ELSEIF [Parameters].[D1 (copy 3)_1113233589196374020] = 47 THEN IF LEN(STR([appearance_l90d])) < 2 AND NOT ISNULL(STR([appearance_l90d])) THEN '0' + STR([appearance_l90d]) ELSE STR([appearance_l90d]) END
ELSEIF [Parameters].[D1 (copy 3)_1113233589196374020] = 48 THEN [ATA Work]
ELSEIF [Parameters].[D1 (copy 3)_1113233589196374020] = 49 THEN [Calculation_499055157754740737]
ELSEIF [Parameters].[D1 (copy 3)_1113233589196374020] = 50 THEN IF LEN(STR([CIIC Appearance in L30D])) < 2 AND NOT ISNULL(STR([CIIC Appearance in L30D])) THEN '0' + STR([CIIC Appearance in L30D]) ELSE STR([CIIC Appearance in L30D]) END
ELSEIF [Parameters].[D1 (copy 3)_1113233589196374020] = 51 THEN IF LEN(STR([CIIC Appearance in L60D])) < 2 AND NOT ISNULL(STR([CIIC Appearance in L60D])) THEN '0' + STR([CIIC Appearance in L60D]) ELSE STR([CIIC Appearance in L60D]) END
ELSEIF [Parameters].[D1 (copy 3)_1113233589196374020] = 52 THEN IF LEN(STR([CIIC Appearance in L90D])) < 2 AND NOT ISNULL(STR([CIIC Appearance in L90D])) THEN '0' + STR([CIIC Appearance in L90D]) ELSE STR([CIIC Appearance in L90D]) END
ELSEIF [Parameters].[D1 (copy 3)_1113233589196374020] = 53 THEN STR([Calculation_989947527401095169])
ELSEIF [Parameters].[D1 (copy 3)_1113233589196374020] = 54 THEN [Calculation_1460573688699854848]
ELSEIF [Parameters].[D1 (copy 3)_1113233589196374020] = 55 THEN [Calculation_1006061976934187009]
ELSE 'Agg'
END",
    "name": "[D1 (copy) (copy)_6374000853573369864]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "D2",
    "datatype": "string",
    "formula": "IF [Parameters].[D1 (copy 2)_1113233589196361731] = 1 THEN [Calculation_6374000853566275585]
ELSEIF [Parameters].[D1 (copy 2)_1113233589196361731]  = 2 THEN [bla_carrierdata_type]
ELSEIF [Parameters].[D1 (copy 2)_1113233589196361731]  = 3 THEN [Calculation_6374000853565702144]
ELSEIF [Parameters].[D1 (copy 2)_1113233589196361731]  = 4 THEN [Phone Carrier]
ELSEIF [Parameters].[D1 (copy 2)_1113233589196361731]  = 5 THEN [CZ Project Name]
ELSEIF [Parameters].[D1 (copy 2)_1113233589196361731]  = 6 THEN [Phone Type]
ELSEIF [Parameters].[D1 (copy 2)_1113233589196361731]  = 7 THEN [normalized carrier]
ELSEIF [Parameters].[D1 (copy 2)_1113233589196361731]  = 8 THEN [Outcome]
ELSEIF [Parameters].[D1 (copy 2)_1113233589196361731]  = 9 THEN [qual_status]
ELSEIF [Parameters].[D1 (copy 2)_1113233589196361731]  = 10 THEN [Source]
ELSEIF [Parameters].[D1 (copy 2)_1113233589196361731]  = 11 THEN [Sub Id]
ELSEIF [Parameters].[D1 (copy 2)_1113233589196361731]  = 12 THEN [gender (copy)_2399292755830108162]
ELSEIF [Parameters].[D1 (copy 2)_1113233589196361731]  = 13 THEN [Creative]
ELSEIF [Parameters].[D1 (copy 2)_1113233589196361731]  = 14 THEN [CL Diagnosis Injury Tiers]
ELSEIF [Parameters].[D1 (copy 2)_1113233589196361731]  = 15 THEN [Calculation_935059914517495808]
ELSEIF [Parameters].[D1 (copy 2)_1113233589196361731]  = 16 THEN [Ad Name]
ELSEIF [Parameters].[D1 (copy 2)_1113233589196361731]  = 17 THEN [Adset Name]
ELSEIF [Parameters].[D1 (copy 2)_1113233589196361731]  = 18 THEN [campaign_id]
ELSEIF [Parameters].[D1 (copy 2)_1113233589196361731]  = 19 THEN [Labels]
ELSEIF [Parameters].[D1 (copy 2)_1113233589196361731]  = 20 THEN [Calculation_5872834692856524810]
ELSEIF [Parameters].[D1 (copy 2)_1113233589196361731]  = 21 THEN [State]
ELSEIF [Parameters].[D1 (copy 2)_1113233589196361731]  = 22 THEN [Phone]
// ELSEIF [Parameters].[D2] = 23 THEN [Tier]
ELSEIF [Parameters].[D1 (copy 2)_1113233589196361731]  = 23 THEN [Calculation_1277614987429064704]
ELSEIF [Parameters].[D1 (copy 2)_1113233589196361731]  = 25 THEN [Result Type]
ELSEIF [Parameters].[D1 (copy 2)_1113233589196361731]  = 26 THEN [placement]
ELSEIF [Parameters].[D1 (copy 2)_1113233589196361731]  = 27 THEN [Calculation_7690318609259716608]
ELSEIF [Parameters].[D1 (copy 2)_1113233589196361731]  = 28 THEN [label]
ELSEIF [Parameters].[D1 (copy 2)_1113233589196361731]  = 29 THEN STR([Calculation_1880252886088871936])
ELSEIF [Parameters].[D1 (copy 2)_1113233589196361731]  = 30 THEN [clientname]
ELSEIF [Parameters].[D1 (copy 2)_1113233589196361731]  = 31 THEN [page_path]
ELSEIF [Parameters].[D1 (copy 2)_1113233589196361731]  = 32 THEN [sgmt]
ELSEIF [Parameters].[D1 (copy 2)_1113233589196361731]  = 33 THEN [ctcphone]
ELSEIF [Parameters].[D1 (copy 2)_1113233589196361731]  = 34 THEN [Calculation_3435894714053935109]
ELSEIF [Parameters].[D1 (copy 2)_1113233589196361731]  = 35 THEN [ltdinoworkmedicalconditions]
ELSEIF [Parameters].[D1 (copy 2)_1113233589196361731]  = 36 THEN [ds_qualstatus]
ELSEIF [Parameters].[D1 (copy 2)_1113233589196361731]  = 37 THEN [ad_id]
ELSEIF [Parameters].[D1 (copy 2)_1113233589196361731]  = 38 THEN [adset_id]
ELSEIF [Parameters].[D1 (copy 2)_1113233589196361731]  = 39 THEN [Calculation_1113233589182521344]
ELSEIF [Parameters].[D1 (copy 2)_1113233589196361731]  = 40 THEN [Calculation_1880252886125215747]
ELSEIF [Parameters].[D1 (copy 2)_1113233589196361731]  = 41 THEN [SubSegment]
ELSEIF [Parameters].[D1 (copy 2)_1113233589196361731] = 42 THEN STR([Calculation_1133007210553765896])
ELSEIF [Parameters].[D1 (copy 2)_1113233589196361731] = 43 THEN [Calculation_7573084309404708864]
ELSEIF [Parameters].[D1 (copy 2)_1113233589196361731] = 44 THEN [Calculation_4531465651676438530]
ELSEIF [Parameters].[D1 (copy 2)_1113233589196361731] = 45 THEN IF LEN(STR([appearance_l30d])) < 2 AND NOT ISNULL(STR([appearance_l30d])) THEN '0' + STR([appearance_l30d]) ELSE STR([appearance_l30d]) END
ELSEIF [Parameters].[D1 (copy 2)_1113233589196361731] = 46 THEN IF LEN(STR([appearance_l60d])) < 2 AND NOT ISNULL(STR([appearance_l60d])) THEN '0' + STR([appearance_l60d]) ELSE STR([appearance_l60d]) END
ELSEIF [Parameters].[D1 (copy 2)_1113233589196361731] = 47 THEN IF LEN(STR([appearance_l90d])) < 2 AND NOT ISNULL(STR([appearance_l90d])) THEN '0' + STR([appearance_l90d]) ELSE STR([appearance_l90d]) END
ELSEIF [Parameters].[D1 (copy 2)_1113233589196361731] = 48 THEN [ATA Work]
ELSEIF [Parameters].[D1 (copy 2)_1113233589196361731] = 49 THEN [Calculation_499055157754740737]
ELSEIF [Parameters].[D1 (copy 2)_1113233589196361731] = 50 THEN IF LEN(STR([CIIC Appearance in L30D])) < 2 AND NOT ISNULL(STR([CIIC Appearance in L30D])) THEN '0' + STR([CIIC Appearance in L30D]) ELSE STR([CIIC Appearance in L30D]) END
ELSEIF [Parameters].[D1 (copy 2)_1113233589196361731] = 51 THEN IF LEN(STR([CIIC Appearance in L60D])) < 2 AND NOT ISNULL(STR([CIIC Appearance in L60D])) THEN '0' + STR([CIIC Appearance in L60D]) ELSE STR([CIIC Appearance in L60D]) END
ELSEIF [Parameters].[D1 (copy 2)_1113233589196361731] = 52 THEN IF LEN(STR([CIIC Appearance in L90D])) < 2 AND NOT ISNULL(STR([CIIC Appearance in L90D])) THEN '0' + STR([CIIC Appearance in L90D]) ELSE STR([CIIC Appearance in L90D]) END
ELSEIF [Parameters].[D1 (copy 2)_1113233589196361731] = 53 THEN STR([Calculation_989947527401095169])
ELSEIF [Parameters].[D1 (copy 2)_1113233589196361731] = 54 THEN [Calculation_1460573688699854848]
ELSEIF [Parameters].[D1 (copy 2)_1113233589196361731] = 55 THEN [Calculation_1006061976934187009]
ELSE 'Agg'
END",
    "name": "[D1 (copy)_6374000853573341191]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "D4",
    "datatype": "string",
    "formula": "IF [Parameters].[D1 (copy)_1113233589196333057] = 1 THEN [Calculation_6374000853566275585]
ELSEIF [Parameters].[D1 (copy)_1113233589196333057] = 2 THEN [bla_carrierdata_type]
ELSEIF [Parameters].[D1 (copy)_1113233589196333057] = 3 THEN [Calculation_6374000853565702144]
ELSEIF [Parameters].[D1 (copy)_1113233589196333057] = 4 THEN [Phone Carrier]
ELSEIF [Parameters].[D1 (copy)_1113233589196333057] = 5 THEN [CZ Project Name]
ELSEIF [Parameters].[D1 (copy)_1113233589196333057] = 6 THEN [Phone Type]
ELSEIF [Parameters].[D1 (copy)_1113233589196333057] = 7 THEN [normalized carrier]
ELSEIF [Parameters].[D1 (copy)_1113233589196333057] = 8 THEN [Outcome]
ELSEIF [Parameters].[D1 (copy)_1113233589196333057] = 9 THEN [qual_status]
ELSEIF [Parameters].[D1 (copy)_1113233589196333057] = 10 THEN [Source]
ELSEIF [Parameters].[D1 (copy)_1113233589196333057] = 11 THEN [Sub Id]
ELSEIF [Parameters].[D1 (copy)_1113233589196333057] = 12 THEN [gender (copy)_2399292755830108162]
ELSEIF [Parameters].[D1 (copy)_1113233589196333057] = 13 THEN [Creative]
ELSEIF [Parameters].[D1 (copy)_1113233589196333057] = 14 THEN [CL Diagnosis Injury Tiers]
ELSEIF [Parameters].[D1 (copy)_1113233589196333057] = 15 THEN [Calculation_935059914517495808]
ELSEIF [Parameters].[D1 (copy)_1113233589196333057] = 16 THEN [Ad Name]
ELSEIF [Parameters].[D1 (copy)_1113233589196333057] = 17 THEN [Adset Name]
ELSEIF [Parameters].[D1 (copy)_1113233589196333057] = 18 THEN [campaign_id]
ELSEIF [Parameters].[D1 (copy)_1113233589196333057] = 19 THEN [Labels]
ELSEIF [Parameters].[D1 (copy)_1113233589196333057] = 20 THEN [Calculation_5872834692856524810]
ELSEIF [Parameters].[D1 (copy)_1113233589196333057] = 21 THEN [State]
ELSEIF [Parameters].[D1 (copy)_1113233589196333057] = 22 THEN [Phone]
// ELSEIF [Parameters].[D4] = 23 THEN [Tier]
ELSEIF [Parameters].[D1 (copy)_1113233589196333057] = 23 THEN [Calculation_1277614987429064704]
ELSEIF [Parameters].[D1 (copy)_1113233589196333057] = 25 THEN [Result Type]
ELSEIF [Parameters].[D1 (copy)_1113233589196333057] = 26 THEN [placement]
ELSEIF [Parameters].[D1 (copy)_1113233589196333057] = 27 THEN [Calculation_7690318609259716608]
ELSEIF [Parameters].[D1 (copy)_1113233589196333057] = 28 THEN [label]
ELSEIF [Parameters].[D1 (copy)_1113233589196333057] = 29 THEN STR([Calculation_1880252886088871936])
ELSEIF [Parameters].[D1 (copy)_1113233589196333057] = 30 THEN [clientname]
ELSEIF [Parameters].[D1 (copy)_1113233589196333057] = 31 THEN [page_path]
ELSEIF [Parameters].[D1 (copy)_1113233589196333057] = 32 THEN [sgmt]
ELSEIF [Parameters].[D1 (copy)_1113233589196333057] = 33 THEN [ctcphone]
ELSEIF [Parameters].[D1 (copy)_1113233589196333057] = 34 THEN [Calculation_3435894714053935109]
ELSEIF [Parameters].[D1 (copy)_1113233589196333057] = 35 THEN [ltdinoworkmedicalconditions]
ELSEIF [Parameters].[D1 (copy)_1113233589196333057] = 36 THEN [ds_qualstatus]
ELSEIF [Parameters].[D1 (copy)_1113233589196333057] = 37 THEN [ad_id]
ELSEIF [Parameters].[D1 (copy)_1113233589196333057] = 38 THEN [adset_id]
ELSEIF [Parameters].[D1 (copy)_1113233589196333057] = 39 THEN [Calculation_1113233589182521344]
ELSEIF [Parameters].[D1 (copy)_1113233589196333057] = 40 THEN [Calculation_1880252886125215747]
ELSEIF [Parameters].[D1 (copy)_1113233589196333057] = 41 THEN [SubSegment]
ELSEIF [Parameters].[D1 (copy)_1113233589196333057] = 42 THEN STR([Calculation_1133007210553765896])
ELSEIF [Parameters].[D1 (copy)_1113233589196333057] = 43 THEN [Calculation_7573084309404708864]
ELSEIF [Parameters].[D1 (copy)_1113233589196333057] = 44 THEN [Calculation_4531465651676438530]
ELSEIF [Parameters].[D1 (copy)_1113233589196333057] = 45 THEN IF LEN(STR([appearance_l30d])) < 2 AND NOT ISNULL(STR([appearance_l30d])) THEN '0' + STR([appearance_l30d]) ELSE STR([appearance_l30d]) END
ELSEIF [Parameters].[D1 (copy)_1113233589196333057] = 46 THEN IF LEN(STR([appearance_l60d])) < 2 AND NOT ISNULL(STR([appearance_l60d])) THEN '0' + STR([appearance_l60d]) ELSE STR([appearance_l60d]) END
ELSEIF [Parameters].[D1 (copy)_1113233589196333057] = 47 THEN IF LEN(STR([appearance_l90d])) < 2 AND NOT ISNULL(STR([appearance_l90d])) THEN '0' + STR([appearance_l90d]) ELSE STR([appearance_l90d]) END
ELSEIF [Parameters].[D1 (copy)_1113233589196333057] = 48 THEN [ATA Work]
ELSEIF [Parameters].[D1 (copy)_1113233589196333057] = 49 THEN [Calculation_499055157754740737]
ELSEIF [Parameters].[D1 (copy)_1113233589196333057] = 50 THEN IF LEN(STR([CIIC Appearance in L30D])) < 2 AND NOT ISNULL(STR([CIIC Appearance in L30D])) THEN '0' + STR([CIIC Appearance in L30D]) ELSE STR([CIIC Appearance in L30D]) END
ELSEIF [Parameters].[D1 (copy)_1113233589196333057] = 51 THEN IF LEN(STR([CIIC Appearance in L60D])) < 2 AND NOT ISNULL(STR([CIIC Appearance in L60D])) THEN '0' + STR([CIIC Appearance in L60D]) ELSE STR([CIIC Appearance in L60D]) END
ELSEIF [Parameters].[D1 (copy)_1113233589196333057] = 52 THEN IF LEN(STR([CIIC Appearance in L90D])) < 2 AND NOT ISNULL(STR([CIIC Appearance in L90D])) THEN '0' + STR([CIIC Appearance in L90D]) ELSE STR([CIIC Appearance in L90D]) END
ELSEIF [Parameters].[D1 (copy)_1113233589196333057] = 53 THEN STR([Calculation_989947527401095169])
ELSEIF [Parameters].[D1 (copy)_1113233589196333057] = 54 THEN [Calculation_1460573688699854848]
ELSEIF [Parameters].[D1 (copy)_1113233589196333057] = 55 THEN [Calculation_1006061976934187009]
ELSE 'Agg'
END",
    "name": "[D3 (copy)_6208563937532035081]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "D5",
    "datatype": "string",
    "formula": "IF [Parameters].[D1 (copy) (copy)_1113233589196361730] = 1 THEN [Calculation_6374000853566275585]
ELSEIF [Parameters].[D1 (copy) (copy)_1113233589196361730] = 2 THEN [bla_carrierdata_type]
ELSEIF [Parameters].[D1 (copy) (copy)_1113233589196361730] = 3 THEN [Calculation_6374000853565702144]
ELSEIF [Parameters].[D1 (copy) (copy)_1113233589196361730] = 4 THEN [Phone Carrier]
ELSEIF [Parameters].[D1 (copy) (copy)_1113233589196361730] = 5 THEN [CZ Project Name]
ELSEIF [Parameters].[D1 (copy) (copy)_1113233589196361730] = 6 THEN [Phone Type]
ELSEIF [Parameters].[D1 (copy) (copy)_1113233589196361730] = 7 THEN [normalized carrier]
ELSEIF [Parameters].[D1 (copy) (copy)_1113233589196361730] = 8 THEN [Outcome]
ELSEIF [Parameters].[D1 (copy) (copy)_1113233589196361730] = 9 THEN [qual_status]
ELSEIF [Parameters].[D1 (copy) (copy)_1113233589196361730] = 10 THEN [Source]
ELSEIF [Parameters].[D1 (copy) (copy)_1113233589196361730] = 11 THEN [Sub Id]
ELSEIF [Parameters].[D1 (copy) (copy)_1113233589196361730] = 12 THEN [gender (copy)_2399292755830108162]
ELSEIF [Parameters].[D1 (copy) (copy)_1113233589196361730] = 13 THEN [Creative]
ELSEIF [Parameters].[D1 (copy) (copy)_1113233589196361730] = 14 THEN [CL Diagnosis Injury Tiers]
ELSEIF [Parameters].[D1 (copy) (copy)_1113233589196361730] = 15 THEN [Calculation_935059914517495808]
ELSEIF [Parameters].[D1 (copy) (copy)_1113233589196361730] = 16 THEN [Ad Name]
ELSEIF [Parameters].[D1 (copy) (copy)_1113233589196361730] = 17 THEN [Adset Name]
ELSEIF [Parameters].[D1 (copy) (copy)_1113233589196361730] = 18 THEN [campaign_id]
ELSEIF [Parameters].[D1 (copy) (copy)_1113233589196361730] = 19 THEN [Labels]
ELSEIF [Parameters].[D1 (copy) (copy)_1113233589196361730] = 20 THEN [Calculation_5872834692856524810]
ELSEIF [Parameters].[D1 (copy) (copy)_1113233589196361730] = 21 THEN [State]
ELSEIF [Parameters].[D1 (copy) (copy)_1113233589196361730] = 22 THEN [Phone]
// ELSEIF [Parameters].[D5] = 23 THEN [Tier]
ELSEIF [Parameters].[D1 (copy) (copy)_1113233589196361730] = 23 THEN [Calculation_1277614987429064704]
ELSEIF [Parameters].[D1 (copy) (copy)_1113233589196361730] = 25 THEN [Result Type]
ELSEIF [Parameters].[D1 (copy) (copy)_1113233589196361730] = 26 THEN [placement]
ELSEIF [Parameters].[D1 (copy) (copy)_1113233589196361730] = 27 THEN [Calculation_7690318609259716608]
ELSEIF [Parameters].[D1 (copy) (copy)_1113233589196361730] = 28 THEN [label]
ELSEIF [Parameters].[D1 (copy) (copy)_1113233589196361730] = 29 THEN STR([Calculation_1880252886088871936])
ELSEIF [Parameters].[D1 (copy) (copy)_1113233589196361730] = 30 THEN [clientname]
ELSEIF [Parameters].[D1 (copy) (copy)_1113233589196361730] = 31 THEN [page_path]
ELSEIF [Parameters].[D1 (copy) (copy)_1113233589196361730] = 32 THEN [sgmt]
ELSEIF [Parameters].[D1 (copy) (copy)_1113233589196361730] = 33 THEN [ctcphone]
ELSEIF [Parameters].[D1 (copy) (copy)_1113233589196361730] = 34 THEN [Calculation_3435894714053935109]
ELSEIF [Parameters].[D1 (copy) (copy)_1113233589196361730] = 35 THEN [ltdinoworkmedicalconditions]
ELSEIF [Parameters].[D1 (copy) (copy)_1113233589196361730] = 36 THEN [ds_qualstatus]
ELSEIF [Parameters].[D1 (copy) (copy)_1113233589196361730] = 37 THEN [ad_id]
ELSEIF [Parameters].[D1 (copy) (copy)_1113233589196361730] = 38 THEN [adset_id]
ELSEIF [Parameters].[D1 (copy) (copy)_1113233589196361730] = 39 THEN [Calculation_1113233589182521344]
ELSEIF [Parameters].[D1 (copy) (copy)_1113233589196361730] = 40 THEN [Calculation_1880252886125215747]
ELSEIF [Parameters].[D1 (copy) (copy)_1113233589196361730] = 41 THEN [SubSegment]
ELSEIF [Parameters].[D1 (copy) (copy)_1113233589196361730] = 42 THEN STR([Calculation_1133007210553765896])
ELSEIF [Parameters].[D1 (copy) (copy)_1113233589196361730] = 43 THEN [Calculation_7573084309404708864]
ELSEIF [Parameters].[D1 (copy) (copy)_1113233589196361730] = 44 THEN [Calculation_4531465651676438530]
ELSEIF [Parameters].[D1 (copy) (copy)_1113233589196361730] = 45 THEN IF LEN(STR([appearance_l30d])) < 2 AND NOT ISNULL(STR([appearance_l30d])) THEN '0' + STR([appearance_l30d]) ELSE STR([appearance_l30d]) END
ELSEIF [Parameters].[D1 (copy) (copy)_1113233589196361730] = 46 THEN IF LEN(STR([appearance_l60d])) < 2 AND NOT ISNULL(STR([appearance_l60d])) THEN '0' + STR([appearance_l60d]) ELSE STR([appearance_l60d]) END
ELSEIF [Parameters].[D1 (copy) (copy)_1113233589196361730] = 47 THEN IF LEN(STR([appearance_l90d])) < 2 AND NOT ISNULL(STR([appearance_l90d])) THEN '0' + STR([appearance_l90d]) ELSE STR([appearance_l90d]) END
ELSEIF [Parameters].[D1 (copy) (copy)_1113233589196361730] = 48 THEN [ATA Work]
ELSEIF [Parameters].[D1 (copy) (copy)_1113233589196361730] = 49 THEN [Calculation_499055157754740737]
ELSEIF [Parameters].[D1 (copy) (copy)_1113233589196361730] = 50 THEN IF LEN(STR([CIIC Appearance in L30D])) < 2 AND NOT ISNULL(STR([CIIC Appearance in L30D])) THEN '0' + STR([CIIC Appearance in L30D]) ELSE STR([CIIC Appearance in L30D]) END
ELSEIF [Parameters].[D1 (copy) (copy)_1113233589196361730] = 51 THEN IF LEN(STR([CIIC Appearance in L60D])) < 2 AND NOT ISNULL(STR([CIIC Appearance in L60D])) THEN '0' + STR([CIIC Appearance in L60D]) ELSE STR([CIIC Appearance in L60D]) END
ELSEIF [Parameters].[D1 (copy) (copy)_1113233589196361730] = 52 THEN IF LEN(STR([CIIC Appearance in L90D])) < 2 AND NOT ISNULL(STR([CIIC Appearance in L90D])) THEN '0' + STR([CIIC Appearance in L90D]) ELSE STR([CIIC Appearance in L90D]) END
ELSEIF [Parameters].[D1 (copy) (copy)_1113233589196361730] = 53 THEN STR([Calculation_989947527401095169])
ELSEIF [Parameters].[D1 (copy) (copy)_1113233589196361730] = 54 THEN [Calculation_1460573688699854848]
ELSEIF [Parameters].[D1 (copy) (copy)_1113233589196361730] = 55 THEN [Calculation_1006061976934187009]
ELSE 'Agg'
END",
    "name": "[D4 (copy)_6208563937532350475]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Gender",
    "datatype": "string",
    "formula": "//Updated Date: 18 May 2022
//Updated By: Manish
//Description: Converting gnder values to upper case

UPPER([Gender])",
    "name": "[gender (copy)_2399292755830108162]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "State Exclusions",
    "datatype": "string",
    "formula": "[State]",
    "name": "[state (copy)_2399292755821703168]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "End Date Comp",
    "datatype": "date",
    "formula": "#2025-08-20#",
    "name": "[End Date (copy)_1152077103892365314]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Start Date",
    "datatype": "date",
    "formula": "#2025-07-30#",
    "name": "[Parameter 5]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "End Date",
    "datatype": "date",
    "formula": "#2025-08-27#",
    "name": "[Parameter 6]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Lead vs Spend",
    "datatype": "string",
    "formula": ""1"",
    "name": "[Parameter 8]",
    "role": "measure",
    "type": "nominal",
  },
  {
    "caption": "Start Date Comp",
    "datatype": "date",
    "formula": "#2025-08-20#",
    "name": "[Start Date (copy)_1152077103891697665]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "TTW Grade",
    "datatype": "string",
    "formula": "IF [ttw_qualstatus] = 'ttw-qualified' then 'Grade A'
ELSEIF  [ttw_qualstatus] = 'ttw-nonqualified' and [TTW Explore Work Form] = 'yes' THEN 'Grade B'
ELSEIF [ttw_qualstatus] = 'ttw-nonqualified' and [TTW Explore Work Form] != 'yes' THEN 'Grade C'
ELSEIF ISNULL([ttw_qualstatus]) and [Stage3 Response] = 'Between 2 and 4 years' then 'Grade D'
ELSE 'Rest'
END",
    "name": "[Calculation_1006061976934187009]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "20hrs Disqual",
    "datatype": "integer",
    "formula": "IF [Stage6 Response] = "More than 20 hours per week" THEN 1 ELSE 0 END",
    "name": "[Calculation_1133007210546622464]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Age Disqual",
    "datatype": "integer",
    "formula": "IF INT([Age]) < 40 OR INT([Age]) > 62 THEN 1 ELSE 0 END",
    "name": "[Calculation_1133007210553298946]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Attorney Disqual",
    "datatype": "integer",
    "formula": "IF [Stage5 Response] = "Yes" THEN 1 ELSE 0 END",
    "name": "[Calculation_1133007210553425923]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Ben Disqual",
    "datatype": "integer",
    "formula": "IF IFNULL([Stage1 Response], "") != "I am not receiving any disability benefits (SSD or SSI)"
THEN 1 ELSE 0 END",
    "name": "[Calculation_1133007210553487364]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Doctor Visit Disqual",
    "datatype": "integer",
    "formula": "IF [Stage4 Response] = "No" THEN 1 ELSE 0 END",
    "name": "[Calculation_1133007210553540613]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Five Year Work Disqual",
    "datatype": "integer",
    "formula": "IF [Stage3 Response] = "Less than 2 years"
OR [Stage3 Response] = "Between 2 and 4 years"
THEN 1 ELSE 0 END",
    "name": "[Calculation_1133007210553618438]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Out of Work Disqual",
    "datatype": "integer",
    "formula": "IF [Stage2 Response] = "No" THEN 1 ELSE 0 END",
    "name": "[Calculation_1133007210553663495]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "# of Disqual",
    "datatype": "integer",
    "formula": "ZN([Calculation_1133007210553487364]) +
ZN([Calculation_1133007210553663495]) +
ZN([Calculation_1133007210553618438]) +
ZN([Calculation_1133007210553540613]) +
ZN([Calculation_1133007210553425923]) +
ZN([Calculation_1133007210546622464]) +
ZN([Calculation_1133007210553298946])",
    "name": "[Calculation_1133007210553765896]",
    "role": "dimension",
    "type": "ordinal",
  },
  {
    "caption": "Selected Posts & Spends",
    "datatype": "real",
    "formula": "IF [Parameters].[Parameter 8] = '1' THEN 
countd(IF [Date]>=[Parameters].[Parameter 5] AND [Date]<=[Parameters].[Parameter 6] THEN
([User Id]) END)
ELSE 
sum({include [Source]: ZN(countd(IF [Date]>=[Parameters].[Parameter 5] AND [Date]<=[Parameters].[Parameter 6] THEN
([User Id]) END)*MAX([Calculation_6314891106343211008]))})

 END",
    "name": "[Calculation_1152077103901933571]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Unresolved SSA Leads",
    "datatype": "string",
    "formula": "IF { FIXED [Phone] : MAX([Resolved Lead]) } = 0 THEN "SSA Unresolved Lead"
ELSEIF { FIXED [Phone] : MAX([Resolved Lead]) } = 1 THEN "SSA Resolved Lead"
END",
    "name": "[Calculation_1467962419029331969]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Data Updated On",
    "datatype": "datetime",
    "formula": "{fixed :max([Post Date])}",
    "name": "[Calculation_2010857255412854784]",
    "role": "dimension",
    "type": "ordinal",
  },
  {
    "caption": "CPL New",
    "datatype": "real",
    "formula": "//Updated Date: 18 May 2022
//Updated By: Manish
//Description: Considering CPL if outcome is initialised

IF [Outcome] = 'initialized' THEN [CPL]ELSE 0 END",
    "name": "[Calculation_6314891106343211008]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Grade",
    "datatype": "string",
    "formula": "// Grade A
IF [qual_status] = 'all-steps' THEN 'Grade A'

// Grade B
ELSEIF 
    [qual_status] IN ('fiveyrwrk-disqual','outofwrk-disqual','doc-disqual')
    AND [Calculation_1133007210553765896] = 1
THEN 'Grade B'

// Grade C
ELSEIF 
    [qual_status] <> 'age-disqual'
    AND NOT [Stage3 Response] IN ('Less than 2 years', 'Between 2 and 4 years')
    AND [Stage1 Response] <> 'Social Security Disability (SSD) Benefits'
    AND [Stage6 Response] = 'Not working'
THEN 'Grade C'

// Grade D
ELSEIF 
    // 1) Not age-disqual, Stage3 NOT in those two, Stage1 not SSD, Stage6 ≠ Not working, disqual ≤ 1
    (
      [qual_status] <> 'age-disqual'
      AND NOT [Stage3 Response] IN ('Less than 2 years', 'Between 2 and 4 years')
      AND [Stage1 Response] <> 'Social Security Disability (SSD) Benefits'
      AND [Stage6 Response] <> 'Not working'
      AND [Calculation_1133007210553765896] <= 1
    )
    // 2) Not age-disqual, Stage3 in those two, Qual Status = outofwrk-disqual
    OR
    (
      [qual_status] <> 'age-disqual'
      AND [Stage3 Response] IN ('Less than 2 years', 'Between 2 and 4 years')
      AND [qual_status] = 'outofwrk-disqual'
    )
    // 3) Not age-disqual, Stage3 in those two, Qual Status ≠ outofwrk-disqual, Stage7 = Yes
    OR
    (
      [qual_status] <> 'age-disqual'
      AND [Stage3 Response] IN ('Less than 2 years', 'Between 2 and 4 years')
      AND [qual_status] <> 'outofwrk-disqual'
      AND [Stage7 Response] = 'Yes'
    )
THEN 'Grade D'

// Rest (including age-disqual or anything else)
ELSE 'Rest'
END",
    "name": "[Calculation_7573084309404708864]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Today-28",
    "datatype": "date",
    "formula": "//Updated Date: 18 May 2022
//Updated By: Manish
//Description: Going back 28 days from today

({MAX(today()-28)})",
    "name": "[Calculation_767300790172184597]",
    "role": "dimension",
    "type": "ordinal",
  },
  {
    "caption": "Min Date",
    "datatype": "date",
    "formula": "//Updated Date: 18 May 2022
//Updated By: Manish
//Description: Calculating max of todays date for including it in the default values of start date

{MAX(today()-7)}",
    "name": "[Calculation_843580506575257602]",
    "role": "dimension",
    "type": "ordinal",
  },
  {
    "caption": "Dial R",
    "datatype": "string",
    "formula": "IF  [Called Count] < 4 then "<=3" 
elseif [Called Count] < 8 then "4-7"
elseif [Called Count] < 11 then "8-10"
elseif [Called Count] < 16 then "11-15"
elseif [Called Count] < 20 then "16-19"
elseif [Called Count] < 26 then "20-25"
elseif [Called Count] < 31 then "25-30"
elseif [Called Count] < 36 then "30-35"
else "35+" 
END",
    "name": "[Calculation_847802666706034688]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Dial R (detail)",
    "datatype": "string",
    "formula": "STR([Called Count])",
    "name": "[Calculation_847802666706186241]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Max Date",
    "datatype": "date",
    "formula": "//Updated Date: 18 May 2022
//Updated By: Manish
//Description: Calculating max of todays date for including it in the default values of end date

{MAX(today())}",
    "name": "[Calculation_882424053213511680]",
    "role": "dimension",
    "type": "ordinal",
  },
  {
    "caption": "Date Filter with Comparision Dates",
    "datatype": "boolean",
    "formula": "//Updated Date: 27 Oct 2022
//Updated By: Nithin
//Description: Filtering data based on date

[Date]>=min([Parameters].[Parameter 5],[Parameters].[Start Date (copy)_1152077103891697665]) AND [Date]<=max([Parameters].[Parameter 6],[Parameters].[End Date (copy)_1152077103892365314])",
    "name": "[Date Filter (copy)_1152077103885066240]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Compared Posts & Spends",
    "datatype": "real",
    "formula": "//countd(IF [Day of Post Date]>=[Start Date Comp] AND [Day of Post Date]<=[End Date Comp] then ([User Id]) end)



IF [Parameters].[Parameter 8] = '1' THEN 
countd(IF [Date]>=[Parameters].[Start Date (copy)_1152077103891697665] AND [Date]<=[Parameters].[End Date (copy)_1152077103892365314] THEN
([User Id]) END)
ELSE 
sum({include [Source]: ZN(countd(IF [Date]>=[Parameters].[Start Date (copy)_1152077103891697665] AND [Date]<=[Parameters].[End Date (copy)_1152077103892365314] THEN
([User Id]) END)*MAX([Calculation_6314891106343211008]))})

 END",
    "name": "[Selected Posts (copy)_1152077103904321540]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Leads Upload End Date",
    "datatype": "date",
    "formula": "#2025-07-30#",
    "name": "[End Date (copy)_767300789999759379]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Helper Date",
    "datatype": "string",
    "formula": ""default"",
    "name": "[Parameter 11]",
    "role": "measure",
    "type": "nominal",
  },
  {
    "caption": "Date Bucket",
    "datatype": "string",
    "formula": ""day"",
    "name": "[Parameter 1]",
    "role": "measure",
    "type": "nominal",
  },
  {
    "caption": "Start Date",
    "datatype": "date",
    "formula": "#2025-07-30#",
    "name": "[Parameter 5]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "End Date",
    "datatype": "date",
    "formula": "#2025-08-27#",
    "name": "[Parameter 6]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Leads Upload Start Date",
    "datatype": "date",
    "formula": "#2024-10-31#",
    "name": "[Start Date (copy)_767300789999747090]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "TTW Grade",
    "datatype": "string",
    "formula": "IF [ttw_qualstatus] = 'ttw-qualified' then 'Grade A'
ELSEIF  [ttw_qualstatus] = 'ttw-nonqualified' and [TTW Explore Work Form] = 'yes' THEN 'Grade B'
ELSEIF [ttw_qualstatus] = 'ttw-nonqualified' and [TTW Explore Work Form] != 'yes' THEN 'Grade C'
ELSEIF ISNULL([ttw_qualstatus]) and [Stage3 Response] = 'Between 2 and 4 years' then 'Grade D'
ELSE 'Rest'
END",
    "name": "[Calculation_1006061976934187009]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "20hrs Disqual",
    "datatype": "integer",
    "formula": "IF [Stage6 Response] = "More than 20 hours per week" THEN 1 ELSE 0 END",
    "name": "[Calculation_1133007210546622464]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Age Disqual",
    "datatype": "integer",
    "formula": "IF INT([Age]) < 40 OR INT([Age]) > 62 THEN 1 ELSE 0 END",
    "name": "[Calculation_1133007210553298946]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Attorney Disqual",
    "datatype": "integer",
    "formula": "IF [Stage5 Response] = "Yes" THEN 1 ELSE 0 END",
    "name": "[Calculation_1133007210553425923]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Ben Disqual",
    "datatype": "integer",
    "formula": "IF IFNULL([Stage1 Response], "") != "I am not receiving any disability benefits (SSD or SSI)"
THEN 1 ELSE 0 END",
    "name": "[Calculation_1133007210553487364]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Doctor Visit Disqual",
    "datatype": "integer",
    "formula": "IF [Stage4 Response] = "No" THEN 1 ELSE 0 END",
    "name": "[Calculation_1133007210553540613]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Five Year Work Disqual",
    "datatype": "integer",
    "formula": "IF [Stage3 Response] = "Less than 2 years"
OR [Stage3 Response] = "Between 2 and 4 years"
THEN 1 ELSE 0 END",
    "name": "[Calculation_1133007210553618438]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Out of Work Disqual",
    "datatype": "integer",
    "formula": "IF [Stage2 Response] = "No" THEN 1 ELSE 0 END",
    "name": "[Calculation_1133007210553663495]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "# of Disqual",
    "datatype": "integer",
    "formula": "ZN([Calculation_1133007210553487364]) +
ZN([Calculation_1133007210553663495]) +
ZN([Calculation_1133007210553618438]) +
ZN([Calculation_1133007210553540613]) +
ZN([Calculation_1133007210553425923]) +
ZN([Calculation_1133007210546622464]) +
ZN([Calculation_1133007210553298946])",
    "name": "[Calculation_1133007210553765896]",
    "role": "dimension",
    "type": "ordinal",
  },
  {
    "caption": "Unresolved SSA Leads",
    "datatype": "string",
    "formula": "IF { FIXED [Phone] : MAX([Resolved Lead]) } = 0 THEN "SSA Unresolved Lead"
ELSEIF { FIXED [Phone] : MAX([Resolved Lead]) } = 1 THEN "SSA Resolved Lead"
END",
    "name": "[Calculation_1467962419029331969]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Post Date ",
    "datatype": "datetime",
    "formula": "//Updated Date: 18 May 2022
//Updated By: Manish
//Description: Formula to calculate UTC date

DATEADD("hour",0,[Post Date])",
    "name": "[Calculation_1916563181826678784]",
    "role": "dimension",
    "type": "ordinal",
  },
  {
    "caption": "Campaign + Post Time",
    "datatype": "string",
    "formula": "//Updated Date: 18 May 2022
//Updated By: Manish
//Description: Concatinating campaign and post date

[CZ Project Name]+' - '+[Calculation_97320012552925214]",
    "name": "[Calculation_3528218480124293121]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Grade",
    "datatype": "string",
    "formula": "// Grade A
IF [qual_status] = 'all-steps' THEN 'Grade A'

// Grade B
ELSEIF 
    [qual_status] IN ('fiveyrwrk-disqual','outofwrk-disqual','doc-disqual')
    AND [Calculation_1133007210553765896] = 1
THEN 'Grade B'

// Grade C
ELSEIF 
    [qual_status] <> 'age-disqual'
    AND NOT [Stage3 Response] IN ('Less than 2 years', 'Between 2 and 4 years')
    AND [Stage1 Response] <> 'Social Security Disability (SSD) Benefits'
    AND [Stage6 Response] = 'Not working'
THEN 'Grade C'

// Grade D
ELSEIF 
    // 1) Not age-disqual, Stage3 NOT in those two, Stage1 not SSD, Stage6 ≠ Not working, disqual ≤ 1
    (
      [qual_status] <> 'age-disqual'
      AND NOT [Stage3 Response] IN ('Less than 2 years', 'Between 2 and 4 years')
      AND [Stage1 Response] <> 'Social Security Disability (SSD) Benefits'
      AND [Stage6 Response] <> 'Not working'
      AND [Calculation_1133007210553765896] <= 1
    )
    // 2) Not age-disqual, Stage3 in those two, Qual Status = outofwrk-disqual
    OR
    (
      [qual_status] <> 'age-disqual'
      AND [Stage3 Response] IN ('Less than 2 years', 'Between 2 and 4 years')
      AND [qual_status] = 'outofwrk-disqual'
    )
    // 3) Not age-disqual, Stage3 in those two, Qual Status ≠ outofwrk-disqual, Stage7 = Yes
    OR
    (
      [qual_status] <> 'age-disqual'
      AND [Stage3 Response] IN ('Less than 2 years', 'Between 2 and 4 years')
      AND [qual_status] <> 'outofwrk-disqual'
      AND [Stage7 Response] = 'Yes'
    )
THEN 'Grade D'

// Rest (including age-disqual or anything else)
ELSE 'Rest'
END",
    "name": "[Calculation_7573084309404708864]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Date filter with Start Date",
    "datatype": "boolean",
    "formula": "//Updated Date: 18 May 2022
//Updated By: Manish
//Description: Calculation to apply date filter with respect to leads upload start date

DATE([Calculation_767300790176440343]) >= [Parameters].[Start Date (copy)_767300789999747090] AND  DATE([Calculation_767300790176440343])<=[Parameters].[End Date (copy)_767300789999759379] AND DATE([Calculation_767300790176440343])<=today()-21",
    "name": "[Calculation_767300789999640593]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Today-28",
    "datatype": "date",
    "formula": "//Updated Date: 18 May 2022
//Updated By: Manish
//Description: Going back 28 days from today

({MAX(today()-28)})",
    "name": "[Calculation_767300790172184597]",
    "role": "dimension",
    "type": "ordinal",
  },
  {
    "caption": "Today-300",
    "datatype": "date",
    "formula": "//Updated Date: 18 May 2022
//Updated By: Manish
//Description: Going back 300 days from today

({MAX(today()-300)})",
    "name": "[Calculation_767300790172483606]",
    "role": "dimension",
    "type": "ordinal",
  },
  {
    "caption": "Start Time",
    "datatype": "date",
    "formula": "//DATEADD('hour',0,DATEPARSE('MMM dd, yyyy hh:mm:ss',TRIM(SPLIT([LED].[Start Time],' UTC',1))))
DATE([Calculation_1916563181826678784])",
    "name": "[Calculation_767300790176440343]",
    "role": "dimension",
    "type": "ordinal",
  },
  {
    "caption": "Date Filter",
    "datatype": "boolean",
    "formula": "//Updated Date: 18 May 2022
//Updated By: Manish
//Description: Filtering data based on date

IF [Parameters].[Parameter 11] = 'default'
THEN [Date]>=[Parameters].[Parameter 5] AND [Date]<=[Parameters].[Parameter 6]
ELSEIF [Parameters].[Parameter 11] = 'weekly'
THEN [Date] >= TODAY()-8 AND [Date] <= TODAY()-1
END",
    "name": "[Calculation_843580506575679492]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Dial R",
    "datatype": "string",
    "formula": "IF  [Called Count] < 4 then "<=3" 
elseif [Called Count] < 8 then "4-7"
elseif [Called Count] < 11 then "8-10"
elseif [Called Count] < 16 then "11-15"
elseif [Called Count] < 20 then "16-19"
elseif [Called Count] < 26 then "20-25"
elseif [Called Count] < 31 then "25-30"
elseif [Called Count] < 36 then "30-35"
else "35+" 
END",
    "name": "[Calculation_847802666706034688]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Dial R (detail)",
    "datatype": "string",
    "formula": "STR([Called Count])",
    "name": "[Calculation_847802666706186241]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Max Date",
    "datatype": "date",
    "formula": "//Updated Date: 18 May 2022
//Updated By: Manish
//Description: Calculating max of todays date for including it in the default values of end date

{MAX(today())}",
    "name": "[Calculation_882424053213511680]",
    "role": "dimension",
    "type": "ordinal",
  },
  {
    "caption": "Post Date  ",
    "datatype": "string",
    "formula": "//Updated Date: 18 May 2022
//Updated By: Manish
//Description: Calculation to apply date bucket

CASE [Parameters].[Parameter 1]
WHEN 'year' THEN str(datepart('year', [Calculation_1916563181826678784]))
WHEN 'quarter' THEN "Q" + str(datepart('quarter', [Calculation_1916563181826678784])) + " " + str(datepart('year', [Calculation_1916563181826678784]))
WHEN 'month' THEN str(datepart('month', [Calculation_1916563181826678784])) + "-" + str(datepart('year', [Calculation_1916563181826678784]))
WHEN 'day' THEN str(DATENAME('month', [Calculation_1916563181826678784]))+ "-" +str(datepart('day', [Calculation_1916563181826678784]))+ "-" + str(datepart('year', [Calculation_1916563181826678784]))
WHEN 'week' THEN "W" + str(datepart('week', [Calculation_1916563181826678784])) + "-" + str(datepart('year', [Calculation_1916563181826678784]))
WHEN "hour" THEN str(DATETRUNC('hour', [Calculation_1916563181826678784]))
WHEN "minute" THEN str(DATETRUNC('minute', [Calculation_1916563181826678784]))
END",
    "name": "[Calculation_97320012552925214]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "TTW Grade",
    "datatype": "string",
    "formula": "IF [ttw_qualstatus] = 'ttw-qualified' then 'Grade A'
ELSEIF  [ttw_qualstatus] = 'ttw-nonqualified' and [TTW Explore Work Form] = 'yes' THEN 'Grade B'
ELSEIF [ttw_qualstatus] = 'ttw-nonqualified' and [TTW Explore Work Form] != 'yes' THEN 'Grade C'
ELSEIF ISNULL([ttw_qualstatus]) and [Stage3 Response] = 'Between 2 and 4 years' then 'Grade D'
ELSE 'Rest'
END",
    "name": "[Calculation_1006061976934187009]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Hour of Day",
    "datatype": "string",
    "formula": "IF LEN(STR(DATEPART('hour', [Calculation_1916563181826678784]))) = 1
THEN "0" + STR(DATEPART('hour', [Calculation_1916563181826678784]))
ELSE STR(DATEPART('hour', [Calculation_1916563181826678784]))
END",
    "name": "[Calculation_1113233589182521344]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "20hrs Disqual",
    "datatype": "integer",
    "formula": "IF [Stage6 Response] = "More than 20 hours per week" THEN 1 ELSE 0 END",
    "name": "[Calculation_1133007210546622464]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Age Disqual",
    "datatype": "integer",
    "formula": "IF INT([Age]) < 40 OR INT([Age]) > 62 THEN 1 ELSE 0 END",
    "name": "[Calculation_1133007210553298946]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Attorney Disqual",
    "datatype": "integer",
    "formula": "IF [Stage5 Response] = "Yes" THEN 1 ELSE 0 END",
    "name": "[Calculation_1133007210553425923]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Ben Disqual",
    "datatype": "integer",
    "formula": "IF IFNULL([Stage1 Response], "") != "I am not receiving any disability benefits (SSD or SSI)"
THEN 1 ELSE 0 END",
    "name": "[Calculation_1133007210553487364]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Doctor Visit Disqual",
    "datatype": "integer",
    "formula": "IF [Stage4 Response] = "No" THEN 1 ELSE 0 END",
    "name": "[Calculation_1133007210553540613]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Five Year Work Disqual",
    "datatype": "integer",
    "formula": "IF [Stage3 Response] = "Less than 2 years"
OR [Stage3 Response] = "Between 2 and 4 years"
THEN 1 ELSE 0 END",
    "name": "[Calculation_1133007210553618438]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Out of Work Disqual",
    "datatype": "integer",
    "formula": "IF [Stage2 Response] = "No" THEN 1 ELSE 0 END",
    "name": "[Calculation_1133007210553663495]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "# of Disqual",
    "datatype": "integer",
    "formula": "ZN([Calculation_1133007210553487364]) +
ZN([Calculation_1133007210553663495]) +
ZN([Calculation_1133007210553618438]) +
ZN([Calculation_1133007210553540613]) +
ZN([Calculation_1133007210553425923]) +
ZN([Calculation_1133007210546622464]) +
ZN([Calculation_1133007210553298946])",
    "name": "[Calculation_1133007210553765896]",
    "role": "dimension",
    "type": "ordinal",
  },
  {
    "caption": "Levine States ",
    "datatype": "string",
    "formula": "IF ISNULL([Levine States]) THEN 'Other'
ELSE [Levine States] END",
    "name": "[Calculation_1277614987429064704]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "DP Leak",
    "datatype": "string",
    "formula": "IF CONTAINS([clientname], 'disabilitypath')
AND [Calculation_7573084309404708864] in ('Grade A', 'Grade B')
THEN 'Yes'
ELSE 'No'
END",
    "name": "[Calculation_1460573688699854848]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Unresolved SSA Leads",
    "datatype": "string",
    "formula": "IF { FIXED [Phone] : MAX([Resolved Lead]) } = 0 THEN "SSA Unresolved Lead"
ELSEIF { FIXED [Phone] : MAX([Resolved Lead]) } = 1 THEN "SSA Resolved Lead"
END",
    "name": "[Calculation_1467962419029331969]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "CTC Lead Flag",
    "datatype": "string",
    "formula": "if [CTC Lead] = 1 then "Yes" else "No" END",
    "name": "[Calculation_1880252886088871936]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "CZ Post Hour Group",
    "datatype": "string",
    "formula": "IF DATEPART('hour', [Post Date]) >= 0 AND DATEPART('hour', [Post Date]) < 6 THEN 'Pre CC Hours'
ELSEIF DATEPART('hour', [Post Date]) >= 6 AND DATEPART('hour', [Post Date]) < 16 THEN 'CC Hours'
ELSEIF DATEPART('hour', [Post Date]) >= 16 AND DATEPART('hour', [Post Date]) < 24 THEN 'Post CC Hours'
END",
    "name": "[Calculation_1880252886125215747]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Post Date ",
    "datatype": "datetime",
    "formula": "//Updated Date: 18 May 2022
//Updated By: Manish
//Description: Formula to calculate UTC date

DATEADD("hour",0,[Post Date])",
    "name": "[Calculation_1916563181826678784]",
    "role": "dimension",
    "type": "ordinal",
  },
  {
    "caption": "Data Updated On",
    "datatype": "datetime",
    "formula": "{fixed :max([Post Date])}",
    "name": "[Calculation_2010857255412854784]",
    "role": "dimension",
    "type": "ordinal",
  },
  {
    "caption": "Lead Sell Type",
    "datatype": "string",
    "formula": "if contains([Transfer Info Label],'CXER') then 'Sold: Call' 
elseif 
contains([sgmt],'ql-leadbuy') or 
contains([ATA Work],'ql-leadbuy')
then 'Sold: Lead'
else 'Internal'
end",
    "name": "[Calculation_3435894714053935109]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Seg4 Control vs. Treatment",
    "datatype": "string",
    "formula": "IF [CZ Project Name] = "Mass Tort - High Intent SSDI" AND [Calculation_1880252886088871936] = "No" AND [qual_status] != "all-steps" THEN
    IF INT(RIGHT([phone masked], 3)) % 2 = 0 THEN "Control"
    ELSEIF INT(RIGHT([phone masked], 3)) % 2 != 0 THEN "Treatment"
    END
END",
    "name": "[Calculation_4531465651676315649]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Seg4 Cohort",
    "datatype": "string",
    "formula": "LOWER(IFNULL([seg4_cohort], [Calculation_4531465651676315649]))",
    "name": "[Calculation_4531465651676438530]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Campaign & Day of Post Date",
    "datatype": "string",
    "formula": "//Updated Date: 18 May 2022
//Updated By: Manish
//Description: Concatinating campaigna and date in UTC

[CZ Project Name]+":"+ STR([Calculation_1916563181826678784])",
    "name": "[Calculation_4891401821032828929]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Time to Call (Minute)",
    "datatype": "real",
    "formula": "IF [Calculation_1880252886088871936] = 'Yes'
THEN ROUND(([CTC Time] - [Post Date]) * 24 * 60, 2)
END",
    "name": "[Calculation_499055157752631296]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Time to Call Bucket",
    "datatype": "string",
    "formula": "IF  [Calculation_499055157752631296] < 0
THEN '<0 Mins'
ELSEIF [Calculation_499055157752631296] <= 2 AND [Calculation_499055157752631296] >= 0
THEN '0-2 Mins'
ELSEIF [Calculation_499055157752631296] <= 5 AND [Calculation_499055157752631296] > 0
THEN '2-5 Mins'
ELSEIF [Calculation_499055157752631296] <= 10 AND [Calculation_499055157752631296] > 0
THEN '5-10 Mins'
ELSEIF [Calculation_499055157752631296] <= 30 AND [Calculation_499055157752631296] > 0 
THEN '10-30 Mins'
ELSEIF [Calculation_499055157752631296] <= 60 AND [Calculation_499055157752631296] > 0
THEN '30Mins-1 Hour'
ELSEIF [Calculation_499055157752631296] <= 300 AND [Calculation_499055157752631296] > 0
THEN '1-5 Hours'
ELSEIF [Calculation_499055157752631296] <= 600 AND [Calculation_499055157752631296] > 0
THEN '5-10 Hours'
ELSEIF [Calculation_499055157752631296] <= 1440 AND [Calculation_499055157752631296] > 0
THEN '10-24 Hours'
ELSEIF [Calculation_499055157752631296] <= 4320 AND [Calculation_499055157752631296] > 0
THEN '24-72 Hours'
ELSEIF [Calculation_499055157752631296] > 4320 AND [Calculation_499055157752631296] > 0
THEN '>72 Hours'
END",
    "name": "[Calculation_499055157754740737]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Project Type",
    "datatype": "string",
    "formula": "IF CONTAINS([CZ Project Name],'Aged') THEN 'Aged'
ELSE 'Live' END",
    "name": "[Calculation_5872834692856524810]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Grade",
    "datatype": "string",
    "formula": "// Grade A
IF [qual_status] = 'all-steps' THEN 'Grade A'

// Grade B
ELSEIF 
    [qual_status] IN ('fiveyrwrk-disqual','outofwrk-disqual','doc-disqual')
    AND [Calculation_1133007210553765896] = 1
THEN 'Grade B'

// Grade C
ELSEIF 
    [qual_status] <> 'age-disqual'
    AND NOT [Stage3 Response] IN ('Less than 2 years', 'Between 2 and 4 years')
    AND [Stage1 Response] <> 'Social Security Disability (SSD) Benefits'
    AND [Stage6 Response] = 'Not working'
THEN 'Grade C'

// Grade D
ELSEIF 
    // 1) Not age-disqual, Stage3 NOT in those two, Stage1 not SSD, Stage6 ≠ Not working, disqual ≤ 1
    (
      [qual_status] <> 'age-disqual'
      AND NOT [Stage3 Response] IN ('Less than 2 years', 'Between 2 and 4 years')
      AND [Stage1 Response] <> 'Social Security Disability (SSD) Benefits'
      AND [Stage6 Response] <> 'Not working'
      AND [Calculation_1133007210553765896] <= 1
    )
    // 2) Not age-disqual, Stage3 in those two, Qual Status = outofwrk-disqual
    OR
    (
      [qual_status] <> 'age-disqual'
      AND [Stage3 Response] IN ('Less than 2 years', 'Between 2 and 4 years')
      AND [qual_status] = 'outofwrk-disqual'
    )
    // 3) Not age-disqual, Stage3 in those two, Qual Status ≠ outofwrk-disqual, Stage7 = Yes
    OR
    (
      [qual_status] <> 'age-disqual'
      AND [Stage3 Response] IN ('Less than 2 years', 'Between 2 and 4 years')
      AND [qual_status] <> 'outofwrk-disqual'
      AND [Stage7 Response] = 'Yes'
    )
THEN 'Grade D'

// Rest (including age-disqual or anything else)
ELSE 'Rest'
END",
    "name": "[Calculation_7573084309404708864]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Hours Since Sat",
    "datatype": "integer",
    "formula": "//Updated Date: 18 May 2022
//Updated By: Manish
//Description: Calculating the differnce in hours since the previous saturday

//date_part(h, getdate()) + ((date_part(dow, getdate())+1)*24) +7

{MAX(DATEDIFF('hour',DATEADD('day',-1,Datetrunc('week',today())),now()))}",
    "name": "[Calculation_767300789949067266]",
    "role": "dimension",
    "type": "ordinal",
  },
  {
    "caption": "RUNNING_SUM(SUM(ZN([CPL])))",
    "datatype": "real",
    "formula": "RUNNING_SUM(SUM(ZN([CPL])))",
    "name": "[Calculation_767300789956329478]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "CPL is Null?",
    "datatype": "boolean",
    "formula": "//Updated Date: 18 May 2022
//Updated By: Manish
//Description: Checking if CPL column is null or not

NOT ISNULL([CPL])",
    "name": "[Calculation_767300789958365193]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "SSD Age Range",
    "datatype": "string",
    "formula": "IF DATE([Calculation_1916563181826678784]) >= #18/08/2025#
THEN
    IF INT([Age]) < 40 THEN "U40"
    ELSEIF INT([Age]) >= 40 AND INT([Age]) <= 49 THEN "40 - 49"
	ELSEIF INT([Age]) >= 50 AND INT([Age]) <= 54 THEN "50 - 54"
    ELSEIF INT([Age]) >= 55 AND INT([Age]) <= 63 THEN "55 - 63"
    ELSEIF INT([Age]) >= 64 THEN "O64+"
    END
ELSEIF INT([Age]) < 40 THEN "*U40"
ELSEIF INT([Age]) >= 40 AND INT([Age]) <= 48 THEN "*40-48"
ELSEIF INT([Age]) = 49 THEN "*49"
ELSEIF INT([Age]) >= 50 AND INT([Age]) <= 62 THEN "*50-62"
ELSEIF INT([Age]) >= 63 THEN "*O63+" 
END",
    "name": "[Calculation_7690318609259716608]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Dial R",
    "datatype": "string",
    "formula": "IF  [Called Count] < 4 then "<=3" 
elseif [Called Count] < 8 then "4-7"
elseif [Called Count] < 11 then "8-10"
elseif [Called Count] < 16 then "11-15"
elseif [Called Count] < 20 then "16-19"
elseif [Called Count] < 26 then "20-25"
elseif [Called Count] < 31 then "25-30"
elseif [Called Count] < 36 then "30-35"
else "35+" 
END",
    "name": "[Calculation_847802666706034688]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Dial R (detail)",
    "datatype": "string",
    "formula": "STR([Called Count])",
    "name": "[Calculation_847802666706186241]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Alt. Branding",
    "datatype": "string",
    "formula": "If int(Right([Phone],2))<30 and [Calculation_5872834692856524810]= 'Live' then 'Yes' else 'No' End",
    "name": "[Calculation_935059914517495808]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Duplicate Rejects",
    "datatype": "string",
    "formula": "if [Outcome]='rejected' and { FIXED [Phone], [Outcome]: COUNTD([User Id])}>1 then 'Yes' else 'No' end",
    "name": "[Calculation_943222690415542272]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Vici Post Delay (Days)",
    "datatype": "integer",
    "formula": "DATEDIFF('day', [Post Date], [Entry Time])",
    "name": "[Calculation_989947527401095169]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Projected Cost",
    "datatype": "real",
    "formula": "//Updated Date: 18 May 2022
//Updated By: Manish
//Description: Calculating the sum of CPL for each day from saturday excluding campaign and datetime

{EXCLUDE [Calculation_4891401821032828929]:SUM(ZN(CPL))}*(24*7)/[Calculation_767300789949067266]",
    "name": "[Running Cost (copy)_450922980938579970]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "State Exclusions",
    "datatype": "string",
    "formula": "[State]",
    "name": "[state (copy)_2399292755821703168]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "TTW Grade",
    "datatype": "string",
    "formula": "IF [ttw_qualstatus] = 'ttw-qualified' then 'Grade A'
ELSEIF  [ttw_qualstatus] = 'ttw-nonqualified' and [TTW Explore Work Form] = 'yes' THEN 'Grade B'
ELSEIF [ttw_qualstatus] = 'ttw-nonqualified' and [TTW Explore Work Form] != 'yes' THEN 'Grade C'
ELSEIF ISNULL([ttw_qualstatus]) and [Stage3 Response] = 'Between 2 and 4 years' then 'Grade D'
ELSE 'Rest'
END",
    "name": "[Calculation_1006061976934187009]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "20hrs Disqual",
    "datatype": "integer",
    "formula": "IF [Stage6 Response] = "More than 20 hours per week" THEN 1 ELSE 0 END",
    "name": "[Calculation_1133007210546622464]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Age Disqual",
    "datatype": "integer",
    "formula": "IF INT([Age]) < 40 OR INT([Age]) > 62 THEN 1 ELSE 0 END",
    "name": "[Calculation_1133007210553298946]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Attorney Disqual",
    "datatype": "integer",
    "formula": "IF [Stage5 Response] = "Yes" THEN 1 ELSE 0 END",
    "name": "[Calculation_1133007210553425923]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Ben Disqual",
    "datatype": "integer",
    "formula": "IF IFNULL([Stage1 Response], "") != "I am not receiving any disability benefits (SSD or SSI)"
THEN 1 ELSE 0 END",
    "name": "[Calculation_1133007210553487364]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Doctor Visit Disqual",
    "datatype": "integer",
    "formula": "IF [Stage4 Response] = "No" THEN 1 ELSE 0 END",
    "name": "[Calculation_1133007210553540613]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Five Year Work Disqual",
    "datatype": "integer",
    "formula": "IF [Stage3 Response] = "Less than 2 years"
OR [Stage3 Response] = "Between 2 and 4 years"
THEN 1 ELSE 0 END",
    "name": "[Calculation_1133007210553618438]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Out of Work Disqual",
    "datatype": "integer",
    "formula": "IF [Stage2 Response] = "No" THEN 1 ELSE 0 END",
    "name": "[Calculation_1133007210553663495]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "# of Disqual",
    "datatype": "integer",
    "formula": "ZN([Calculation_1133007210553487364]) +
ZN([Calculation_1133007210553663495]) +
ZN([Calculation_1133007210553618438]) +
ZN([Calculation_1133007210553540613]) +
ZN([Calculation_1133007210553425923]) +
ZN([Calculation_1133007210546622464]) +
ZN([Calculation_1133007210553298946])",
    "name": "[Calculation_1133007210553765896]",
    "role": "dimension",
    "type": "ordinal",
  },
  {
    "caption": "Unresolved SSA Leads",
    "datatype": "string",
    "formula": "IF { FIXED [Phone] : MAX([Resolved Lead]) } = 0 THEN "SSA Unresolved Lead"
ELSEIF { FIXED [Phone] : MAX([Resolved Lead]) } = 1 THEN "SSA Resolved Lead"
END",
    "name": "[Calculation_1467962419029331969]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Post Date ",
    "datatype": "datetime",
    "formula": "//Updated Date: 18 May 2022
//Updated By: Manish
//Description: Formula to calculate UTC date

DATEADD("hour",0,[Post Date])",
    "name": "[Calculation_1916563181826678784]",
    "role": "dimension",
    "type": "ordinal",
  },
  {
    "caption": "Data Updated On",
    "datatype": "datetime",
    "formula": "{fixed :max([Post Date])}",
    "name": "[Calculation_2010857255412854784]",
    "role": "dimension",
    "type": "ordinal",
  },
  {
    "caption": "Campaign & Day of Post Date",
    "datatype": "string",
    "formula": "//Updated Date: 18 May 2022
//Updated By: Manish
//Description: Concatinating campaigna and date in UTC

[CZ Project Name]+":"+ STR([Calculation_1916563181826678784])",
    "name": "[Calculation_4891401821032828929]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Grade",
    "datatype": "string",
    "formula": "// Grade A
IF [qual_status] = 'all-steps' THEN 'Grade A'

// Grade B
ELSEIF 
    [qual_status] IN ('fiveyrwrk-disqual','outofwrk-disqual','doc-disqual')
    AND [Calculation_1133007210553765896] = 1
THEN 'Grade B'

// Grade C
ELSEIF 
    [qual_status] <> 'age-disqual'
    AND NOT [Stage3 Response] IN ('Less than 2 years', 'Between 2 and 4 years')
    AND [Stage1 Response] <> 'Social Security Disability (SSD) Benefits'
    AND [Stage6 Response] = 'Not working'
THEN 'Grade C'

// Grade D
ELSEIF 
    // 1) Not age-disqual, Stage3 NOT in those two, Stage1 not SSD, Stage6 ≠ Not working, disqual ≤ 1
    (
      [qual_status] <> 'age-disqual'
      AND NOT [Stage3 Response] IN ('Less than 2 years', 'Between 2 and 4 years')
      AND [Stage1 Response] <> 'Social Security Disability (SSD) Benefits'
      AND [Stage6 Response] <> 'Not working'
      AND [Calculation_1133007210553765896] <= 1
    )
    // 2) Not age-disqual, Stage3 in those two, Qual Status = outofwrk-disqual
    OR
    (
      [qual_status] <> 'age-disqual'
      AND [Stage3 Response] IN ('Less than 2 years', 'Between 2 and 4 years')
      AND [qual_status] = 'outofwrk-disqual'
    )
    // 3) Not age-disqual, Stage3 in those two, Qual Status ≠ outofwrk-disqual, Stage7 = Yes
    OR
    (
      [qual_status] <> 'age-disqual'
      AND [Stage3 Response] IN ('Less than 2 years', 'Between 2 and 4 years')
      AND [qual_status] <> 'outofwrk-disqual'
      AND [Stage7 Response] = 'Yes'
    )
THEN 'Grade D'

// Rest (including age-disqual or anything else)
ELSE 'Rest'
END",
    "name": "[Calculation_7573084309404708864]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Hours Since Sat",
    "datatype": "integer",
    "formula": "//Updated Date: 18 May 2022
//Updated By: Manish
//Description: Calculating the differnce in hours since the previous saturday

//date_part(h, getdate()) + ((date_part(dow, getdate())+1)*24) +7

{MAX(DATEDIFF('hour',DATEADD('day',-1,Datetrunc('week',today())),now()))}",
    "name": "[Calculation_767300789949067266]",
    "role": "dimension",
    "type": "ordinal",
  },
  {
    "caption": "RUNNING_SUM(SUM(ZN([CPL])))",
    "datatype": "real",
    "formula": "RUNNING_SUM(SUM(ZN([CPL])))",
    "name": "[Calculation_767300789956329478]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "CPL is Null?",
    "datatype": "boolean",
    "formula": "//Updated Date: 18 May 2022
//Updated By: Manish
//Description: Checking if CPL column is null or not

NOT ISNULL([CPL])",
    "name": "[Calculation_767300789958365193]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Dial R",
    "datatype": "string",
    "formula": "IF  [Called Count] < 4 then "<=3" 
elseif [Called Count] < 8 then "4-7"
elseif [Called Count] < 11 then "8-10"
elseif [Called Count] < 16 then "11-15"
elseif [Called Count] < 20 then "16-19"
elseif [Called Count] < 26 then "20-25"
elseif [Called Count] < 31 then "25-30"
elseif [Called Count] < 36 then "30-35"
else "35+" 
END",
    "name": "[Calculation_847802666706034688]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Dial R (detail)",
    "datatype": "string",
    "formula": "STR([Called Count])",
    "name": "[Calculation_847802666706186241]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Projected Cost",
    "datatype": "real",
    "formula": "//Updated Date: 18 May 2022
//Updated By: Manish
//Description: Calculating the sum of CPL for each day from saturday excluding campaign and datetime

{EXCLUDE [Calculation_4891401821032828929]:SUM(ZN(CPL))}*(24*7)/[Calculation_767300789949067266]",
    "name": "[Running Cost (copy)_450922980938579970]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Helper Date",
    "datatype": "string",
    "formula": ""default"",
    "name": "[Parameter 11]",
    "role": "measure",
    "type": "nominal",
  },
  {
    "caption": "User Identifier",
    "datatype": "integer",
    "formula": "0",
    "name": "[Parameter 12]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Date Bucket",
    "datatype": "string",
    "formula": ""day"",
    "name": "[Parameter 1]",
    "role": "measure",
    "type": "nominal",
  },
  {
    "caption": "Start Date",
    "datatype": "date",
    "formula": "#2025-07-30#",
    "name": "[Parameter 5]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "End Date",
    "datatype": "date",
    "formula": "#2025-08-27#",
    "name": "[Parameter 6]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "TTW Grade",
    "datatype": "string",
    "formula": "IF [ttw_qualstatus] = 'ttw-qualified' then 'Grade A'
ELSEIF  [ttw_qualstatus] = 'ttw-nonqualified' and [TTW Explore Work Form] = 'yes' THEN 'Grade B'
ELSEIF [ttw_qualstatus] = 'ttw-nonqualified' and [TTW Explore Work Form] != 'yes' THEN 'Grade C'
ELSEIF ISNULL([ttw_qualstatus]) and [Stage3 Response] = 'Between 2 and 4 years' then 'Grade D'
ELSE 'Rest'
END",
    "name": "[Calculation_1006061976934187009]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "20hrs Disqual",
    "datatype": "integer",
    "formula": "IF [Stage6 Response] = "More than 20 hours per week" THEN 1 ELSE 0 END",
    "name": "[Calculation_1133007210546622464]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Age Disqual",
    "datatype": "integer",
    "formula": "IF INT([Age]) < 40 OR INT([Age]) > 62 THEN 1 ELSE 0 END",
    "name": "[Calculation_1133007210553298946]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Attorney Disqual",
    "datatype": "integer",
    "formula": "IF [Stage5 Response] = "Yes" THEN 1 ELSE 0 END",
    "name": "[Calculation_1133007210553425923]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Ben Disqual",
    "datatype": "integer",
    "formula": "IF IFNULL([Stage1 Response], "") != "I am not receiving any disability benefits (SSD or SSI)"
THEN 1 ELSE 0 END",
    "name": "[Calculation_1133007210553487364]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Doctor Visit Disqual",
    "datatype": "integer",
    "formula": "IF [Stage4 Response] = "No" THEN 1 ELSE 0 END",
    "name": "[Calculation_1133007210553540613]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Five Year Work Disqual",
    "datatype": "integer",
    "formula": "IF [Stage3 Response] = "Less than 2 years"
OR [Stage3 Response] = "Between 2 and 4 years"
THEN 1 ELSE 0 END",
    "name": "[Calculation_1133007210553618438]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Out of Work Disqual",
    "datatype": "integer",
    "formula": "IF [Stage2 Response] = "No" THEN 1 ELSE 0 END",
    "name": "[Calculation_1133007210553663495]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "# of Disqual",
    "datatype": "integer",
    "formula": "ZN([Calculation_1133007210553487364]) +
ZN([Calculation_1133007210553663495]) +
ZN([Calculation_1133007210553618438]) +
ZN([Calculation_1133007210553540613]) +
ZN([Calculation_1133007210553425923]) +
ZN([Calculation_1133007210546622464]) +
ZN([Calculation_1133007210553298946])",
    "name": "[Calculation_1133007210553765896]",
    "role": "dimension",
    "type": "ordinal",
  },
  {
    "caption": "Unresolved SSA Leads",
    "datatype": "string",
    "formula": "IF { FIXED [Phone] : MAX([Resolved Lead]) } = 0 THEN "SSA Unresolved Lead"
ELSEIF { FIXED [Phone] : MAX([Resolved Lead]) } = 1 THEN "SSA Resolved Lead"
END",
    "name": "[Calculation_1467962419029331969]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Post Date ",
    "datatype": "datetime",
    "formula": "//Updated Date: 18 May 2022
//Updated By: Manish
//Description: Formula to calculate UTC date

DATEADD("hour",0,[Post Date])",
    "name": "[Calculation_1916563181826678784]",
    "role": "dimension",
    "type": "ordinal",
  },
  {
    "caption": "Data Updated On",
    "datatype": "datetime",
    "formula": "{fixed :max([Post Date])}",
    "name": "[Calculation_2010857255412854784]",
    "role": "dimension",
    "type": "ordinal",
  },
  {
    "caption": "TOTAL([Posted #])",
    "datatype": "integer",
    "formula": "TOTAL([Calculation_99712551082803223])",
    "name": "[Calculation_4891401821048414216]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Grade",
    "datatype": "string",
    "formula": "// Grade A
IF [qual_status] = 'all-steps' THEN 'Grade A'

// Grade B
ELSEIF 
    [qual_status] IN ('fiveyrwrk-disqual','outofwrk-disqual','doc-disqual')
    AND [Calculation_1133007210553765896] = 1
THEN 'Grade B'

// Grade C
ELSEIF 
    [qual_status] <> 'age-disqual'
    AND NOT [Stage3 Response] IN ('Less than 2 years', 'Between 2 and 4 years')
    AND [Stage1 Response] <> 'Social Security Disability (SSD) Benefits'
    AND [Stage6 Response] = 'Not working'
THEN 'Grade C'

// Grade D
ELSEIF 
    // 1) Not age-disqual, Stage3 NOT in those two, Stage1 not SSD, Stage6 ≠ Not working, disqual ≤ 1
    (
      [qual_status] <> 'age-disqual'
      AND NOT [Stage3 Response] IN ('Less than 2 years', 'Between 2 and 4 years')
      AND [Stage1 Response] <> 'Social Security Disability (SSD) Benefits'
      AND [Stage6 Response] <> 'Not working'
      AND [Calculation_1133007210553765896] <= 1
    )
    // 2) Not age-disqual, Stage3 in those two, Qual Status = outofwrk-disqual
    OR
    (
      [qual_status] <> 'age-disqual'
      AND [Stage3 Response] IN ('Less than 2 years', 'Between 2 and 4 years')
      AND [qual_status] = 'outofwrk-disqual'
    )
    // 3) Not age-disqual, Stage3 in those two, Qual Status ≠ outofwrk-disqual, Stage7 = Yes
    OR
    (
      [qual_status] <> 'age-disqual'
      AND [Stage3 Response] IN ('Less than 2 years', 'Between 2 and 4 years')
      AND [qual_status] <> 'outofwrk-disqual'
      AND [Stage7 Response] = 'Yes'
    )
THEN 'Grade D'

// Rest (including age-disqual or anything else)
ELSE 'Rest'
END",
    "name": "[Calculation_7573084309404708864]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Today-28",
    "datatype": "date",
    "formula": "//Updated Date: 18 May 2022
//Updated By: Manish
//Description: Going back 28 days from today

({MAX(today()-28)})",
    "name": "[Calculation_767300790172184597]",
    "role": "dimension",
    "type": "ordinal",
  },
  {
    "caption": "Time-Source-Subid",
    "datatype": "string",
    "formula": "//Updated Date: 18 May 2022
//Updated By: Manish
//Description: Changing the data type to string of Time-Source-Subid column

STR([Date])+'-'+[Source]+'-'+[Sub Id]",
    "name": "[Calculation_7746824680808361990]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Date Filter",
    "datatype": "boolean",
    "formula": "//Updated Date: 18 May 2022
//Updated By: Manish
//Description: Filtering data based on date

IF [Parameters].[Parameter 11] = 'default'
THEN [Date]>=[Parameters].[Parameter 5] AND [Date]<=[Parameters].[Parameter 6]
ELSEIF [Parameters].[Parameter 11] = 'weekly'
THEN [Date] >= TODAY()-8 AND [Date] <= TODAY()-1
END",
    "name": "[Calculation_843580506575679492]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Dial R",
    "datatype": "string",
    "formula": "IF  [Called Count] < 4 then "<=3" 
elseif [Called Count] < 8 then "4-7"
elseif [Called Count] < 11 then "8-10"
elseif [Called Count] < 16 then "11-15"
elseif [Called Count] < 20 then "16-19"
elseif [Called Count] < 26 then "20-25"
elseif [Called Count] < 31 then "25-30"
elseif [Called Count] < 36 then "30-35"
else "35+" 
END",
    "name": "[Calculation_847802666706034688]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Dial R (detail)",
    "datatype": "string",
    "formula": "STR([Called Count])",
    "name": "[Calculation_847802666706186241]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Max Date",
    "datatype": "date",
    "formula": "//Updated Date: 18 May 2022
//Updated By: Manish
//Description: Calculating max of todays date for including it in the default values of end date

{MAX(today())}",
    "name": "[Calculation_882424053213511680]",
    "role": "dimension",
    "type": "ordinal",
  },
  {
    "caption": "User Identifier",
    "datatype": "string",
    "formula": "IF [Parameters].[Parameter 12] = 0 THEN [User Id]
ELSEIF [Parameters].[Parameter 12] = 1 THEN [Phone]
END",
    "name": "[Calculation_906349454594166784]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Post Date  ",
    "datatype": "string",
    "formula": "//Updated Date: 18 May 2022
//Updated By: Manish
//Description: Calculation to apply date bucket

CASE [Parameters].[Parameter 1]
WHEN 'year' THEN str(datepart('year', [Calculation_1916563181826678784]))
WHEN 'quarter' THEN "Q" + str(datepart('quarter', [Calculation_1916563181826678784])) + " " + str(datepart('year', [Calculation_1916563181826678784]))
WHEN 'month' THEN str(datepart('month', [Calculation_1916563181826678784])) + "-" + str(datepart('year', [Calculation_1916563181826678784]))
WHEN 'day' THEN str(DATENAME('month', [Calculation_1916563181826678784]))+ "-" +str(datepart('day', [Calculation_1916563181826678784]))+ "-" + str(datepart('year', [Calculation_1916563181826678784]))
WHEN 'week' THEN "W" + str(datepart('week', [Calculation_1916563181826678784])) + "-" + str(datepart('year', [Calculation_1916563181826678784]))
WHEN "hour" THEN str(DATETRUNC('hour', [Calculation_1916563181826678784]))
WHEN "minute" THEN str(DATETRUNC('minute', [Calculation_1916563181826678784]))
END",
    "name": "[Calculation_97320012552925214]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Posted #",
    "datatype": "integer",
    "formula": "//Updated Date: 18 May 2022
//Updated By: Manish
//Description: Calculating the sum of user id wrt to source

countd([Calculation_906349454594166784])",
    "name": "[Calculation_99712551082803223]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Source - Date",
    "datatype": "string",
    "formula": "//Updated Date: 18 May 2022
//Updated By: Manish//Description: Calculating max of todays date for including it in the default values of end date
//Description: Concatinating source and date column

[Source]+":"+[Calculation_97320012552925214]",
    "name": "[Calculation_99712551088799768]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "TTW Grade",
    "datatype": "string",
    "formula": "IF [ttw_qualstatus] = 'ttw-qualified' then 'Grade A'
ELSEIF  [ttw_qualstatus] = 'ttw-nonqualified' and [TTW Explore Work Form] = 'yes' THEN 'Grade B'
ELSEIF [ttw_qualstatus] = 'ttw-nonqualified' and [TTW Explore Work Form] != 'yes' THEN 'Grade C'
ELSEIF ISNULL([ttw_qualstatus]) and [Stage3 Response] = 'Between 2 and 4 years' then 'Grade D'
ELSE 'Rest'
END",
    "name": "[Calculation_1006061976934187009]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "20hrs Disqual",
    "datatype": "integer",
    "formula": "IF [Stage6 Response] = "More than 20 hours per week" THEN 1 ELSE 0 END",
    "name": "[Calculation_1133007210546622464]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Age Disqual",
    "datatype": "integer",
    "formula": "IF INT([Age]) < 40 OR INT([Age]) > 62 THEN 1 ELSE 0 END",
    "name": "[Calculation_1133007210553298946]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Attorney Disqual",
    "datatype": "integer",
    "formula": "IF [Stage5 Response] = "Yes" THEN 1 ELSE 0 END",
    "name": "[Calculation_1133007210553425923]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Ben Disqual",
    "datatype": "integer",
    "formula": "IF IFNULL([Stage1 Response], "") != "I am not receiving any disability benefits (SSD or SSI)"
THEN 1 ELSE 0 END",
    "name": "[Calculation_1133007210553487364]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Doctor Visit Disqual",
    "datatype": "integer",
    "formula": "IF [Stage4 Response] = "No" THEN 1 ELSE 0 END",
    "name": "[Calculation_1133007210553540613]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Five Year Work Disqual",
    "datatype": "integer",
    "formula": "IF [Stage3 Response] = "Less than 2 years"
OR [Stage3 Response] = "Between 2 and 4 years"
THEN 1 ELSE 0 END",
    "name": "[Calculation_1133007210553618438]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Out of Work Disqual",
    "datatype": "integer",
    "formula": "IF [Stage2 Response] = "No" THEN 1 ELSE 0 END",
    "name": "[Calculation_1133007210553663495]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "# of Disqual",
    "datatype": "integer",
    "formula": "ZN([Calculation_1133007210553487364]) +
ZN([Calculation_1133007210553663495]) +
ZN([Calculation_1133007210553618438]) +
ZN([Calculation_1133007210553540613]) +
ZN([Calculation_1133007210553425923]) +
ZN([Calculation_1133007210546622464]) +
ZN([Calculation_1133007210553298946])",
    "name": "[Calculation_1133007210553765896]",
    "role": "dimension",
    "type": "ordinal",
  },
  {
    "caption": "Unresolved SSA Leads",
    "datatype": "string",
    "formula": "IF { FIXED [Phone] : MAX([Resolved Lead]) } = 0 THEN "SSA Unresolved Lead"
ELSEIF { FIXED [Phone] : MAX([Resolved Lead]) } = 1 THEN "SSA Resolved Lead"
END",
    "name": "[Calculation_1467962419029331969]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Grade",
    "datatype": "string",
    "formula": "// Grade A
IF [qual_status] = 'all-steps' THEN 'Grade A'

// Grade B
ELSEIF 
    [qual_status] IN ('fiveyrwrk-disqual','outofwrk-disqual','doc-disqual')
    AND [Calculation_1133007210553765896] = 1
THEN 'Grade B'

// Grade C
ELSEIF 
    [qual_status] <> 'age-disqual'
    AND NOT [Stage3 Response] IN ('Less than 2 years', 'Between 2 and 4 years')
    AND [Stage1 Response] <> 'Social Security Disability (SSD) Benefits'
    AND [Stage6 Response] = 'Not working'
THEN 'Grade C'

// Grade D
ELSEIF 
    // 1) Not age-disqual, Stage3 NOT in those two, Stage1 not SSD, Stage6 ≠ Not working, disqual ≤ 1
    (
      [qual_status] <> 'age-disqual'
      AND NOT [Stage3 Response] IN ('Less than 2 years', 'Between 2 and 4 years')
      AND [Stage1 Response] <> 'Social Security Disability (SSD) Benefits'
      AND [Stage6 Response] <> 'Not working'
      AND [Calculation_1133007210553765896] <= 1
    )
    // 2) Not age-disqual, Stage3 in those two, Qual Status = outofwrk-disqual
    OR
    (
      [qual_status] <> 'age-disqual'
      AND [Stage3 Response] IN ('Less than 2 years', 'Between 2 and 4 years')
      AND [qual_status] = 'outofwrk-disqual'
    )
    // 3) Not age-disqual, Stage3 in those two, Qual Status ≠ outofwrk-disqual, Stage7 = Yes
    OR
    (
      [qual_status] <> 'age-disqual'
      AND [Stage3 Response] IN ('Less than 2 years', 'Between 2 and 4 years')
      AND [qual_status] <> 'outofwrk-disqual'
      AND [Stage7 Response] = 'Yes'
    )
THEN 'Grade D'

// Rest (including age-disqual or anything else)
ELSE 'Rest'
END",
    "name": "[Calculation_7573084309404708864]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Time-Source-Subid",
    "datatype": "string",
    "formula": "//Updated Date: 18 May 2022
//Updated By: Manish
//Description: Changing the data type to string of Time-Source-Subid column

STR([Date])+'-'+[Source]+'-'+[Sub Id]",
    "name": "[Calculation_7746824680808361990]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Dial R",
    "datatype": "string",
    "formula": "IF  [Called Count] < 4 then "<=3" 
elseif [Called Count] < 8 then "4-7"
elseif [Called Count] < 11 then "8-10"
elseif [Called Count] < 16 then "11-15"
elseif [Called Count] < 20 then "16-19"
elseif [Called Count] < 26 then "20-25"
elseif [Called Count] < 31 then "25-30"
elseif [Called Count] < 36 then "30-35"
else "35+" 
END",
    "name": "[Calculation_847802666706034688]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Dial R (detail)",
    "datatype": "string",
    "formula": "STR([Called Count])",
    "name": "[Calculation_847802666706186241]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Date Filter Yeaterday",
    "datatype": "boolean",
    "formula": "//Updated Date: 18 May 2022
//Updated By: Manish
//Description: Filtering the date wrt yesterday

[Date]=today()-1",
    "name": "[Date Filter (copy)_7495186061619691521]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Helper Date",
    "datatype": "string",
    "formula": ""default"",
    "name": "[Parameter 11]",
    "role": "measure",
    "type": "nominal",
  },
  {
    "caption": "User Identifier",
    "datatype": "integer",
    "formula": "0",
    "name": "[Parameter 12]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Date Bucket",
    "datatype": "string",
    "formula": ""day"",
    "name": "[Parameter 1]",
    "role": "measure",
    "type": "nominal",
  },
  {
    "caption": "Start Date",
    "datatype": "date",
    "formula": "#2025-07-30#",
    "name": "[Parameter 5]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "End Date",
    "datatype": "date",
    "formula": "#2025-08-27#",
    "name": "[Parameter 6]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "TTW Grade",
    "datatype": "string",
    "formula": "IF [ttw_qualstatus] = 'ttw-qualified' then 'Grade A'
ELSEIF  [ttw_qualstatus] = 'ttw-nonqualified' and [TTW Explore Work Form] = 'yes' THEN 'Grade B'
ELSEIF [ttw_qualstatus] = 'ttw-nonqualified' and [TTW Explore Work Form] != 'yes' THEN 'Grade C'
ELSEIF ISNULL([ttw_qualstatus]) and [Stage3 Response] = 'Between 2 and 4 years' then 'Grade D'
ELSE 'Rest'
END",
    "name": "[Calculation_1006061976934187009]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "20hrs Disqual",
    "datatype": "integer",
    "formula": "IF [Stage6 Response] = "More than 20 hours per week" THEN 1 ELSE 0 END",
    "name": "[Calculation_1133007210546622464]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Age Disqual",
    "datatype": "integer",
    "formula": "IF INT([Age]) < 40 OR INT([Age]) > 62 THEN 1 ELSE 0 END",
    "name": "[Calculation_1133007210553298946]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Attorney Disqual",
    "datatype": "integer",
    "formula": "IF [Stage5 Response] = "Yes" THEN 1 ELSE 0 END",
    "name": "[Calculation_1133007210553425923]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Ben Disqual",
    "datatype": "integer",
    "formula": "IF IFNULL([Stage1 Response], "") != "I am not receiving any disability benefits (SSD or SSI)"
THEN 1 ELSE 0 END",
    "name": "[Calculation_1133007210553487364]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Doctor Visit Disqual",
    "datatype": "integer",
    "formula": "IF [Stage4 Response] = "No" THEN 1 ELSE 0 END",
    "name": "[Calculation_1133007210553540613]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Five Year Work Disqual",
    "datatype": "integer",
    "formula": "IF [Stage3 Response] = "Less than 2 years"
OR [Stage3 Response] = "Between 2 and 4 years"
THEN 1 ELSE 0 END",
    "name": "[Calculation_1133007210553618438]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Out of Work Disqual",
    "datatype": "integer",
    "formula": "IF [Stage2 Response] = "No" THEN 1 ELSE 0 END",
    "name": "[Calculation_1133007210553663495]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "# of Disqual",
    "datatype": "integer",
    "formula": "ZN([Calculation_1133007210553487364]) +
ZN([Calculation_1133007210553663495]) +
ZN([Calculation_1133007210553618438]) +
ZN([Calculation_1133007210553540613]) +
ZN([Calculation_1133007210553425923]) +
ZN([Calculation_1133007210546622464]) +
ZN([Calculation_1133007210553298946])",
    "name": "[Calculation_1133007210553765896]",
    "role": "dimension",
    "type": "ordinal",
  },
  {
    "caption": "Unresolved SSA Leads",
    "datatype": "string",
    "formula": "IF { FIXED [Phone] : MAX([Resolved Lead]) } = 0 THEN "SSA Unresolved Lead"
ELSEIF { FIXED [Phone] : MAX([Resolved Lead]) } = 1 THEN "SSA Resolved Lead"
END",
    "name": "[Calculation_1467962419029331969]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Post Date ",
    "datatype": "datetime",
    "formula": "//Updated Date: 18 May 2022
//Updated By: Manish
//Description: Formula to calculate UTC date

DATEADD("hour",0,[Post Date])",
    "name": "[Calculation_1916563181826678784]",
    "role": "dimension",
    "type": "ordinal",
  },
  {
    "caption": "Data Updated On",
    "datatype": "datetime",
    "formula": "{fixed :max([Post Date])}",
    "name": "[Calculation_2010857255412854784]",
    "role": "dimension",
    "type": "ordinal",
  },
  {
    "caption": "Grade",
    "datatype": "string",
    "formula": "// Grade A
IF [qual_status] = 'all-steps' THEN 'Grade A'

// Grade B
ELSEIF 
    [qual_status] IN ('fiveyrwrk-disqual','outofwrk-disqual','doc-disqual')
    AND [Calculation_1133007210553765896] = 1
THEN 'Grade B'

// Grade C
ELSEIF 
    [qual_status] <> 'age-disqual'
    AND NOT [Stage3 Response] IN ('Less than 2 years', 'Between 2 and 4 years')
    AND [Stage1 Response] <> 'Social Security Disability (SSD) Benefits'
    AND [Stage6 Response] = 'Not working'
THEN 'Grade C'

// Grade D
ELSEIF 
    // 1) Not age-disqual, Stage3 NOT in those two, Stage1 not SSD, Stage6 ≠ Not working, disqual ≤ 1
    (
      [qual_status] <> 'age-disqual'
      AND NOT [Stage3 Response] IN ('Less than 2 years', 'Between 2 and 4 years')
      AND [Stage1 Response] <> 'Social Security Disability (SSD) Benefits'
      AND [Stage6 Response] <> 'Not working'
      AND [Calculation_1133007210553765896] <= 1
    )
    // 2) Not age-disqual, Stage3 in those two, Qual Status = outofwrk-disqual
    OR
    (
      [qual_status] <> 'age-disqual'
      AND [Stage3 Response] IN ('Less than 2 years', 'Between 2 and 4 years')
      AND [qual_status] = 'outofwrk-disqual'
    )
    // 3) Not age-disqual, Stage3 in those two, Qual Status ≠ outofwrk-disqual, Stage7 = Yes
    OR
    (
      [qual_status] <> 'age-disqual'
      AND [Stage3 Response] IN ('Less than 2 years', 'Between 2 and 4 years')
      AND [qual_status] <> 'outofwrk-disqual'
      AND [Stage7 Response] = 'Yes'
    )
THEN 'Grade D'

// Rest (including age-disqual or anything else)
ELSE 'Rest'
END",
    "name": "[Calculation_7573084309404708864]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Today-28",
    "datatype": "date",
    "formula": "//Updated Date: 18 May 2022
//Updated By: Manish
//Description: Going back 28 days from today

({MAX(today()-28)})",
    "name": "[Calculation_767300790172184597]",
    "role": "dimension",
    "type": "ordinal",
  },
  {
    "caption": "Time-Source-Subid",
    "datatype": "string",
    "formula": "//Updated Date: 18 May 2022
//Updated By: Manish
//Description: Changing the data type to string of Time-Source-Subid column

STR([Date])+'-'+[Source]+'-'+[Sub Id]",
    "name": "[Calculation_7746824680808361990]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "TOTAL([Posted #])",
    "datatype": "integer",
    "formula": "TOTAL([Calculation_99712551082803223])",
    "name": "[Calculation_7975100929058668549]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Date Filter",
    "datatype": "boolean",
    "formula": "//Updated Date: 18 May 2022
//Updated By: Manish
//Description: Filtering data based on date

IF [Parameters].[Parameter 11] = 'default'
THEN [Date]>=[Parameters].[Parameter 5] AND [Date]<=[Parameters].[Parameter 6]
ELSEIF [Parameters].[Parameter 11] = 'weekly'
THEN [Date] >= TODAY()-8 AND [Date] <= TODAY()-1
END",
    "name": "[Calculation_843580506575679492]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Dial R",
    "datatype": "string",
    "formula": "IF  [Called Count] < 4 then "<=3" 
elseif [Called Count] < 8 then "4-7"
elseif [Called Count] < 11 then "8-10"
elseif [Called Count] < 16 then "11-15"
elseif [Called Count] < 20 then "16-19"
elseif [Called Count] < 26 then "20-25"
elseif [Called Count] < 31 then "25-30"
elseif [Called Count] < 36 then "30-35"
else "35+" 
END",
    "name": "[Calculation_847802666706034688]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Dial R (detail)",
    "datatype": "string",
    "formula": "STR([Called Count])",
    "name": "[Calculation_847802666706186241]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Max Date",
    "datatype": "date",
    "formula": "//Updated Date: 18 May 2022
//Updated By: Manish
//Description: Calculating max of todays date for including it in the default values of end date

{MAX(today())}",
    "name": "[Calculation_882424053213511680]",
    "role": "dimension",
    "type": "ordinal",
  },
  {
    "caption": "User Identifier",
    "datatype": "string",
    "formula": "IF [Parameters].[Parameter 12] = 0 THEN [User Id]
ELSEIF [Parameters].[Parameter 12] = 1 THEN [Phone]
END",
    "name": "[Calculation_906349454594166784]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Post Date  ",
    "datatype": "string",
    "formula": "//Updated Date: 18 May 2022
//Updated By: Manish
//Description: Calculation to apply date bucket

CASE [Parameters].[Parameter 1]
WHEN 'year' THEN str(datepart('year', [Calculation_1916563181826678784]))
WHEN 'quarter' THEN "Q" + str(datepart('quarter', [Calculation_1916563181826678784])) + " " + str(datepart('year', [Calculation_1916563181826678784]))
WHEN 'month' THEN str(datepart('month', [Calculation_1916563181826678784])) + "-" + str(datepart('year', [Calculation_1916563181826678784]))
WHEN 'day' THEN str(DATENAME('month', [Calculation_1916563181826678784]))+ "-" +str(datepart('day', [Calculation_1916563181826678784]))+ "-" + str(datepart('year', [Calculation_1916563181826678784]))
WHEN 'week' THEN "W" + str(datepart('week', [Calculation_1916563181826678784])) + "-" + str(datepart('year', [Calculation_1916563181826678784]))
WHEN "hour" THEN str(DATETRUNC('hour', [Calculation_1916563181826678784]))
WHEN "minute" THEN str(DATETRUNC('minute', [Calculation_1916563181826678784]))
END",
    "name": "[Calculation_97320012552925214]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Posted #",
    "datatype": "integer",
    "formula": "//Updated Date: 18 May 2022
//Updated By: Manish
//Description: Calculating the sum of user id wrt to source

countd([Calculation_906349454594166784])",
    "name": "[Calculation_99712551082803223]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Source - Date",
    "datatype": "string",
    "formula": "//Updated Date: 18 May 2022
//Updated By: Manish//Description: Calculating max of todays date for including it in the default values of end date
//Description: Concatinating source and date column

[Source]+":"+[Calculation_97320012552925214]",
    "name": "[Calculation_99712551088799768]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Disallowed States",
    "datatype": "string",
    "formula": "[State]",
    "name": "[state (copy)_3014878530503516162]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Helper Date",
    "datatype": "string",
    "formula": ""default"",
    "name": "[Parameter 11]",
    "role": "measure",
    "type": "nominal",
  },
  {
    "caption": "Start Date",
    "datatype": "date",
    "formula": "#2025-07-30#",
    "name": "[Parameter 5]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "End Date",
    "datatype": "date",
    "formula": "#2025-08-27#",
    "name": "[Parameter 6]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "TTW Grade",
    "datatype": "string",
    "formula": "IF [ttw_qualstatus] = 'ttw-qualified' then 'Grade A'
ELSEIF  [ttw_qualstatus] = 'ttw-nonqualified' and [TTW Explore Work Form] = 'yes' THEN 'Grade B'
ELSEIF [ttw_qualstatus] = 'ttw-nonqualified' and [TTW Explore Work Form] != 'yes' THEN 'Grade C'
ELSEIF ISNULL([ttw_qualstatus]) and [Stage3 Response] = 'Between 2 and 4 years' then 'Grade D'
ELSE 'Rest'
END",
    "name": "[Calculation_1006061976934187009]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Hour of Day",
    "datatype": "string",
    "formula": "IF LEN(STR(DATEPART('hour', [Calculation_1916563181826678784]))) = 1
THEN "0" + STR(DATEPART('hour', [Calculation_1916563181826678784]))
ELSE STR(DATEPART('hour', [Calculation_1916563181826678784]))
END",
    "name": "[Calculation_1113233589182521344]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "20hrs Disqual",
    "datatype": "integer",
    "formula": "IF [Stage6 Response] = "More than 20 hours per week" THEN 1 ELSE 0 END",
    "name": "[Calculation_1133007210546622464]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Age Disqual",
    "datatype": "integer",
    "formula": "IF INT([Age]) < 40 OR INT([Age]) > 62 THEN 1 ELSE 0 END",
    "name": "[Calculation_1133007210553298946]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Attorney Disqual",
    "datatype": "integer",
    "formula": "IF [Stage5 Response] = "Yes" THEN 1 ELSE 0 END",
    "name": "[Calculation_1133007210553425923]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Ben Disqual",
    "datatype": "integer",
    "formula": "IF IFNULL([Stage1 Response], "") != "I am not receiving any disability benefits (SSD or SSI)"
THEN 1 ELSE 0 END",
    "name": "[Calculation_1133007210553487364]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Doctor Visit Disqual",
    "datatype": "integer",
    "formula": "IF [Stage4 Response] = "No" THEN 1 ELSE 0 END",
    "name": "[Calculation_1133007210553540613]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Five Year Work Disqual",
    "datatype": "integer",
    "formula": "IF [Stage3 Response] = "Less than 2 years"
OR [Stage3 Response] = "Between 2 and 4 years"
THEN 1 ELSE 0 END",
    "name": "[Calculation_1133007210553618438]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Out of Work Disqual",
    "datatype": "integer",
    "formula": "IF [Stage2 Response] = "No" THEN 1 ELSE 0 END",
    "name": "[Calculation_1133007210553663495]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "# of Disqual",
    "datatype": "integer",
    "formula": "ZN([Calculation_1133007210553487364]) +
ZN([Calculation_1133007210553663495]) +
ZN([Calculation_1133007210553618438]) +
ZN([Calculation_1133007210553540613]) +
ZN([Calculation_1133007210553425923]) +
ZN([Calculation_1133007210546622464]) +
ZN([Calculation_1133007210553298946])",
    "name": "[Calculation_1133007210553765896]",
    "role": "dimension",
    "type": "ordinal",
  },
  {
    "caption": "Unresolved SSA Leads",
    "datatype": "string",
    "formula": "IF { FIXED [Phone] : MAX([Resolved Lead]) } = 0 THEN "SSA Unresolved Lead"
ELSEIF { FIXED [Phone] : MAX([Resolved Lead]) } = 1 THEN "SSA Resolved Lead"
END",
    "name": "[Calculation_1467962419029331969]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "CZ Post Hour Group",
    "datatype": "string",
    "formula": "IF DATEPART('hour', [Post Date]) >= 0 AND DATEPART('hour', [Post Date]) < 6 THEN 'Pre CC Hours'
ELSEIF DATEPART('hour', [Post Date]) >= 6 AND DATEPART('hour', [Post Date]) < 16 THEN 'CC Hours'
ELSEIF DATEPART('hour', [Post Date]) >= 16 AND DATEPART('hour', [Post Date]) < 24 THEN 'Post CC Hours'
END",
    "name": "[Calculation_1880252886125215747]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Post Date ",
    "datatype": "datetime",
    "formula": "//Updated Date: 18 May 2022
//Updated By: Manish
//Description: Formula to calculate UTC date

DATEADD("hour",0,[Post Date])",
    "name": "[Calculation_1916563181826678784]",
    "role": "dimension",
    "type": "ordinal",
  },
  {
    "caption": "Data Updated On",
    "datatype": "datetime",
    "formula": "{fixed :max([Post Date])}",
    "name": "[Calculation_2010857255412854784]",
    "role": "dimension",
    "type": "ordinal",
  },
  {
    "caption": "Masked Address",
    "datatype": "string",
    "formula": "//Replace([Address],SPLIT([Address],' ',1),'******')
'***********' + ' ' + SPLIT([Address],' ',-1)",
    "name": "[Calculation_2902429233286373378]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Grade",
    "datatype": "string",
    "formula": "// Grade A
IF [qual_status] = 'all-steps' THEN 'Grade A'

// Grade B
ELSEIF 
    [qual_status] IN ('fiveyrwrk-disqual','outofwrk-disqual','doc-disqual')
    AND [Calculation_1133007210553765896] = 1
THEN 'Grade B'

// Grade C
ELSEIF 
    [qual_status] <> 'age-disqual'
    AND NOT [Stage3 Response] IN ('Less than 2 years', 'Between 2 and 4 years')
    AND [Stage1 Response] <> 'Social Security Disability (SSD) Benefits'
    AND [Stage6 Response] = 'Not working'
THEN 'Grade C'

// Grade D
ELSEIF 
    // 1) Not age-disqual, Stage3 NOT in those two, Stage1 not SSD, Stage6 ≠ Not working, disqual ≤ 1
    (
      [qual_status] <> 'age-disqual'
      AND NOT [Stage3 Response] IN ('Less than 2 years', 'Between 2 and 4 years')
      AND [Stage1 Response] <> 'Social Security Disability (SSD) Benefits'
      AND [Stage6 Response] <> 'Not working'
      AND [Calculation_1133007210553765896] <= 1
    )
    // 2) Not age-disqual, Stage3 in those two, Qual Status = outofwrk-disqual
    OR
    (
      [qual_status] <> 'age-disqual'
      AND [Stage3 Response] IN ('Less than 2 years', 'Between 2 and 4 years')
      AND [qual_status] = 'outofwrk-disqual'
    )
    // 3) Not age-disqual, Stage3 in those two, Qual Status ≠ outofwrk-disqual, Stage7 = Yes
    OR
    (
      [qual_status] <> 'age-disqual'
      AND [Stage3 Response] IN ('Less than 2 years', 'Between 2 and 4 years')
      AND [qual_status] <> 'outofwrk-disqual'
      AND [Stage7 Response] = 'Yes'
    )
THEN 'Grade D'

// Rest (including age-disqual or anything else)
ELSE 'Rest'
END",
    "name": "[Calculation_7573084309404708864]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Today-28",
    "datatype": "date",
    "formula": "//Updated Date: 18 May 2022
//Updated By: Manish
//Description: Going back 28 days from today

({MAX(today()-28)})",
    "name": "[Calculation_767300790172184597]",
    "role": "dimension",
    "type": "ordinal",
  },
  {
    "caption": "Date Filter",
    "datatype": "boolean",
    "formula": "//Updated Date: 18 May 2022
//Updated By: Manish
//Description: Filtering data based on date

IF [Parameters].[Parameter 11] = 'default'
THEN [Date]>=[Parameters].[Parameter 5] AND [Date]<=[Parameters].[Parameter 6]
ELSEIF [Parameters].[Parameter 11] = 'weekly'
THEN [Date] >= TODAY()-8 AND [Date] <= TODAY()-1
END",
    "name": "[Calculation_843580506575679492]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Dial R",
    "datatype": "string",
    "formula": "IF  [Called Count] < 4 then "<=3" 
elseif [Called Count] < 8 then "4-7"
elseif [Called Count] < 11 then "8-10"
elseif [Called Count] < 16 then "11-15"
elseif [Called Count] < 20 then "16-19"
elseif [Called Count] < 26 then "20-25"
elseif [Called Count] < 31 then "25-30"
elseif [Called Count] < 36 then "30-35"
else "35+" 
END",
    "name": "[Calculation_847802666706034688]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Dial R (detail)",
    "datatype": "string",
    "formula": "STR([Called Count])",
    "name": "[Calculation_847802666706186241]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Max Date",
    "datatype": "date",
    "formula": "//Updated Date: 18 May 2022
//Updated By: Manish
//Description: Calculating max of todays date for including it in the default values of end date

{MAX(today())}",
    "name": "[Calculation_882424053213511680]",
    "role": "dimension",
    "type": "ordinal",
  },
  {
    "caption": "Row Id",
    "datatype": "integer",
    "formula": "INDEX()",
    "name": "[Calculation_97320012553666594]",
    "role": "measure",
    "type": "ordinal",
  },
  {
    "caption": "Blank",
    "datatype": "string",
    "formula": "//Updated Date: 18 May 2022
//Updated By: Manish
//Description: Blank column

""",
    "name": "[Calculation_97320012562538539]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Status For Context Filter",
    "datatype": "string",
    "formula": "[Status]",
    "name": "[Status (copy)_1621014427209760791]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Helper Date",
    "datatype": "string",
    "formula": ""default"",
    "name": "[Parameter 11]",
    "role": "measure",
    "type": "nominal",
  },
  {
    "caption": "Date Bucket",
    "datatype": "string",
    "formula": ""day"",
    "name": "[Parameter 1]",
    "role": "measure",
    "type": "nominal",
  },
  {
    "caption": "Start Date",
    "datatype": "date",
    "formula": "#2025-07-30#",
    "name": "[Parameter 5]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "End Date",
    "datatype": "date",
    "formula": "#2025-08-27#",
    "name": "[Parameter 6]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "TTW Grade",
    "datatype": "string",
    "formula": "IF [ttw_qualstatus] = 'ttw-qualified' then 'Grade A'
ELSEIF  [ttw_qualstatus] = 'ttw-nonqualified' and [TTW Explore Work Form] = 'yes' THEN 'Grade B'
ELSEIF [ttw_qualstatus] = 'ttw-nonqualified' and [TTW Explore Work Form] != 'yes' THEN 'Grade C'
ELSEIF ISNULL([ttw_qualstatus]) and [Stage3 Response] = 'Between 2 and 4 years' then 'Grade D'
ELSE 'Rest'
END",
    "name": "[Calculation_1006061976934187009]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "20hrs Disqual",
    "datatype": "integer",
    "formula": "IF [Stage6 Response] = "More than 20 hours per week" THEN 1 ELSE 0 END",
    "name": "[Calculation_1133007210546622464]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Age Disqual",
    "datatype": "integer",
    "formula": "IF INT([Age]) < 40 OR INT([Age]) > 62 THEN 1 ELSE 0 END",
    "name": "[Calculation_1133007210553298946]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Attorney Disqual",
    "datatype": "integer",
    "formula": "IF [Stage5 Response] = "Yes" THEN 1 ELSE 0 END",
    "name": "[Calculation_1133007210553425923]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Ben Disqual",
    "datatype": "integer",
    "formula": "IF IFNULL([Stage1 Response], "") != "I am not receiving any disability benefits (SSD or SSI)"
THEN 1 ELSE 0 END",
    "name": "[Calculation_1133007210553487364]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Doctor Visit Disqual",
    "datatype": "integer",
    "formula": "IF [Stage4 Response] = "No" THEN 1 ELSE 0 END",
    "name": "[Calculation_1133007210553540613]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Five Year Work Disqual",
    "datatype": "integer",
    "formula": "IF [Stage3 Response] = "Less than 2 years"
OR [Stage3 Response] = "Between 2 and 4 years"
THEN 1 ELSE 0 END",
    "name": "[Calculation_1133007210553618438]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Out of Work Disqual",
    "datatype": "integer",
    "formula": "IF [Stage2 Response] = "No" THEN 1 ELSE 0 END",
    "name": "[Calculation_1133007210553663495]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "# of Disqual",
    "datatype": "integer",
    "formula": "ZN([Calculation_1133007210553487364]) +
ZN([Calculation_1133007210553663495]) +
ZN([Calculation_1133007210553618438]) +
ZN([Calculation_1133007210553540613]) +
ZN([Calculation_1133007210553425923]) +
ZN([Calculation_1133007210546622464]) +
ZN([Calculation_1133007210553298946])",
    "name": "[Calculation_1133007210553765896]",
    "role": "dimension",
    "type": "ordinal",
  },
  {
    "caption": "Unresolved SSA Leads",
    "datatype": "string",
    "formula": "IF { FIXED [Phone] : MAX([Resolved Lead]) } = 0 THEN "SSA Unresolved Lead"
ELSEIF { FIXED [Phone] : MAX([Resolved Lead]) } = 1 THEN "SSA Resolved Lead"
END",
    "name": "[Calculation_1467962419029331969]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Post Date ",
    "datatype": "datetime",
    "formula": "//Updated Date: 18 May 2022
//Updated By: Manish
//Description: Formula to calculate UTC date

DATEADD("hour",0,[Post Date])",
    "name": "[Calculation_1916563181826678784]",
    "role": "dimension",
    "type": "ordinal",
  },
  {
    "caption": "Grade",
    "datatype": "string",
    "formula": "// Grade A
IF [qual_status] = 'all-steps' THEN 'Grade A'

// Grade B
ELSEIF 
    [qual_status] IN ('fiveyrwrk-disqual','outofwrk-disqual','doc-disqual')
    AND [Calculation_1133007210553765896] = 1
THEN 'Grade B'

// Grade C
ELSEIF 
    [qual_status] <> 'age-disqual'
    AND NOT [Stage3 Response] IN ('Less than 2 years', 'Between 2 and 4 years')
    AND [Stage1 Response] <> 'Social Security Disability (SSD) Benefits'
    AND [Stage6 Response] = 'Not working'
THEN 'Grade C'

// Grade D
ELSEIF 
    // 1) Not age-disqual, Stage3 NOT in those two, Stage1 not SSD, Stage6 ≠ Not working, disqual ≤ 1
    (
      [qual_status] <> 'age-disqual'
      AND NOT [Stage3 Response] IN ('Less than 2 years', 'Between 2 and 4 years')
      AND [Stage1 Response] <> 'Social Security Disability (SSD) Benefits'
      AND [Stage6 Response] <> 'Not working'
      AND [Calculation_1133007210553765896] <= 1
    )
    // 2) Not age-disqual, Stage3 in those two, Qual Status = outofwrk-disqual
    OR
    (
      [qual_status] <> 'age-disqual'
      AND [Stage3 Response] IN ('Less than 2 years', 'Between 2 and 4 years')
      AND [qual_status] = 'outofwrk-disqual'
    )
    // 3) Not age-disqual, Stage3 in those two, Qual Status ≠ outofwrk-disqual, Stage7 = Yes
    OR
    (
      [qual_status] <> 'age-disqual'
      AND [Stage3 Response] IN ('Less than 2 years', 'Between 2 and 4 years')
      AND [qual_status] <> 'outofwrk-disqual'
      AND [Stage7 Response] = 'Yes'
    )
THEN 'Grade D'

// Rest (including age-disqual or anything else)
ELSE 'Rest'
END",
    "name": "[Calculation_7573084309404708864]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Today-28",
    "datatype": "date",
    "formula": "//Updated Date: 18 May 2022
//Updated By: Manish
//Description: Going back 28 days from today

({MAX(today()-28)})",
    "name": "[Calculation_767300790172184597]",
    "role": "dimension",
    "type": "ordinal",
  },
  {
    "caption": "Time-Source-Subid",
    "datatype": "string",
    "formula": "//Updated Date: 18 May 2022
//Updated By: Manish
//Description: Changing the data type to string of Time-Source-Subid column

STR([Date])+'-'+[Source]+'-'+[Sub Id]",
    "name": "[Calculation_7746824680808361990]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Dupe Count",
    "datatype": "integer",
    "formula": "//Updated Date: 18 May 2022
//Updated By: Manish
//Description: Counting unique count of user id when outcome is initialzed

COUNTD(IF [Outcome]="initialized" THEN [User Id] END)",
    "name": "[Calculation_7975100929094058002]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Phone (w/o area code)",
    "datatype": "string",
    "formula": "//Updated Date: 18 May 2022
//Updated By: Manish
//Description: Removing the area code from phone numbers

MID([Phone],4)",
    "name": "[Calculation_8176144444085837826]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Date Filter",
    "datatype": "boolean",
    "formula": "//Updated Date: 18 May 2022
//Updated By: Manish
//Description: Filtering data based on date

IF [Parameters].[Parameter 11] = 'default'
THEN [Date]>=[Parameters].[Parameter 5] AND [Date]<=[Parameters].[Parameter 6]
ELSEIF [Parameters].[Parameter 11] = 'weekly'
THEN [Date] >= TODAY()-8 AND [Date] <= TODAY()-1
END",
    "name": "[Calculation_843580506575679492]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Dial R",
    "datatype": "string",
    "formula": "IF  [Called Count] < 4 then "<=3" 
elseif [Called Count] < 8 then "4-7"
elseif [Called Count] < 11 then "8-10"
elseif [Called Count] < 16 then "11-15"
elseif [Called Count] < 20 then "16-19"
elseif [Called Count] < 26 then "20-25"
elseif [Called Count] < 31 then "25-30"
elseif [Called Count] < 36 then "30-35"
else "35+" 
END",
    "name": "[Calculation_847802666706034688]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Dial R (detail)",
    "datatype": "string",
    "formula": "STR([Called Count])",
    "name": "[Calculation_847802666706186241]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Max Date",
    "datatype": "date",
    "formula": "//Updated Date: 18 May 2022
//Updated By: Manish
//Description: Calculating max of todays date for including it in the default values of end date

{MAX(today())}",
    "name": "[Calculation_882424053213511680]",
    "role": "dimension",
    "type": "ordinal",
  },
  {
    "caption": "Post Date  ",
    "datatype": "string",
    "formula": "//Updated Date: 18 May 2022
//Updated By: Manish
//Description: Calculation to apply date bucket

CASE [Parameters].[Parameter 1]
WHEN 'year' THEN str(datepart('year', [Calculation_1916563181826678784]))
WHEN 'quarter' THEN "Q" + str(datepart('quarter', [Calculation_1916563181826678784])) + " " + str(datepart('year', [Calculation_1916563181826678784]))
WHEN 'month' THEN str(datepart('month', [Calculation_1916563181826678784])) + "-" + str(datepart('year', [Calculation_1916563181826678784]))
WHEN 'day' THEN str(DATENAME('month', [Calculation_1916563181826678784]))+ "-" +str(datepart('day', [Calculation_1916563181826678784]))+ "-" + str(datepart('year', [Calculation_1916563181826678784]))
WHEN 'week' THEN "W" + str(datepart('week', [Calculation_1916563181826678784])) + "-" + str(datepart('year', [Calculation_1916563181826678784]))
WHEN "hour" THEN str(DATETRUNC('hour', [Calculation_1916563181826678784]))
WHEN "minute" THEN str(DATETRUNC('minute', [Calculation_1916563181826678784]))
END",
    "name": "[Calculation_97320012552925214]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Row Id",
    "datatype": "integer",
    "formula": "INDEX()",
    "name": "[Calculation_97320012553666594]",
    "role": "measure",
    "type": "ordinal",
  },
  {
    "caption": "Blank",
    "datatype": "string",
    "formula": "//Updated Date: 18 May 2022
//Updated By: Manish
//Description: Blank column

""",
    "name": "[Calculation_97320012562538539]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Source - Date",
    "datatype": "string",
    "formula": "//Updated Date: 18 May 2022
//Updated By: Manish//Description: Calculating max of todays date for including it in the default values of end date
//Description: Concatinating source and date column

[Source]+":"+[Calculation_97320012552925214]",
    "name": "[Calculation_99712551088799768]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Helper Date",
    "datatype": "string",
    "formula": ""default"",
    "name": "[Parameter 11]",
    "role": "measure",
    "type": "nominal",
  },
  {
    "caption": "User Identifier",
    "datatype": "integer",
    "formula": "0",
    "name": "[Parameter 12]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Date Bucket",
    "datatype": "string",
    "formula": ""day"",
    "name": "[Parameter 1]",
    "role": "measure",
    "type": "nominal",
  },
  {
    "caption": "Start Date",
    "datatype": "date",
    "formula": "#2025-07-30#",
    "name": "[Parameter 5]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "End Date",
    "datatype": "date",
    "formula": "#2025-08-27#",
    "name": "[Parameter 6]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "TTW Grade",
    "datatype": "string",
    "formula": "IF [ttw_qualstatus] = 'ttw-qualified' then 'Grade A'
ELSEIF  [ttw_qualstatus] = 'ttw-nonqualified' and [TTW Explore Work Form] = 'yes' THEN 'Grade B'
ELSEIF [ttw_qualstatus] = 'ttw-nonqualified' and [TTW Explore Work Form] != 'yes' THEN 'Grade C'
ELSEIF ISNULL([ttw_qualstatus]) and [Stage3 Response] = 'Between 2 and 4 years' then 'Grade D'
ELSE 'Rest'
END",
    "name": "[Calculation_1006061976934187009]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "20hrs Disqual",
    "datatype": "integer",
    "formula": "IF [Stage6 Response] = "More than 20 hours per week" THEN 1 ELSE 0 END",
    "name": "[Calculation_1133007210546622464]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Age Disqual",
    "datatype": "integer",
    "formula": "IF INT([Age]) < 40 OR INT([Age]) > 62 THEN 1 ELSE 0 END",
    "name": "[Calculation_1133007210553298946]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Attorney Disqual",
    "datatype": "integer",
    "formula": "IF [Stage5 Response] = "Yes" THEN 1 ELSE 0 END",
    "name": "[Calculation_1133007210553425923]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Ben Disqual",
    "datatype": "integer",
    "formula": "IF IFNULL([Stage1 Response], "") != "I am not receiving any disability benefits (SSD or SSI)"
THEN 1 ELSE 0 END",
    "name": "[Calculation_1133007210553487364]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Doctor Visit Disqual",
    "datatype": "integer",
    "formula": "IF [Stage4 Response] = "No" THEN 1 ELSE 0 END",
    "name": "[Calculation_1133007210553540613]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Five Year Work Disqual",
    "datatype": "integer",
    "formula": "IF [Stage3 Response] = "Less than 2 years"
OR [Stage3 Response] = "Between 2 and 4 years"
THEN 1 ELSE 0 END",
    "name": "[Calculation_1133007210553618438]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Out of Work Disqual",
    "datatype": "integer",
    "formula": "IF [Stage2 Response] = "No" THEN 1 ELSE 0 END",
    "name": "[Calculation_1133007210553663495]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "# of Disqual",
    "datatype": "integer",
    "formula": "ZN([Calculation_1133007210553487364]) +
ZN([Calculation_1133007210553663495]) +
ZN([Calculation_1133007210553618438]) +
ZN([Calculation_1133007210553540613]) +
ZN([Calculation_1133007210553425923]) +
ZN([Calculation_1133007210546622464]) +
ZN([Calculation_1133007210553298946])",
    "name": "[Calculation_1133007210553765896]",
    "role": "dimension",
    "type": "ordinal",
  },
  {
    "caption": "Unresolved SSA Leads",
    "datatype": "string",
    "formula": "IF { FIXED [Phone] : MAX([Resolved Lead]) } = 0 THEN "SSA Unresolved Lead"
ELSEIF { FIXED [Phone] : MAX([Resolved Lead]) } = 1 THEN "SSA Resolved Lead"
END",
    "name": "[Calculation_1467962419029331969]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Post Date ",
    "datatype": "datetime",
    "formula": "//Updated Date: 18 May 2022
//Updated By: Manish
//Description: Formula to calculate UTC date

DATEADD("hour",0,[Post Date])",
    "name": "[Calculation_1916563181826678784]",
    "role": "dimension",
    "type": "ordinal",
  },
  {
    "caption": "Data Updated On",
    "datatype": "datetime",
    "formula": "{fixed :max([Post Date])}",
    "name": "[Calculation_2010857255412854784]",
    "role": "dimension",
    "type": "ordinal",
  },
  {
    "caption": "Grade",
    "datatype": "string",
    "formula": "// Grade A
IF [qual_status] = 'all-steps' THEN 'Grade A'

// Grade B
ELSEIF 
    [qual_status] IN ('fiveyrwrk-disqual','outofwrk-disqual','doc-disqual')
    AND [Calculation_1133007210553765896] = 1
THEN 'Grade B'

// Grade C
ELSEIF 
    [qual_status] <> 'age-disqual'
    AND NOT [Stage3 Response] IN ('Less than 2 years', 'Between 2 and 4 years')
    AND [Stage1 Response] <> 'Social Security Disability (SSD) Benefits'
    AND [Stage6 Response] = 'Not working'
THEN 'Grade C'

// Grade D
ELSEIF 
    // 1) Not age-disqual, Stage3 NOT in those two, Stage1 not SSD, Stage6 ≠ Not working, disqual ≤ 1
    (
      [qual_status] <> 'age-disqual'
      AND NOT [Stage3 Response] IN ('Less than 2 years', 'Between 2 and 4 years')
      AND [Stage1 Response] <> 'Social Security Disability (SSD) Benefits'
      AND [Stage6 Response] <> 'Not working'
      AND [Calculation_1133007210553765896] <= 1
    )
    // 2) Not age-disqual, Stage3 in those two, Qual Status = outofwrk-disqual
    OR
    (
      [qual_status] <> 'age-disqual'
      AND [Stage3 Response] IN ('Less than 2 years', 'Between 2 and 4 years')
      AND [qual_status] = 'outofwrk-disqual'
    )
    // 3) Not age-disqual, Stage3 in those two, Qual Status ≠ outofwrk-disqual, Stage7 = Yes
    OR
    (
      [qual_status] <> 'age-disqual'
      AND [Stage3 Response] IN ('Less than 2 years', 'Between 2 and 4 years')
      AND [qual_status] <> 'outofwrk-disqual'
      AND [Stage7 Response] = 'Yes'
    )
THEN 'Grade D'

// Rest (including age-disqual or anything else)
ELSE 'Rest'
END",
    "name": "[Calculation_7573084309404708864]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Today-28",
    "datatype": "date",
    "formula": "//Updated Date: 18 May 2022
//Updated By: Manish
//Description: Going back 28 days from today

({MAX(today()-28)})",
    "name": "[Calculation_767300790172184597]",
    "role": "dimension",
    "type": "ordinal",
  },
  {
    "caption": "Time-Source-Subid",
    "datatype": "string",
    "formula": "//Updated Date: 18 May 2022
//Updated By: Manish
//Description: Changing the data type to string of Time-Source-Subid column

STR([Date])+'-'+[Source]+'-'+[Sub Id]",
    "name": "[Calculation_7746824680808361990]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "TOTAL([Posted #])",
    "datatype": "integer",
    "formula": "TOTAL([Calculation_99712551082803223])",
    "name": "[Calculation_7975100929060315143]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Date Filter",
    "datatype": "boolean",
    "formula": "//Updated Date: 18 May 2022
//Updated By: Manish
//Description: Filtering data based on date

IF [Parameters].[Parameter 11] = 'default'
THEN [Date]>=[Parameters].[Parameter 5] AND [Date]<=[Parameters].[Parameter 6]
ELSEIF [Parameters].[Parameter 11] = 'weekly'
THEN [Date] >= TODAY()-8 AND [Date] <= TODAY()-1
END",
    "name": "[Calculation_843580506575679492]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Dial R",
    "datatype": "string",
    "formula": "IF  [Called Count] < 4 then "<=3" 
elseif [Called Count] < 8 then "4-7"
elseif [Called Count] < 11 then "8-10"
elseif [Called Count] < 16 then "11-15"
elseif [Called Count] < 20 then "16-19"
elseif [Called Count] < 26 then "20-25"
elseif [Called Count] < 31 then "25-30"
elseif [Called Count] < 36 then "30-35"
else "35+" 
END",
    "name": "[Calculation_847802666706034688]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Dial R (detail)",
    "datatype": "string",
    "formula": "STR([Called Count])",
    "name": "[Calculation_847802666706186241]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Max Date",
    "datatype": "date",
    "formula": "//Updated Date: 18 May 2022
//Updated By: Manish
//Description: Calculating max of todays date for including it in the default values of end date

{MAX(today())}",
    "name": "[Calculation_882424053213511680]",
    "role": "dimension",
    "type": "ordinal",
  },
  {
    "caption": "User Identifier",
    "datatype": "string",
    "formula": "IF [Parameters].[Parameter 12] = 0 THEN [User Id]
ELSEIF [Parameters].[Parameter 12] = 1 THEN [Phone]
END",
    "name": "[Calculation_906349454594166784]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Post Date  ",
    "datatype": "string",
    "formula": "//Updated Date: 18 May 2022
//Updated By: Manish
//Description: Calculation to apply date bucket

CASE [Parameters].[Parameter 1]
WHEN 'year' THEN str(datepart('year', [Calculation_1916563181826678784]))
WHEN 'quarter' THEN "Q" + str(datepart('quarter', [Calculation_1916563181826678784])) + " " + str(datepart('year', [Calculation_1916563181826678784]))
WHEN 'month' THEN str(datepart('month', [Calculation_1916563181826678784])) + "-" + str(datepart('year', [Calculation_1916563181826678784]))
WHEN 'day' THEN str(DATENAME('month', [Calculation_1916563181826678784]))+ "-" +str(datepart('day', [Calculation_1916563181826678784]))+ "-" + str(datepart('year', [Calculation_1916563181826678784]))
WHEN 'week' THEN "W" + str(datepart('week', [Calculation_1916563181826678784])) + "-" + str(datepart('year', [Calculation_1916563181826678784]))
WHEN "hour" THEN str(DATETRUNC('hour', [Calculation_1916563181826678784]))
WHEN "minute" THEN str(DATETRUNC('minute', [Calculation_1916563181826678784]))
END",
    "name": "[Calculation_97320012552925214]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Posted #",
    "datatype": "integer",
    "formula": "//Updated Date: 18 May 2022
//Updated By: Manish
//Description: Calculating the sum of user id wrt to source

countd([Calculation_906349454594166784])",
    "name": "[Calculation_99712551082803223]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Source - Date",
    "datatype": "string",
    "formula": "//Updated Date: 18 May 2022
//Updated By: Manish//Description: Calculating max of todays date for including it in the default values of end date
//Description: Concatinating source and date column

[Source]+":"+[Calculation_97320012552925214]",
    "name": "[Calculation_99712551088799768]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Helper Date",
    "datatype": "string",
    "formula": ""default"",
    "name": "[Parameter 11]",
    "role": "measure",
    "type": "nominal",
  },
  {
    "caption": "Start Date",
    "datatype": "date",
    "formula": "#2025-07-30#",
    "name": "[Parameter 5]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "End Date",
    "datatype": "date",
    "formula": "#2025-08-27#",
    "name": "[Parameter 6]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "TTW Grade",
    "datatype": "string",
    "formula": "IF [ttw_qualstatus] = 'ttw-qualified' then 'Grade A'
ELSEIF  [ttw_qualstatus] = 'ttw-nonqualified' and [TTW Explore Work Form] = 'yes' THEN 'Grade B'
ELSEIF [ttw_qualstatus] = 'ttw-nonqualified' and [TTW Explore Work Form] != 'yes' THEN 'Grade C'
ELSEIF ISNULL([ttw_qualstatus]) and [Stage3 Response] = 'Between 2 and 4 years' then 'Grade D'
ELSE 'Rest'
END",
    "name": "[Calculation_1006061976934187009]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "20hrs Disqual",
    "datatype": "integer",
    "formula": "IF [Stage6 Response] = "More than 20 hours per week" THEN 1 ELSE 0 END",
    "name": "[Calculation_1133007210546622464]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Age Disqual",
    "datatype": "integer",
    "formula": "IF INT([Age]) < 40 OR INT([Age]) > 62 THEN 1 ELSE 0 END",
    "name": "[Calculation_1133007210553298946]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Attorney Disqual",
    "datatype": "integer",
    "formula": "IF [Stage5 Response] = "Yes" THEN 1 ELSE 0 END",
    "name": "[Calculation_1133007210553425923]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Ben Disqual",
    "datatype": "integer",
    "formula": "IF IFNULL([Stage1 Response], "") != "I am not receiving any disability benefits (SSD or SSI)"
THEN 1 ELSE 0 END",
    "name": "[Calculation_1133007210553487364]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Doctor Visit Disqual",
    "datatype": "integer",
    "formula": "IF [Stage4 Response] = "No" THEN 1 ELSE 0 END",
    "name": "[Calculation_1133007210553540613]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Five Year Work Disqual",
    "datatype": "integer",
    "formula": "IF [Stage3 Response] = "Less than 2 years"
OR [Stage3 Response] = "Between 2 and 4 years"
THEN 1 ELSE 0 END",
    "name": "[Calculation_1133007210553618438]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Out of Work Disqual",
    "datatype": "integer",
    "formula": "IF [Stage2 Response] = "No" THEN 1 ELSE 0 END",
    "name": "[Calculation_1133007210553663495]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "# of Disqual",
    "datatype": "integer",
    "formula": "ZN([Calculation_1133007210553487364]) +
ZN([Calculation_1133007210553663495]) +
ZN([Calculation_1133007210553618438]) +
ZN([Calculation_1133007210553540613]) +
ZN([Calculation_1133007210553425923]) +
ZN([Calculation_1133007210546622464]) +
ZN([Calculation_1133007210553298946])",
    "name": "[Calculation_1133007210553765896]",
    "role": "dimension",
    "type": "ordinal",
  },
  {
    "caption": "Unresolved SSA Leads",
    "datatype": "string",
    "formula": "IF { FIXED [Phone] : MAX([Resolved Lead]) } = 0 THEN "SSA Unresolved Lead"
ELSEIF { FIXED [Phone] : MAX([Resolved Lead]) } = 1 THEN "SSA Resolved Lead"
END",
    "name": "[Calculation_1467962419029331969]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Grade",
    "datatype": "string",
    "formula": "// Grade A
IF [qual_status] = 'all-steps' THEN 'Grade A'

// Grade B
ELSEIF 
    [qual_status] IN ('fiveyrwrk-disqual','outofwrk-disqual','doc-disqual')
    AND [Calculation_1133007210553765896] = 1
THEN 'Grade B'

// Grade C
ELSEIF 
    [qual_status] <> 'age-disqual'
    AND NOT [Stage3 Response] IN ('Less than 2 years', 'Between 2 and 4 years')
    AND [Stage1 Response] <> 'Social Security Disability (SSD) Benefits'
    AND [Stage6 Response] = 'Not working'
THEN 'Grade C'

// Grade D
ELSEIF 
    // 1) Not age-disqual, Stage3 NOT in those two, Stage1 not SSD, Stage6 ≠ Not working, disqual ≤ 1
    (
      [qual_status] <> 'age-disqual'
      AND NOT [Stage3 Response] IN ('Less than 2 years', 'Between 2 and 4 years')
      AND [Stage1 Response] <> 'Social Security Disability (SSD) Benefits'
      AND [Stage6 Response] <> 'Not working'
      AND [Calculation_1133007210553765896] <= 1
    )
    // 2) Not age-disqual, Stage3 in those two, Qual Status = outofwrk-disqual
    OR
    (
      [qual_status] <> 'age-disqual'
      AND [Stage3 Response] IN ('Less than 2 years', 'Between 2 and 4 years')
      AND [qual_status] = 'outofwrk-disqual'
    )
    // 3) Not age-disqual, Stage3 in those two, Qual Status ≠ outofwrk-disqual, Stage7 = Yes
    OR
    (
      [qual_status] <> 'age-disqual'
      AND [Stage3 Response] IN ('Less than 2 years', 'Between 2 and 4 years')
      AND [qual_status] <> 'outofwrk-disqual'
      AND [Stage7 Response] = 'Yes'
    )
THEN 'Grade D'

// Rest (including age-disqual or anything else)
ELSE 'Rest'
END",
    "name": "[Calculation_7573084309404708864]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Today-28",
    "datatype": "date",
    "formula": "//Updated Date: 18 May 2022
//Updated By: Manish
//Description: Going back 28 days from today

({MAX(today()-28)})",
    "name": "[Calculation_767300790172184597]",
    "role": "dimension",
    "type": "ordinal",
  },
  {
    "caption": "FirstName #",
    "datatype": "integer",
    "formula": "//Updated Date: 18 May 2022
//Updated By: Manish
//Description: Checking if first name is null or not

IF ISNULL([First Name]) THEN 1 ELSE 0 END",
    "name": "[Calculation_7848437147364691990]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Date Filter",
    "datatype": "boolean",
    "formula": "//Updated Date: 18 May 2022
//Updated By: Manish
//Description: Filtering data based on date

IF [Parameters].[Parameter 11] = 'default'
THEN [Date]>=[Parameters].[Parameter 5] AND [Date]<=[Parameters].[Parameter 6]
ELSEIF [Parameters].[Parameter 11] = 'weekly'
THEN [Date] >= TODAY()-8 AND [Date] <= TODAY()-1
END",
    "name": "[Calculation_843580506575679492]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Dial R",
    "datatype": "string",
    "formula": "IF  [Called Count] < 4 then "<=3" 
elseif [Called Count] < 8 then "4-7"
elseif [Called Count] < 11 then "8-10"
elseif [Called Count] < 16 then "11-15"
elseif [Called Count] < 20 then "16-19"
elseif [Called Count] < 26 then "20-25"
elseif [Called Count] < 31 then "25-30"
elseif [Called Count] < 36 then "30-35"
else "35+" 
END",
    "name": "[Calculation_847802666706034688]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Dial R (detail)",
    "datatype": "string",
    "formula": "STR([Called Count])",
    "name": "[Calculation_847802666706186241]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Max Date",
    "datatype": "date",
    "formula": "//Updated Date: 18 May 2022
//Updated By: Manish
//Description: Calculating max of todays date for including it in the default values of end date

{MAX(today())}",
    "name": "[Calculation_882424053213511680]",
    "role": "dimension",
    "type": "ordinal",
  },
  {
    "caption": "State #",
    "datatype": "integer",
    "formula": "//Updated Date: 18 May 2022
//Updated By: Manish
//Description: Checking if the state is null

IF ISNULL([State]) THEN 1 ELSE 0 END",
    "name": "[City #  (copy)_7848437147365756953]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Ip #",
    "datatype": "integer",
    "formula": "//Updated Date: 18 May 2022
//Updated By: Manish
//Description: Checking if ip is null or not

IF ISNULL([IP]) THEN 1 ELSE 0 END",
    "name": "[Dob # (copy)_7848437147366694940]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Subid #",
    "datatype": "integer",
    "formula": "//Updated Date: 18 May 2022
//Updated By: Manish
//Description: Checking if the subid is null

IF ISNULL([Sub Id]) THEN 1 ELSE 0 END",
    "name": "[Dob # (copy)_7848437147366932509]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "LastName # ",
    "datatype": "integer",
    "formula": "//Updated Date: 18 May 2022
//Updated By: Manish
//Description: Checking if last name is null

IF ISNULL([Last Name]) THEN 1 ELSE 0 END",
    "name": "[FirstName # (copy)_7848437147365089303]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Trusted Form # ",
    "datatype": "integer",
    "formula": "//Updated Date: 18 May 2022
//Updated By: Manish
//Description: Checking if the trusted form is null

IF ([Trusted Form]) = '' THEN 1 ELSE 0 END",
    "name": "[FirstName # (copy)_7848437147367211038]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "City # ",
    "datatype": "integer",
    "formula": "//Updated Date: 18 May 2022
//Updated By: Manish
//Description: Checking if city is null

IF ([City])='' THEN 1 ELSE 0 END",
    "name": "[LastName #  (copy)_7848437147365244952]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Dob #",
    "datatype": "integer",
    "formula": "//Updated Date: 18 May 2022
//Updated By: Manish
//Description: Checking if DOB is null or not

IF ISNULL([DOB]) THEN 1 ELSE 0 END",
    "name": "[PostalCode # (copy)_7848437147366457371]",
    "role": "dimension",
    "type": "ordinal",
  },
  {
    "caption": "PostalCode #",
    "datatype": "integer",
    "formula": "//Updated Date: 18 May 2022
//Updated By: Manish
//Description: Checking if postal code is null or not

IF ISNULL([Postal Code]) THEN 1 ELSE 0 END",
    "name": "[State # (copy)_7848437147366141978]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Date Bucket",
    "datatype": "string",
    "formula": ""day"",
    "name": "[Parameter 1]",
    "role": "measure",
    "type": "nominal",
  },
  {
    "caption": "TTW Grade",
    "datatype": "string",
    "formula": "IF [ttw_qualstatus] = 'ttw-qualified' then 'Grade A'
ELSEIF  [ttw_qualstatus] = 'ttw-nonqualified' and [TTW Explore Work Form] = 'yes' THEN 'Grade B'
ELSEIF [ttw_qualstatus] = 'ttw-nonqualified' and [TTW Explore Work Form] != 'yes' THEN 'Grade C'
ELSEIF ISNULL([ttw_qualstatus]) and [Stage3 Response] = 'Between 2 and 4 years' then 'Grade D'
ELSE 'Rest'
END",
    "name": "[Calculation_1006061976934187009]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "20hrs Disqual",
    "datatype": "integer",
    "formula": "IF [Stage6 Response] = "More than 20 hours per week" THEN 1 ELSE 0 END",
    "name": "[Calculation_1133007210546622464]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Age Disqual",
    "datatype": "integer",
    "formula": "IF INT([Age]) < 40 OR INT([Age]) > 62 THEN 1 ELSE 0 END",
    "name": "[Calculation_1133007210553298946]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Attorney Disqual",
    "datatype": "integer",
    "formula": "IF [Stage5 Response] = "Yes" THEN 1 ELSE 0 END",
    "name": "[Calculation_1133007210553425923]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Ben Disqual",
    "datatype": "integer",
    "formula": "IF IFNULL([Stage1 Response], "") != "I am not receiving any disability benefits (SSD or SSI)"
THEN 1 ELSE 0 END",
    "name": "[Calculation_1133007210553487364]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Doctor Visit Disqual",
    "datatype": "integer",
    "formula": "IF [Stage4 Response] = "No" THEN 1 ELSE 0 END",
    "name": "[Calculation_1133007210553540613]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Five Year Work Disqual",
    "datatype": "integer",
    "formula": "IF [Stage3 Response] = "Less than 2 years"
OR [Stage3 Response] = "Between 2 and 4 years"
THEN 1 ELSE 0 END",
    "name": "[Calculation_1133007210553618438]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Out of Work Disqual",
    "datatype": "integer",
    "formula": "IF [Stage2 Response] = "No" THEN 1 ELSE 0 END",
    "name": "[Calculation_1133007210553663495]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "# of Disqual",
    "datatype": "integer",
    "formula": "ZN([Calculation_1133007210553487364]) +
ZN([Calculation_1133007210553663495]) +
ZN([Calculation_1133007210553618438]) +
ZN([Calculation_1133007210553540613]) +
ZN([Calculation_1133007210553425923]) +
ZN([Calculation_1133007210546622464]) +
ZN([Calculation_1133007210553298946])",
    "name": "[Calculation_1133007210553765896]",
    "role": "dimension",
    "type": "ordinal",
  },
  {
    "caption": "Unresolved SSA Leads",
    "datatype": "string",
    "formula": "IF { FIXED [Phone] : MAX([Resolved Lead]) } = 0 THEN "SSA Unresolved Lead"
ELSEIF { FIXED [Phone] : MAX([Resolved Lead]) } = 1 THEN "SSA Resolved Lead"
END",
    "name": "[Calculation_1467962419029331969]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Post Date ",
    "datatype": "datetime",
    "formula": "//Updated Date: 18 May 2022
//Updated By: Manish
//Description: Formula to calculate UTC date

DATEADD("hour",0,[Post Date])",
    "name": "[Calculation_1916563181826678784]",
    "role": "dimension",
    "type": "ordinal",
  },
  {
    "caption": "Grade",
    "datatype": "string",
    "formula": "// Grade A
IF [qual_status] = 'all-steps' THEN 'Grade A'

// Grade B
ELSEIF 
    [qual_status] IN ('fiveyrwrk-disqual','outofwrk-disqual','doc-disqual')
    AND [Calculation_1133007210553765896] = 1
THEN 'Grade B'

// Grade C
ELSEIF 
    [qual_status] <> 'age-disqual'
    AND NOT [Stage3 Response] IN ('Less than 2 years', 'Between 2 and 4 years')
    AND [Stage1 Response] <> 'Social Security Disability (SSD) Benefits'
    AND [Stage6 Response] = 'Not working'
THEN 'Grade C'

// Grade D
ELSEIF 
    // 1) Not age-disqual, Stage3 NOT in those two, Stage1 not SSD, Stage6 ≠ Not working, disqual ≤ 1
    (
      [qual_status] <> 'age-disqual'
      AND NOT [Stage3 Response] IN ('Less than 2 years', 'Between 2 and 4 years')
      AND [Stage1 Response] <> 'Social Security Disability (SSD) Benefits'
      AND [Stage6 Response] <> 'Not working'
      AND [Calculation_1133007210553765896] <= 1
    )
    // 2) Not age-disqual, Stage3 in those two, Qual Status = outofwrk-disqual
    OR
    (
      [qual_status] <> 'age-disqual'
      AND [Stage3 Response] IN ('Less than 2 years', 'Between 2 and 4 years')
      AND [qual_status] = 'outofwrk-disqual'
    )
    // 3) Not age-disqual, Stage3 in those two, Qual Status ≠ outofwrk-disqual, Stage7 = Yes
    OR
    (
      [qual_status] <> 'age-disqual'
      AND [Stage3 Response] IN ('Less than 2 years', 'Between 2 and 4 years')
      AND [qual_status] <> 'outofwrk-disqual'
      AND [Stage7 Response] = 'Yes'
    )
THEN 'Grade D'

// Rest (including age-disqual or anything else)
ELSE 'Rest'
END",
    "name": "[Calculation_7573084309404708864]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Time-Source-Subid",
    "datatype": "string",
    "formula": "//Updated Date: 18 May 2022
//Updated By: Manish
//Description: Changing the data type to string of Time-Source-Subid column

STR([Date])+'-'+[Source]+'-'+[Sub Id]",
    "name": "[Calculation_7746824680808361990]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Dial R",
    "datatype": "string",
    "formula": "IF  [Called Count] < 4 then "<=3" 
elseif [Called Count] < 8 then "4-7"
elseif [Called Count] < 11 then "8-10"
elseif [Called Count] < 16 then "11-15"
elseif [Called Count] < 20 then "16-19"
elseif [Called Count] < 26 then "20-25"
elseif [Called Count] < 31 then "25-30"
elseif [Called Count] < 36 then "30-35"
else "35+" 
END",
    "name": "[Calculation_847802666706034688]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Dial R (detail)",
    "datatype": "string",
    "formula": "STR([Called Count])",
    "name": "[Calculation_847802666706186241]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Post Date  ",
    "datatype": "string",
    "formula": "//Updated Date: 18 May 2022
//Updated By: Manish
//Description: Calculation to apply date bucket

CASE [Parameters].[Parameter 1]
WHEN 'year' THEN str(datepart('year', [Calculation_1916563181826678784]))
WHEN 'quarter' THEN "Q" + str(datepart('quarter', [Calculation_1916563181826678784])) + " " + str(datepart('year', [Calculation_1916563181826678784]))
WHEN 'month' THEN str(datepart('month', [Calculation_1916563181826678784])) + "-" + str(datepart('year', [Calculation_1916563181826678784]))
WHEN 'day' THEN str(DATENAME('month', [Calculation_1916563181826678784]))+ "-" +str(datepart('day', [Calculation_1916563181826678784]))+ "-" + str(datepart('year', [Calculation_1916563181826678784]))
WHEN 'week' THEN "W" + str(datepart('week', [Calculation_1916563181826678784])) + "-" + str(datepart('year', [Calculation_1916563181826678784]))
WHEN "hour" THEN str(DATETRUNC('hour', [Calculation_1916563181826678784]))
WHEN "minute" THEN str(DATETRUNC('minute', [Calculation_1916563181826678784]))
END",
    "name": "[Calculation_97320012552925214]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "TF present",
    "datatype": "integer",
    "formula": "//Updated Date: 18 May 2022
//Updated By: Manish//Description: Calculating max of todays date for including it in the default values of end date
//Description: Checking if trusted form link is present or not

If len([Trusted Form])>0 then 1
else 0
end",
    "name": "[Calculation_97320012555014180]",
    "role": "dimension",
    "type": "ordinal",
  },
  {
    "caption": "Source - Date",
    "datatype": "string",
    "formula": "//Updated Date: 18 May 2022
//Updated By: Manish//Description: Calculating max of todays date for including it in the default values of end date
//Description: Concatinating source and date column

[Source]+":"+[Calculation_97320012552925214]",
    "name": "[Calculation_99712551088799768]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Date Filter Yeaterday",
    "datatype": "boolean",
    "formula": "//Updated Date: 18 May 2022
//Updated By: Manish
//Description: Filtering the date wrt yesterday

[Date]=today()-1",
    "name": "[Date Filter (copy)_7495186061619691521]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Missing TF",
    "datatype": "integer",
    "formula": "COUNT(IF ISNULL([Calculation_97320012555014180]) or [Calculation_97320012555014180] = 0 THEN [User Id] END)


//COUNT(IF ISNULL([lastname]) OR [lastname] = ''
//OR ISNULL([subid]) OR [subid] = '' 
//OR ISNULL([postalcode]) OR [postalcode] = ''
//OR ISNULL([city]) OR [city] = ''
//OR ISNULL([state]) OR [state] = '' THEN [userid] END)",
    "name": "[Missing Subid (copy)_1022317140787544070]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "campaign name (copy)",
    "datatype": "string",
    "formula": "[CZ Project Name]",
    "name": "[campaign name (copy)_2703707902190374912]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Start Date",
    "datatype": "date",
    "formula": "#2025-07-30#",
    "name": "[Parameter 5]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "End Date",
    "datatype": "date",
    "formula": "#2025-08-27#",
    "name": "[Parameter 6]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Date Selected",
    "datatype": "string",
    "formula": ""Post Date"",
    "name": "[Parameter 9]",
    "role": "measure",
    "type": "nominal",
  },
  {
    "caption": "Show Source",
    "datatype": "string",
    "formula": ""1"",
    "name": "[Phone (copy)_1255659924007981058]",
    "role": "measure",
    "type": "nominal",
  },
  {
    "caption": "TTW Grade",
    "datatype": "string",
    "formula": "IF [ttw_qualstatus] = 'ttw-qualified' then 'Grade A'
ELSEIF  [ttw_qualstatus] = 'ttw-nonqualified' and [TTW Explore Work Form] = 'yes' THEN 'Grade B'
ELSEIF [ttw_qualstatus] = 'ttw-nonqualified' and [TTW Explore Work Form] != 'yes' THEN 'Grade C'
ELSEIF ISNULL([ttw_qualstatus]) and [Stage3 Response] = 'Between 2 and 4 years' then 'Grade D'
ELSE 'Rest'
END",
    "name": "[Calculation_1006061976934187009]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Hour of Day",
    "datatype": "string",
    "formula": "IF LEN(STR(DATEPART('hour', [Calculation_1916563181826678784]))) = 1
THEN "0" + STR(DATEPART('hour', [Calculation_1916563181826678784]))
ELSE STR(DATEPART('hour', [Calculation_1916563181826678784]))
END",
    "name": "[Calculation_1113233589182521344]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "20hrs Disqual",
    "datatype": "integer",
    "formula": "IF [Stage6 Response] = "More than 20 hours per week" THEN 1 ELSE 0 END",
    "name": "[Calculation_1133007210546622464]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Age Disqual",
    "datatype": "integer",
    "formula": "IF INT([Age]) < 40 OR INT([Age]) > 62 THEN 1 ELSE 0 END",
    "name": "[Calculation_1133007210553298946]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Attorney Disqual",
    "datatype": "integer",
    "formula": "IF [Stage5 Response] = "Yes" THEN 1 ELSE 0 END",
    "name": "[Calculation_1133007210553425923]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Ben Disqual",
    "datatype": "integer",
    "formula": "IF IFNULL([Stage1 Response], "") != "I am not receiving any disability benefits (SSD or SSI)"
THEN 1 ELSE 0 END",
    "name": "[Calculation_1133007210553487364]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Doctor Visit Disqual",
    "datatype": "integer",
    "formula": "IF [Stage4 Response] = "No" THEN 1 ELSE 0 END",
    "name": "[Calculation_1133007210553540613]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Five Year Work Disqual",
    "datatype": "integer",
    "formula": "IF [Stage3 Response] = "Less than 2 years"
OR [Stage3 Response] = "Between 2 and 4 years"
THEN 1 ELSE 0 END",
    "name": "[Calculation_1133007210553618438]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Out of Work Disqual",
    "datatype": "integer",
    "formula": "IF [Stage2 Response] = "No" THEN 1 ELSE 0 END",
    "name": "[Calculation_1133007210553663495]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "# of Disqual",
    "datatype": "integer",
    "formula": "ZN([Calculation_1133007210553487364]) +
ZN([Calculation_1133007210553663495]) +
ZN([Calculation_1133007210553618438]) +
ZN([Calculation_1133007210553540613]) +
ZN([Calculation_1133007210553425923]) +
ZN([Calculation_1133007210546622464]) +
ZN([Calculation_1133007210553298946])",
    "name": "[Calculation_1133007210553765896]",
    "role": "dimension",
    "type": "ordinal",
  },
  {
    "caption": "''",
    "datatype": "string",
    "formula": "''",
    "name": "[Calculation_1355583493698101250]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Unresolved SSA Leads",
    "datatype": "string",
    "formula": "IF { FIXED [Phone] : MAX([Resolved Lead]) } = 0 THEN "SSA Unresolved Lead"
ELSEIF { FIXED [Phone] : MAX([Resolved Lead]) } = 1 THEN "SSA Resolved Lead"
END",
    "name": "[Calculation_1467962419029331969]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "CZ Post Hour Group",
    "datatype": "string",
    "formula": "IF DATEPART('hour', [Post Date]) >= 0 AND DATEPART('hour', [Post Date]) < 6 THEN 'Pre CC Hours'
ELSEIF DATEPART('hour', [Post Date]) >= 6 AND DATEPART('hour', [Post Date]) < 16 THEN 'CC Hours'
ELSEIF DATEPART('hour', [Post Date]) >= 16 AND DATEPART('hour', [Post Date]) < 24 THEN 'Post CC Hours'
END",
    "name": "[Calculation_1880252886125215747]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Post Date ",
    "datatype": "datetime",
    "formula": "//Updated Date: 18 May 2022
//Updated By: Manish
//Description: Formula to calculate UTC date

DATEADD("hour",0,[Post Date])",
    "name": "[Calculation_1916563181826678784]",
    "role": "dimension",
    "type": "ordinal",
  },
  {
    "caption": "Data Updated On",
    "datatype": "datetime",
    "formula": "{fixed :max([Post Date])}",
    "name": "[Calculation_2010857255412854784]",
    "role": "dimension",
    "type": "ordinal",
  },
  {
    "caption": "Grade",
    "datatype": "string",
    "formula": "// Grade A
IF [qual_status] = 'all-steps' THEN 'Grade A'

// Grade B
ELSEIF 
    [qual_status] IN ('fiveyrwrk-disqual','outofwrk-disqual','doc-disqual')
    AND [Calculation_1133007210553765896] = 1
THEN 'Grade B'

// Grade C
ELSEIF 
    [qual_status] <> 'age-disqual'
    AND NOT [Stage3 Response] IN ('Less than 2 years', 'Between 2 and 4 years')
    AND [Stage1 Response] <> 'Social Security Disability (SSD) Benefits'
    AND [Stage6 Response] = 'Not working'
THEN 'Grade C'

// Grade D
ELSEIF 
    // 1) Not age-disqual, Stage3 NOT in those two, Stage1 not SSD, Stage6 ≠ Not working, disqual ≤ 1
    (
      [qual_status] <> 'age-disqual'
      AND NOT [Stage3 Response] IN ('Less than 2 years', 'Between 2 and 4 years')
      AND [Stage1 Response] <> 'Social Security Disability (SSD) Benefits'
      AND [Stage6 Response] <> 'Not working'
      AND [Calculation_1133007210553765896] <= 1
    )
    // 2) Not age-disqual, Stage3 in those two, Qual Status = outofwrk-disqual
    OR
    (
      [qual_status] <> 'age-disqual'
      AND [Stage3 Response] IN ('Less than 2 years', 'Between 2 and 4 years')
      AND [qual_status] = 'outofwrk-disqual'
    )
    // 3) Not age-disqual, Stage3 in those two, Qual Status ≠ outofwrk-disqual, Stage7 = Yes
    OR
    (
      [qual_status] <> 'age-disqual'
      AND [Stage3 Response] IN ('Less than 2 years', 'Between 2 and 4 years')
      AND [qual_status] <> 'outofwrk-disqual'
      AND [Stage7 Response] = 'Yes'
    )
THEN 'Grade D'

// Rest (including age-disqual or anything else)
ELSE 'Rest'
END",
    "name": "[Calculation_7573084309404708864]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Today-28",
    "datatype": "date",
    "formula": "//Updated Date: 18 May 2022
//Updated By: Manish
//Description: Going back 28 days from today

({MAX(today()-28)})",
    "name": "[Calculation_767300790172184597]",
    "role": "dimension",
    "type": "ordinal",
  },
  {
    "caption": "Dial R",
    "datatype": "string",
    "formula": "IF  [Called Count] < 4 then "<=3" 
elseif [Called Count] < 8 then "4-7"
elseif [Called Count] < 11 then "8-10"
elseif [Called Count] < 16 then "11-15"
elseif [Called Count] < 20 then "16-19"
elseif [Called Count] < 26 then "20-25"
elseif [Called Count] < 31 then "25-30"
elseif [Called Count] < 36 then "30-35"
else "35+" 
END",
    "name": "[Calculation_847802666706034688]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Dial R (detail)",
    "datatype": "string",
    "formula": "STR([Called Count])",
    "name": "[Calculation_847802666706186241]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Max Date",
    "datatype": "date",
    "formula": "//Updated Date: 18 May 2022
//Updated By: Manish
//Description: Calculating max of todays date for including it in the default values of end date

{MAX(today())}",
    "name": "[Calculation_882424053213511680]",
    "role": "dimension",
    "type": "ordinal",
  },
  {
    "caption": "Date Filter to swap Modify Date",
    "datatype": "boolean",
    "formula": "//Updated Date: 18 May 2022
//Updated By: Manish
//Description: Filtering data based on date
IF [Parameters].[Parameter 9] = 'Post Date' THEN

[Date]>=[Parameters].[Parameter 5] AND [Date]<=[Parameters].[Parameter 6]
ELSE DATE([Modify Date])>=[Parameters].[Parameter 5] AND DATE([Modify Date])<=[Parameters].[Parameter 6] END",
    "name": "[Date Filter (copy)_1968354565469626368]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Source ",
    "datatype": "string",
    "formula": "CASE [Parameters].[Phone (copy)_1255659924007981058]
WHEN "0" THEN "Agg"
WHEN "1" THEN [Source]
END",
    "name": "[Phone (copy)_1255659924007964673]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Helper Date",
    "datatype": "string",
    "formula": ""default"",
    "name": "[Parameter 11]",
    "role": "measure",
    "type": "nominal",
  },
  {
    "caption": "Date Bucket",
    "datatype": "string",
    "formula": ""day"",
    "name": "[Parameter 1]",
    "role": "measure",
    "type": "nominal",
  },
  {
    "caption": "Start Date",
    "datatype": "date",
    "formula": "#2025-07-30#",
    "name": "[Parameter 5]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "End Date",
    "datatype": "date",
    "formula": "#2025-08-27#",
    "name": "[Parameter 6]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "TTW Grade",
    "datatype": "string",
    "formula": "IF [ttw_qualstatus] = 'ttw-qualified' then 'Grade A'
ELSEIF  [ttw_qualstatus] = 'ttw-nonqualified' and [TTW Explore Work Form] = 'yes' THEN 'Grade B'
ELSEIF [ttw_qualstatus] = 'ttw-nonqualified' and [TTW Explore Work Form] != 'yes' THEN 'Grade C'
ELSEIF ISNULL([ttw_qualstatus]) and [Stage3 Response] = 'Between 2 and 4 years' then 'Grade D'
ELSE 'Rest'
END",
    "name": "[Calculation_1006061976934187009]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "20hrs Disqual",
    "datatype": "integer",
    "formula": "IF [Stage6 Response] = "More than 20 hours per week" THEN 1 ELSE 0 END",
    "name": "[Calculation_1133007210546622464]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Age Disqual",
    "datatype": "integer",
    "formula": "IF INT([Age]) < 40 OR INT([Age]) > 62 THEN 1 ELSE 0 END",
    "name": "[Calculation_1133007210553298946]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Attorney Disqual",
    "datatype": "integer",
    "formula": "IF [Stage5 Response] = "Yes" THEN 1 ELSE 0 END",
    "name": "[Calculation_1133007210553425923]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Ben Disqual",
    "datatype": "integer",
    "formula": "IF IFNULL([Stage1 Response], "") != "I am not receiving any disability benefits (SSD or SSI)"
THEN 1 ELSE 0 END",
    "name": "[Calculation_1133007210553487364]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Doctor Visit Disqual",
    "datatype": "integer",
    "formula": "IF [Stage4 Response] = "No" THEN 1 ELSE 0 END",
    "name": "[Calculation_1133007210553540613]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Five Year Work Disqual",
    "datatype": "integer",
    "formula": "IF [Stage3 Response] = "Less than 2 years"
OR [Stage3 Response] = "Between 2 and 4 years"
THEN 1 ELSE 0 END",
    "name": "[Calculation_1133007210553618438]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Out of Work Disqual",
    "datatype": "integer",
    "formula": "IF [Stage2 Response] = "No" THEN 1 ELSE 0 END",
    "name": "[Calculation_1133007210553663495]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "# of Disqual",
    "datatype": "integer",
    "formula": "ZN([Calculation_1133007210553487364]) +
ZN([Calculation_1133007210553663495]) +
ZN([Calculation_1133007210553618438]) +
ZN([Calculation_1133007210553540613]) +
ZN([Calculation_1133007210553425923]) +
ZN([Calculation_1133007210546622464]) +
ZN([Calculation_1133007210553298946])",
    "name": "[Calculation_1133007210553765896]",
    "role": "dimension",
    "type": "ordinal",
  },
  {
    "caption": "Unresolved SSA Leads",
    "datatype": "string",
    "formula": "IF { FIXED [Phone] : MAX([Resolved Lead]) } = 0 THEN "SSA Unresolved Lead"
ELSEIF { FIXED [Phone] : MAX([Resolved Lead]) } = 1 THEN "SSA Resolved Lead"
END",
    "name": "[Calculation_1467962419029331969]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Post Date ",
    "datatype": "datetime",
    "formula": "//Updated Date: 18 May 2022
//Updated By: Manish
//Description: Formula to calculate UTC date

DATEADD("hour",0,[Post Date])",
    "name": "[Calculation_1916563181826678784]",
    "role": "dimension",
    "type": "ordinal",
  },
  {
    "caption": "Data Updated On",
    "datatype": "datetime",
    "formula": "{fixed :max([Post Date])}",
    "name": "[Calculation_2010857255412854784]",
    "role": "dimension",
    "type": "ordinal",
  },
  {
    "caption": "TOTAL([Lead])",
    "datatype": "integer",
    "formula": "TOTAL([Calculation_97320012564762668])",
    "name": "[Calculation_4891401821490655261]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Project Type",
    "datatype": "string",
    "formula": "IF CONTAINS([CZ Project Name],'Aged') THEN 'Aged'
ELSE 'Live' END",
    "name": "[Calculation_5872834692856524810]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Grade",
    "datatype": "string",
    "formula": "// Grade A
IF [qual_status] = 'all-steps' THEN 'Grade A'

// Grade B
ELSEIF 
    [qual_status] IN ('fiveyrwrk-disqual','outofwrk-disqual','doc-disqual')
    AND [Calculation_1133007210553765896] = 1
THEN 'Grade B'

// Grade C
ELSEIF 
    [qual_status] <> 'age-disqual'
    AND NOT [Stage3 Response] IN ('Less than 2 years', 'Between 2 and 4 years')
    AND [Stage1 Response] <> 'Social Security Disability (SSD) Benefits'
    AND [Stage6 Response] = 'Not working'
THEN 'Grade C'

// Grade D
ELSEIF 
    // 1) Not age-disqual, Stage3 NOT in those two, Stage1 not SSD, Stage6 ≠ Not working, disqual ≤ 1
    (
      [qual_status] <> 'age-disqual'
      AND NOT [Stage3 Response] IN ('Less than 2 years', 'Between 2 and 4 years')
      AND [Stage1 Response] <> 'Social Security Disability (SSD) Benefits'
      AND [Stage6 Response] <> 'Not working'
      AND [Calculation_1133007210553765896] <= 1
    )
    // 2) Not age-disqual, Stage3 in those two, Qual Status = outofwrk-disqual
    OR
    (
      [qual_status] <> 'age-disqual'
      AND [Stage3 Response] IN ('Less than 2 years', 'Between 2 and 4 years')
      AND [qual_status] = 'outofwrk-disqual'
    )
    // 3) Not age-disqual, Stage3 in those two, Qual Status ≠ outofwrk-disqual, Stage7 = Yes
    OR
    (
      [qual_status] <> 'age-disqual'
      AND [Stage3 Response] IN ('Less than 2 years', 'Between 2 and 4 years')
      AND [qual_status] <> 'outofwrk-disqual'
      AND [Stage7 Response] = 'Yes'
    )
THEN 'Grade D'

// Rest (including age-disqual or anything else)
ELSE 'Rest'
END",
    "name": "[Calculation_7573084309404708864]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Today-28",
    "datatype": "date",
    "formula": "//Updated Date: 18 May 2022
//Updated By: Manish
//Description: Going back 28 days from today

({MAX(today()-28)})",
    "name": "[Calculation_767300790172184597]",
    "role": "dimension",
    "type": "ordinal",
  },
  {
    "caption": "Date Filter",
    "datatype": "boolean",
    "formula": "//Updated Date: 18 May 2022
//Updated By: Manish
//Description: Filtering data based on date

IF [Parameters].[Parameter 11] = 'default'
THEN [Date]>=[Parameters].[Parameter 5] AND [Date]<=[Parameters].[Parameter 6]
ELSEIF [Parameters].[Parameter 11] = 'weekly'
THEN [Date] >= TODAY()-8 AND [Date] <= TODAY()-1
END",
    "name": "[Calculation_843580506575679492]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Dial R",
    "datatype": "string",
    "formula": "IF  [Called Count] < 4 then "<=3" 
elseif [Called Count] < 8 then "4-7"
elseif [Called Count] < 11 then "8-10"
elseif [Called Count] < 16 then "11-15"
elseif [Called Count] < 20 then "16-19"
elseif [Called Count] < 26 then "20-25"
elseif [Called Count] < 31 then "25-30"
elseif [Called Count] < 36 then "30-35"
else "35+" 
END",
    "name": "[Calculation_847802666706034688]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Dial R (detail)",
    "datatype": "string",
    "formula": "STR([Called Count])",
    "name": "[Calculation_847802666706186241]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Max Date",
    "datatype": "date",
    "formula": "//Updated Date: 18 May 2022
//Updated By: Manish
//Description: Calculating max of todays date for including it in the default values of end date

{MAX(today())}",
    "name": "[Calculation_882424053213511680]",
    "role": "dimension",
    "type": "ordinal",
  },
  {
    "caption": "Alt. Branding",
    "datatype": "string",
    "formula": "If int(Right([Phone],2))<30 and [Calculation_5872834692856524810]= 'Live' then 'Yes' else 'No' End",
    "name": "[Calculation_935059914517495808]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Post Date  ",
    "datatype": "string",
    "formula": "//Updated Date: 18 May 2022
//Updated By: Manish
//Description: Calculation to apply date bucket

CASE [Parameters].[Parameter 1]
WHEN 'year' THEN str(datepart('year', [Calculation_1916563181826678784]))
WHEN 'quarter' THEN "Q" + str(datepart('quarter', [Calculation_1916563181826678784])) + " " + str(datepart('year', [Calculation_1916563181826678784]))
WHEN 'month' THEN str(datepart('month', [Calculation_1916563181826678784])) + "-" + str(datepart('year', [Calculation_1916563181826678784]))
WHEN 'day' THEN str(DATENAME('month', [Calculation_1916563181826678784]))+ "-" +str(datepart('day', [Calculation_1916563181826678784]))+ "-" + str(datepart('year', [Calculation_1916563181826678784]))
WHEN 'week' THEN "W" + str(datepart('week', [Calculation_1916563181826678784])) + "-" + str(datepart('year', [Calculation_1916563181826678784]))
WHEN "hour" THEN str(DATETRUNC('hour', [Calculation_1916563181826678784]))
WHEN "minute" THEN str(DATETRUNC('minute', [Calculation_1916563181826678784]))
END",
    "name": "[Calculation_97320012552925214]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Campaign & Date",
    "datatype": "string",
    "formula": "//Updated Date: 18 May 2022
//Updated By: Manish
//Description: Concatinating campaign and date

[CZ Project Name]+":"+[Calculation_97320012552925214]",
    "name": "[Calculation_97320012555808806]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Lead",
    "datatype": "integer",
    "formula": "//Updated Date: 18 May 2022
//Updated By: Manish
//Description: Calculating the unique count of user ids

COUNTD([User Id])",
    "name": "[Calculation_97320012564762668]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Helper Date",
    "datatype": "string",
    "formula": ""default"",
    "name": "[Parameter 11]",
    "role": "measure",
    "type": "nominal",
  },
  {
    "caption": "User Identifier",
    "datatype": "integer",
    "formula": "0",
    "name": "[Parameter 12]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Date Bucket",
    "datatype": "string",
    "formula": ""day"",
    "name": "[Parameter 1]",
    "role": "measure",
    "type": "nominal",
  },
  {
    "caption": "Start Date",
    "datatype": "date",
    "formula": "#2025-07-30#",
    "name": "[Parameter 5]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "End Date",
    "datatype": "date",
    "formula": "#2025-08-27#",
    "name": "[Parameter 6]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "TTW Grade",
    "datatype": "string",
    "formula": "IF [ttw_qualstatus] = 'ttw-qualified' then 'Grade A'
ELSEIF  [ttw_qualstatus] = 'ttw-nonqualified' and [TTW Explore Work Form] = 'yes' THEN 'Grade B'
ELSEIF [ttw_qualstatus] = 'ttw-nonqualified' and [TTW Explore Work Form] != 'yes' THEN 'Grade C'
ELSEIF ISNULL([ttw_qualstatus]) and [Stage3 Response] = 'Between 2 and 4 years' then 'Grade D'
ELSE 'Rest'
END",
    "name": "[Calculation_1006061976934187009]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "20hrs Disqual",
    "datatype": "integer",
    "formula": "IF [Stage6 Response] = "More than 20 hours per week" THEN 1 ELSE 0 END",
    "name": "[Calculation_1133007210546622464]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Age Disqual",
    "datatype": "integer",
    "formula": "IF INT([Age]) < 40 OR INT([Age]) > 62 THEN 1 ELSE 0 END",
    "name": "[Calculation_1133007210553298946]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Attorney Disqual",
    "datatype": "integer",
    "formula": "IF [Stage5 Response] = "Yes" THEN 1 ELSE 0 END",
    "name": "[Calculation_1133007210553425923]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Ben Disqual",
    "datatype": "integer",
    "formula": "IF IFNULL([Stage1 Response], "") != "I am not receiving any disability benefits (SSD or SSI)"
THEN 1 ELSE 0 END",
    "name": "[Calculation_1133007210553487364]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Doctor Visit Disqual",
    "datatype": "integer",
    "formula": "IF [Stage4 Response] = "No" THEN 1 ELSE 0 END",
    "name": "[Calculation_1133007210553540613]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Five Year Work Disqual",
    "datatype": "integer",
    "formula": "IF [Stage3 Response] = "Less than 2 years"
OR [Stage3 Response] = "Between 2 and 4 years"
THEN 1 ELSE 0 END",
    "name": "[Calculation_1133007210553618438]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Out of Work Disqual",
    "datatype": "integer",
    "formula": "IF [Stage2 Response] = "No" THEN 1 ELSE 0 END",
    "name": "[Calculation_1133007210553663495]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "# of Disqual",
    "datatype": "integer",
    "formula": "ZN([Calculation_1133007210553487364]) +
ZN([Calculation_1133007210553663495]) +
ZN([Calculation_1133007210553618438]) +
ZN([Calculation_1133007210553540613]) +
ZN([Calculation_1133007210553425923]) +
ZN([Calculation_1133007210546622464]) +
ZN([Calculation_1133007210553298946])",
    "name": "[Calculation_1133007210553765896]",
    "role": "dimension",
    "type": "ordinal",
  },
  {
    "caption": "Unresolved SSA Leads",
    "datatype": "string",
    "formula": "IF { FIXED [Phone] : MAX([Resolved Lead]) } = 0 THEN "SSA Unresolved Lead"
ELSEIF { FIXED [Phone] : MAX([Resolved Lead]) } = 1 THEN "SSA Resolved Lead"
END",
    "name": "[Calculation_1467962419029331969]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Post Date ",
    "datatype": "datetime",
    "formula": "//Updated Date: 18 May 2022
//Updated By: Manish
//Description: Formula to calculate UTC date

DATEADD("hour",0,[Post Date])",
    "name": "[Calculation_1916563181826678784]",
    "role": "dimension",
    "type": "ordinal",
  },
  {
    "caption": "Data Updated On",
    "datatype": "datetime",
    "formula": "{fixed :max([Post Date])}",
    "name": "[Calculation_2010857255412854784]",
    "role": "dimension",
    "type": "ordinal",
  },
  {
    "caption": "Grade",
    "datatype": "string",
    "formula": "// Grade A
IF [qual_status] = 'all-steps' THEN 'Grade A'

// Grade B
ELSEIF 
    [qual_status] IN ('fiveyrwrk-disqual','outofwrk-disqual','doc-disqual')
    AND [Calculation_1133007210553765896] = 1
THEN 'Grade B'

// Grade C
ELSEIF 
    [qual_status] <> 'age-disqual'
    AND NOT [Stage3 Response] IN ('Less than 2 years', 'Between 2 and 4 years')
    AND [Stage1 Response] <> 'Social Security Disability (SSD) Benefits'
    AND [Stage6 Response] = 'Not working'
THEN 'Grade C'

// Grade D
ELSEIF 
    // 1) Not age-disqual, Stage3 NOT in those two, Stage1 not SSD, Stage6 ≠ Not working, disqual ≤ 1
    (
      [qual_status] <> 'age-disqual'
      AND NOT [Stage3 Response] IN ('Less than 2 years', 'Between 2 and 4 years')
      AND [Stage1 Response] <> 'Social Security Disability (SSD) Benefits'
      AND [Stage6 Response] <> 'Not working'
      AND [Calculation_1133007210553765896] <= 1
    )
    // 2) Not age-disqual, Stage3 in those two, Qual Status = outofwrk-disqual
    OR
    (
      [qual_status] <> 'age-disqual'
      AND [Stage3 Response] IN ('Less than 2 years', 'Between 2 and 4 years')
      AND [qual_status] = 'outofwrk-disqual'
    )
    // 3) Not age-disqual, Stage3 in those two, Qual Status ≠ outofwrk-disqual, Stage7 = Yes
    OR
    (
      [qual_status] <> 'age-disqual'
      AND [Stage3 Response] IN ('Less than 2 years', 'Between 2 and 4 years')
      AND [qual_status] <> 'outofwrk-disqual'
      AND [Stage7 Response] = 'Yes'
    )
THEN 'Grade D'

// Rest (including age-disqual or anything else)
ELSE 'Rest'
END",
    "name": "[Calculation_7573084309404708864]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Today-28",
    "datatype": "date",
    "formula": "//Updated Date: 18 May 2022
//Updated By: Manish
//Description: Going back 28 days from today

({MAX(today()-28)})",
    "name": "[Calculation_767300790172184597]",
    "role": "dimension",
    "type": "ordinal",
  },
  {
    "caption": "Time-Source-Subid",
    "datatype": "string",
    "formula": "//Updated Date: 18 May 2022
//Updated By: Manish
//Description: Changing the data type to string of Time-Source-Subid column

STR([Date])+'-'+[Source]+'-'+[Sub Id]",
    "name": "[Calculation_7746824680808361990]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "TOTAL([Posted #])",
    "datatype": "integer",
    "formula": "TOTAL([Calculation_99712551082803223])",
    "name": "[Calculation_7975100929057521665]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Date Filter",
    "datatype": "boolean",
    "formula": "//Updated Date: 18 May 2022
//Updated By: Manish
//Description: Filtering data based on date

IF [Parameters].[Parameter 11] = 'default'
THEN [Date]>=[Parameters].[Parameter 5] AND [Date]<=[Parameters].[Parameter 6]
ELSEIF [Parameters].[Parameter 11] = 'weekly'
THEN [Date] >= TODAY()-8 AND [Date] <= TODAY()-1
END",
    "name": "[Calculation_843580506575679492]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Dial R",
    "datatype": "string",
    "formula": "IF  [Called Count] < 4 then "<=3" 
elseif [Called Count] < 8 then "4-7"
elseif [Called Count] < 11 then "8-10"
elseif [Called Count] < 16 then "11-15"
elseif [Called Count] < 20 then "16-19"
elseif [Called Count] < 26 then "20-25"
elseif [Called Count] < 31 then "25-30"
elseif [Called Count] < 36 then "30-35"
else "35+" 
END",
    "name": "[Calculation_847802666706034688]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Dial R (detail)",
    "datatype": "string",
    "formula": "STR([Called Count])",
    "name": "[Calculation_847802666706186241]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Max Date",
    "datatype": "date",
    "formula": "//Updated Date: 18 May 2022
//Updated By: Manish
//Description: Calculating max of todays date for including it in the default values of end date

{MAX(today())}",
    "name": "[Calculation_882424053213511680]",
    "role": "dimension",
    "type": "ordinal",
  },
  {
    "caption": "User Identifier",
    "datatype": "string",
    "formula": "IF [Parameters].[Parameter 12] = 0 THEN [User Id]
ELSEIF [Parameters].[Parameter 12] = 1 THEN [Phone]
END",
    "name": "[Calculation_906349454594166784]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Post Date  ",
    "datatype": "string",
    "formula": "//Updated Date: 18 May 2022
//Updated By: Manish
//Description: Calculation to apply date bucket

CASE [Parameters].[Parameter 1]
WHEN 'year' THEN str(datepart('year', [Calculation_1916563181826678784]))
WHEN 'quarter' THEN "Q" + str(datepart('quarter', [Calculation_1916563181826678784])) + " " + str(datepart('year', [Calculation_1916563181826678784]))
WHEN 'month' THEN str(datepart('month', [Calculation_1916563181826678784])) + "-" + str(datepart('year', [Calculation_1916563181826678784]))
WHEN 'day' THEN str(DATENAME('month', [Calculation_1916563181826678784]))+ "-" +str(datepart('day', [Calculation_1916563181826678784]))+ "-" + str(datepart('year', [Calculation_1916563181826678784]))
WHEN 'week' THEN "W" + str(datepart('week', [Calculation_1916563181826678784])) + "-" + str(datepart('year', [Calculation_1916563181826678784]))
WHEN "hour" THEN str(DATETRUNC('hour', [Calculation_1916563181826678784]))
WHEN "minute" THEN str(DATETRUNC('minute', [Calculation_1916563181826678784]))
END",
    "name": "[Calculation_97320012552925214]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Posted #",
    "datatype": "integer",
    "formula": "//Updated Date: 18 May 2022
//Updated By: Manish
//Description: Calculating the sum of user id wrt to source

countd([Calculation_906349454594166784])",
    "name": "[Calculation_99712551082803223]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Source - Date",
    "datatype": "string",
    "formula": "//Updated Date: 18 May 2022
//Updated By: Manish//Description: Calculating max of todays date for including it in the default values of end date
//Description: Concatinating source and date column

[Source]+":"+[Calculation_97320012552925214]",
    "name": "[Calculation_99712551088799768]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Helper Date",
    "datatype": "string",
    "formula": ""default"",
    "name": "[Parameter 11]",
    "role": "measure",
    "type": "nominal",
  },
  {
    "caption": "User Identifier",
    "datatype": "integer",
    "formula": "0",
    "name": "[Parameter 12]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Date Bucket",
    "datatype": "string",
    "formula": ""day"",
    "name": "[Parameter 1]",
    "role": "measure",
    "type": "nominal",
  },
  {
    "caption": "Start Date",
    "datatype": "date",
    "formula": "#2025-07-30#",
    "name": "[Parameter 5]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "End Date",
    "datatype": "date",
    "formula": "#2025-08-27#",
    "name": "[Parameter 6]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Show Source",
    "datatype": "string",
    "formula": ""1"",
    "name": "[Phone (copy)_1255659924007981058]",
    "role": "measure",
    "type": "nominal",
  },
  {
    "caption": "TTW Grade",
    "datatype": "string",
    "formula": "IF [ttw_qualstatus] = 'ttw-qualified' then 'Grade A'
ELSEIF  [ttw_qualstatus] = 'ttw-nonqualified' and [TTW Explore Work Form] = 'yes' THEN 'Grade B'
ELSEIF [ttw_qualstatus] = 'ttw-nonqualified' and [TTW Explore Work Form] != 'yes' THEN 'Grade C'
ELSEIF ISNULL([ttw_qualstatus]) and [Stage3 Response] = 'Between 2 and 4 years' then 'Grade D'
ELSE 'Rest'
END",
    "name": "[Calculation_1006061976934187009]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "20hrs Disqual",
    "datatype": "integer",
    "formula": "IF [Stage6 Response] = "More than 20 hours per week" THEN 1 ELSE 0 END",
    "name": "[Calculation_1133007210546622464]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Age Disqual",
    "datatype": "integer",
    "formula": "IF INT([Age]) < 40 OR INT([Age]) > 62 THEN 1 ELSE 0 END",
    "name": "[Calculation_1133007210553298946]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Attorney Disqual",
    "datatype": "integer",
    "formula": "IF [Stage5 Response] = "Yes" THEN 1 ELSE 0 END",
    "name": "[Calculation_1133007210553425923]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Ben Disqual",
    "datatype": "integer",
    "formula": "IF IFNULL([Stage1 Response], "") != "I am not receiving any disability benefits (SSD or SSI)"
THEN 1 ELSE 0 END",
    "name": "[Calculation_1133007210553487364]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Doctor Visit Disqual",
    "datatype": "integer",
    "formula": "IF [Stage4 Response] = "No" THEN 1 ELSE 0 END",
    "name": "[Calculation_1133007210553540613]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Five Year Work Disqual",
    "datatype": "integer",
    "formula": "IF [Stage3 Response] = "Less than 2 years"
OR [Stage3 Response] = "Between 2 and 4 years"
THEN 1 ELSE 0 END",
    "name": "[Calculation_1133007210553618438]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Out of Work Disqual",
    "datatype": "integer",
    "formula": "IF [Stage2 Response] = "No" THEN 1 ELSE 0 END",
    "name": "[Calculation_1133007210553663495]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "# of Disqual",
    "datatype": "integer",
    "formula": "ZN([Calculation_1133007210553487364]) +
ZN([Calculation_1133007210553663495]) +
ZN([Calculation_1133007210553618438]) +
ZN([Calculation_1133007210553540613]) +
ZN([Calculation_1133007210553425923]) +
ZN([Calculation_1133007210546622464]) +
ZN([Calculation_1133007210553298946])",
    "name": "[Calculation_1133007210553765896]",
    "role": "dimension",
    "type": "ordinal",
  },
  {
    "caption": "Unresolved SSA Leads",
    "datatype": "string",
    "formula": "IF { FIXED [Phone] : MAX([Resolved Lead]) } = 0 THEN "SSA Unresolved Lead"
ELSEIF { FIXED [Phone] : MAX([Resolved Lead]) } = 1 THEN "SSA Resolved Lead"
END",
    "name": "[Calculation_1467962419029331969]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Post Date ",
    "datatype": "datetime",
    "formula": "//Updated Date: 18 May 2022
//Updated By: Manish
//Description: Formula to calculate UTC date

DATEADD("hour",0,[Post Date])",
    "name": "[Calculation_1916563181826678784]",
    "role": "dimension",
    "type": "ordinal",
  },
  {
    "caption": "Data Updated On",
    "datatype": "datetime",
    "formula": "{fixed :max([Post Date])}",
    "name": "[Calculation_2010857255412854784]",
    "role": "dimension",
    "type": "ordinal",
  },
  {
    "caption": "Grade",
    "datatype": "string",
    "formula": "// Grade A
IF [qual_status] = 'all-steps' THEN 'Grade A'

// Grade B
ELSEIF 
    [qual_status] IN ('fiveyrwrk-disqual','outofwrk-disqual','doc-disqual')
    AND [Calculation_1133007210553765896] = 1
THEN 'Grade B'

// Grade C
ELSEIF 
    [qual_status] <> 'age-disqual'
    AND NOT [Stage3 Response] IN ('Less than 2 years', 'Between 2 and 4 years')
    AND [Stage1 Response] <> 'Social Security Disability (SSD) Benefits'
    AND [Stage6 Response] = 'Not working'
THEN 'Grade C'

// Grade D
ELSEIF 
    // 1) Not age-disqual, Stage3 NOT in those two, Stage1 not SSD, Stage6 ≠ Not working, disqual ≤ 1
    (
      [qual_status] <> 'age-disqual'
      AND NOT [Stage3 Response] IN ('Less than 2 years', 'Between 2 and 4 years')
      AND [Stage1 Response] <> 'Social Security Disability (SSD) Benefits'
      AND [Stage6 Response] <> 'Not working'
      AND [Calculation_1133007210553765896] <= 1
    )
    // 2) Not age-disqual, Stage3 in those two, Qual Status = outofwrk-disqual
    OR
    (
      [qual_status] <> 'age-disqual'
      AND [Stage3 Response] IN ('Less than 2 years', 'Between 2 and 4 years')
      AND [qual_status] = 'outofwrk-disqual'
    )
    // 3) Not age-disqual, Stage3 in those two, Qual Status ≠ outofwrk-disqual, Stage7 = Yes
    OR
    (
      [qual_status] <> 'age-disqual'
      AND [Stage3 Response] IN ('Less than 2 years', 'Between 2 and 4 years')
      AND [qual_status] <> 'outofwrk-disqual'
      AND [Stage7 Response] = 'Yes'
    )
THEN 'Grade D'

// Rest (including age-disqual or anything else)
ELSE 'Rest'
END",
    "name": "[Calculation_7573084309404708864]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Today-28",
    "datatype": "date",
    "formula": "//Updated Date: 18 May 2022
//Updated By: Manish
//Description: Going back 28 days from today

({MAX(today()-28)})",
    "name": "[Calculation_767300790172184597]",
    "role": "dimension",
    "type": "ordinal",
  },
  {
    "caption": "Time-Source-Subid",
    "datatype": "string",
    "formula": "//Updated Date: 18 May 2022
//Updated By: Manish
//Description: Changing the data type to string of Time-Source-Subid column

STR([Date])+'-'+[Source]+'-'+[Sub Id]",
    "name": "[Calculation_7746824680808361990]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "TOTAL([Posted #])",
    "datatype": "integer",
    "formula": "TOTAL([Calculation_99712551082803223])",
    "name": "[Calculation_7975100929058140163]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Date Filter",
    "datatype": "boolean",
    "formula": "//Updated Date: 18 May 2022
//Updated By: Manish
//Description: Filtering data based on date

IF [Parameters].[Parameter 11] = 'default'
THEN [Date]>=[Parameters].[Parameter 5] AND [Date]<=[Parameters].[Parameter 6]
ELSEIF [Parameters].[Parameter 11] = 'weekly'
THEN [Date] >= TODAY()-8 AND [Date] <= TODAY()-1
END",
    "name": "[Calculation_843580506575679492]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Dial R",
    "datatype": "string",
    "formula": "IF  [Called Count] < 4 then "<=3" 
elseif [Called Count] < 8 then "4-7"
elseif [Called Count] < 11 then "8-10"
elseif [Called Count] < 16 then "11-15"
elseif [Called Count] < 20 then "16-19"
elseif [Called Count] < 26 then "20-25"
elseif [Called Count] < 31 then "25-30"
elseif [Called Count] < 36 then "30-35"
else "35+" 
END",
    "name": "[Calculation_847802666706034688]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Dial R (detail)",
    "datatype": "string",
    "formula": "STR([Called Count])",
    "name": "[Calculation_847802666706186241]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Max Date",
    "datatype": "date",
    "formula": "//Updated Date: 18 May 2022
//Updated By: Manish
//Description: Calculating max of todays date for including it in the default values of end date

{MAX(today())}",
    "name": "[Calculation_882424053213511680]",
    "role": "dimension",
    "type": "ordinal",
  },
  {
    "caption": "User Identifier",
    "datatype": "string",
    "formula": "IF [Parameters].[Parameter 12] = 0 THEN [User Id]
ELSEIF [Parameters].[Parameter 12] = 1 THEN [Phone]
END",
    "name": "[Calculation_906349454594166784]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Post Date  ",
    "datatype": "string",
    "formula": "//Updated Date: 18 May 2022
//Updated By: Manish
//Description: Calculation to apply date bucket

CASE [Parameters].[Parameter 1]
WHEN 'year' THEN str(datepart('year', [Calculation_1916563181826678784]))
WHEN 'quarter' THEN "Q" + str(datepart('quarter', [Calculation_1916563181826678784])) + " " + str(datepart('year', [Calculation_1916563181826678784]))
WHEN 'month' THEN str(datepart('month', [Calculation_1916563181826678784])) + "-" + str(datepart('year', [Calculation_1916563181826678784]))
WHEN 'day' THEN str(DATENAME('month', [Calculation_1916563181826678784]))+ "-" +str(datepart('day', [Calculation_1916563181826678784]))+ "-" + str(datepart('year', [Calculation_1916563181826678784]))
WHEN 'week' THEN "W" + str(datepart('week', [Calculation_1916563181826678784])) + "-" + str(datepart('year', [Calculation_1916563181826678784]))
WHEN "hour" THEN str(DATETRUNC('hour', [Calculation_1916563181826678784]))
WHEN "minute" THEN str(DATETRUNC('minute', [Calculation_1916563181826678784]))
END",
    "name": "[Calculation_97320012552925214]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Posted #",
    "datatype": "integer",
    "formula": "//Updated Date: 18 May 2022
//Updated By: Manish
//Description: Calculating the sum of user id wrt to source

countd([Calculation_906349454594166784])",
    "name": "[Calculation_99712551082803223]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Source - Date",
    "datatype": "string",
    "formula": "//Updated Date: 18 May 2022
//Updated By: Manish//Description: Calculating max of todays date for including it in the default values of end date
//Description: Concatinating source and date column

[Source]+":"+[Calculation_97320012552925214]",
    "name": "[Calculation_99712551088799768]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Source ",
    "datatype": "string",
    "formula": "CASE [Parameters].[Phone (copy)_1255659924007981058]
WHEN "0" THEN "Agg"
WHEN "1" THEN [Source]
END",
    "name": "[Phone (copy)_1255659924007964673]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Source-Subid-Date",
    "datatype": "string",
    "formula": "//Updated Date: 18 May 2022
//Updated By: Manish//Description: Calculating max of todays date for including it in the default values of end date
//Description: Concatinating source, subid and date column

[Phone (copy)_1255659924007964673]+":"+[Sub Id]+":"+[Calculation_97320012552925214]",
    "name": "[Source-Subid (copy)_99712551118721055]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Date Bucket",
    "datatype": "string",
    "formula": ""day"",
    "name": "[Parameter 1]",
    "role": "measure",
    "type": "nominal",
  },
  {
    "caption": "TTW Grade",
    "datatype": "string",
    "formula": "IF [ttw_qualstatus] = 'ttw-qualified' then 'Grade A'
ELSEIF  [ttw_qualstatus] = 'ttw-nonqualified' and [TTW Explore Work Form] = 'yes' THEN 'Grade B'
ELSEIF [ttw_qualstatus] = 'ttw-nonqualified' and [TTW Explore Work Form] != 'yes' THEN 'Grade C'
ELSEIF ISNULL([ttw_qualstatus]) and [Stage3 Response] = 'Between 2 and 4 years' then 'Grade D'
ELSE 'Rest'
END",
    "name": "[Calculation_1006061976934187009]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "20hrs Disqual",
    "datatype": "integer",
    "formula": "IF [Stage6 Response] = "More than 20 hours per week" THEN 1 ELSE 0 END",
    "name": "[Calculation_1133007210546622464]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Age Disqual",
    "datatype": "integer",
    "formula": "IF INT([Age]) < 40 OR INT([Age]) > 62 THEN 1 ELSE 0 END",
    "name": "[Calculation_1133007210553298946]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Attorney Disqual",
    "datatype": "integer",
    "formula": "IF [Stage5 Response] = "Yes" THEN 1 ELSE 0 END",
    "name": "[Calculation_1133007210553425923]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Ben Disqual",
    "datatype": "integer",
    "formula": "IF IFNULL([Stage1 Response], "") != "I am not receiving any disability benefits (SSD or SSI)"
THEN 1 ELSE 0 END",
    "name": "[Calculation_1133007210553487364]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Doctor Visit Disqual",
    "datatype": "integer",
    "formula": "IF [Stage4 Response] = "No" THEN 1 ELSE 0 END",
    "name": "[Calculation_1133007210553540613]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Five Year Work Disqual",
    "datatype": "integer",
    "formula": "IF [Stage3 Response] = "Less than 2 years"
OR [Stage3 Response] = "Between 2 and 4 years"
THEN 1 ELSE 0 END",
    "name": "[Calculation_1133007210553618438]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Out of Work Disqual",
    "datatype": "integer",
    "formula": "IF [Stage2 Response] = "No" THEN 1 ELSE 0 END",
    "name": "[Calculation_1133007210553663495]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "# of Disqual",
    "datatype": "integer",
    "formula": "ZN([Calculation_1133007210553487364]) +
ZN([Calculation_1133007210553663495]) +
ZN([Calculation_1133007210553618438]) +
ZN([Calculation_1133007210553540613]) +
ZN([Calculation_1133007210553425923]) +
ZN([Calculation_1133007210546622464]) +
ZN([Calculation_1133007210553298946])",
    "name": "[Calculation_1133007210553765896]",
    "role": "dimension",
    "type": "ordinal",
  },
  {
    "caption": "Unresolved SSA Leads",
    "datatype": "string",
    "formula": "IF { FIXED [Phone] : MAX([Resolved Lead]) } = 0 THEN "SSA Unresolved Lead"
ELSEIF { FIXED [Phone] : MAX([Resolved Lead]) } = 1 THEN "SSA Resolved Lead"
END",
    "name": "[Calculation_1467962419029331969]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Post Date ",
    "datatype": "datetime",
    "formula": "//Updated Date: 18 May 2022
//Updated By: Manish
//Description: Formula to calculate UTC date

DATEADD("hour",0,[Post Date])",
    "name": "[Calculation_1916563181826678784]",
    "role": "dimension",
    "type": "ordinal",
  },
  {
    "caption": "Data Updated On",
    "datatype": "datetime",
    "formula": "{fixed :max([Post Date])}",
    "name": "[Calculation_2010857255412854784]",
    "role": "dimension",
    "type": "ordinal",
  },
  {
    "caption": "Grade",
    "datatype": "string",
    "formula": "// Grade A
IF [qual_status] = 'all-steps' THEN 'Grade A'

// Grade B
ELSEIF 
    [qual_status] IN ('fiveyrwrk-disqual','outofwrk-disqual','doc-disqual')
    AND [Calculation_1133007210553765896] = 1
THEN 'Grade B'

// Grade C
ELSEIF 
    [qual_status] <> 'age-disqual'
    AND NOT [Stage3 Response] IN ('Less than 2 years', 'Between 2 and 4 years')
    AND [Stage1 Response] <> 'Social Security Disability (SSD) Benefits'
    AND [Stage6 Response] = 'Not working'
THEN 'Grade C'

// Grade D
ELSEIF 
    // 1) Not age-disqual, Stage3 NOT in those two, Stage1 not SSD, Stage6 ≠ Not working, disqual ≤ 1
    (
      [qual_status] <> 'age-disqual'
      AND NOT [Stage3 Response] IN ('Less than 2 years', 'Between 2 and 4 years')
      AND [Stage1 Response] <> 'Social Security Disability (SSD) Benefits'
      AND [Stage6 Response] <> 'Not working'
      AND [Calculation_1133007210553765896] <= 1
    )
    // 2) Not age-disqual, Stage3 in those two, Qual Status = outofwrk-disqual
    OR
    (
      [qual_status] <> 'age-disqual'
      AND [Stage3 Response] IN ('Less than 2 years', 'Between 2 and 4 years')
      AND [qual_status] = 'outofwrk-disqual'
    )
    // 3) Not age-disqual, Stage3 in those two, Qual Status ≠ outofwrk-disqual, Stage7 = Yes
    OR
    (
      [qual_status] <> 'age-disqual'
      AND [Stage3 Response] IN ('Less than 2 years', 'Between 2 and 4 years')
      AND [qual_status] <> 'outofwrk-disqual'
      AND [Stage7 Response] = 'Yes'
    )
THEN 'Grade D'

// Rest (including age-disqual or anything else)
ELSE 'Rest'
END",
    "name": "[Calculation_7573084309404708864]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Time-Source-Subid",
    "datatype": "string",
    "formula": "//Updated Date: 18 May 2022
//Updated By: Manish
//Description: Changing the data type to string of Time-Source-Subid column

STR([Date])+'-'+[Source]+'-'+[Sub Id]",
    "name": "[Calculation_7746824680808361990]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Dial R",
    "datatype": "string",
    "formula": "IF  [Called Count] < 4 then "<=3" 
elseif [Called Count] < 8 then "4-7"
elseif [Called Count] < 11 then "8-10"
elseif [Called Count] < 16 then "11-15"
elseif [Called Count] < 20 then "16-19"
elseif [Called Count] < 26 then "20-25"
elseif [Called Count] < 31 then "25-30"
elseif [Called Count] < 36 then "30-35"
else "35+" 
END",
    "name": "[Calculation_847802666706034688]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Dial R (detail)",
    "datatype": "string",
    "formula": "STR([Called Count])",
    "name": "[Calculation_847802666706186241]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Post Date  ",
    "datatype": "string",
    "formula": "//Updated Date: 18 May 2022
//Updated By: Manish
//Description: Calculation to apply date bucket

CASE [Parameters].[Parameter 1]
WHEN 'year' THEN str(datepart('year', [Calculation_1916563181826678784]))
WHEN 'quarter' THEN "Q" + str(datepart('quarter', [Calculation_1916563181826678784])) + " " + str(datepart('year', [Calculation_1916563181826678784]))
WHEN 'month' THEN str(datepart('month', [Calculation_1916563181826678784])) + "-" + str(datepart('year', [Calculation_1916563181826678784]))
WHEN 'day' THEN str(DATENAME('month', [Calculation_1916563181826678784]))+ "-" +str(datepart('day', [Calculation_1916563181826678784]))+ "-" + str(datepart('year', [Calculation_1916563181826678784]))
WHEN 'week' THEN "W" + str(datepart('week', [Calculation_1916563181826678784])) + "-" + str(datepart('year', [Calculation_1916563181826678784]))
WHEN "hour" THEN str(DATETRUNC('hour', [Calculation_1916563181826678784]))
WHEN "minute" THEN str(DATETRUNC('minute', [Calculation_1916563181826678784]))
END",
    "name": "[Calculation_97320012552925214]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Source - Date",
    "datatype": "string",
    "formula": "//Updated Date: 18 May 2022
//Updated By: Manish//Description: Calculating max of todays date for including it in the default values of end date
//Description: Concatinating source and date column

[Source]+":"+[Calculation_97320012552925214]",
    "name": "[Calculation_99712551088799768]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Date Filter Yeaterday",
    "datatype": "boolean",
    "formula": "//Updated Date: 18 May 2022
//Updated By: Manish
//Description: Filtering the date wrt yesterday

[Date]=today()-1",
    "name": "[Date Filter (copy)_7495186061619691521]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Helper Date",
    "datatype": "string",
    "formula": ""default"",
    "name": "[Parameter 11]",
    "role": "measure",
    "type": "nominal",
  },
  {
    "caption": "Date Bucket",
    "datatype": "string",
    "formula": ""day"",
    "name": "[Parameter 1]",
    "role": "measure",
    "type": "nominal",
  },
  {
    "caption": "Start Date",
    "datatype": "date",
    "formula": "#2025-07-30#",
    "name": "[Parameter 5]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "End Date",
    "datatype": "date",
    "formula": "#2025-08-27#",
    "name": "[Parameter 6]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "TTW Grade",
    "datatype": "string",
    "formula": "IF [ttw_qualstatus] = 'ttw-qualified' then 'Grade A'
ELSEIF  [ttw_qualstatus] = 'ttw-nonqualified' and [TTW Explore Work Form] = 'yes' THEN 'Grade B'
ELSEIF [ttw_qualstatus] = 'ttw-nonqualified' and [TTW Explore Work Form] != 'yes' THEN 'Grade C'
ELSEIF ISNULL([ttw_qualstatus]) and [Stage3 Response] = 'Between 2 and 4 years' then 'Grade D'
ELSE 'Rest'
END",
    "name": "[Calculation_1006061976934187009]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "20hrs Disqual",
    "datatype": "integer",
    "formula": "IF [Stage6 Response] = "More than 20 hours per week" THEN 1 ELSE 0 END",
    "name": "[Calculation_1133007210546622464]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Age Disqual",
    "datatype": "integer",
    "formula": "IF INT([Age]) < 40 OR INT([Age]) > 62 THEN 1 ELSE 0 END",
    "name": "[Calculation_1133007210553298946]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Attorney Disqual",
    "datatype": "integer",
    "formula": "IF [Stage5 Response] = "Yes" THEN 1 ELSE 0 END",
    "name": "[Calculation_1133007210553425923]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Ben Disqual",
    "datatype": "integer",
    "formula": "IF IFNULL([Stage1 Response], "") != "I am not receiving any disability benefits (SSD or SSI)"
THEN 1 ELSE 0 END",
    "name": "[Calculation_1133007210553487364]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Doctor Visit Disqual",
    "datatype": "integer",
    "formula": "IF [Stage4 Response] = "No" THEN 1 ELSE 0 END",
    "name": "[Calculation_1133007210553540613]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Five Year Work Disqual",
    "datatype": "integer",
    "formula": "IF [Stage3 Response] = "Less than 2 years"
OR [Stage3 Response] = "Between 2 and 4 years"
THEN 1 ELSE 0 END",
    "name": "[Calculation_1133007210553618438]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Out of Work Disqual",
    "datatype": "integer",
    "formula": "IF [Stage2 Response] = "No" THEN 1 ELSE 0 END",
    "name": "[Calculation_1133007210553663495]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "# of Disqual",
    "datatype": "integer",
    "formula": "ZN([Calculation_1133007210553487364]) +
ZN([Calculation_1133007210553663495]) +
ZN([Calculation_1133007210553618438]) +
ZN([Calculation_1133007210553540613]) +
ZN([Calculation_1133007210553425923]) +
ZN([Calculation_1133007210546622464]) +
ZN([Calculation_1133007210553298946])",
    "name": "[Calculation_1133007210553765896]",
    "role": "dimension",
    "type": "ordinal",
  },
  {
    "caption": "Unresolved SSA Leads",
    "datatype": "string",
    "formula": "IF { FIXED [Phone] : MAX([Resolved Lead]) } = 0 THEN "SSA Unresolved Lead"
ELSEIF { FIXED [Phone] : MAX([Resolved Lead]) } = 1 THEN "SSA Resolved Lead"
END",
    "name": "[Calculation_1467962419029331969]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Post Date ",
    "datatype": "datetime",
    "formula": "//Updated Date: 18 May 2022
//Updated By: Manish
//Description: Formula to calculate UTC date

DATEADD("hour",0,[Post Date])",
    "name": "[Calculation_1916563181826678784]",
    "role": "dimension",
    "type": "ordinal",
  },
  {
    "caption": "Data Updated On",
    "datatype": "datetime",
    "formula": "{fixed :max([Post Date])}",
    "name": "[Calculation_2010857255412854784]",
    "role": "dimension",
    "type": "ordinal",
  },
  {
    "caption": "{EXCLUDE [Source-Subid]: [Lead]}",
    "datatype": "integer",
    "formula": "{EXCLUDE [Calculation_99712551105503258]: [Calculation_97320012564762668]}",
    "name": "[Calculation_390968786027806720]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Grade",
    "datatype": "string",
    "formula": "// Grade A
IF [qual_status] = 'all-steps' THEN 'Grade A'

// Grade B
ELSEIF 
    [qual_status] IN ('fiveyrwrk-disqual','outofwrk-disqual','doc-disqual')
    AND [Calculation_1133007210553765896] = 1
THEN 'Grade B'

// Grade C
ELSEIF 
    [qual_status] <> 'age-disqual'
    AND NOT [Stage3 Response] IN ('Less than 2 years', 'Between 2 and 4 years')
    AND [Stage1 Response] <> 'Social Security Disability (SSD) Benefits'
    AND [Stage6 Response] = 'Not working'
THEN 'Grade C'

// Grade D
ELSEIF 
    // 1) Not age-disqual, Stage3 NOT in those two, Stage1 not SSD, Stage6 ≠ Not working, disqual ≤ 1
    (
      [qual_status] <> 'age-disqual'
      AND NOT [Stage3 Response] IN ('Less than 2 years', 'Between 2 and 4 years')
      AND [Stage1 Response] <> 'Social Security Disability (SSD) Benefits'
      AND [Stage6 Response] <> 'Not working'
      AND [Calculation_1133007210553765896] <= 1
    )
    // 2) Not age-disqual, Stage3 in those two, Qual Status = outofwrk-disqual
    OR
    (
      [qual_status] <> 'age-disqual'
      AND [Stage3 Response] IN ('Less than 2 years', 'Between 2 and 4 years')
      AND [qual_status] = 'outofwrk-disqual'
    )
    // 3) Not age-disqual, Stage3 in those two, Qual Status ≠ outofwrk-disqual, Stage7 = Yes
    OR
    (
      [qual_status] <> 'age-disqual'
      AND [Stage3 Response] IN ('Less than 2 years', 'Between 2 and 4 years')
      AND [qual_status] <> 'outofwrk-disqual'
      AND [Stage7 Response] = 'Yes'
    )
THEN 'Grade D'

// Rest (including age-disqual or anything else)
ELSE 'Rest'
END",
    "name": "[Calculation_7573084309404708864]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Today-28",
    "datatype": "date",
    "formula": "//Updated Date: 18 May 2022
//Updated By: Manish
//Description: Going back 28 days from today

({MAX(today()-28)})",
    "name": "[Calculation_767300790172184597]",
    "role": "dimension",
    "type": "ordinal",
  },
  {
    "caption": "Date Filter",
    "datatype": "boolean",
    "formula": "//Updated Date: 18 May 2022
//Updated By: Manish
//Description: Filtering data based on date

IF [Parameters].[Parameter 11] = 'default'
THEN [Date]>=[Parameters].[Parameter 5] AND [Date]<=[Parameters].[Parameter 6]
ELSEIF [Parameters].[Parameter 11] = 'weekly'
THEN [Date] >= TODAY()-8 AND [Date] <= TODAY()-1
END",
    "name": "[Calculation_843580506575679492]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Dial R",
    "datatype": "string",
    "formula": "IF  [Called Count] < 4 then "<=3" 
elseif [Called Count] < 8 then "4-7"
elseif [Called Count] < 11 then "8-10"
elseif [Called Count] < 16 then "11-15"
elseif [Called Count] < 20 then "16-19"
elseif [Called Count] < 26 then "20-25"
elseif [Called Count] < 31 then "25-30"
elseif [Called Count] < 36 then "30-35"
else "35+" 
END",
    "name": "[Calculation_847802666706034688]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Dial R (detail)",
    "datatype": "string",
    "formula": "STR([Called Count])",
    "name": "[Calculation_847802666706186241]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Max Date",
    "datatype": "date",
    "formula": "//Updated Date: 18 May 2022
//Updated By: Manish
//Description: Calculating max of todays date for including it in the default values of end date

{MAX(today())}",
    "name": "[Calculation_882424053213511680]",
    "role": "dimension",
    "type": "ordinal",
  },
  {
    "caption": "Post Date  ",
    "datatype": "string",
    "formula": "//Updated Date: 18 May 2022
//Updated By: Manish
//Description: Calculation to apply date bucket

CASE [Parameters].[Parameter 1]
WHEN 'year' THEN str(datepart('year', [Calculation_1916563181826678784]))
WHEN 'quarter' THEN "Q" + str(datepart('quarter', [Calculation_1916563181826678784])) + " " + str(datepart('year', [Calculation_1916563181826678784]))
WHEN 'month' THEN str(datepart('month', [Calculation_1916563181826678784])) + "-" + str(datepart('year', [Calculation_1916563181826678784]))
WHEN 'day' THEN str(DATENAME('month', [Calculation_1916563181826678784]))+ "-" +str(datepart('day', [Calculation_1916563181826678784]))+ "-" + str(datepart('year', [Calculation_1916563181826678784]))
WHEN 'week' THEN "W" + str(datepart('week', [Calculation_1916563181826678784])) + "-" + str(datepart('year', [Calculation_1916563181826678784]))
WHEN "hour" THEN str(DATETRUNC('hour', [Calculation_1916563181826678784]))
WHEN "minute" THEN str(DATETRUNC('minute', [Calculation_1916563181826678784]))
END",
    "name": "[Calculation_97320012552925214]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Campaign & Date",
    "datatype": "string",
    "formula": "//Updated Date: 18 May 2022
//Updated By: Manish
//Description: Concatinating campaign and date

[CZ Project Name]+":"+[Calculation_97320012552925214]",
    "name": "[Calculation_97320012555808806]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Lead",
    "datatype": "integer",
    "formula": "//Updated Date: 18 May 2022
//Updated By: Manish
//Description: Calculating the unique count of user ids

COUNTD([User Id])",
    "name": "[Calculation_97320012564762668]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Source-Subid",
    "datatype": "string",
    "formula": "//Updated Date: 18 May 2022
//Updated By: Manish//Description: Calculating max of todays date for including it in the default values of end date
//Description: Concatinating source and subid column

[Source]+" : "+[Sub Id]",
    "name": "[Calculation_99712551105503258]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Helper Date",
    "datatype": "string",
    "formula": ""default"",
    "name": "[Parameter 11]",
    "role": "measure",
    "type": "nominal",
  },
  {
    "caption": "Date Bucket",
    "datatype": "string",
    "formula": ""day"",
    "name": "[Parameter 1]",
    "role": "measure",
    "type": "nominal",
  },
  {
    "caption": "Start Date",
    "datatype": "date",
    "formula": "#2025-07-30#",
    "name": "[Parameter 5]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "End Date",
    "datatype": "date",
    "formula": "#2025-08-27#",
    "name": "[Parameter 6]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "TTW Grade",
    "datatype": "string",
    "formula": "IF [ttw_qualstatus] = 'ttw-qualified' then 'Grade A'
ELSEIF  [ttw_qualstatus] = 'ttw-nonqualified' and [TTW Explore Work Form] = 'yes' THEN 'Grade B'
ELSEIF [ttw_qualstatus] = 'ttw-nonqualified' and [TTW Explore Work Form] != 'yes' THEN 'Grade C'
ELSEIF ISNULL([ttw_qualstatus]) and [Stage3 Response] = 'Between 2 and 4 years' then 'Grade D'
ELSE 'Rest'
END",
    "name": "[Calculation_1006061976934187009]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Hour of Day",
    "datatype": "string",
    "formula": "IF LEN(STR(DATEPART('hour', [Calculation_1916563181826678784]))) = 1
THEN "0" + STR(DATEPART('hour', [Calculation_1916563181826678784]))
ELSE STR(DATEPART('hour', [Calculation_1916563181826678784]))
END",
    "name": "[Calculation_1113233589182521344]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "20hrs Disqual",
    "datatype": "integer",
    "formula": "IF [Stage6 Response] = "More than 20 hours per week" THEN 1 ELSE 0 END",
    "name": "[Calculation_1133007210546622464]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Age Disqual",
    "datatype": "integer",
    "formula": "IF INT([Age]) < 40 OR INT([Age]) > 62 THEN 1 ELSE 0 END",
    "name": "[Calculation_1133007210553298946]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Attorney Disqual",
    "datatype": "integer",
    "formula": "IF [Stage5 Response] = "Yes" THEN 1 ELSE 0 END",
    "name": "[Calculation_1133007210553425923]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Ben Disqual",
    "datatype": "integer",
    "formula": "IF IFNULL([Stage1 Response], "") != "I am not receiving any disability benefits (SSD or SSI)"
THEN 1 ELSE 0 END",
    "name": "[Calculation_1133007210553487364]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Doctor Visit Disqual",
    "datatype": "integer",
    "formula": "IF [Stage4 Response] = "No" THEN 1 ELSE 0 END",
    "name": "[Calculation_1133007210553540613]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Five Year Work Disqual",
    "datatype": "integer",
    "formula": "IF [Stage3 Response] = "Less than 2 years"
OR [Stage3 Response] = "Between 2 and 4 years"
THEN 1 ELSE 0 END",
    "name": "[Calculation_1133007210553618438]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Out of Work Disqual",
    "datatype": "integer",
    "formula": "IF [Stage2 Response] = "No" THEN 1 ELSE 0 END",
    "name": "[Calculation_1133007210553663495]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "# of Disqual",
    "datatype": "integer",
    "formula": "ZN([Calculation_1133007210553487364]) +
ZN([Calculation_1133007210553663495]) +
ZN([Calculation_1133007210553618438]) +
ZN([Calculation_1133007210553540613]) +
ZN([Calculation_1133007210553425923]) +
ZN([Calculation_1133007210546622464]) +
ZN([Calculation_1133007210553298946])",
    "name": "[Calculation_1133007210553765896]",
    "role": "dimension",
    "type": "ordinal",
  },
  {
    "caption": "Unresolved SSA Leads",
    "datatype": "string",
    "formula": "IF { FIXED [Phone] : MAX([Resolved Lead]) } = 0 THEN "SSA Unresolved Lead"
ELSEIF { FIXED [Phone] : MAX([Resolved Lead]) } = 1 THEN "SSA Resolved Lead"
END",
    "name": "[Calculation_1467962419029331969]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "CZ Post Hour Group",
    "datatype": "string",
    "formula": "IF DATEPART('hour', [Post Date]) >= 0 AND DATEPART('hour', [Post Date]) < 6 THEN 'Pre CC Hours'
ELSEIF DATEPART('hour', [Post Date]) >= 6 AND DATEPART('hour', [Post Date]) < 16 THEN 'CC Hours'
ELSEIF DATEPART('hour', [Post Date]) >= 16 AND DATEPART('hour', [Post Date]) < 24 THEN 'Post CC Hours'
END",
    "name": "[Calculation_1880252886125215747]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Post Date ",
    "datatype": "datetime",
    "formula": "//Updated Date: 18 May 2022
//Updated By: Manish
//Description: Formula to calculate UTC date

DATEADD("hour",0,[Post Date])",
    "name": "[Calculation_1916563181826678784]",
    "role": "dimension",
    "type": "ordinal",
  },
  {
    "caption": "Data Updated On",
    "datatype": "datetime",
    "formula": "{fixed :max([Post Date])}",
    "name": "[Calculation_2010857255412854784]",
    "role": "dimension",
    "type": "ordinal",
  },
  {
    "caption": "{EXCLUDE  [Status]:[Lead]}",
    "datatype": "integer",
    "formula": "{EXCLUDE  [Status]:[Calculation_97320012564762668]}",
    "name": "[Calculation_390968786028515329]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Grade",
    "datatype": "string",
    "formula": "// Grade A
IF [qual_status] = 'all-steps' THEN 'Grade A'

// Grade B
ELSEIF 
    [qual_status] IN ('fiveyrwrk-disqual','outofwrk-disqual','doc-disqual')
    AND [Calculation_1133007210553765896] = 1
THEN 'Grade B'

// Grade C
ELSEIF 
    [qual_status] <> 'age-disqual'
    AND NOT [Stage3 Response] IN ('Less than 2 years', 'Between 2 and 4 years')
    AND [Stage1 Response] <> 'Social Security Disability (SSD) Benefits'
    AND [Stage6 Response] = 'Not working'
THEN 'Grade C'

// Grade D
ELSEIF 
    // 1) Not age-disqual, Stage3 NOT in those two, Stage1 not SSD, Stage6 ≠ Not working, disqual ≤ 1
    (
      [qual_status] <> 'age-disqual'
      AND NOT [Stage3 Response] IN ('Less than 2 years', 'Between 2 and 4 years')
      AND [Stage1 Response] <> 'Social Security Disability (SSD) Benefits'
      AND [Stage6 Response] <> 'Not working'
      AND [Calculation_1133007210553765896] <= 1
    )
    // 2) Not age-disqual, Stage3 in those two, Qual Status = outofwrk-disqual
    OR
    (
      [qual_status] <> 'age-disqual'
      AND [Stage3 Response] IN ('Less than 2 years', 'Between 2 and 4 years')
      AND [qual_status] = 'outofwrk-disqual'
    )
    // 3) Not age-disqual, Stage3 in those two, Qual Status ≠ outofwrk-disqual, Stage7 = Yes
    OR
    (
      [qual_status] <> 'age-disqual'
      AND [Stage3 Response] IN ('Less than 2 years', 'Between 2 and 4 years')
      AND [qual_status] <> 'outofwrk-disqual'
      AND [Stage7 Response] = 'Yes'
    )
THEN 'Grade D'

// Rest (including age-disqual or anything else)
ELSE 'Rest'
END",
    "name": "[Calculation_7573084309404708864]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Today-28",
    "datatype": "date",
    "formula": "//Updated Date: 18 May 2022
//Updated By: Manish
//Description: Going back 28 days from today

({MAX(today()-28)})",
    "name": "[Calculation_767300790172184597]",
    "role": "dimension",
    "type": "ordinal",
  },
  {
    "caption": "Date Filter",
    "datatype": "boolean",
    "formula": "//Updated Date: 18 May 2022
//Updated By: Manish
//Description: Filtering data based on date

IF [Parameters].[Parameter 11] = 'default'
THEN [Date]>=[Parameters].[Parameter 5] AND [Date]<=[Parameters].[Parameter 6]
ELSEIF [Parameters].[Parameter 11] = 'weekly'
THEN [Date] >= TODAY()-8 AND [Date] <= TODAY()-1
END",
    "name": "[Calculation_843580506575679492]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Dial R",
    "datatype": "string",
    "formula": "IF  [Called Count] < 4 then "<=3" 
elseif [Called Count] < 8 then "4-7"
elseif [Called Count] < 11 then "8-10"
elseif [Called Count] < 16 then "11-15"
elseif [Called Count] < 20 then "16-19"
elseif [Called Count] < 26 then "20-25"
elseif [Called Count] < 31 then "25-30"
elseif [Called Count] < 36 then "30-35"
else "35+" 
END",
    "name": "[Calculation_847802666706034688]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Dial R (detail)",
    "datatype": "string",
    "formula": "STR([Called Count])",
    "name": "[Calculation_847802666706186241]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Max Date",
    "datatype": "date",
    "formula": "//Updated Date: 18 May 2022
//Updated By: Manish
//Description: Calculating max of todays date for including it in the default values of end date

{MAX(today())}",
    "name": "[Calculation_882424053213511680]",
    "role": "dimension",
    "type": "ordinal",
  },
  {
    "caption": "Post Date  ",
    "datatype": "string",
    "formula": "//Updated Date: 18 May 2022
//Updated By: Manish
//Description: Calculation to apply date bucket

CASE [Parameters].[Parameter 1]
WHEN 'year' THEN str(datepart('year', [Calculation_1916563181826678784]))
WHEN 'quarter' THEN "Q" + str(datepart('quarter', [Calculation_1916563181826678784])) + " " + str(datepart('year', [Calculation_1916563181826678784]))
WHEN 'month' THEN str(datepart('month', [Calculation_1916563181826678784])) + "-" + str(datepart('year', [Calculation_1916563181826678784]))
WHEN 'day' THEN str(DATENAME('month', [Calculation_1916563181826678784]))+ "-" +str(datepart('day', [Calculation_1916563181826678784]))+ "-" + str(datepart('year', [Calculation_1916563181826678784]))
WHEN 'week' THEN "W" + str(datepart('week', [Calculation_1916563181826678784])) + "-" + str(datepart('year', [Calculation_1916563181826678784]))
WHEN "hour" THEN str(DATETRUNC('hour', [Calculation_1916563181826678784]))
WHEN "minute" THEN str(DATETRUNC('minute', [Calculation_1916563181826678784]))
END",
    "name": "[Calculation_97320012552925214]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Campaign & Date",
    "datatype": "string",
    "formula": "//Updated Date: 18 May 2022
//Updated By: Manish
//Description: Concatinating campaign and date

[CZ Project Name]+":"+[Calculation_97320012552925214]",
    "name": "[Calculation_97320012555808806]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Lead",
    "datatype": "integer",
    "formula": "//Updated Date: 18 May 2022
//Updated By: Manish
//Description: Calculating the unique count of user ids

COUNTD([User Id])",
    "name": "[Calculation_97320012564762668]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Helper Date",
    "datatype": "string",
    "formula": ""default"",
    "name": "[Parameter 11]",
    "role": "measure",
    "type": "nominal",
  },
  {
    "caption": "Date Bucket",
    "datatype": "string",
    "formula": ""day"",
    "name": "[Parameter 1]",
    "role": "measure",
    "type": "nominal",
  },
  {
    "caption": "Start Date",
    "datatype": "date",
    "formula": "#2025-07-30#",
    "name": "[Parameter 5]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "End Date",
    "datatype": "date",
    "formula": "#2025-08-27#",
    "name": "[Parameter 6]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "TTW Grade",
    "datatype": "string",
    "formula": "IF [ttw_qualstatus] = 'ttw-qualified' then 'Grade A'
ELSEIF  [ttw_qualstatus] = 'ttw-nonqualified' and [TTW Explore Work Form] = 'yes' THEN 'Grade B'
ELSEIF [ttw_qualstatus] = 'ttw-nonqualified' and [TTW Explore Work Form] != 'yes' THEN 'Grade C'
ELSEIF ISNULL([ttw_qualstatus]) and [Stage3 Response] = 'Between 2 and 4 years' then 'Grade D'
ELSE 'Rest'
END",
    "name": "[Calculation_1006061976934187009]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "20hrs Disqual",
    "datatype": "integer",
    "formula": "IF [Stage6 Response] = "More than 20 hours per week" THEN 1 ELSE 0 END",
    "name": "[Calculation_1133007210546622464]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Age Disqual",
    "datatype": "integer",
    "formula": "IF INT([Age]) < 40 OR INT([Age]) > 62 THEN 1 ELSE 0 END",
    "name": "[Calculation_1133007210553298946]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Attorney Disqual",
    "datatype": "integer",
    "formula": "IF [Stage5 Response] = "Yes" THEN 1 ELSE 0 END",
    "name": "[Calculation_1133007210553425923]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Ben Disqual",
    "datatype": "integer",
    "formula": "IF IFNULL([Stage1 Response], "") != "I am not receiving any disability benefits (SSD or SSI)"
THEN 1 ELSE 0 END",
    "name": "[Calculation_1133007210553487364]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Doctor Visit Disqual",
    "datatype": "integer",
    "formula": "IF [Stage4 Response] = "No" THEN 1 ELSE 0 END",
    "name": "[Calculation_1133007210553540613]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Five Year Work Disqual",
    "datatype": "integer",
    "formula": "IF [Stage3 Response] = "Less than 2 years"
OR [Stage3 Response] = "Between 2 and 4 years"
THEN 1 ELSE 0 END",
    "name": "[Calculation_1133007210553618438]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Out of Work Disqual",
    "datatype": "integer",
    "formula": "IF [Stage2 Response] = "No" THEN 1 ELSE 0 END",
    "name": "[Calculation_1133007210553663495]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "# of Disqual",
    "datatype": "integer",
    "formula": "ZN([Calculation_1133007210553487364]) +
ZN([Calculation_1133007210553663495]) +
ZN([Calculation_1133007210553618438]) +
ZN([Calculation_1133007210553540613]) +
ZN([Calculation_1133007210553425923]) +
ZN([Calculation_1133007210546622464]) +
ZN([Calculation_1133007210553298946])",
    "name": "[Calculation_1133007210553765896]",
    "role": "dimension",
    "type": "ordinal",
  },
  {
    "caption": "Unresolved SSA Leads",
    "datatype": "string",
    "formula": "IF { FIXED [Phone] : MAX([Resolved Lead]) } = 0 THEN "SSA Unresolved Lead"
ELSEIF { FIXED [Phone] : MAX([Resolved Lead]) } = 1 THEN "SSA Resolved Lead"
END",
    "name": "[Calculation_1467962419029331969]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Post Date ",
    "datatype": "datetime",
    "formula": "//Updated Date: 18 May 2022
//Updated By: Manish
//Description: Formula to calculate UTC date

DATEADD("hour",0,[Post Date])",
    "name": "[Calculation_1916563181826678784]",
    "role": "dimension",
    "type": "ordinal",
  },
  {
    "caption": "Data Updated On",
    "datatype": "datetime",
    "formula": "{fixed :max([Post Date])}",
    "name": "[Calculation_2010857255412854784]",
    "role": "dimension",
    "type": "ordinal",
  },
  {
    "caption": "TOTAL([Lead])",
    "datatype": "integer",
    "formula": "TOTAL([Calculation_97320012564762668])",
    "name": "[Calculation_4891401821046988806]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Grade",
    "datatype": "string",
    "formula": "// Grade A
IF [qual_status] = 'all-steps' THEN 'Grade A'

// Grade B
ELSEIF 
    [qual_status] IN ('fiveyrwrk-disqual','outofwrk-disqual','doc-disqual')
    AND [Calculation_1133007210553765896] = 1
THEN 'Grade B'

// Grade C
ELSEIF 
    [qual_status] <> 'age-disqual'
    AND NOT [Stage3 Response] IN ('Less than 2 years', 'Between 2 and 4 years')
    AND [Stage1 Response] <> 'Social Security Disability (SSD) Benefits'
    AND [Stage6 Response] = 'Not working'
THEN 'Grade C'

// Grade D
ELSEIF 
    // 1) Not age-disqual, Stage3 NOT in those two, Stage1 not SSD, Stage6 ≠ Not working, disqual ≤ 1
    (
      [qual_status] <> 'age-disqual'
      AND NOT [Stage3 Response] IN ('Less than 2 years', 'Between 2 and 4 years')
      AND [Stage1 Response] <> 'Social Security Disability (SSD) Benefits'
      AND [Stage6 Response] <> 'Not working'
      AND [Calculation_1133007210553765896] <= 1
    )
    // 2) Not age-disqual, Stage3 in those two, Qual Status = outofwrk-disqual
    OR
    (
      [qual_status] <> 'age-disqual'
      AND [Stage3 Response] IN ('Less than 2 years', 'Between 2 and 4 years')
      AND [qual_status] = 'outofwrk-disqual'
    )
    // 3) Not age-disqual, Stage3 in those two, Qual Status ≠ outofwrk-disqual, Stage7 = Yes
    OR
    (
      [qual_status] <> 'age-disqual'
      AND [Stage3 Response] IN ('Less than 2 years', 'Between 2 and 4 years')
      AND [qual_status] <> 'outofwrk-disqual'
      AND [Stage7 Response] = 'Yes'
    )
THEN 'Grade D'

// Rest (including age-disqual or anything else)
ELSE 'Rest'
END",
    "name": "[Calculation_7573084309404708864]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Today-28",
    "datatype": "date",
    "formula": "//Updated Date: 18 May 2022
//Updated By: Manish
//Description: Going back 28 days from today

({MAX(today()-28)})",
    "name": "[Calculation_767300790172184597]",
    "role": "dimension",
    "type": "ordinal",
  },
  {
    "caption": "Date Filter",
    "datatype": "boolean",
    "formula": "//Updated Date: 18 May 2022
//Updated By: Manish
//Description: Filtering data based on date

IF [Parameters].[Parameter 11] = 'default'
THEN [Date]>=[Parameters].[Parameter 5] AND [Date]<=[Parameters].[Parameter 6]
ELSEIF [Parameters].[Parameter 11] = 'weekly'
THEN [Date] >= TODAY()-8 AND [Date] <= TODAY()-1
END",
    "name": "[Calculation_843580506575679492]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Dial R",
    "datatype": "string",
    "formula": "IF  [Called Count] < 4 then "<=3" 
elseif [Called Count] < 8 then "4-7"
elseif [Called Count] < 11 then "8-10"
elseif [Called Count] < 16 then "11-15"
elseif [Called Count] < 20 then "16-19"
elseif [Called Count] < 26 then "20-25"
elseif [Called Count] < 31 then "25-30"
elseif [Called Count] < 36 then "30-35"
else "35+" 
END",
    "name": "[Calculation_847802666706034688]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Dial R (detail)",
    "datatype": "string",
    "formula": "STR([Called Count])",
    "name": "[Calculation_847802666706186241]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Max Date",
    "datatype": "date",
    "formula": "//Updated Date: 18 May 2022
//Updated By: Manish
//Description: Calculating max of todays date for including it in the default values of end date

{MAX(today())}",
    "name": "[Calculation_882424053213511680]",
    "role": "dimension",
    "type": "ordinal",
  },
  {
    "caption": "Post Date  ",
    "datatype": "string",
    "formula": "//Updated Date: 18 May 2022
//Updated By: Manish
//Description: Calculation to apply date bucket

CASE [Parameters].[Parameter 1]
WHEN 'year' THEN str(datepart('year', [Calculation_1916563181826678784]))
WHEN 'quarter' THEN "Q" + str(datepart('quarter', [Calculation_1916563181826678784])) + " " + str(datepart('year', [Calculation_1916563181826678784]))
WHEN 'month' THEN str(datepart('month', [Calculation_1916563181826678784])) + "-" + str(datepart('year', [Calculation_1916563181826678784]))
WHEN 'day' THEN str(DATENAME('month', [Calculation_1916563181826678784]))+ "-" +str(datepart('day', [Calculation_1916563181826678784]))+ "-" + str(datepart('year', [Calculation_1916563181826678784]))
WHEN 'week' THEN "W" + str(datepart('week', [Calculation_1916563181826678784])) + "-" + str(datepart('year', [Calculation_1916563181826678784]))
WHEN "hour" THEN str(DATETRUNC('hour', [Calculation_1916563181826678784]))
WHEN "minute" THEN str(DATETRUNC('minute', [Calculation_1916563181826678784]))
END",
    "name": "[Calculation_97320012552925214]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Lead",
    "datatype": "integer",
    "formula": "//Updated Date: 18 May 2022
//Updated By: Manish
//Description: Calculating the unique count of user ids

COUNTD([User Id])",
    "name": "[Calculation_97320012564762668]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Gender",
    "datatype": "string",
    "formula": "//Updated Date: 18 May 2022
//Updated By: Manish
//Description: Converting gnder values to upper case

UPPER([Gender])",
    "name": "[gender (copy)_2399292755830108162]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Helper Date",
    "datatype": "string",
    "formula": ""default"",
    "name": "[Parameter 11]",
    "role": "measure",
    "type": "nominal",
  },
  {
    "caption": "Start Date",
    "datatype": "date",
    "formula": "#2025-07-30#",
    "name": "[Parameter 5]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "End Date",
    "datatype": "date",
    "formula": "#2025-08-27#",
    "name": "[Parameter 6]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Show Source",
    "datatype": "string",
    "formula": ""1"",
    "name": "[Phone (copy)_1255659924007981058]",
    "role": "measure",
    "type": "nominal",
  },
  {
    "caption": "TTW Grade",
    "datatype": "string",
    "formula": "IF [ttw_qualstatus] = 'ttw-qualified' then 'Grade A'
ELSEIF  [ttw_qualstatus] = 'ttw-nonqualified' and [TTW Explore Work Form] = 'yes' THEN 'Grade B'
ELSEIF [ttw_qualstatus] = 'ttw-nonqualified' and [TTW Explore Work Form] != 'yes' THEN 'Grade C'
ELSEIF ISNULL([ttw_qualstatus]) and [Stage3 Response] = 'Between 2 and 4 years' then 'Grade D'
ELSE 'Rest'
END",
    "name": "[Calculation_1006061976934187009]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "20hrs Disqual",
    "datatype": "integer",
    "formula": "IF [Stage6 Response] = "More than 20 hours per week" THEN 1 ELSE 0 END",
    "name": "[Calculation_1133007210546622464]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Age Disqual",
    "datatype": "integer",
    "formula": "IF INT([Age]) < 40 OR INT([Age]) > 62 THEN 1 ELSE 0 END",
    "name": "[Calculation_1133007210553298946]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Attorney Disqual",
    "datatype": "integer",
    "formula": "IF [Stage5 Response] = "Yes" THEN 1 ELSE 0 END",
    "name": "[Calculation_1133007210553425923]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Ben Disqual",
    "datatype": "integer",
    "formula": "IF IFNULL([Stage1 Response], "") != "I am not receiving any disability benefits (SSD or SSI)"
THEN 1 ELSE 0 END",
    "name": "[Calculation_1133007210553487364]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Doctor Visit Disqual",
    "datatype": "integer",
    "formula": "IF [Stage4 Response] = "No" THEN 1 ELSE 0 END",
    "name": "[Calculation_1133007210553540613]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Five Year Work Disqual",
    "datatype": "integer",
    "formula": "IF [Stage3 Response] = "Less than 2 years"
OR [Stage3 Response] = "Between 2 and 4 years"
THEN 1 ELSE 0 END",
    "name": "[Calculation_1133007210553618438]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Out of Work Disqual",
    "datatype": "integer",
    "formula": "IF [Stage2 Response] = "No" THEN 1 ELSE 0 END",
    "name": "[Calculation_1133007210553663495]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "# of Disqual",
    "datatype": "integer",
    "formula": "ZN([Calculation_1133007210553487364]) +
ZN([Calculation_1133007210553663495]) +
ZN([Calculation_1133007210553618438]) +
ZN([Calculation_1133007210553540613]) +
ZN([Calculation_1133007210553425923]) +
ZN([Calculation_1133007210546622464]) +
ZN([Calculation_1133007210553298946])",
    "name": "[Calculation_1133007210553765896]",
    "role": "dimension",
    "type": "ordinal",
  },
  {
    "caption": "Unresolved SSA Leads",
    "datatype": "string",
    "formula": "IF { FIXED [Phone] : MAX([Resolved Lead]) } = 0 THEN "SSA Unresolved Lead"
ELSEIF { FIXED [Phone] : MAX([Resolved Lead]) } = 1 THEN "SSA Resolved Lead"
END",
    "name": "[Calculation_1467962419029331969]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "{exclude [Source]:Sum([ConcatText])}",
    "datatype": "integer",
    "formula": "{exclude [Source]:Sum([Calculation_2370019326410940416])}",
    "name": "[Calculation_1621014427181342742]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "ConcatText",
    "datatype": "integer",
    "formula": "//Updated Date: 18 May 2022
//Updated By: Manish
//Description: Concating the first 2 characters of first name, last name, city, state, postal code, DOB, ip, subid and trusted form columns and checking if the length of this text is equal to 18 or not

IF LEN(LEFT([First Name],2) + LEFT([Last Name],2) + LEFT([City],2) + LEFT([State],2) + LEFT([Postal Code],2) + LEFT([DOB],2) + LEFT([IP],2)  + LEFT([Sub Id],2) + LEFT([Trusted Form],2))
 = 18 THEN 0 ELSE 1 END",
    "name": "[Calculation_2370019326410940416]",
    "role": "dimension",
    "type": "ordinal",
  },
  {
    "caption": "Grade",
    "datatype": "string",
    "formula": "// Grade A
IF [qual_status] = 'all-steps' THEN 'Grade A'

// Grade B
ELSEIF 
    [qual_status] IN ('fiveyrwrk-disqual','outofwrk-disqual','doc-disqual')
    AND [Calculation_1133007210553765896] = 1
THEN 'Grade B'

// Grade C
ELSEIF 
    [qual_status] <> 'age-disqual'
    AND NOT [Stage3 Response] IN ('Less than 2 years', 'Between 2 and 4 years')
    AND [Stage1 Response] <> 'Social Security Disability (SSD) Benefits'
    AND [Stage6 Response] = 'Not working'
THEN 'Grade C'

// Grade D
ELSEIF 
    // 1) Not age-disqual, Stage3 NOT in those two, Stage1 not SSD, Stage6 ≠ Not working, disqual ≤ 1
    (
      [qual_status] <> 'age-disqual'
      AND NOT [Stage3 Response] IN ('Less than 2 years', 'Between 2 and 4 years')
      AND [Stage1 Response] <> 'Social Security Disability (SSD) Benefits'
      AND [Stage6 Response] <> 'Not working'
      AND [Calculation_1133007210553765896] <= 1
    )
    // 2) Not age-disqual, Stage3 in those two, Qual Status = outofwrk-disqual
    OR
    (
      [qual_status] <> 'age-disqual'
      AND [Stage3 Response] IN ('Less than 2 years', 'Between 2 and 4 years')
      AND [qual_status] = 'outofwrk-disqual'
    )
    // 3) Not age-disqual, Stage3 in those two, Qual Status ≠ outofwrk-disqual, Stage7 = Yes
    OR
    (
      [qual_status] <> 'age-disqual'
      AND [Stage3 Response] IN ('Less than 2 years', 'Between 2 and 4 years')
      AND [qual_status] <> 'outofwrk-disqual'
      AND [Stage7 Response] = 'Yes'
    )
THEN 'Grade D'

// Rest (including age-disqual or anything else)
ELSE 'Rest'
END",
    "name": "[Calculation_7573084309404708864]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Today-28",
    "datatype": "date",
    "formula": "//Updated Date: 18 May 2022
//Updated By: Manish
//Description: Going back 28 days from today

({MAX(today()-28)})",
    "name": "[Calculation_767300790172184597]",
    "role": "dimension",
    "type": "ordinal",
  },
  {
    "caption": "Date Filter",
    "datatype": "boolean",
    "formula": "//Updated Date: 18 May 2022
//Updated By: Manish
//Description: Filtering data based on date

IF [Parameters].[Parameter 11] = 'default'
THEN [Date]>=[Parameters].[Parameter 5] AND [Date]<=[Parameters].[Parameter 6]
ELSEIF [Parameters].[Parameter 11] = 'weekly'
THEN [Date] >= TODAY()-8 AND [Date] <= TODAY()-1
END",
    "name": "[Calculation_843580506575679492]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Dial R",
    "datatype": "string",
    "formula": "IF  [Called Count] < 4 then "<=3" 
elseif [Called Count] < 8 then "4-7"
elseif [Called Count] < 11 then "8-10"
elseif [Called Count] < 16 then "11-15"
elseif [Called Count] < 20 then "16-19"
elseif [Called Count] < 26 then "20-25"
elseif [Called Count] < 31 then "25-30"
elseif [Called Count] < 36 then "30-35"
else "35+" 
END",
    "name": "[Calculation_847802666706034688]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Dial R (detail)",
    "datatype": "string",
    "formula": "STR([Called Count])",
    "name": "[Calculation_847802666706186241]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Max Date",
    "datatype": "date",
    "formula": "//Updated Date: 18 May 2022
//Updated By: Manish
//Description: Calculating max of todays date for including it in the default values of end date

{MAX(today())}",
    "name": "[Calculation_882424053213511680]",
    "role": "dimension",
    "type": "ordinal",
  },
  {
    "caption": "Source ",
    "datatype": "string",
    "formula": "CASE [Parameters].[Phone (copy)_1255659924007981058]
WHEN "0" THEN "Agg"
WHEN "1" THEN [Source]
END",
    "name": "[Phone (copy)_1255659924007964673]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Total concatinated",
    "datatype": "integer",
    "formula": "//Updated Date: 18 May 2022
//Updated By: Manish
//Description: Calculating the sum of text excluding the source

{EXCLUDE [Phone (copy)_1255659924007964673]:sum([Calculation_2370019326410940416])}",
    "name": "[Total (copy)_2370019326411395073]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Helper Date",
    "datatype": "string",
    "formula": ""default"",
    "name": "[Parameter 11]",
    "role": "measure",
    "type": "nominal",
  },
  {
    "caption": "Date Bucket",
    "datatype": "string",
    "formula": ""day"",
    "name": "[Parameter 1]",
    "role": "measure",
    "type": "nominal",
  },
  {
    "caption": "Start Date",
    "datatype": "date",
    "formula": "#2025-07-30#",
    "name": "[Parameter 5]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "End Date",
    "datatype": "date",
    "formula": "#2025-08-27#",
    "name": "[Parameter 6]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "TTW Grade",
    "datatype": "string",
    "formula": "IF [ttw_qualstatus] = 'ttw-qualified' then 'Grade A'
ELSEIF  [ttw_qualstatus] = 'ttw-nonqualified' and [TTW Explore Work Form] = 'yes' THEN 'Grade B'
ELSEIF [ttw_qualstatus] = 'ttw-nonqualified' and [TTW Explore Work Form] != 'yes' THEN 'Grade C'
ELSEIF ISNULL([ttw_qualstatus]) and [Stage3 Response] = 'Between 2 and 4 years' then 'Grade D'
ELSE 'Rest'
END",
    "name": "[Calculation_1006061976934187009]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Hour of Day",
    "datatype": "string",
    "formula": "IF LEN(STR(DATEPART('hour', [Calculation_1916563181826678784]))) = 1
THEN "0" + STR(DATEPART('hour', [Calculation_1916563181826678784]))
ELSE STR(DATEPART('hour', [Calculation_1916563181826678784]))
END",
    "name": "[Calculation_1113233589182521344]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "20hrs Disqual",
    "datatype": "integer",
    "formula": "IF [Stage6 Response] = "More than 20 hours per week" THEN 1 ELSE 0 END",
    "name": "[Calculation_1133007210546622464]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Age Disqual",
    "datatype": "integer",
    "formula": "IF INT([Age]) < 40 OR INT([Age]) > 62 THEN 1 ELSE 0 END",
    "name": "[Calculation_1133007210553298946]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Attorney Disqual",
    "datatype": "integer",
    "formula": "IF [Stage5 Response] = "Yes" THEN 1 ELSE 0 END",
    "name": "[Calculation_1133007210553425923]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Ben Disqual",
    "datatype": "integer",
    "formula": "IF IFNULL([Stage1 Response], "") != "I am not receiving any disability benefits (SSD or SSI)"
THEN 1 ELSE 0 END",
    "name": "[Calculation_1133007210553487364]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Doctor Visit Disqual",
    "datatype": "integer",
    "formula": "IF [Stage4 Response] = "No" THEN 1 ELSE 0 END",
    "name": "[Calculation_1133007210553540613]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Five Year Work Disqual",
    "datatype": "integer",
    "formula": "IF [Stage3 Response] = "Less than 2 years"
OR [Stage3 Response] = "Between 2 and 4 years"
THEN 1 ELSE 0 END",
    "name": "[Calculation_1133007210553618438]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Out of Work Disqual",
    "datatype": "integer",
    "formula": "IF [Stage2 Response] = "No" THEN 1 ELSE 0 END",
    "name": "[Calculation_1133007210553663495]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "# of Disqual",
    "datatype": "integer",
    "formula": "ZN([Calculation_1133007210553487364]) +
ZN([Calculation_1133007210553663495]) +
ZN([Calculation_1133007210553618438]) +
ZN([Calculation_1133007210553540613]) +
ZN([Calculation_1133007210553425923]) +
ZN([Calculation_1133007210546622464]) +
ZN([Calculation_1133007210553298946])",
    "name": "[Calculation_1133007210553765896]",
    "role": "dimension",
    "type": "ordinal",
  },
  {
    "caption": "Levine States ",
    "datatype": "string",
    "formula": "IF ISNULL([Levine States]) THEN 'Other'
ELSE [Levine States] END",
    "name": "[Calculation_1277614987429064704]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "DP Leak",
    "datatype": "string",
    "formula": "IF CONTAINS([clientname], 'disabilitypath')
AND [Calculation_7573084309404708864] in ('Grade A', 'Grade B')
THEN 'Yes'
ELSE 'No'
END",
    "name": "[Calculation_1460573688699854848]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Unresolved SSA Leads",
    "datatype": "string",
    "formula": "IF { FIXED [Phone] : MAX([Resolved Lead]) } = 0 THEN "SSA Unresolved Lead"
ELSEIF { FIXED [Phone] : MAX([Resolved Lead]) } = 1 THEN "SSA Resolved Lead"
END",
    "name": "[Calculation_1467962419029331969]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "{exclude [Source]:[Cost]}",
    "datatype": "real",
    "formula": "{exclude [Source]:[Calculation_97320012556025895]}",
    "name": "[Calculation_1621014426988371983]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "CTC Lead Flag",
    "datatype": "string",
    "formula": "if [CTC Lead] = 1 then "Yes" else "No" END",
    "name": "[Calculation_1880252886088871936]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "CZ Post Hour Group",
    "datatype": "string",
    "formula": "IF DATEPART('hour', [Post Date]) >= 0 AND DATEPART('hour', [Post Date]) < 6 THEN 'Pre CC Hours'
ELSEIF DATEPART('hour', [Post Date]) >= 6 AND DATEPART('hour', [Post Date]) < 16 THEN 'CC Hours'
ELSEIF DATEPART('hour', [Post Date]) >= 16 AND DATEPART('hour', [Post Date]) < 24 THEN 'Post CC Hours'
END",
    "name": "[Calculation_1880252886125215747]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Post Date ",
    "datatype": "datetime",
    "formula": "//Updated Date: 18 May 2022
//Updated By: Manish
//Description: Formula to calculate UTC date

DATEADD("hour",0,[Post Date])",
    "name": "[Calculation_1916563181826678784]",
    "role": "dimension",
    "type": "ordinal",
  },
  {
    "caption": "Data Updated On",
    "datatype": "datetime",
    "formula": "{fixed :max([Post Date])}",
    "name": "[Calculation_2010857255412854784]",
    "role": "dimension",
    "type": "ordinal",
  },
  {
    "caption": "Lead Sell Type",
    "datatype": "string",
    "formula": "if contains([Transfer Info Label],'CXER') then 'Sold: Call' 
elseif 
contains([sgmt],'ql-leadbuy') or 
contains([ATA Work],'ql-leadbuy')
then 'Sold: Lead'
else 'Internal'
end",
    "name": "[Calculation_3435894714053935109]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Seg4 Control vs. Treatment",
    "datatype": "string",
    "formula": "IF [CZ Project Name] = "Mass Tort - High Intent SSDI" AND [Calculation_1880252886088871936] = "No" AND [qual_status] != "all-steps" THEN
    IF INT(RIGHT([phone masked], 3)) % 2 = 0 THEN "Control"
    ELSEIF INT(RIGHT([phone masked], 3)) % 2 != 0 THEN "Treatment"
    END
END",
    "name": "[Calculation_4531465651676315649]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Seg4 Cohort",
    "datatype": "string",
    "formula": "LOWER(IFNULL([seg4_cohort], [Calculation_4531465651676315649]))",
    "name": "[Calculation_4531465651676438530]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Time to Call (Minute)",
    "datatype": "real",
    "formula": "IF [Calculation_1880252886088871936] = 'Yes'
THEN ROUND(([CTC Time] - [Post Date]) * 24 * 60, 2)
END",
    "name": "[Calculation_499055157752631296]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Time to Call Bucket",
    "datatype": "string",
    "formula": "IF  [Calculation_499055157752631296] < 0
THEN '<0 Mins'
ELSEIF [Calculation_499055157752631296] <= 2 AND [Calculation_499055157752631296] >= 0
THEN '0-2 Mins'
ELSEIF [Calculation_499055157752631296] <= 5 AND [Calculation_499055157752631296] > 0
THEN '2-5 Mins'
ELSEIF [Calculation_499055157752631296] <= 10 AND [Calculation_499055157752631296] > 0
THEN '5-10 Mins'
ELSEIF [Calculation_499055157752631296] <= 30 AND [Calculation_499055157752631296] > 0 
THEN '10-30 Mins'
ELSEIF [Calculation_499055157752631296] <= 60 AND [Calculation_499055157752631296] > 0
THEN '30Mins-1 Hour'
ELSEIF [Calculation_499055157752631296] <= 300 AND [Calculation_499055157752631296] > 0
THEN '1-5 Hours'
ELSEIF [Calculation_499055157752631296] <= 600 AND [Calculation_499055157752631296] > 0
THEN '5-10 Hours'
ELSEIF [Calculation_499055157752631296] <= 1440 AND [Calculation_499055157752631296] > 0
THEN '10-24 Hours'
ELSEIF [Calculation_499055157752631296] <= 4320 AND [Calculation_499055157752631296] > 0
THEN '24-72 Hours'
ELSEIF [Calculation_499055157752631296] > 4320 AND [Calculation_499055157752631296] > 0
THEN '>72 Hours'
END",
    "name": "[Calculation_499055157754740737]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Project Type",
    "datatype": "string",
    "formula": "IF CONTAINS([CZ Project Name],'Aged') THEN 'Aged'
ELSE 'Live' END",
    "name": "[Calculation_5872834692856524810]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "CPL New",
    "datatype": "real",
    "formula": "//Updated Date: 18 May 2022
//Updated By: Manish
//Description: Considering CPL if outcome is initialised

IF [Outcome] = 'initialized' THEN [CPL]ELSE 0 END",
    "name": "[Calculation_6314891106343211008]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Grade",
    "datatype": "string",
    "formula": "// Grade A
IF [qual_status] = 'all-steps' THEN 'Grade A'

// Grade B
ELSEIF 
    [qual_status] IN ('fiveyrwrk-disqual','outofwrk-disqual','doc-disqual')
    AND [Calculation_1133007210553765896] = 1
THEN 'Grade B'

// Grade C
ELSEIF 
    [qual_status] <> 'age-disqual'
    AND NOT [Stage3 Response] IN ('Less than 2 years', 'Between 2 and 4 years')
    AND [Stage1 Response] <> 'Social Security Disability (SSD) Benefits'
    AND [Stage6 Response] = 'Not working'
THEN 'Grade C'

// Grade D
ELSEIF 
    // 1) Not age-disqual, Stage3 NOT in those two, Stage1 not SSD, Stage6 ≠ Not working, disqual ≤ 1
    (
      [qual_status] <> 'age-disqual'
      AND NOT [Stage3 Response] IN ('Less than 2 years', 'Between 2 and 4 years')
      AND [Stage1 Response] <> 'Social Security Disability (SSD) Benefits'
      AND [Stage6 Response] <> 'Not working'
      AND [Calculation_1133007210553765896] <= 1
    )
    // 2) Not age-disqual, Stage3 in those two, Qual Status = outofwrk-disqual
    OR
    (
      [qual_status] <> 'age-disqual'
      AND [Stage3 Response] IN ('Less than 2 years', 'Between 2 and 4 years')
      AND [qual_status] = 'outofwrk-disqual'
    )
    // 3) Not age-disqual, Stage3 in those two, Qual Status ≠ outofwrk-disqual, Stage7 = Yes
    OR
    (
      [qual_status] <> 'age-disqual'
      AND [Stage3 Response] IN ('Less than 2 years', 'Between 2 and 4 years')
      AND [qual_status] <> 'outofwrk-disqual'
      AND [Stage7 Response] = 'Yes'
    )
THEN 'Grade D'

// Rest (including age-disqual or anything else)
ELSE 'Rest'
END",
    "name": "[Calculation_7573084309404708864]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Today-28",
    "datatype": "date",
    "formula": "//Updated Date: 18 May 2022
//Updated By: Manish
//Description: Going back 28 days from today

({MAX(today()-28)})",
    "name": "[Calculation_767300790172184597]",
    "role": "dimension",
    "type": "ordinal",
  },
  {
    "caption": "SSD Age Range",
    "datatype": "string",
    "formula": "IF DATE([Calculation_1916563181826678784]) >= #18/08/2025#
THEN
    IF INT([Age]) < 40 THEN "U40"
    ELSEIF INT([Age]) >= 40 AND INT([Age]) <= 49 THEN "40 - 49"
	ELSEIF INT([Age]) >= 50 AND INT([Age]) <= 54 THEN "50 - 54"
    ELSEIF INT([Age]) >= 55 AND INT([Age]) <= 63 THEN "55 - 63"
    ELSEIF INT([Age]) >= 64 THEN "O64+"
    END
ELSEIF INT([Age]) < 40 THEN "*U40"
ELSEIF INT([Age]) >= 40 AND INT([Age]) <= 48 THEN "*40-48"
ELSEIF INT([Age]) = 49 THEN "*49"
ELSEIF INT([Age]) >= 50 AND INT([Age]) <= 62 THEN "*50-62"
ELSEIF INT([Age]) >= 63 THEN "*O63+" 
END",
    "name": "[Calculation_7690318609259716608]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Date Filter",
    "datatype": "boolean",
    "formula": "//Updated Date: 18 May 2022
//Updated By: Manish
//Description: Filtering data based on date

IF [Parameters].[Parameter 11] = 'default'
THEN [Date]>=[Parameters].[Parameter 5] AND [Date]<=[Parameters].[Parameter 6]
ELSEIF [Parameters].[Parameter 11] = 'weekly'
THEN [Date] >= TODAY()-8 AND [Date] <= TODAY()-1
END",
    "name": "[Calculation_843580506575679492]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Dial R",
    "datatype": "string",
    "formula": "IF  [Called Count] < 4 then "<=3" 
elseif [Called Count] < 8 then "4-7"
elseif [Called Count] < 11 then "8-10"
elseif [Called Count] < 16 then "11-15"
elseif [Called Count] < 20 then "16-19"
elseif [Called Count] < 26 then "20-25"
elseif [Called Count] < 31 then "25-30"
elseif [Called Count] < 36 then "30-35"
else "35+" 
END",
    "name": "[Calculation_847802666706034688]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Dial R (detail)",
    "datatype": "string",
    "formula": "STR([Called Count])",
    "name": "[Calculation_847802666706186241]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Max Date",
    "datatype": "date",
    "formula": "//Updated Date: 18 May 2022
//Updated By: Manish
//Description: Calculating max of todays date for including it in the default values of end date

{MAX(today())}",
    "name": "[Calculation_882424053213511680]",
    "role": "dimension",
    "type": "ordinal",
  },
  {
    "caption": "Alt. Branding",
    "datatype": "string",
    "formula": "If int(Right([Phone],2))<30 and [Calculation_5872834692856524810]= 'Live' then 'Yes' else 'No' End",
    "name": "[Calculation_935059914517495808]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Duplicate Rejects",
    "datatype": "string",
    "formula": "if [Outcome]='rejected' and { FIXED [Phone], [Outcome]: COUNTD([User Id])}>1 then 'Yes' else 'No' end",
    "name": "[Calculation_943222690415542272]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Post Date  ",
    "datatype": "string",
    "formula": "//Updated Date: 18 May 2022
//Updated By: Manish
//Description: Calculation to apply date bucket

CASE [Parameters].[Parameter 1]
WHEN 'year' THEN str(datepart('year', [Calculation_1916563181826678784]))
WHEN 'quarter' THEN "Q" + str(datepart('quarter', [Calculation_1916563181826678784])) + " " + str(datepart('year', [Calculation_1916563181826678784]))
WHEN 'month' THEN str(datepart('month', [Calculation_1916563181826678784])) + "-" + str(datepart('year', [Calculation_1916563181826678784]))
WHEN 'day' THEN str(DATENAME('month', [Calculation_1916563181826678784]))+ "-" +str(datepart('day', [Calculation_1916563181826678784]))+ "-" + str(datepart('year', [Calculation_1916563181826678784]))
WHEN 'week' THEN "W" + str(datepart('week', [Calculation_1916563181826678784])) + "-" + str(datepart('year', [Calculation_1916563181826678784]))
WHEN "hour" THEN str(DATETRUNC('hour', [Calculation_1916563181826678784]))
WHEN "minute" THEN str(DATETRUNC('minute', [Calculation_1916563181826678784]))
END",
    "name": "[Calculation_97320012552925214]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Campaign & Date",
    "datatype": "string",
    "formula": "//Updated Date: 18 May 2022
//Updated By: Manish
//Description: Concatinating campaign and date

[CZ Project Name]+":"+[Calculation_97320012552925214]",
    "name": "[Calculation_97320012555808806]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Cost",
    "datatype": "real",
    "formula": "//Updated Date: 2 June 2022
//Updated By: Sree
//Description: Calculating the sum of CPL per source and per user. THIS NEEDS TO BE COUNTD ONLY


SUM(
//IF [outcome] = 'initialized' THEN 
{include [Source]: ZN(countD([User Id])*MAX([Calculation_6314891106343211008]))}
//ELSE 0 END
)",
    "name": "[Calculation_97320012556025895]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Vici Post Delay (Days)",
    "datatype": "integer",
    "formula": "DATEDIFF('day', [Post Date], [Entry Time])",
    "name": "[Calculation_989947527401095169]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "State Exclusions",
    "datatype": "string",
    "formula": "[State]",
    "name": "[state (copy)_2399292755821703168]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Helper Date",
    "datatype": "string",
    "formula": ""default"",
    "name": "[Parameter 11]",
    "role": "measure",
    "type": "nominal",
  },
  {
    "caption": "Date Bucket",
    "datatype": "string",
    "formula": ""day"",
    "name": "[Parameter 1]",
    "role": "measure",
    "type": "nominal",
  },
  {
    "caption": "Start Date",
    "datatype": "date",
    "formula": "#2025-07-30#",
    "name": "[Parameter 5]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "End Date",
    "datatype": "date",
    "formula": "#2025-08-27#",
    "name": "[Parameter 6]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "TTW Grade",
    "datatype": "string",
    "formula": "IF [ttw_qualstatus] = 'ttw-qualified' then 'Grade A'
ELSEIF  [ttw_qualstatus] = 'ttw-nonqualified' and [TTW Explore Work Form] = 'yes' THEN 'Grade B'
ELSEIF [ttw_qualstatus] = 'ttw-nonqualified' and [TTW Explore Work Form] != 'yes' THEN 'Grade C'
ELSEIF ISNULL([ttw_qualstatus]) and [Stage3 Response] = 'Between 2 and 4 years' then 'Grade D'
ELSE 'Rest'
END",
    "name": "[Calculation_1006061976934187009]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Hour of Day",
    "datatype": "string",
    "formula": "IF LEN(STR(DATEPART('hour', [Calculation_1916563181826678784]))) = 1
THEN "0" + STR(DATEPART('hour', [Calculation_1916563181826678784]))
ELSE STR(DATEPART('hour', [Calculation_1916563181826678784]))
END",
    "name": "[Calculation_1113233589182521344]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "20hrs Disqual",
    "datatype": "integer",
    "formula": "IF [Stage6 Response] = "More than 20 hours per week" THEN 1 ELSE 0 END",
    "name": "[Calculation_1133007210546622464]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Age Disqual",
    "datatype": "integer",
    "formula": "IF INT([Age]) < 40 OR INT([Age]) > 62 THEN 1 ELSE 0 END",
    "name": "[Calculation_1133007210553298946]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Attorney Disqual",
    "datatype": "integer",
    "formula": "IF [Stage5 Response] = "Yes" THEN 1 ELSE 0 END",
    "name": "[Calculation_1133007210553425923]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Ben Disqual",
    "datatype": "integer",
    "formula": "IF IFNULL([Stage1 Response], "") != "I am not receiving any disability benefits (SSD or SSI)"
THEN 1 ELSE 0 END",
    "name": "[Calculation_1133007210553487364]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Doctor Visit Disqual",
    "datatype": "integer",
    "formula": "IF [Stage4 Response] = "No" THEN 1 ELSE 0 END",
    "name": "[Calculation_1133007210553540613]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Five Year Work Disqual",
    "datatype": "integer",
    "formula": "IF [Stage3 Response] = "Less than 2 years"
OR [Stage3 Response] = "Between 2 and 4 years"
THEN 1 ELSE 0 END",
    "name": "[Calculation_1133007210553618438]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Out of Work Disqual",
    "datatype": "integer",
    "formula": "IF [Stage2 Response] = "No" THEN 1 ELSE 0 END",
    "name": "[Calculation_1133007210553663495]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "# of Disqual",
    "datatype": "integer",
    "formula": "ZN([Calculation_1133007210553487364]) +
ZN([Calculation_1133007210553663495]) +
ZN([Calculation_1133007210553618438]) +
ZN([Calculation_1133007210553540613]) +
ZN([Calculation_1133007210553425923]) +
ZN([Calculation_1133007210546622464]) +
ZN([Calculation_1133007210553298946])",
    "name": "[Calculation_1133007210553765896]",
    "role": "dimension",
    "type": "ordinal",
  },
  {
    "caption": "Month - Year",
    "datatype": "string",
    "formula": "DATENAME('month',[Post Date])+' '+ STR(YEAR([Post Date]))",
    "name": "[Calculation_1232578966341357571]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Unresolved SSA Leads",
    "datatype": "string",
    "formula": "IF { FIXED [Phone] : MAX([Resolved Lead]) } = 0 THEN "SSA Unresolved Lead"
ELSEIF { FIXED [Phone] : MAX([Resolved Lead]) } = 1 THEN "SSA Resolved Lead"
END",
    "name": "[Calculation_1467962419029331969]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "CZ Post Hour Group",
    "datatype": "string",
    "formula": "IF DATEPART('hour', [Post Date]) >= 0 AND DATEPART('hour', [Post Date]) < 6 THEN 'Pre CC Hours'
ELSEIF DATEPART('hour', [Post Date]) >= 6 AND DATEPART('hour', [Post Date]) < 16 THEN 'CC Hours'
ELSEIF DATEPART('hour', [Post Date]) >= 16 AND DATEPART('hour', [Post Date]) < 24 THEN 'Post CC Hours'
END",
    "name": "[Calculation_1880252886125215747]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Post Date ",
    "datatype": "datetime",
    "formula": "//Updated Date: 18 May 2022
//Updated By: Manish
//Description: Formula to calculate UTC date

DATEADD("hour",0,[Post Date])",
    "name": "[Calculation_1916563181826678784]",
    "role": "dimension",
    "type": "ordinal",
  },
  {
    "caption": "Data Updated On",
    "datatype": "datetime",
    "formula": "{fixed :max([Post Date])}",
    "name": "[Calculation_2010857255412854784]",
    "role": "dimension",
    "type": "ordinal",
  },
  {
    "caption": "TOTAL([Missing Leads in CRM])",
    "datatype": "integer",
    "formula": "TOTAL([Missing Leads in Vici (copy)_336081184380698624])",
    "name": "[Calculation_336081184382418945]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "{exclude [Source]: [Missing Leads in CRM]}",
    "datatype": "integer",
    "formula": "{exclude [Source]: [Missing Leads in Vici (copy)_336081184380698624]}",
    "name": "[Calculation_336081184382537730]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "[Missing Leads in Vici]/ATTR({exclude [Source]: [Missing Lead...",
    "datatype": "real",
    "formula": "[Calculation_7975100929080872974]/ATTR({exclude [Source]: [Missing Leads in Vici (copy)_336081184380698624]})",
    "name": "[Calculation_336081184383455235]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Project Type",
    "datatype": "string",
    "formula": "IF CONTAINS([CZ Project Name],'Aged') THEN 'Aged'
ELSE 'Live' END",
    "name": "[Calculation_5872834692856524810]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Grade",
    "datatype": "string",
    "formula": "// Grade A
IF [qual_status] = 'all-steps' THEN 'Grade A'

// Grade B
ELSEIF 
    [qual_status] IN ('fiveyrwrk-disqual','outofwrk-disqual','doc-disqual')
    AND [Calculation_1133007210553765896] = 1
THEN 'Grade B'

// Grade C
ELSEIF 
    [qual_status] <> 'age-disqual'
    AND NOT [Stage3 Response] IN ('Less than 2 years', 'Between 2 and 4 years')
    AND [Stage1 Response] <> 'Social Security Disability (SSD) Benefits'
    AND [Stage6 Response] = 'Not working'
THEN 'Grade C'

// Grade D
ELSEIF 
    // 1) Not age-disqual, Stage3 NOT in those two, Stage1 not SSD, Stage6 ≠ Not working, disqual ≤ 1
    (
      [qual_status] <> 'age-disqual'
      AND NOT [Stage3 Response] IN ('Less than 2 years', 'Between 2 and 4 years')
      AND [Stage1 Response] <> 'Social Security Disability (SSD) Benefits'
      AND [Stage6 Response] <> 'Not working'
      AND [Calculation_1133007210553765896] <= 1
    )
    // 2) Not age-disqual, Stage3 in those two, Qual Status = outofwrk-disqual
    OR
    (
      [qual_status] <> 'age-disqual'
      AND [Stage3 Response] IN ('Less than 2 years', 'Between 2 and 4 years')
      AND [qual_status] = 'outofwrk-disqual'
    )
    // 3) Not age-disqual, Stage3 in those two, Qual Status ≠ outofwrk-disqual, Stage7 = Yes
    OR
    (
      [qual_status] <> 'age-disqual'
      AND [Stage3 Response] IN ('Less than 2 years', 'Between 2 and 4 years')
      AND [qual_status] <> 'outofwrk-disqual'
      AND [Stage7 Response] = 'Yes'
    )
THEN 'Grade D'

// Rest (including age-disqual or anything else)
ELSE 'Rest'
END",
    "name": "[Calculation_7573084309404708864]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Today-28",
    "datatype": "date",
    "formula": "//Updated Date: 18 May 2022
//Updated By: Manish
//Description: Going back 28 days from today

({MAX(today()-28)})",
    "name": "[Calculation_767300790172184597]",
    "role": "dimension",
    "type": "ordinal",
  },
  {
    "caption": "Missing Leads in Vici",
    "datatype": "integer",
    "formula": "//Updated Date: 18 May 2022
//Updated By: Manish
//Description: Calculating the unique count of Phone

COUNT(IF ISNULL([Vici User Flag]) THEN [Phone] END)",
    "name": "[Calculation_7975100929080872974]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Date Filter",
    "datatype": "boolean",
    "formula": "//Updated Date: 18 May 2022
//Updated By: Manish
//Description: Filtering data based on date

IF [Parameters].[Parameter 11] = 'default'
THEN [Date]>=[Parameters].[Parameter 5] AND [Date]<=[Parameters].[Parameter 6]
ELSEIF [Parameters].[Parameter 11] = 'weekly'
THEN [Date] >= TODAY()-8 AND [Date] <= TODAY()-1
END",
    "name": "[Calculation_843580506575679492]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Dial R",
    "datatype": "string",
    "formula": "IF  [Called Count] < 4 then "<=3" 
elseif [Called Count] < 8 then "4-7"
elseif [Called Count] < 11 then "8-10"
elseif [Called Count] < 16 then "11-15"
elseif [Called Count] < 20 then "16-19"
elseif [Called Count] < 26 then "20-25"
elseif [Called Count] < 31 then "25-30"
elseif [Called Count] < 36 then "30-35"
else "35+" 
END",
    "name": "[Calculation_847802666706034688]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Dial R (detail)",
    "datatype": "string",
    "formula": "STR([Called Count])",
    "name": "[Calculation_847802666706186241]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Max Date",
    "datatype": "date",
    "formula": "//Updated Date: 18 May 2022
//Updated By: Manish
//Description: Calculating max of todays date for including it in the default values of end date

{MAX(today())}",
    "name": "[Calculation_882424053213511680]",
    "role": "dimension",
    "type": "ordinal",
  },
  {
    "caption": "Alt. Branding",
    "datatype": "string",
    "formula": "If int(Right([Phone],2))<30 and [Calculation_5872834692856524810]= 'Live' then 'Yes' else 'No' End",
    "name": "[Calculation_935059914517495808]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Post Date  ",
    "datatype": "string",
    "formula": "//Updated Date: 18 May 2022
//Updated By: Manish
//Description: Calculation to apply date bucket

CASE [Parameters].[Parameter 1]
WHEN 'year' THEN str(datepart('year', [Calculation_1916563181826678784]))
WHEN 'quarter' THEN "Q" + str(datepart('quarter', [Calculation_1916563181826678784])) + " " + str(datepart('year', [Calculation_1916563181826678784]))
WHEN 'month' THEN str(datepart('month', [Calculation_1916563181826678784])) + "-" + str(datepart('year', [Calculation_1916563181826678784]))
WHEN 'day' THEN str(DATENAME('month', [Calculation_1916563181826678784]))+ "-" +str(datepart('day', [Calculation_1916563181826678784]))+ "-" + str(datepart('year', [Calculation_1916563181826678784]))
WHEN 'week' THEN "W" + str(datepart('week', [Calculation_1916563181826678784])) + "-" + str(datepart('year', [Calculation_1916563181826678784]))
WHEN "hour" THEN str(DATETRUNC('hour', [Calculation_1916563181826678784]))
WHEN "minute" THEN str(DATETRUNC('minute', [Calculation_1916563181826678784]))
END",
    "name": "[Calculation_97320012552925214]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Missing Leads in CRM",
    "datatype": "integer",
    "formula": "//Updated Date: 18 May 2022
//Updated By: Manish
//Description: Calculating the unique count of Phone

COUNTD(IF isnull([CRM Flag]) THEN  [Phone] END)",
    "name": "[Missing Leads in Vici (copy)_336081184380698624]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Age Exclusions",
    "datatype": "string",
    "formula": "[Age Range]",
    "name": "[age range (copy)_99712551094624281]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Helper Date",
    "datatype": "string",
    "formula": ""default"",
    "name": "[Parameter 11]",
    "role": "measure",
    "type": "nominal",
  },
  {
    "caption": "Date Bucket",
    "datatype": "string",
    "formula": ""day"",
    "name": "[Parameter 1]",
    "role": "measure",
    "type": "nominal",
  },
  {
    "caption": "Start Date",
    "datatype": "date",
    "formula": "#2025-07-30#",
    "name": "[Parameter 5]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "End Date",
    "datatype": "date",
    "formula": "#2025-08-27#",
    "name": "[Parameter 6]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "TTW Grade",
    "datatype": "string",
    "formula": "IF [ttw_qualstatus] = 'ttw-qualified' then 'Grade A'
ELSEIF  [ttw_qualstatus] = 'ttw-nonqualified' and [TTW Explore Work Form] = 'yes' THEN 'Grade B'
ELSEIF [ttw_qualstatus] = 'ttw-nonqualified' and [TTW Explore Work Form] != 'yes' THEN 'Grade C'
ELSEIF ISNULL([ttw_qualstatus]) and [Stage3 Response] = 'Between 2 and 4 years' then 'Grade D'
ELSE 'Rest'
END",
    "name": "[Calculation_1006061976934187009]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Hour of Day",
    "datatype": "string",
    "formula": "IF LEN(STR(DATEPART('hour', [Calculation_1916563181826678784]))) = 1
THEN "0" + STR(DATEPART('hour', [Calculation_1916563181826678784]))
ELSE STR(DATEPART('hour', [Calculation_1916563181826678784]))
END",
    "name": "[Calculation_1113233589182521344]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "20hrs Disqual",
    "datatype": "integer",
    "formula": "IF [Stage6 Response] = "More than 20 hours per week" THEN 1 ELSE 0 END",
    "name": "[Calculation_1133007210546622464]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Age Disqual",
    "datatype": "integer",
    "formula": "IF INT([Age]) < 40 OR INT([Age]) > 62 THEN 1 ELSE 0 END",
    "name": "[Calculation_1133007210553298946]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Attorney Disqual",
    "datatype": "integer",
    "formula": "IF [Stage5 Response] = "Yes" THEN 1 ELSE 0 END",
    "name": "[Calculation_1133007210553425923]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Ben Disqual",
    "datatype": "integer",
    "formula": "IF IFNULL([Stage1 Response], "") != "I am not receiving any disability benefits (SSD or SSI)"
THEN 1 ELSE 0 END",
    "name": "[Calculation_1133007210553487364]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Doctor Visit Disqual",
    "datatype": "integer",
    "formula": "IF [Stage4 Response] = "No" THEN 1 ELSE 0 END",
    "name": "[Calculation_1133007210553540613]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Five Year Work Disqual",
    "datatype": "integer",
    "formula": "IF [Stage3 Response] = "Less than 2 years"
OR [Stage3 Response] = "Between 2 and 4 years"
THEN 1 ELSE 0 END",
    "name": "[Calculation_1133007210553618438]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Out of Work Disqual",
    "datatype": "integer",
    "formula": "IF [Stage2 Response] = "No" THEN 1 ELSE 0 END",
    "name": "[Calculation_1133007210553663495]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "# of Disqual",
    "datatype": "integer",
    "formula": "ZN([Calculation_1133007210553487364]) +
ZN([Calculation_1133007210553663495]) +
ZN([Calculation_1133007210553618438]) +
ZN([Calculation_1133007210553540613]) +
ZN([Calculation_1133007210553425923]) +
ZN([Calculation_1133007210546622464]) +
ZN([Calculation_1133007210553298946])",
    "name": "[Calculation_1133007210553765896]",
    "role": "dimension",
    "type": "ordinal",
  },
  {
    "caption": "Month - Year",
    "datatype": "string",
    "formula": "DATENAME('month',[Post Date])+' '+ STR(YEAR([Post Date]))",
    "name": "[Calculation_1232578966341357571]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Leads Missing in Vici #",
    "datatype": "integer",
    "formula": "COUNTD(if isnull([Vici User Flag]) 
and [Status] != "CONVERTED" 
and [Status] != "STOP" then [User Id] end)",
    "name": "[Calculation_1419196839344672769]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Unresolved SSA Leads",
    "datatype": "string",
    "formula": "IF { FIXED [Phone] : MAX([Resolved Lead]) } = 0 THEN "SSA Unresolved Lead"
ELSEIF { FIXED [Phone] : MAX([Resolved Lead]) } = 1 THEN "SSA Resolved Lead"
END",
    "name": "[Calculation_1467962419029331969]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "CZ Post Hour Group",
    "datatype": "string",
    "formula": "IF DATEPART('hour', [Post Date]) >= 0 AND DATEPART('hour', [Post Date]) < 6 THEN 'Pre CC Hours'
ELSEIF DATEPART('hour', [Post Date]) >= 6 AND DATEPART('hour', [Post Date]) < 16 THEN 'CC Hours'
ELSEIF DATEPART('hour', [Post Date]) >= 16 AND DATEPART('hour', [Post Date]) < 24 THEN 'Post CC Hours'
END",
    "name": "[Calculation_1880252886125215747]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Post Date ",
    "datatype": "datetime",
    "formula": "//Updated Date: 18 May 2022
//Updated By: Manish
//Description: Formula to calculate UTC date

DATEADD("hour",0,[Post Date])",
    "name": "[Calculation_1916563181826678784]",
    "role": "dimension",
    "type": "ordinal",
  },
  {
    "caption": "Data Updated On",
    "datatype": "datetime",
    "formula": "{fixed :max([Post Date])}",
    "name": "[Calculation_2010857255412854784]",
    "role": "dimension",
    "type": "ordinal",
  },
  {
    "caption": "Project Type",
    "datatype": "string",
    "formula": "IF CONTAINS([CZ Project Name],'Aged') THEN 'Aged'
ELSE 'Live' END",
    "name": "[Calculation_5872834692856524810]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "{exclude [Source]: [Leads Missing in Vici #]}",
    "datatype": "integer",
    "formula": "{exclude [Source]: [Calculation_1419196839344672769]}",
    "name": "[Calculation_6634928168327516161]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "[Leads Missing in Vici #]/ATTR({exclude [Source]: [Leads Miss...",
    "datatype": "real",
    "formula": "[Calculation_1419196839344672769]/ATTR({exclude [Source]: [Calculation_1419196839344672769]})",
    "name": "[Calculation_6634928168328052741]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Grade",
    "datatype": "string",
    "formula": "// Grade A
IF [qual_status] = 'all-steps' THEN 'Grade A'

// Grade B
ELSEIF 
    [qual_status] IN ('fiveyrwrk-disqual','outofwrk-disqual','doc-disqual')
    AND [Calculation_1133007210553765896] = 1
THEN 'Grade B'

// Grade C
ELSEIF 
    [qual_status] <> 'age-disqual'
    AND NOT [Stage3 Response] IN ('Less than 2 years', 'Between 2 and 4 years')
    AND [Stage1 Response] <> 'Social Security Disability (SSD) Benefits'
    AND [Stage6 Response] = 'Not working'
THEN 'Grade C'

// Grade D
ELSEIF 
    // 1) Not age-disqual, Stage3 NOT in those two, Stage1 not SSD, Stage6 ≠ Not working, disqual ≤ 1
    (
      [qual_status] <> 'age-disqual'
      AND NOT [Stage3 Response] IN ('Less than 2 years', 'Between 2 and 4 years')
      AND [Stage1 Response] <> 'Social Security Disability (SSD) Benefits'
      AND [Stage6 Response] <> 'Not working'
      AND [Calculation_1133007210553765896] <= 1
    )
    // 2) Not age-disqual, Stage3 in those two, Qual Status = outofwrk-disqual
    OR
    (
      [qual_status] <> 'age-disqual'
      AND [Stage3 Response] IN ('Less than 2 years', 'Between 2 and 4 years')
      AND [qual_status] = 'outofwrk-disqual'
    )
    // 3) Not age-disqual, Stage3 in those two, Qual Status ≠ outofwrk-disqual, Stage7 = Yes
    OR
    (
      [qual_status] <> 'age-disqual'
      AND [Stage3 Response] IN ('Less than 2 years', 'Between 2 and 4 years')
      AND [qual_status] <> 'outofwrk-disqual'
      AND [Stage7 Response] = 'Yes'
    )
THEN 'Grade D'

// Rest (including age-disqual or anything else)
ELSE 'Rest'
END",
    "name": "[Calculation_7573084309404708864]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Today-28",
    "datatype": "date",
    "formula": "//Updated Date: 18 May 2022
//Updated By: Manish
//Description: Going back 28 days from today

({MAX(today()-28)})",
    "name": "[Calculation_767300790172184597]",
    "role": "dimension",
    "type": "ordinal",
  },
  {
    "caption": "Time-Source-Subid",
    "datatype": "string",
    "formula": "//Updated Date: 18 May 2022
//Updated By: Manish
//Description: Changing the data type to string of Time-Source-Subid column

STR([Date])+'-'+[Source]+'-'+[Sub Id]",
    "name": "[Calculation_7746824680808361990]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Date Filter",
    "datatype": "boolean",
    "formula": "//Updated Date: 18 May 2022
//Updated By: Manish
//Description: Filtering data based on date

IF [Parameters].[Parameter 11] = 'default'
THEN [Date]>=[Parameters].[Parameter 5] AND [Date]<=[Parameters].[Parameter 6]
ELSEIF [Parameters].[Parameter 11] = 'weekly'
THEN [Date] >= TODAY()-8 AND [Date] <= TODAY()-1
END",
    "name": "[Calculation_843580506575679492]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Dial R",
    "datatype": "string",
    "formula": "IF  [Called Count] < 4 then "<=3" 
elseif [Called Count] < 8 then "4-7"
elseif [Called Count] < 11 then "8-10"
elseif [Called Count] < 16 then "11-15"
elseif [Called Count] < 20 then "16-19"
elseif [Called Count] < 26 then "20-25"
elseif [Called Count] < 31 then "25-30"
elseif [Called Count] < 36 then "30-35"
else "35+" 
END",
    "name": "[Calculation_847802666706034688]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Dial R (detail)",
    "datatype": "string",
    "formula": "STR([Called Count])",
    "name": "[Calculation_847802666706186241]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Max Date",
    "datatype": "date",
    "formula": "//Updated Date: 18 May 2022
//Updated By: Manish
//Description: Calculating max of todays date for including it in the default values of end date

{MAX(today())}",
    "name": "[Calculation_882424053213511680]",
    "role": "dimension",
    "type": "ordinal",
  },
  {
    "caption": "Alt. Branding",
    "datatype": "string",
    "formula": "If int(Right([Phone],2))<30 and [Calculation_5872834692856524810]= 'Live' then 'Yes' else 'No' End",
    "name": "[Calculation_935059914517495808]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Post Date  ",
    "datatype": "string",
    "formula": "//Updated Date: 18 May 2022
//Updated By: Manish
//Description: Calculation to apply date bucket

CASE [Parameters].[Parameter 1]
WHEN 'year' THEN str(datepart('year', [Calculation_1916563181826678784]))
WHEN 'quarter' THEN "Q" + str(datepart('quarter', [Calculation_1916563181826678784])) + " " + str(datepart('year', [Calculation_1916563181826678784]))
WHEN 'month' THEN str(datepart('month', [Calculation_1916563181826678784])) + "-" + str(datepart('year', [Calculation_1916563181826678784]))
WHEN 'day' THEN str(DATENAME('month', [Calculation_1916563181826678784]))+ "-" +str(datepart('day', [Calculation_1916563181826678784]))+ "-" + str(datepart('year', [Calculation_1916563181826678784]))
WHEN 'week' THEN "W" + str(datepart('week', [Calculation_1916563181826678784])) + "-" + str(datepart('year', [Calculation_1916563181826678784]))
WHEN "hour" THEN str(DATETRUNC('hour', [Calculation_1916563181826678784]))
WHEN "minute" THEN str(DATETRUNC('minute', [Calculation_1916563181826678784]))
END",
    "name": "[Calculation_97320012552925214]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Age Exclusions",
    "datatype": "string",
    "formula": "[Age Range]",
    "name": "[age range (copy)_99712551094624281]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Helper Date",
    "datatype": "string",
    "formula": ""default"",
    "name": "[Parameter 11]",
    "role": "measure",
    "type": "nominal",
  },
  {
    "caption": "Date Bucket",
    "datatype": "string",
    "formula": ""day"",
    "name": "[Parameter 1]",
    "role": "measure",
    "type": "nominal",
  },
  {
    "caption": "Start Date",
    "datatype": "date",
    "formula": "#2025-07-30#",
    "name": "[Parameter 5]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "End Date",
    "datatype": "date",
    "formula": "#2025-08-27#",
    "name": "[Parameter 6]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "TTW Grade",
    "datatype": "string",
    "formula": "IF [ttw_qualstatus] = 'ttw-qualified' then 'Grade A'
ELSEIF  [ttw_qualstatus] = 'ttw-nonqualified' and [TTW Explore Work Form] = 'yes' THEN 'Grade B'
ELSEIF [ttw_qualstatus] = 'ttw-nonqualified' and [TTW Explore Work Form] != 'yes' THEN 'Grade C'
ELSEIF ISNULL([ttw_qualstatus]) and [Stage3 Response] = 'Between 2 and 4 years' then 'Grade D'
ELSE 'Rest'
END",
    "name": "[Calculation_1006061976934187009]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Hour of Day",
    "datatype": "string",
    "formula": "IF LEN(STR(DATEPART('hour', [Calculation_1916563181826678784]))) = 1
THEN "0" + STR(DATEPART('hour', [Calculation_1916563181826678784]))
ELSE STR(DATEPART('hour', [Calculation_1916563181826678784]))
END",
    "name": "[Calculation_1113233589182521344]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "20hrs Disqual",
    "datatype": "integer",
    "formula": "IF [Stage6 Response] = "More than 20 hours per week" THEN 1 ELSE 0 END",
    "name": "[Calculation_1133007210546622464]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Age Disqual",
    "datatype": "integer",
    "formula": "IF INT([Age]) < 40 OR INT([Age]) > 62 THEN 1 ELSE 0 END",
    "name": "[Calculation_1133007210553298946]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Attorney Disqual",
    "datatype": "integer",
    "formula": "IF [Stage5 Response] = "Yes" THEN 1 ELSE 0 END",
    "name": "[Calculation_1133007210553425923]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Ben Disqual",
    "datatype": "integer",
    "formula": "IF IFNULL([Stage1 Response], "") != "I am not receiving any disability benefits (SSD or SSI)"
THEN 1 ELSE 0 END",
    "name": "[Calculation_1133007210553487364]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Doctor Visit Disqual",
    "datatype": "integer",
    "formula": "IF [Stage4 Response] = "No" THEN 1 ELSE 0 END",
    "name": "[Calculation_1133007210553540613]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Five Year Work Disqual",
    "datatype": "integer",
    "formula": "IF [Stage3 Response] = "Less than 2 years"
OR [Stage3 Response] = "Between 2 and 4 years"
THEN 1 ELSE 0 END",
    "name": "[Calculation_1133007210553618438]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Out of Work Disqual",
    "datatype": "integer",
    "formula": "IF [Stage2 Response] = "No" THEN 1 ELSE 0 END",
    "name": "[Calculation_1133007210553663495]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "# of Disqual",
    "datatype": "integer",
    "formula": "ZN([Calculation_1133007210553487364]) +
ZN([Calculation_1133007210553663495]) +
ZN([Calculation_1133007210553618438]) +
ZN([Calculation_1133007210553540613]) +
ZN([Calculation_1133007210553425923]) +
ZN([Calculation_1133007210546622464]) +
ZN([Calculation_1133007210553298946])",
    "name": "[Calculation_1133007210553765896]",
    "role": "dimension",
    "type": "ordinal",
  },
  {
    "caption": "Month - Year",
    "datatype": "string",
    "formula": "DATENAME('month',[Post Date])+' '+ STR(YEAR([Post Date]))",
    "name": "[Calculation_1232578966341357571]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "LM Combination",
    "datatype": "string",
    "formula": "IFNULL(STR([Post Date]),'')+
IFNULL([Phone],'')",
    "name": "[Calculation_1341228293760880641]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Unresolved SSA Leads",
    "datatype": "string",
    "formula": "IF { FIXED [Phone] : MAX([Resolved Lead]) } = 0 THEN "SSA Unresolved Lead"
ELSEIF { FIXED [Phone] : MAX([Resolved Lead]) } = 1 THEN "SSA Resolved Lead"
END",
    "name": "[Calculation_1467962419029331969]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "CZ Post Hour Group",
    "datatype": "string",
    "formula": "IF DATEPART('hour', [Post Date]) >= 0 AND DATEPART('hour', [Post Date]) < 6 THEN 'Pre CC Hours'
ELSEIF DATEPART('hour', [Post Date]) >= 6 AND DATEPART('hour', [Post Date]) < 16 THEN 'CC Hours'
ELSEIF DATEPART('hour', [Post Date]) >= 16 AND DATEPART('hour', [Post Date]) < 24 THEN 'Post CC Hours'
END",
    "name": "[Calculation_1880252886125215747]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Post Date ",
    "datatype": "datetime",
    "formula": "//Updated Date: 18 May 2022
//Updated By: Manish
//Description: Formula to calculate UTC date

DATEADD("hour",0,[Post Date])",
    "name": "[Calculation_1916563181826678784]",
    "role": "dimension",
    "type": "ordinal",
  },
  {
    "caption": "Data Updated On",
    "datatype": "datetime",
    "formula": "{fixed :max([Post Date])}",
    "name": "[Calculation_2010857255412854784]",
    "role": "dimension",
    "type": "ordinal",
  },
  {
    "caption": "Masked Email",
    "datatype": "string",
    "formula": "Replace(Email,SPLIT([Email],'@',1),'******')",
    "name": "[Calculation_2902429233285222401]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Masked Address",
    "datatype": "string",
    "formula": "//Replace([Address],SPLIT([Address],' ',1),'******')
'***********' + ' ' + SPLIT([Address],' ',-1)",
    "name": "[Calculation_2902429233286373378]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Project Type",
    "datatype": "string",
    "formula": "IF CONTAINS([CZ Project Name],'Aged') THEN 'Aged'
ELSE 'Live' END",
    "name": "[Calculation_5872834692856524810]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Missing Leads in CRM Flag",
    "datatype": "integer",
    "formula": "IF isnull([CRM Flag]) THEN  1 else 0 END",
    "name": "[Calculation_632192798363463680]",
    "role": "dimension",
    "type": "ordinal",
  },
  {
    "caption": "Grade",
    "datatype": "string",
    "formula": "// Grade A
IF [qual_status] = 'all-steps' THEN 'Grade A'

// Grade B
ELSEIF 
    [qual_status] IN ('fiveyrwrk-disqual','outofwrk-disqual','doc-disqual')
    AND [Calculation_1133007210553765896] = 1
THEN 'Grade B'

// Grade C
ELSEIF 
    [qual_status] <> 'age-disqual'
    AND NOT [Stage3 Response] IN ('Less than 2 years', 'Between 2 and 4 years')
    AND [Stage1 Response] <> 'Social Security Disability (SSD) Benefits'
    AND [Stage6 Response] = 'Not working'
THEN 'Grade C'

// Grade D
ELSEIF 
    // 1) Not age-disqual, Stage3 NOT in those two, Stage1 not SSD, Stage6 ≠ Not working, disqual ≤ 1
    (
      [qual_status] <> 'age-disqual'
      AND NOT [Stage3 Response] IN ('Less than 2 years', 'Between 2 and 4 years')
      AND [Stage1 Response] <> 'Social Security Disability (SSD) Benefits'
      AND [Stage6 Response] <> 'Not working'
      AND [Calculation_1133007210553765896] <= 1
    )
    // 2) Not age-disqual, Stage3 in those two, Qual Status = outofwrk-disqual
    OR
    (
      [qual_status] <> 'age-disqual'
      AND [Stage3 Response] IN ('Less than 2 years', 'Between 2 and 4 years')
      AND [qual_status] = 'outofwrk-disqual'
    )
    // 3) Not age-disqual, Stage3 in those two, Qual Status ≠ outofwrk-disqual, Stage7 = Yes
    OR
    (
      [qual_status] <> 'age-disqual'
      AND [Stage3 Response] IN ('Less than 2 years', 'Between 2 and 4 years')
      AND [qual_status] <> 'outofwrk-disqual'
      AND [Stage7 Response] = 'Yes'
    )
THEN 'Grade D'

// Rest (including age-disqual or anything else)
ELSE 'Rest'
END",
    "name": "[Calculation_7573084309404708864]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Today-28",
    "datatype": "date",
    "formula": "//Updated Date: 18 May 2022
//Updated By: Manish
//Description: Going back 28 days from today

({MAX(today()-28)})",
    "name": "[Calculation_767300790172184597]",
    "role": "dimension",
    "type": "ordinal",
  },
  {
    "caption": "Date Filter",
    "datatype": "boolean",
    "formula": "//Updated Date: 18 May 2022
//Updated By: Manish
//Description: Filtering data based on date

IF [Parameters].[Parameter 11] = 'default'
THEN [Date]>=[Parameters].[Parameter 5] AND [Date]<=[Parameters].[Parameter 6]
ELSEIF [Parameters].[Parameter 11] = 'weekly'
THEN [Date] >= TODAY()-8 AND [Date] <= TODAY()-1
END",
    "name": "[Calculation_843580506575679492]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Dial R",
    "datatype": "string",
    "formula": "IF  [Called Count] < 4 then "<=3" 
elseif [Called Count] < 8 then "4-7"
elseif [Called Count] < 11 then "8-10"
elseif [Called Count] < 16 then "11-15"
elseif [Called Count] < 20 then "16-19"
elseif [Called Count] < 26 then "20-25"
elseif [Called Count] < 31 then "25-30"
elseif [Called Count] < 36 then "30-35"
else "35+" 
END",
    "name": "[Calculation_847802666706034688]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Dial R (detail)",
    "datatype": "string",
    "formula": "STR([Called Count])",
    "name": "[Calculation_847802666706186241]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Max Date",
    "datatype": "date",
    "formula": "//Updated Date: 18 May 2022
//Updated By: Manish
//Description: Calculating max of todays date for including it in the default values of end date

{MAX(today())}",
    "name": "[Calculation_882424053213511680]",
    "role": "dimension",
    "type": "ordinal",
  },
  {
    "caption": "Alt. Branding",
    "datatype": "string",
    "formula": "If int(Right([Phone],2))<30 and [Calculation_5872834692856524810]= 'Live' then 'Yes' else 'No' End",
    "name": "[Calculation_935059914517495808]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Post Date  ",
    "datatype": "string",
    "formula": "//Updated Date: 18 May 2022
//Updated By: Manish
//Description: Calculation to apply date bucket

CASE [Parameters].[Parameter 1]
WHEN 'year' THEN str(datepart('year', [Calculation_1916563181826678784]))
WHEN 'quarter' THEN "Q" + str(datepart('quarter', [Calculation_1916563181826678784])) + " " + str(datepart('year', [Calculation_1916563181826678784]))
WHEN 'month' THEN str(datepart('month', [Calculation_1916563181826678784])) + "-" + str(datepart('year', [Calculation_1916563181826678784]))
WHEN 'day' THEN str(DATENAME('month', [Calculation_1916563181826678784]))+ "-" +str(datepart('day', [Calculation_1916563181826678784]))+ "-" + str(datepart('year', [Calculation_1916563181826678784]))
WHEN 'week' THEN "W" + str(datepart('week', [Calculation_1916563181826678784])) + "-" + str(datepart('year', [Calculation_1916563181826678784]))
WHEN "hour" THEN str(DATETRUNC('hour', [Calculation_1916563181826678784]))
WHEN "minute" THEN str(DATETRUNC('minute', [Calculation_1916563181826678784]))
END",
    "name": "[Calculation_97320012552925214]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Age Exclusions",
    "datatype": "string",
    "formula": "[Age Range]",
    "name": "[age range (copy)_99712551094624281]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Helper Date",
    "datatype": "string",
    "formula": ""default"",
    "name": "[Parameter 11]",
    "role": "measure",
    "type": "nominal",
  },
  {
    "caption": "Date Bucket",
    "datatype": "string",
    "formula": ""day"",
    "name": "[Parameter 1]",
    "role": "measure",
    "type": "nominal",
  },
  {
    "caption": "Start Date",
    "datatype": "date",
    "formula": "#2025-07-30#",
    "name": "[Parameter 5]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "End Date",
    "datatype": "date",
    "formula": "#2025-08-27#",
    "name": "[Parameter 6]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Show Source",
    "datatype": "string",
    "formula": ""1"",
    "name": "[Phone (copy)_1255659924007981058]",
    "role": "measure",
    "type": "nominal",
  },
  {
    "caption": "TTW Grade",
    "datatype": "string",
    "formula": "IF [ttw_qualstatus] = 'ttw-qualified' then 'Grade A'
ELSEIF  [ttw_qualstatus] = 'ttw-nonqualified' and [TTW Explore Work Form] = 'yes' THEN 'Grade B'
ELSEIF [ttw_qualstatus] = 'ttw-nonqualified' and [TTW Explore Work Form] != 'yes' THEN 'Grade C'
ELSEIF ISNULL([ttw_qualstatus]) and [Stage3 Response] = 'Between 2 and 4 years' then 'Grade D'
ELSE 'Rest'
END",
    "name": "[Calculation_1006061976934187009]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Hour of Day",
    "datatype": "string",
    "formula": "IF LEN(STR(DATEPART('hour', [Calculation_1916563181826678784]))) = 1
THEN "0" + STR(DATEPART('hour', [Calculation_1916563181826678784]))
ELSE STR(DATEPART('hour', [Calculation_1916563181826678784]))
END",
    "name": "[Calculation_1113233589182521344]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "20hrs Disqual",
    "datatype": "integer",
    "formula": "IF [Stage6 Response] = "More than 20 hours per week" THEN 1 ELSE 0 END",
    "name": "[Calculation_1133007210546622464]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Age Disqual",
    "datatype": "integer",
    "formula": "IF INT([Age]) < 40 OR INT([Age]) > 62 THEN 1 ELSE 0 END",
    "name": "[Calculation_1133007210553298946]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Attorney Disqual",
    "datatype": "integer",
    "formula": "IF [Stage5 Response] = "Yes" THEN 1 ELSE 0 END",
    "name": "[Calculation_1133007210553425923]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Ben Disqual",
    "datatype": "integer",
    "formula": "IF IFNULL([Stage1 Response], "") != "I am not receiving any disability benefits (SSD or SSI)"
THEN 1 ELSE 0 END",
    "name": "[Calculation_1133007210553487364]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Doctor Visit Disqual",
    "datatype": "integer",
    "formula": "IF [Stage4 Response] = "No" THEN 1 ELSE 0 END",
    "name": "[Calculation_1133007210553540613]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Five Year Work Disqual",
    "datatype": "integer",
    "formula": "IF [Stage3 Response] = "Less than 2 years"
OR [Stage3 Response] = "Between 2 and 4 years"
THEN 1 ELSE 0 END",
    "name": "[Calculation_1133007210553618438]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Out of Work Disqual",
    "datatype": "integer",
    "formula": "IF [Stage2 Response] = "No" THEN 1 ELSE 0 END",
    "name": "[Calculation_1133007210553663495]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "# of Disqual",
    "datatype": "integer",
    "formula": "ZN([Calculation_1133007210553487364]) +
ZN([Calculation_1133007210553663495]) +
ZN([Calculation_1133007210553618438]) +
ZN([Calculation_1133007210553540613]) +
ZN([Calculation_1133007210553425923]) +
ZN([Calculation_1133007210546622464]) +
ZN([Calculation_1133007210553298946])",
    "name": "[Calculation_1133007210553765896]",
    "role": "dimension",
    "type": "ordinal",
  },
  {
    "caption": "Month - Year",
    "datatype": "string",
    "formula": "DATENAME('month',[Post Date])+' '+ STR(YEAR([Post Date]))",
    "name": "[Calculation_1232578966341357571]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "LM Combination",
    "datatype": "string",
    "formula": "IFNULL(STR([Post Date]),'')+
IFNULL([Phone],'')",
    "name": "[Calculation_1341228293760880641]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Unresolved SSA Leads",
    "datatype": "string",
    "formula": "IF { FIXED [Phone] : MAX([Resolved Lead]) } = 0 THEN "SSA Unresolved Lead"
ELSEIF { FIXED [Phone] : MAX([Resolved Lead]) } = 1 THEN "SSA Resolved Lead"
END",
    "name": "[Calculation_1467962419029331969]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "CZ Post Hour Group",
    "datatype": "string",
    "formula": "IF DATEPART('hour', [Post Date]) >= 0 AND DATEPART('hour', [Post Date]) < 6 THEN 'Pre CC Hours'
ELSEIF DATEPART('hour', [Post Date]) >= 6 AND DATEPART('hour', [Post Date]) < 16 THEN 'CC Hours'
ELSEIF DATEPART('hour', [Post Date]) >= 16 AND DATEPART('hour', [Post Date]) < 24 THEN 'Post CC Hours'
END",
    "name": "[Calculation_1880252886125215747]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Post Date ",
    "datatype": "datetime",
    "formula": "//Updated Date: 18 May 2022
//Updated By: Manish
//Description: Formula to calculate UTC date

DATEADD("hour",0,[Post Date])",
    "name": "[Calculation_1916563181826678784]",
    "role": "dimension",
    "type": "ordinal",
  },
  {
    "caption": "Data Updated On",
    "datatype": "datetime",
    "formula": "{fixed :max([Post Date])}",
    "name": "[Calculation_2010857255412854784]",
    "role": "dimension",
    "type": "ordinal",
  },
  {
    "caption": "Masked Email",
    "datatype": "string",
    "formula": "Replace(Email,SPLIT([Email],'@',1),'******')",
    "name": "[Calculation_2902429233285222401]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Masked Address",
    "datatype": "string",
    "formula": "//Replace([Address],SPLIT([Address],' ',1),'******')
'***********' + ' ' + SPLIT([Address],' ',-1)",
    "name": "[Calculation_2902429233286373378]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Project Type",
    "datatype": "string",
    "formula": "IF CONTAINS([CZ Project Name],'Aged') THEN 'Aged'
ELSE 'Live' END",
    "name": "[Calculation_5872834692856524810]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Grade",
    "datatype": "string",
    "formula": "// Grade A
IF [qual_status] = 'all-steps' THEN 'Grade A'

// Grade B
ELSEIF 
    [qual_status] IN ('fiveyrwrk-disqual','outofwrk-disqual','doc-disqual')
    AND [Calculation_1133007210553765896] = 1
THEN 'Grade B'

// Grade C
ELSEIF 
    [qual_status] <> 'age-disqual'
    AND NOT [Stage3 Response] IN ('Less than 2 years', 'Between 2 and 4 years')
    AND [Stage1 Response] <> 'Social Security Disability (SSD) Benefits'
    AND [Stage6 Response] = 'Not working'
THEN 'Grade C'

// Grade D
ELSEIF 
    // 1) Not age-disqual, Stage3 NOT in those two, Stage1 not SSD, Stage6 ≠ Not working, disqual ≤ 1
    (
      [qual_status] <> 'age-disqual'
      AND NOT [Stage3 Response] IN ('Less than 2 years', 'Between 2 and 4 years')
      AND [Stage1 Response] <> 'Social Security Disability (SSD) Benefits'
      AND [Stage6 Response] <> 'Not working'
      AND [Calculation_1133007210553765896] <= 1
    )
    // 2) Not age-disqual, Stage3 in those two, Qual Status = outofwrk-disqual
    OR
    (
      [qual_status] <> 'age-disqual'
      AND [Stage3 Response] IN ('Less than 2 years', 'Between 2 and 4 years')
      AND [qual_status] = 'outofwrk-disqual'
    )
    // 3) Not age-disqual, Stage3 in those two, Qual Status ≠ outofwrk-disqual, Stage7 = Yes
    OR
    (
      [qual_status] <> 'age-disqual'
      AND [Stage3 Response] IN ('Less than 2 years', 'Between 2 and 4 years')
      AND [qual_status] <> 'outofwrk-disqual'
      AND [Stage7 Response] = 'Yes'
    )
THEN 'Grade D'

// Rest (including age-disqual or anything else)
ELSE 'Rest'
END",
    "name": "[Calculation_7573084309404708864]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Today-28",
    "datatype": "date",
    "formula": "//Updated Date: 18 May 2022
//Updated By: Manish
//Description: Going back 28 days from today

({MAX(today()-28)})",
    "name": "[Calculation_767300790172184597]",
    "role": "dimension",
    "type": "ordinal",
  },
  {
    "caption": "Time-Source-Subid",
    "datatype": "string",
    "formula": "//Updated Date: 18 May 2022
//Updated By: Manish
//Description: Changing the data type to string of Time-Source-Subid column

STR([Date])+'-'+[Source]+'-'+[Sub Id]",
    "name": "[Calculation_7746824680808361990]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Date Filter",
    "datatype": "boolean",
    "formula": "//Updated Date: 18 May 2022
//Updated By: Manish
//Description: Filtering data based on date

IF [Parameters].[Parameter 11] = 'default'
THEN [Date]>=[Parameters].[Parameter 5] AND [Date]<=[Parameters].[Parameter 6]
ELSEIF [Parameters].[Parameter 11] = 'weekly'
THEN [Date] >= TODAY()-8 AND [Date] <= TODAY()-1
END",
    "name": "[Calculation_843580506575679492]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Dial R",
    "datatype": "string",
    "formula": "IF  [Called Count] < 4 then "<=3" 
elseif [Called Count] < 8 then "4-7"
elseif [Called Count] < 11 then "8-10"
elseif [Called Count] < 16 then "11-15"
elseif [Called Count] < 20 then "16-19"
elseif [Called Count] < 26 then "20-25"
elseif [Called Count] < 31 then "25-30"
elseif [Called Count] < 36 then "30-35"
else "35+" 
END",
    "name": "[Calculation_847802666706034688]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Dial R (detail)",
    "datatype": "string",
    "formula": "STR([Called Count])",
    "name": "[Calculation_847802666706186241]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Max Date",
    "datatype": "date",
    "formula": "//Updated Date: 18 May 2022
//Updated By: Manish
//Description: Calculating max of todays date for including it in the default values of end date

{MAX(today())}",
    "name": "[Calculation_882424053213511680]",
    "role": "dimension",
    "type": "ordinal",
  },
  {
    "caption": "Alt. Branding",
    "datatype": "string",
    "formula": "If int(Right([Phone],2))<30 and [Calculation_5872834692856524810]= 'Live' then 'Yes' else 'No' End",
    "name": "[Calculation_935059914517495808]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Post Date  ",
    "datatype": "string",
    "formula": "//Updated Date: 18 May 2022
//Updated By: Manish
//Description: Calculation to apply date bucket

CASE [Parameters].[Parameter 1]
WHEN 'year' THEN str(datepart('year', [Calculation_1916563181826678784]))
WHEN 'quarter' THEN "Q" + str(datepart('quarter', [Calculation_1916563181826678784])) + " " + str(datepart('year', [Calculation_1916563181826678784]))
WHEN 'month' THEN str(datepart('month', [Calculation_1916563181826678784])) + "-" + str(datepart('year', [Calculation_1916563181826678784]))
WHEN 'day' THEN str(DATENAME('month', [Calculation_1916563181826678784]))+ "-" +str(datepart('day', [Calculation_1916563181826678784]))+ "-" + str(datepart('year', [Calculation_1916563181826678784]))
WHEN 'week' THEN "W" + str(datepart('week', [Calculation_1916563181826678784])) + "-" + str(datepart('year', [Calculation_1916563181826678784]))
WHEN "hour" THEN str(DATETRUNC('hour', [Calculation_1916563181826678784]))
WHEN "minute" THEN str(DATETRUNC('minute', [Calculation_1916563181826678784]))
END",
    "name": "[Calculation_97320012552925214]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Blank",
    "datatype": "string",
    "formula": "//Updated Date: 18 May 2022
//Updated By: Manish
//Description: Blank column

""",
    "name": "[Calculation_97320012562538539]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Source ",
    "datatype": "string",
    "formula": "CASE [Parameters].[Phone (copy)_1255659924007981058]
WHEN "0" THEN "Agg"
WHEN "1" THEN [Source]
END",
    "name": "[Phone (copy)_1255659924007964673]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Age Exclusions",
    "datatype": "string",
    "formula": "[Age Range]",
    "name": "[age range (copy)_99712551094624281]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "D2",
    "datatype": "integer",
    "formula": "0",
    "name": "[D1 (copy 2)_1113233589196361731]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "D3",
    "datatype": "integer",
    "formula": "0",
    "name": "[D1 (copy 3)_1113233589196374020]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "D5",
    "datatype": "integer",
    "formula": "0",
    "name": "[D1 (copy) (copy)_1113233589196361730]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "D4",
    "datatype": "integer",
    "formula": "0",
    "name": "[D1 (copy)_1113233589196333057]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "D1",
    "datatype": "integer",
    "formula": "0",
    "name": "[Parameter 10]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Helper Date",
    "datatype": "string",
    "formula": ""default"",
    "name": "[Parameter 11]",
    "role": "measure",
    "type": "nominal",
  },
  {
    "caption": "User Identifier",
    "datatype": "integer",
    "formula": "0",
    "name": "[Parameter 12]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Date Bucket",
    "datatype": "string",
    "formula": ""day"",
    "name": "[Parameter 1]",
    "role": "measure",
    "type": "nominal",
  },
  {
    "caption": "Start Date",
    "datatype": "date",
    "formula": "#2025-07-30#",
    "name": "[Parameter 5]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "End Date",
    "datatype": "date",
    "formula": "#2025-08-27#",
    "name": "[Parameter 6]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "TTW Grade",
    "datatype": "string",
    "formula": "IF [ttw_qualstatus] = 'ttw-qualified' then 'Grade A'
ELSEIF  [ttw_qualstatus] = 'ttw-nonqualified' and [TTW Explore Work Form] = 'yes' THEN 'Grade B'
ELSEIF [ttw_qualstatus] = 'ttw-nonqualified' and [TTW Explore Work Form] != 'yes' THEN 'Grade C'
ELSEIF ISNULL([ttw_qualstatus]) and [Stage3 Response] = 'Between 2 and 4 years' then 'Grade D'
ELSE 'Rest'
END",
    "name": "[Calculation_1006061976934187009]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Hour of Day",
    "datatype": "string",
    "formula": "IF LEN(STR(DATEPART('hour', [Calculation_1916563181826678784]))) = 1
THEN "0" + STR(DATEPART('hour', [Calculation_1916563181826678784]))
ELSE STR(DATEPART('hour', [Calculation_1916563181826678784]))
END",
    "name": "[Calculation_1113233589182521344]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "20hrs Disqual",
    "datatype": "integer",
    "formula": "IF [Stage6 Response] = "More than 20 hours per week" THEN 1 ELSE 0 END",
    "name": "[Calculation_1133007210546622464]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Age Disqual",
    "datatype": "integer",
    "formula": "IF INT([Age]) < 40 OR INT([Age]) > 62 THEN 1 ELSE 0 END",
    "name": "[Calculation_1133007210553298946]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Attorney Disqual",
    "datatype": "integer",
    "formula": "IF [Stage5 Response] = "Yes" THEN 1 ELSE 0 END",
    "name": "[Calculation_1133007210553425923]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Ben Disqual",
    "datatype": "integer",
    "formula": "IF IFNULL([Stage1 Response], "") != "I am not receiving any disability benefits (SSD or SSI)"
THEN 1 ELSE 0 END",
    "name": "[Calculation_1133007210553487364]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Doctor Visit Disqual",
    "datatype": "integer",
    "formula": "IF [Stage4 Response] = "No" THEN 1 ELSE 0 END",
    "name": "[Calculation_1133007210553540613]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Five Year Work Disqual",
    "datatype": "integer",
    "formula": "IF [Stage3 Response] = "Less than 2 years"
OR [Stage3 Response] = "Between 2 and 4 years"
THEN 1 ELSE 0 END",
    "name": "[Calculation_1133007210553618438]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Out of Work Disqual",
    "datatype": "integer",
    "formula": "IF [Stage2 Response] = "No" THEN 1 ELSE 0 END",
    "name": "[Calculation_1133007210553663495]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "# of Disqual",
    "datatype": "integer",
    "formula": "ZN([Calculation_1133007210553487364]) +
ZN([Calculation_1133007210553663495]) +
ZN([Calculation_1133007210553618438]) +
ZN([Calculation_1133007210553540613]) +
ZN([Calculation_1133007210553425923]) +
ZN([Calculation_1133007210546622464]) +
ZN([Calculation_1133007210553298946])",
    "name": "[Calculation_1133007210553765896]",
    "role": "dimension",
    "type": "ordinal",
  },
  {
    "caption": "Levine States ",
    "datatype": "string",
    "formula": "IF ISNULL([Levine States]) THEN 'Other'
ELSE [Levine States] END",
    "name": "[Calculation_1277614987429064704]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "DP Leak",
    "datatype": "string",
    "formula": "IF CONTAINS([clientname], 'disabilitypath')
AND [Calculation_7573084309404708864] in ('Grade A', 'Grade B')
THEN 'Yes'
ELSE 'No'
END",
    "name": "[Calculation_1460573688699854848]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Unresolved SSA Leads",
    "datatype": "string",
    "formula": "IF { FIXED [Phone] : MAX([Resolved Lead]) } = 0 THEN "SSA Unresolved Lead"
ELSEIF { FIXED [Phone] : MAX([Resolved Lead]) } = 1 THEN "SSA Resolved Lead"
END",
    "name": "[Calculation_1467962419029331969]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "CTC Lead Flag",
    "datatype": "string",
    "formula": "if [CTC Lead] = 1 then "Yes" else "No" END",
    "name": "[Calculation_1880252886088871936]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "CZ Post Hour Group",
    "datatype": "string",
    "formula": "IF DATEPART('hour', [Post Date]) >= 0 AND DATEPART('hour', [Post Date]) < 6 THEN 'Pre CC Hours'
ELSEIF DATEPART('hour', [Post Date]) >= 6 AND DATEPART('hour', [Post Date]) < 16 THEN 'CC Hours'
ELSEIF DATEPART('hour', [Post Date]) >= 16 AND DATEPART('hour', [Post Date]) < 24 THEN 'Post CC Hours'
END",
    "name": "[Calculation_1880252886125215747]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Post Date ",
    "datatype": "datetime",
    "formula": "//Updated Date: 18 May 2022
//Updated By: Manish
//Description: Formula to calculate UTC date

DATEADD("hour",0,[Post Date])",
    "name": "[Calculation_1916563181826678784]",
    "role": "dimension",
    "type": "ordinal",
  },
  {
    "caption": "PD Dimensions",
    "datatype": "string",
    "formula": "IFNULL(STR([Calculation_97320012552925214]),'')+
IFNULL([Calculation_6374000853571039236],'')+
IFNULL([D1 (copy)_6374000853573341191],'')+
IFNULL([D1 (copy) (copy)_6374000853573369864],'')+
IFNULL([D3 (copy)_6208563937532035081],'')+
IFNULL([D4 (copy)_6208563937532350475],'')",
    "name": "[Calculation_1999879738529857536]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Data Updated On",
    "datatype": "datetime",
    "formula": "{fixed :max([Post Date])}",
    "name": "[Calculation_2010857255412854784]",
    "role": "dimension",
    "type": "ordinal",
  },
  {
    "caption": "Lead Sell Type",
    "datatype": "string",
    "formula": "if contains([Transfer Info Label],'CXER') then 'Sold: Call' 
elseif 
contains([sgmt],'ql-leadbuy') or 
contains([ATA Work],'ql-leadbuy')
then 'Sold: Lead'
else 'Internal'
end",
    "name": "[Calculation_3435894714053935109]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "L15D Dupes #",
    "datatype": "integer",
    "formula": "COUNTD(
  IF [appearance_l15d] > 0
  THEN [Calculation_906349454594166784]
  END)",
    "name": "[Calculation_3545951403000930304]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "L3D Dupes #",
    "datatype": "integer",
    "formula": "COUNTD(
  IF [appearance_l3d] > 0
  THEN [Calculation_906349454594166784]
  END)",
    "name": "[Calculation_3545951403001835522]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "L7D Dupes #",
    "datatype": "integer",
    "formula": "COUNTD(
  IF [appearance_l7d] > 0
  THEN [Calculation_906349454594166784]
  END)",
    "name": "[Calculation_3545951403002036227]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "L30D Dupes #",
    "datatype": "integer",
    "formula": "COUNTD(
  IF [appearance_l30d] > 0
  THEN [Calculation_906349454594166784]
  END)",
    "name": "[Calculation_3545951403002183684]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "L60D Dupes #",
    "datatype": "integer",
    "formula": "COUNTD(
  IF [appearance_l60d] > 0
  THEN [Calculation_906349454594166784]
  END)",
    "name": "[Calculation_3545951403002527749]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "L90D Dupes #",
    "datatype": "integer",
    "formula": "COUNTD(
  IF [appearance_l90d] > 0
  THEN [Calculation_906349454594166784]
  END)",
    "name": "[Calculation_3545951403003084806]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Seg4 Control vs. Treatment",
    "datatype": "string",
    "formula": "IF [CZ Project Name] = "Mass Tort - High Intent SSDI" AND [Calculation_1880252886088871936] = "No" AND [qual_status] != "all-steps" THEN
    IF INT(RIGHT([phone masked], 3)) % 2 = 0 THEN "Control"
    ELSEIF INT(RIGHT([phone masked], 3)) % 2 != 0 THEN "Treatment"
    END
END",
    "name": "[Calculation_4531465651676315649]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Seg4 Cohort",
    "datatype": "string",
    "formula": "LOWER(IFNULL([seg4_cohort], [Calculation_4531465651676315649]))",
    "name": "[Calculation_4531465651676438530]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Avg CPL",
    "datatype": "real",
    "formula": "//Updated Date: 18 May 2022
//Updated By: Manish
//Description: Calculating the avg CPL

ZN(SUM(ZN(CPL))/ZN([Calculation_99712551082803223]))",
    "name": "[Calculation_4891401821037686787]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Time to Call (Minute)",
    "datatype": "real",
    "formula": "IF [Calculation_1880252886088871936] = 'Yes'
THEN ROUND(([CTC Time] - [Post Date]) * 24 * 60, 2)
END",
    "name": "[Calculation_499055157752631296]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Time to Call Bucket",
    "datatype": "string",
    "formula": "IF  [Calculation_499055157752631296] < 0
THEN '<0 Mins'
ELSEIF [Calculation_499055157752631296] <= 2 AND [Calculation_499055157752631296] >= 0
THEN '0-2 Mins'
ELSEIF [Calculation_499055157752631296] <= 5 AND [Calculation_499055157752631296] > 0
THEN '2-5 Mins'
ELSEIF [Calculation_499055157752631296] <= 10 AND [Calculation_499055157752631296] > 0
THEN '5-10 Mins'
ELSEIF [Calculation_499055157752631296] <= 30 AND [Calculation_499055157752631296] > 0 
THEN '10-30 Mins'
ELSEIF [Calculation_499055157752631296] <= 60 AND [Calculation_499055157752631296] > 0
THEN '30Mins-1 Hour'
ELSEIF [Calculation_499055157752631296] <= 300 AND [Calculation_499055157752631296] > 0
THEN '1-5 Hours'
ELSEIF [Calculation_499055157752631296] <= 600 AND [Calculation_499055157752631296] > 0
THEN '5-10 Hours'
ELSEIF [Calculation_499055157752631296] <= 1440 AND [Calculation_499055157752631296] > 0
THEN '10-24 Hours'
ELSEIF [Calculation_499055157752631296] <= 4320 AND [Calculation_499055157752631296] > 0
THEN '24-72 Hours'
ELSEIF [Calculation_499055157752631296] > 4320 AND [Calculation_499055157752631296] > 0
THEN '>72 Hours'
END",
    "name": "[Calculation_499055157754740737]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Project Type",
    "datatype": "string",
    "formula": "IF CONTAINS([CZ Project Name],'Aged') THEN 'Aged'
ELSE 'Live' END",
    "name": "[Calculation_5872834692856524810]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "BLA Status",
    "datatype": "string",
    "formula": "IF [bla_blacklisted] = 'true' THEN 'Blacklisted'
ELSEIF [bla_blacklisted] = 'false' THEN 'Passed'
ELSE NULL
END",
    "name": "[Calculation_6374000853565702144]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "BLA Code",
    "datatype": "string",
    "formula": "[bla_rejectcodes]",
    "name": "[Calculation_6374000853566275585]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "D1 ('+' to add dim)",
    "datatype": "string",
    "formula": "IF [Parameters].[Parameter 10] = 1 THEN [Calculation_6374000853566275585]
ELSEIF [Parameters].[Parameter 10] = 2 THEN [bla_carrierdata_type]
ELSEIF [Parameters].[Parameter 10] = 3 THEN [Calculation_6374000853565702144]
ELSEIF [Parameters].[Parameter 10] = 4 THEN [Phone Carrier]
ELSEIF [Parameters].[Parameter 10] = 5 THEN [CZ Project Name]
ELSEIF [Parameters].[Parameter 10] = 6 THEN [Phone Type]
ELSEIF [Parameters].[Parameter 10] = 7 THEN [normalized carrier]
ELSEIF [Parameters].[Parameter 10] = 8 THEN [Outcome]
ELSEIF [Parameters].[Parameter 10] = 9 THEN [qual_status]
ELSEIF [Parameters].[Parameter 10] = 10 THEN [Source]
ELSEIF [Parameters].[Parameter 10] = 11 THEN [Sub Id]
ELSEIF [Parameters].[Parameter 10] = 12 THEN [gender (copy)_2399292755830108162]
ELSEIF [Parameters].[Parameter 10] = 13 THEN [Creative]
ELSEIF [Parameters].[Parameter 10] = 14 THEN [CL Diagnosis Injury Tiers]
ELSEIF [Parameters].[Parameter 10] = 15 THEN [Calculation_935059914517495808]
ELSEIF [Parameters].[Parameter 10] = 16 THEN [Ad Name]
ELSEIF [Parameters].[Parameter 10] = 17 THEN [Adset Name]
ELSEIF [Parameters].[Parameter 10] = 18 THEN [campaign_id]
ELSEIF [Parameters].[Parameter 10] = 19 THEN [Labels]
ELSEIF [Parameters].[Parameter 10] = 20 THEN [Calculation_5872834692856524810]
ELSEIF [Parameters].[Parameter 10] = 21 THEN [State]
ELSEIF [Parameters].[Parameter 10] = 22 THEN [Phone]
// ELSEIF [D1] = 23 THEN [Tier]
ELSEIF [Parameters].[Parameter 10] = 23 THEN [Calculation_1277614987429064704]
ELSEIF [Parameters].[Parameter 10] = 25 THEN [Result Type]
ELSEIF [Parameters].[Parameter 10] = 26 THEN [placement]
ELSEIF [Parameters].[Parameter 10] = 27 THEN [Calculation_7690318609259716608]
ELSEIF [Parameters].[Parameter 10] = 28 THEN [label]
ELSEIF [Parameters].[Parameter 10] = 29 THEN STR([Calculation_1880252886088871936])
ELSEIF [Parameters].[Parameter 10] = 30 THEN [clientname]
ELSEIF [Parameters].[Parameter 10] = 31 THEN [page_path]
ELSEIF [Parameters].[Parameter 10] = 32 THEN [sgmt]
ELSEIF [Parameters].[Parameter 10] = 33 THEN [ctcphone]
ELSEIF [Parameters].[Parameter 10] = 34 THEN [Calculation_3435894714053935109]
ELSEIF [Parameters].[Parameter 10] = 35 THEN [ltdinoworkmedicalconditions]
ELSEIF [Parameters].[Parameter 10] = 36 THEN [ds_qualstatus]
ELSEIF [Parameters].[Parameter 10] = 37 THEN [ad_id]
ELSEIF [Parameters].[Parameter 10] = 38 THEN [adset_id]
ELSEIF [Parameters].[Parameter 10] = 39 THEN [Calculation_1113233589182521344]
ELSEIF [Parameters].[Parameter 10] = 40 THEN [Calculation_1880252886125215747]
ELSEIF [Parameters].[Parameter 10] = 41 THEN [SubSegment]
ELSEIF [Parameters].[Parameter 10] = 42 THEN STR([Calculation_1133007210553765896])
ELSEIF [Parameters].[Parameter 10] = 43 THEN [Calculation_7573084309404708864]
ELSEIF [Parameters].[Parameter 10] = 44 THEN [Calculation_4531465651676438530]
ELSEIF [Parameters].[Parameter 10] = 45 THEN IF LEN(STR([appearance_l30d])) < 2 AND NOT ISNULL(STR([appearance_l30d])) THEN '0' + STR([appearance_l30d]) ELSE STR([appearance_l30d]) END
ELSEIF [Parameters].[Parameter 10] = 46 THEN IF LEN(STR([appearance_l60d])) < 2 AND NOT ISNULL(STR([appearance_l60d])) THEN '0' + STR([appearance_l60d]) ELSE STR([appearance_l60d]) END
ELSEIF [Parameters].[Parameter 10] = 47 THEN IF LEN(STR([appearance_l90d])) < 2 AND NOT ISNULL(STR([appearance_l90d])) THEN '0' + STR([appearance_l90d]) ELSE STR([appearance_l90d]) END
ELSEIF [Parameters].[Parameter 10] = 48 THEN [ATA Work]
ELSEIF [Parameters].[Parameter 10] = 49 THEN [Calculation_499055157754740737]
ELSEIF [Parameters].[Parameter 10] = 50 THEN IF LEN(STR([CIIC Appearance in L30D])) < 2 AND NOT ISNULL(STR([CIIC Appearance in L30D])) THEN '0' + STR([CIIC Appearance in L30D]) ELSE STR([CIIC Appearance in L30D]) END
ELSEIF [Parameters].[Parameter 10] = 51 THEN IF LEN(STR([CIIC Appearance in L60D])) < 2 AND NOT ISNULL(STR([CIIC Appearance in L60D])) THEN '0' + STR([CIIC Appearance in L60D]) ELSE STR([CIIC Appearance in L60D]) END
ELSEIF [Parameters].[Parameter 10] = 52 THEN IF LEN(STR([CIIC Appearance in L90D])) < 2 AND NOT ISNULL(STR([CIIC Appearance in L90D])) THEN '0' + STR([CIIC Appearance in L90D]) ELSE STR([CIIC Appearance in L90D]) END
ELSEIF [Parameters].[Parameter 10] = 53 THEN STR([Calculation_989947527401095169])
ELSEIF [Parameters].[Parameter 10] = 54 THEN [Calculation_1460573688699854848]
ELSEIF [Parameters].[Parameter 10] = 55 THEN [Calculation_1006061976934187009]
ELSE 'Agg'
END",
    "name": "[Calculation_6374000853571039236]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Grade",
    "datatype": "string",
    "formula": "// Grade A
IF [qual_status] = 'all-steps' THEN 'Grade A'

// Grade B
ELSEIF 
    [qual_status] IN ('fiveyrwrk-disqual','outofwrk-disqual','doc-disqual')
    AND [Calculation_1133007210553765896] = 1
THEN 'Grade B'

// Grade C
ELSEIF 
    [qual_status] <> 'age-disqual'
    AND NOT [Stage3 Response] IN ('Less than 2 years', 'Between 2 and 4 years')
    AND [Stage1 Response] <> 'Social Security Disability (SSD) Benefits'
    AND [Stage6 Response] = 'Not working'
THEN 'Grade C'

// Grade D
ELSEIF 
    // 1) Not age-disqual, Stage3 NOT in those two, Stage1 not SSD, Stage6 ≠ Not working, disqual ≤ 1
    (
      [qual_status] <> 'age-disqual'
      AND NOT [Stage3 Response] IN ('Less than 2 years', 'Between 2 and 4 years')
      AND [Stage1 Response] <> 'Social Security Disability (SSD) Benefits'
      AND [Stage6 Response] <> 'Not working'
      AND [Calculation_1133007210553765896] <= 1
    )
    // 2) Not age-disqual, Stage3 in those two, Qual Status = outofwrk-disqual
    OR
    (
      [qual_status] <> 'age-disqual'
      AND [Stage3 Response] IN ('Less than 2 years', 'Between 2 and 4 years')
      AND [qual_status] = 'outofwrk-disqual'
    )
    // 3) Not age-disqual, Stage3 in those two, Qual Status ≠ outofwrk-disqual, Stage7 = Yes
    OR
    (
      [qual_status] <> 'age-disqual'
      AND [Stage3 Response] IN ('Less than 2 years', 'Between 2 and 4 years')
      AND [qual_status] <> 'outofwrk-disqual'
      AND [Stage7 Response] = 'Yes'
    )
THEN 'Grade D'

// Rest (including age-disqual or anything else)
ELSE 'Rest'
END",
    "name": "[Calculation_7573084309404708864]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Today-28",
    "datatype": "date",
    "formula": "//Updated Date: 18 May 2022
//Updated By: Manish
//Description: Going back 28 days from today

({MAX(today()-28)})",
    "name": "[Calculation_767300790172184597]",
    "role": "dimension",
    "type": "ordinal",
  },
  {
    "caption": "SSD Age Range",
    "datatype": "string",
    "formula": "IF DATE([Calculation_1916563181826678784]) >= #18/08/2025#
THEN
    IF INT([Age]) < 40 THEN "U40"
    ELSEIF INT([Age]) >= 40 AND INT([Age]) <= 49 THEN "40 - 49"
	ELSEIF INT([Age]) >= 50 AND INT([Age]) <= 54 THEN "50 - 54"
    ELSEIF INT([Age]) >= 55 AND INT([Age]) <= 63 THEN "55 - 63"
    ELSEIF INT([Age]) >= 64 THEN "O64+"
    END
ELSEIF INT([Age]) < 40 THEN "*U40"
ELSEIF INT([Age]) >= 40 AND INT([Age]) <= 48 THEN "*40-48"
ELSEIF INT([Age]) = 49 THEN "*49"
ELSEIF INT([Age]) >= 50 AND INT([Age]) <= 62 THEN "*50-62"
ELSEIF INT([Age]) >= 63 THEN "*O63+" 
END",
    "name": "[Calculation_7690318609259716608]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Date Filter",
    "datatype": "boolean",
    "formula": "//Updated Date: 18 May 2022
//Updated By: Manish
//Description: Filtering data based on date

IF [Parameters].[Parameter 11] = 'default'
THEN [Date]>=[Parameters].[Parameter 5] AND [Date]<=[Parameters].[Parameter 6]
ELSEIF [Parameters].[Parameter 11] = 'weekly'
THEN [Date] >= TODAY()-8 AND [Date] <= TODAY()-1
END",
    "name": "[Calculation_843580506575679492]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Dial R",
    "datatype": "string",
    "formula": "IF  [Called Count] < 4 then "<=3" 
elseif [Called Count] < 8 then "4-7"
elseif [Called Count] < 11 then "8-10"
elseif [Called Count] < 16 then "11-15"
elseif [Called Count] < 20 then "16-19"
elseif [Called Count] < 26 then "20-25"
elseif [Called Count] < 31 then "25-30"
elseif [Called Count] < 36 then "30-35"
else "35+" 
END",
    "name": "[Calculation_847802666706034688]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Dial R (detail)",
    "datatype": "string",
    "formula": "STR([Called Count])",
    "name": "[Calculation_847802666706186241]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Max Date",
    "datatype": "date",
    "formula": "//Updated Date: 18 May 2022
//Updated By: Manish
//Description: Calculating max of todays date for including it in the default values of end date

{MAX(today())}",
    "name": "[Calculation_882424053213511680]",
    "role": "dimension",
    "type": "ordinal",
  },
  {
    "caption": "User Identifier",
    "datatype": "string",
    "formula": "IF [Parameters].[Parameter 12] = 0 THEN [User Id]
ELSEIF [Parameters].[Parameter 12] = 1 THEN [Phone]
END",
    "name": "[Calculation_906349454594166784]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Alt. Branding",
    "datatype": "string",
    "formula": "If int(Right([Phone],2))<30 and [Calculation_5872834692856524810]= 'Live' then 'Yes' else 'No' End",
    "name": "[Calculation_935059914517495808]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Duplicate Rejects",
    "datatype": "string",
    "formula": "if [Outcome]='rejected' and { FIXED [Phone], [Outcome]: COUNTD([User Id])}>1 then 'Yes' else 'No' end",
    "name": "[Calculation_943222690415542272]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Post Date  ",
    "datatype": "string",
    "formula": "//Updated Date: 18 May 2022
//Updated By: Manish
//Description: Calculation to apply date bucket

CASE [Parameters].[Parameter 1]
WHEN 'year' THEN str(datepart('year', [Calculation_1916563181826678784]))
WHEN 'quarter' THEN "Q" + str(datepart('quarter', [Calculation_1916563181826678784])) + " " + str(datepart('year', [Calculation_1916563181826678784]))
WHEN 'month' THEN str(datepart('month', [Calculation_1916563181826678784])) + "-" + str(datepart('year', [Calculation_1916563181826678784]))
WHEN 'day' THEN str(DATENAME('month', [Calculation_1916563181826678784]))+ "-" +str(datepart('day', [Calculation_1916563181826678784]))+ "-" + str(datepart('year', [Calculation_1916563181826678784]))
WHEN 'week' THEN "W" + str(datepart('week', [Calculation_1916563181826678784])) + "-" + str(datepart('year', [Calculation_1916563181826678784]))
WHEN "hour" THEN str(DATETRUNC('hour', [Calculation_1916563181826678784]))
WHEN "minute" THEN str(DATETRUNC('minute', [Calculation_1916563181826678784]))
END",
    "name": "[Calculation_97320012552925214]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Vici Post Delay (Days)",
    "datatype": "integer",
    "formula": "DATEDIFF('day', [Post Date], [Entry Time])",
    "name": "[Calculation_989947527401095169]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Vici Leads #",
    "datatype": "integer",
    "formula": "COUNTD(IF
{ FIXED [User Id] : MAX(IF ISNULL([Entry Time])
THEN 0 ELSE 1
END)} = 1
THEN [User Id]
END)",
    "name": "[Calculation_989947527401988098]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Vici Post %",
    "datatype": "real",
    "formula": "[Calculation_989947527401988098] / [Calculation_99712551082803223]",
    "name": "[Calculation_989947527403532291]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Posted #",
    "datatype": "integer",
    "formula": "//Updated Date: 18 May 2022
//Updated By: Manish
//Description: Calculating the sum of user id wrt to source

countd([Calculation_906349454594166784])",
    "name": "[Calculation_99712551082803223]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "D3",
    "datatype": "string",
    "formula": "IF [Parameters].[D1 (copy 3)_1113233589196374020] = 1 THEN [Calculation_6374000853566275585]
ELSEIF [Parameters].[D1 (copy 3)_1113233589196374020] = 2 THEN [bla_carrierdata_type]
ELSEIF [Parameters].[D1 (copy 3)_1113233589196374020] = 3 THEN [Calculation_6374000853565702144]
ELSEIF [Parameters].[D1 (copy 3)_1113233589196374020] = 4 THEN [Phone Carrier]
ELSEIF [Parameters].[D1 (copy 3)_1113233589196374020] = 5 THEN [CZ Project Name]
ELSEIF [Parameters].[D1 (copy 3)_1113233589196374020] = 6 THEN [Phone Type]
ELSEIF [Parameters].[D1 (copy 3)_1113233589196374020] = 7 THEN [normalized carrier]
ELSEIF [Parameters].[D1 (copy 3)_1113233589196374020] = 8 THEN [Outcome]
ELSEIF [Parameters].[D1 (copy 3)_1113233589196374020] = 9 THEN [qual_status]
ELSEIF [Parameters].[D1 (copy 3)_1113233589196374020] = 10 THEN [Source]
ELSEIF [Parameters].[D1 (copy 3)_1113233589196374020] = 11 THEN [Sub Id]
ELSEIF [Parameters].[D1 (copy 3)_1113233589196374020] = 12 THEN [gender (copy)_2399292755830108162]
ELSEIF [Parameters].[D1 (copy 3)_1113233589196374020] = 13 THEN [Creative]
ELSEIF [Parameters].[D1 (copy 3)_1113233589196374020] = 14 THEN [CL Diagnosis Injury Tiers]
ELSEIF [Parameters].[D1 (copy 3)_1113233589196374020] = 15 THEN [Calculation_935059914517495808]
ELSEIF [Parameters].[D1 (copy 3)_1113233589196374020] = 16 THEN [Ad Name]
ELSEIF [Parameters].[D1 (copy 3)_1113233589196374020] = 17 THEN [Adset Name]
ELSEIF [Parameters].[D1 (copy 3)_1113233589196374020] = 18 THEN [campaign_id]
ELSEIF [Parameters].[D1 (copy 3)_1113233589196374020] = 19 THEN [Labels]
ELSEIF [Parameters].[D1 (copy 3)_1113233589196374020] = 20 THEN [Calculation_5872834692856524810]
ELSEIF [Parameters].[D1 (copy 3)_1113233589196374020] = 21 THEN [State]
ELSEIF [Parameters].[D1 (copy 3)_1113233589196374020] = 22 THEN [Phone]
// ELSEIF [Parameters].[D3] = 23 THEN [Tier]
ELSEIF [Parameters].[D1 (copy 3)_1113233589196374020] = 23 THEN [Calculation_1277614987429064704]
ELSEIF [Parameters].[D1 (copy 3)_1113233589196374020] = 25 THEN [Result Type]
ELSEIF [Parameters].[D1 (copy 3)_1113233589196374020] = 26 THEN [placement]
ELSEIF [Parameters].[D1 (copy 3)_1113233589196374020] = 27 THEN [Calculation_7690318609259716608]
ELSEIF [Parameters].[D1 (copy 3)_1113233589196374020] = 28 THEN [label]
ELSEIF [Parameters].[D1 (copy 3)_1113233589196374020] = 29 THEN STR([Calculation_1880252886088871936])
ELSEIF [Parameters].[D1 (copy 3)_1113233589196374020] = 30 THEN [clientname]
ELSEIF [Parameters].[D1 (copy 3)_1113233589196374020] = 31 THEN [page_path]
ELSEIF [Parameters].[D1 (copy 3)_1113233589196374020] = 32 THEN [sgmt]
ELSEIF [Parameters].[D1 (copy 3)_1113233589196374020] = 33 THEN [ctcphone]
ELSEIF [Parameters].[D1 (copy 3)_1113233589196374020] = 34 THEN [Calculation_3435894714053935109]
ELSEIF [Parameters].[D1 (copy 3)_1113233589196374020] = 35 THEN [ltdinoworkmedicalconditions]
ELSEIF [Parameters].[D1 (copy 3)_1113233589196374020] = 36 THEN [ds_qualstatus]
ELSEIF [Parameters].[D1 (copy 3)_1113233589196374020] = 37 THEN [ad_id]
ELSEIF [Parameters].[D1 (copy 3)_1113233589196374020] = 38 THEN [adset_id]
ELSEIF [Parameters].[D1 (copy 3)_1113233589196374020] = 39 THEN [Calculation_1113233589182521344]
ELSEIF [Parameters].[D1 (copy 3)_1113233589196374020] = 40 THEN [Calculation_1880252886125215747]
ELSEIF [Parameters].[D1 (copy 3)_1113233589196374020] = 41 THEN [SubSegment]
ELSEIF [Parameters].[D1 (copy 3)_1113233589196374020] = 42 THEN STR([Calculation_1133007210553765896])
ELSEIF [Parameters].[D1 (copy 3)_1113233589196374020] = 43 THEN [Calculation_7573084309404708864]
ELSEIF [Parameters].[D1 (copy 3)_1113233589196374020] = 44 THEN [Calculation_4531465651676438530]
ELSEIF [Parameters].[D1 (copy 3)_1113233589196374020] = 45 THEN IF LEN(STR([appearance_l30d])) < 2 AND NOT ISNULL(STR([appearance_l30d])) THEN '0' + STR([appearance_l30d]) ELSE STR([appearance_l30d]) END
ELSEIF [Parameters].[D1 (copy 3)_1113233589196374020] = 46 THEN IF LEN(STR([appearance_l60d])) < 2 AND NOT ISNULL(STR([appearance_l60d])) THEN '0' + STR([appearance_l60d]) ELSE STR([appearance_l60d]) END
ELSEIF [Parameters].[D1 (copy 3)_1113233589196374020] = 47 THEN IF LEN(STR([appearance_l90d])) < 2 AND NOT ISNULL(STR([appearance_l90d])) THEN '0' + STR([appearance_l90d]) ELSE STR([appearance_l90d]) END
ELSEIF [Parameters].[D1 (copy 3)_1113233589196374020] = 48 THEN [ATA Work]
ELSEIF [Parameters].[D1 (copy 3)_1113233589196374020] = 49 THEN [Calculation_499055157754740737]
ELSEIF [Parameters].[D1 (copy 3)_1113233589196374020] = 50 THEN IF LEN(STR([CIIC Appearance in L30D])) < 2 AND NOT ISNULL(STR([CIIC Appearance in L30D])) THEN '0' + STR([CIIC Appearance in L30D]) ELSE STR([CIIC Appearance in L30D]) END
ELSEIF [Parameters].[D1 (copy 3)_1113233589196374020] = 51 THEN IF LEN(STR([CIIC Appearance in L60D])) < 2 AND NOT ISNULL(STR([CIIC Appearance in L60D])) THEN '0' + STR([CIIC Appearance in L60D]) ELSE STR([CIIC Appearance in L60D]) END
ELSEIF [Parameters].[D1 (copy 3)_1113233589196374020] = 52 THEN IF LEN(STR([CIIC Appearance in L90D])) < 2 AND NOT ISNULL(STR([CIIC Appearance in L90D])) THEN '0' + STR([CIIC Appearance in L90D]) ELSE STR([CIIC Appearance in L90D]) END
ELSEIF [Parameters].[D1 (copy 3)_1113233589196374020] = 53 THEN STR([Calculation_989947527401095169])
ELSEIF [Parameters].[D1 (copy 3)_1113233589196374020] = 54 THEN [Calculation_1460573688699854848]
ELSEIF [Parameters].[D1 (copy 3)_1113233589196374020] = 55 THEN [Calculation_1006061976934187009]
ELSE 'Agg'
END",
    "name": "[D1 (copy) (copy)_6374000853573369864]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "D2",
    "datatype": "string",
    "formula": "IF [Parameters].[D1 (copy 2)_1113233589196361731] = 1 THEN [Calculation_6374000853566275585]
ELSEIF [Parameters].[D1 (copy 2)_1113233589196361731]  = 2 THEN [bla_carrierdata_type]
ELSEIF [Parameters].[D1 (copy 2)_1113233589196361731]  = 3 THEN [Calculation_6374000853565702144]
ELSEIF [Parameters].[D1 (copy 2)_1113233589196361731]  = 4 THEN [Phone Carrier]
ELSEIF [Parameters].[D1 (copy 2)_1113233589196361731]  = 5 THEN [CZ Project Name]
ELSEIF [Parameters].[D1 (copy 2)_1113233589196361731]  = 6 THEN [Phone Type]
ELSEIF [Parameters].[D1 (copy 2)_1113233589196361731]  = 7 THEN [normalized carrier]
ELSEIF [Parameters].[D1 (copy 2)_1113233589196361731]  = 8 THEN [Outcome]
ELSEIF [Parameters].[D1 (copy 2)_1113233589196361731]  = 9 THEN [qual_status]
ELSEIF [Parameters].[D1 (copy 2)_1113233589196361731]  = 10 THEN [Source]
ELSEIF [Parameters].[D1 (copy 2)_1113233589196361731]  = 11 THEN [Sub Id]
ELSEIF [Parameters].[D1 (copy 2)_1113233589196361731]  = 12 THEN [gender (copy)_2399292755830108162]
ELSEIF [Parameters].[D1 (copy 2)_1113233589196361731]  = 13 THEN [Creative]
ELSEIF [Parameters].[D1 (copy 2)_1113233589196361731]  = 14 THEN [CL Diagnosis Injury Tiers]
ELSEIF [Parameters].[D1 (copy 2)_1113233589196361731]  = 15 THEN [Calculation_935059914517495808]
ELSEIF [Parameters].[D1 (copy 2)_1113233589196361731]  = 16 THEN [Ad Name]
ELSEIF [Parameters].[D1 (copy 2)_1113233589196361731]  = 17 THEN [Adset Name]
ELSEIF [Parameters].[D1 (copy 2)_1113233589196361731]  = 18 THEN [campaign_id]
ELSEIF [Parameters].[D1 (copy 2)_1113233589196361731]  = 19 THEN [Labels]
ELSEIF [Parameters].[D1 (copy 2)_1113233589196361731]  = 20 THEN [Calculation_5872834692856524810]
ELSEIF [Parameters].[D1 (copy 2)_1113233589196361731]  = 21 THEN [State]
ELSEIF [Parameters].[D1 (copy 2)_1113233589196361731]  = 22 THEN [Phone]
// ELSEIF [Parameters].[D2] = 23 THEN [Tier]
ELSEIF [Parameters].[D1 (copy 2)_1113233589196361731]  = 23 THEN [Calculation_1277614987429064704]
ELSEIF [Parameters].[D1 (copy 2)_1113233589196361731]  = 25 THEN [Result Type]
ELSEIF [Parameters].[D1 (copy 2)_1113233589196361731]  = 26 THEN [placement]
ELSEIF [Parameters].[D1 (copy 2)_1113233589196361731]  = 27 THEN [Calculation_7690318609259716608]
ELSEIF [Parameters].[D1 (copy 2)_1113233589196361731]  = 28 THEN [label]
ELSEIF [Parameters].[D1 (copy 2)_1113233589196361731]  = 29 THEN STR([Calculation_1880252886088871936])
ELSEIF [Parameters].[D1 (copy 2)_1113233589196361731]  = 30 THEN [clientname]
ELSEIF [Parameters].[D1 (copy 2)_1113233589196361731]  = 31 THEN [page_path]
ELSEIF [Parameters].[D1 (copy 2)_1113233589196361731]  = 32 THEN [sgmt]
ELSEIF [Parameters].[D1 (copy 2)_1113233589196361731]  = 33 THEN [ctcphone]
ELSEIF [Parameters].[D1 (copy 2)_1113233589196361731]  = 34 THEN [Calculation_3435894714053935109]
ELSEIF [Parameters].[D1 (copy 2)_1113233589196361731]  = 35 THEN [ltdinoworkmedicalconditions]
ELSEIF [Parameters].[D1 (copy 2)_1113233589196361731]  = 36 THEN [ds_qualstatus]
ELSEIF [Parameters].[D1 (copy 2)_1113233589196361731]  = 37 THEN [ad_id]
ELSEIF [Parameters].[D1 (copy 2)_1113233589196361731]  = 38 THEN [adset_id]
ELSEIF [Parameters].[D1 (copy 2)_1113233589196361731]  = 39 THEN [Calculation_1113233589182521344]
ELSEIF [Parameters].[D1 (copy 2)_1113233589196361731]  = 40 THEN [Calculation_1880252886125215747]
ELSEIF [Parameters].[D1 (copy 2)_1113233589196361731]  = 41 THEN [SubSegment]
ELSEIF [Parameters].[D1 (copy 2)_1113233589196361731] = 42 THEN STR([Calculation_1133007210553765896])
ELSEIF [Parameters].[D1 (copy 2)_1113233589196361731] = 43 THEN [Calculation_7573084309404708864]
ELSEIF [Parameters].[D1 (copy 2)_1113233589196361731] = 44 THEN [Calculation_4531465651676438530]
ELSEIF [Parameters].[D1 (copy 2)_1113233589196361731] = 45 THEN IF LEN(STR([appearance_l30d])) < 2 AND NOT ISNULL(STR([appearance_l30d])) THEN '0' + STR([appearance_l30d]) ELSE STR([appearance_l30d]) END
ELSEIF [Parameters].[D1 (copy 2)_1113233589196361731] = 46 THEN IF LEN(STR([appearance_l60d])) < 2 AND NOT ISNULL(STR([appearance_l60d])) THEN '0' + STR([appearance_l60d]) ELSE STR([appearance_l60d]) END
ELSEIF [Parameters].[D1 (copy 2)_1113233589196361731] = 47 THEN IF LEN(STR([appearance_l90d])) < 2 AND NOT ISNULL(STR([appearance_l90d])) THEN '0' + STR([appearance_l90d]) ELSE STR([appearance_l90d]) END
ELSEIF [Parameters].[D1 (copy 2)_1113233589196361731] = 48 THEN [ATA Work]
ELSEIF [Parameters].[D1 (copy 2)_1113233589196361731] = 49 THEN [Calculation_499055157754740737]
ELSEIF [Parameters].[D1 (copy 2)_1113233589196361731] = 50 THEN IF LEN(STR([CIIC Appearance in L30D])) < 2 AND NOT ISNULL(STR([CIIC Appearance in L30D])) THEN '0' + STR([CIIC Appearance in L30D]) ELSE STR([CIIC Appearance in L30D]) END
ELSEIF [Parameters].[D1 (copy 2)_1113233589196361731] = 51 THEN IF LEN(STR([CIIC Appearance in L60D])) < 2 AND NOT ISNULL(STR([CIIC Appearance in L60D])) THEN '0' + STR([CIIC Appearance in L60D]) ELSE STR([CIIC Appearance in L60D]) END
ELSEIF [Parameters].[D1 (copy 2)_1113233589196361731] = 52 THEN IF LEN(STR([CIIC Appearance in L90D])) < 2 AND NOT ISNULL(STR([CIIC Appearance in L90D])) THEN '0' + STR([CIIC Appearance in L90D]) ELSE STR([CIIC Appearance in L90D]) END
ELSEIF [Parameters].[D1 (copy 2)_1113233589196361731] = 53 THEN STR([Calculation_989947527401095169])
ELSEIF [Parameters].[D1 (copy 2)_1113233589196361731] = 54 THEN [Calculation_1460573688699854848]
ELSEIF [Parameters].[D1 (copy 2)_1113233589196361731] = 55 THEN [Calculation_1006061976934187009]
ELSE 'Agg'
END",
    "name": "[D1 (copy)_6374000853573341191]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "D4",
    "datatype": "string",
    "formula": "IF [Parameters].[D1 (copy)_1113233589196333057] = 1 THEN [Calculation_6374000853566275585]
ELSEIF [Parameters].[D1 (copy)_1113233589196333057] = 2 THEN [bla_carrierdata_type]
ELSEIF [Parameters].[D1 (copy)_1113233589196333057] = 3 THEN [Calculation_6374000853565702144]
ELSEIF [Parameters].[D1 (copy)_1113233589196333057] = 4 THEN [Phone Carrier]
ELSEIF [Parameters].[D1 (copy)_1113233589196333057] = 5 THEN [CZ Project Name]
ELSEIF [Parameters].[D1 (copy)_1113233589196333057] = 6 THEN [Phone Type]
ELSEIF [Parameters].[D1 (copy)_1113233589196333057] = 7 THEN [normalized carrier]
ELSEIF [Parameters].[D1 (copy)_1113233589196333057] = 8 THEN [Outcome]
ELSEIF [Parameters].[D1 (copy)_1113233589196333057] = 9 THEN [qual_status]
ELSEIF [Parameters].[D1 (copy)_1113233589196333057] = 10 THEN [Source]
ELSEIF [Parameters].[D1 (copy)_1113233589196333057] = 11 THEN [Sub Id]
ELSEIF [Parameters].[D1 (copy)_1113233589196333057] = 12 THEN [gender (copy)_2399292755830108162]
ELSEIF [Parameters].[D1 (copy)_1113233589196333057] = 13 THEN [Creative]
ELSEIF [Parameters].[D1 (copy)_1113233589196333057] = 14 THEN [CL Diagnosis Injury Tiers]
ELSEIF [Parameters].[D1 (copy)_1113233589196333057] = 15 THEN [Calculation_935059914517495808]
ELSEIF [Parameters].[D1 (copy)_1113233589196333057] = 16 THEN [Ad Name]
ELSEIF [Parameters].[D1 (copy)_1113233589196333057] = 17 THEN [Adset Name]
ELSEIF [Parameters].[D1 (copy)_1113233589196333057] = 18 THEN [campaign_id]
ELSEIF [Parameters].[D1 (copy)_1113233589196333057] = 19 THEN [Labels]
ELSEIF [Parameters].[D1 (copy)_1113233589196333057] = 20 THEN [Calculation_5872834692856524810]
ELSEIF [Parameters].[D1 (copy)_1113233589196333057] = 21 THEN [State]
ELSEIF [Parameters].[D1 (copy)_1113233589196333057] = 22 THEN [Phone]
// ELSEIF [Parameters].[D4] = 23 THEN [Tier]
ELSEIF [Parameters].[D1 (copy)_1113233589196333057] = 23 THEN [Calculation_1277614987429064704]
ELSEIF [Parameters].[D1 (copy)_1113233589196333057] = 25 THEN [Result Type]
ELSEIF [Parameters].[D1 (copy)_1113233589196333057] = 26 THEN [placement]
ELSEIF [Parameters].[D1 (copy)_1113233589196333057] = 27 THEN [Calculation_7690318609259716608]
ELSEIF [Parameters].[D1 (copy)_1113233589196333057] = 28 THEN [label]
ELSEIF [Parameters].[D1 (copy)_1113233589196333057] = 29 THEN STR([Calculation_1880252886088871936])
ELSEIF [Parameters].[D1 (copy)_1113233589196333057] = 30 THEN [clientname]
ELSEIF [Parameters].[D1 (copy)_1113233589196333057] = 31 THEN [page_path]
ELSEIF [Parameters].[D1 (copy)_1113233589196333057] = 32 THEN [sgmt]
ELSEIF [Parameters].[D1 (copy)_1113233589196333057] = 33 THEN [ctcphone]
ELSEIF [Parameters].[D1 (copy)_1113233589196333057] = 34 THEN [Calculation_3435894714053935109]
ELSEIF [Parameters].[D1 (copy)_1113233589196333057] = 35 THEN [ltdinoworkmedicalconditions]
ELSEIF [Parameters].[D1 (copy)_1113233589196333057] = 36 THEN [ds_qualstatus]
ELSEIF [Parameters].[D1 (copy)_1113233589196333057] = 37 THEN [ad_id]
ELSEIF [Parameters].[D1 (copy)_1113233589196333057] = 38 THEN [adset_id]
ELSEIF [Parameters].[D1 (copy)_1113233589196333057] = 39 THEN [Calculation_1113233589182521344]
ELSEIF [Parameters].[D1 (copy)_1113233589196333057] = 40 THEN [Calculation_1880252886125215747]
ELSEIF [Parameters].[D1 (copy)_1113233589196333057] = 41 THEN [SubSegment]
ELSEIF [Parameters].[D1 (copy)_1113233589196333057] = 42 THEN STR([Calculation_1133007210553765896])
ELSEIF [Parameters].[D1 (copy)_1113233589196333057] = 43 THEN [Calculation_7573084309404708864]
ELSEIF [Parameters].[D1 (copy)_1113233589196333057] = 44 THEN [Calculation_4531465651676438530]
ELSEIF [Parameters].[D1 (copy)_1113233589196333057] = 45 THEN IF LEN(STR([appearance_l30d])) < 2 AND NOT ISNULL(STR([appearance_l30d])) THEN '0' + STR([appearance_l30d]) ELSE STR([appearance_l30d]) END
ELSEIF [Parameters].[D1 (copy)_1113233589196333057] = 46 THEN IF LEN(STR([appearance_l60d])) < 2 AND NOT ISNULL(STR([appearance_l60d])) THEN '0' + STR([appearance_l60d]) ELSE STR([appearance_l60d]) END
ELSEIF [Parameters].[D1 (copy)_1113233589196333057] = 47 THEN IF LEN(STR([appearance_l90d])) < 2 AND NOT ISNULL(STR([appearance_l90d])) THEN '0' + STR([appearance_l90d]) ELSE STR([appearance_l90d]) END
ELSEIF [Parameters].[D1 (copy)_1113233589196333057] = 48 THEN [ATA Work]
ELSEIF [Parameters].[D1 (copy)_1113233589196333057] = 49 THEN [Calculation_499055157754740737]
ELSEIF [Parameters].[D1 (copy)_1113233589196333057] = 50 THEN IF LEN(STR([CIIC Appearance in L30D])) < 2 AND NOT ISNULL(STR([CIIC Appearance in L30D])) THEN '0' + STR([CIIC Appearance in L30D]) ELSE STR([CIIC Appearance in L30D]) END
ELSEIF [Parameters].[D1 (copy)_1113233589196333057] = 51 THEN IF LEN(STR([CIIC Appearance in L60D])) < 2 AND NOT ISNULL(STR([CIIC Appearance in L60D])) THEN '0' + STR([CIIC Appearance in L60D]) ELSE STR([CIIC Appearance in L60D]) END
ELSEIF [Parameters].[D1 (copy)_1113233589196333057] = 52 THEN IF LEN(STR([CIIC Appearance in L90D])) < 2 AND NOT ISNULL(STR([CIIC Appearance in L90D])) THEN '0' + STR([CIIC Appearance in L90D]) ELSE STR([CIIC Appearance in L90D]) END
ELSEIF [Parameters].[D1 (copy)_1113233589196333057] = 53 THEN STR([Calculation_989947527401095169])
ELSEIF [Parameters].[D1 (copy)_1113233589196333057] = 54 THEN [Calculation_1460573688699854848]
ELSEIF [Parameters].[D1 (copy)_1113233589196333057] = 55 THEN [Calculation_1006061976934187009]
ELSE 'Agg'
END",
    "name": "[D3 (copy)_6208563937532035081]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "D5",
    "datatype": "string",
    "formula": "IF [Parameters].[D1 (copy) (copy)_1113233589196361730] = 1 THEN [Calculation_6374000853566275585]
ELSEIF [Parameters].[D1 (copy) (copy)_1113233589196361730] = 2 THEN [bla_carrierdata_type]
ELSEIF [Parameters].[D1 (copy) (copy)_1113233589196361730] = 3 THEN [Calculation_6374000853565702144]
ELSEIF [Parameters].[D1 (copy) (copy)_1113233589196361730] = 4 THEN [Phone Carrier]
ELSEIF [Parameters].[D1 (copy) (copy)_1113233589196361730] = 5 THEN [CZ Project Name]
ELSEIF [Parameters].[D1 (copy) (copy)_1113233589196361730] = 6 THEN [Phone Type]
ELSEIF [Parameters].[D1 (copy) (copy)_1113233589196361730] = 7 THEN [normalized carrier]
ELSEIF [Parameters].[D1 (copy) (copy)_1113233589196361730] = 8 THEN [Outcome]
ELSEIF [Parameters].[D1 (copy) (copy)_1113233589196361730] = 9 THEN [qual_status]
ELSEIF [Parameters].[D1 (copy) (copy)_1113233589196361730] = 10 THEN [Source]
ELSEIF [Parameters].[D1 (copy) (copy)_1113233589196361730] = 11 THEN [Sub Id]
ELSEIF [Parameters].[D1 (copy) (copy)_1113233589196361730] = 12 THEN [gender (copy)_2399292755830108162]
ELSEIF [Parameters].[D1 (copy) (copy)_1113233589196361730] = 13 THEN [Creative]
ELSEIF [Parameters].[D1 (copy) (copy)_1113233589196361730] = 14 THEN [CL Diagnosis Injury Tiers]
ELSEIF [Parameters].[D1 (copy) (copy)_1113233589196361730] = 15 THEN [Calculation_935059914517495808]
ELSEIF [Parameters].[D1 (copy) (copy)_1113233589196361730] = 16 THEN [Ad Name]
ELSEIF [Parameters].[D1 (copy) (copy)_1113233589196361730] = 17 THEN [Adset Name]
ELSEIF [Parameters].[D1 (copy) (copy)_1113233589196361730] = 18 THEN [campaign_id]
ELSEIF [Parameters].[D1 (copy) (copy)_1113233589196361730] = 19 THEN [Labels]
ELSEIF [Parameters].[D1 (copy) (copy)_1113233589196361730] = 20 THEN [Calculation_5872834692856524810]
ELSEIF [Parameters].[D1 (copy) (copy)_1113233589196361730] = 21 THEN [State]
ELSEIF [Parameters].[D1 (copy) (copy)_1113233589196361730] = 22 THEN [Phone]
// ELSEIF [Parameters].[D5] = 23 THEN [Tier]
ELSEIF [Parameters].[D1 (copy) (copy)_1113233589196361730] = 23 THEN [Calculation_1277614987429064704]
ELSEIF [Parameters].[D1 (copy) (copy)_1113233589196361730] = 25 THEN [Result Type]
ELSEIF [Parameters].[D1 (copy) (copy)_1113233589196361730] = 26 THEN [placement]
ELSEIF [Parameters].[D1 (copy) (copy)_1113233589196361730] = 27 THEN [Calculation_7690318609259716608]
ELSEIF [Parameters].[D1 (copy) (copy)_1113233589196361730] = 28 THEN [label]
ELSEIF [Parameters].[D1 (copy) (copy)_1113233589196361730] = 29 THEN STR([Calculation_1880252886088871936])
ELSEIF [Parameters].[D1 (copy) (copy)_1113233589196361730] = 30 THEN [clientname]
ELSEIF [Parameters].[D1 (copy) (copy)_1113233589196361730] = 31 THEN [page_path]
ELSEIF [Parameters].[D1 (copy) (copy)_1113233589196361730] = 32 THEN [sgmt]
ELSEIF [Parameters].[D1 (copy) (copy)_1113233589196361730] = 33 THEN [ctcphone]
ELSEIF [Parameters].[D1 (copy) (copy)_1113233589196361730] = 34 THEN [Calculation_3435894714053935109]
ELSEIF [Parameters].[D1 (copy) (copy)_1113233589196361730] = 35 THEN [ltdinoworkmedicalconditions]
ELSEIF [Parameters].[D1 (copy) (copy)_1113233589196361730] = 36 THEN [ds_qualstatus]
ELSEIF [Parameters].[D1 (copy) (copy)_1113233589196361730] = 37 THEN [ad_id]
ELSEIF [Parameters].[D1 (copy) (copy)_1113233589196361730] = 38 THEN [adset_id]
ELSEIF [Parameters].[D1 (copy) (copy)_1113233589196361730] = 39 THEN [Calculation_1113233589182521344]
ELSEIF [Parameters].[D1 (copy) (copy)_1113233589196361730] = 40 THEN [Calculation_1880252886125215747]
ELSEIF [Parameters].[D1 (copy) (copy)_1113233589196361730] = 41 THEN [SubSegment]
ELSEIF [Parameters].[D1 (copy) (copy)_1113233589196361730] = 42 THEN STR([Calculation_1133007210553765896])
ELSEIF [Parameters].[D1 (copy) (copy)_1113233589196361730] = 43 THEN [Calculation_7573084309404708864]
ELSEIF [Parameters].[D1 (copy) (copy)_1113233589196361730] = 44 THEN [Calculation_4531465651676438530]
ELSEIF [Parameters].[D1 (copy) (copy)_1113233589196361730] = 45 THEN IF LEN(STR([appearance_l30d])) < 2 AND NOT ISNULL(STR([appearance_l30d])) THEN '0' + STR([appearance_l30d]) ELSE STR([appearance_l30d]) END
ELSEIF [Parameters].[D1 (copy) (copy)_1113233589196361730] = 46 THEN IF LEN(STR([appearance_l60d])) < 2 AND NOT ISNULL(STR([appearance_l60d])) THEN '0' + STR([appearance_l60d]) ELSE STR([appearance_l60d]) END
ELSEIF [Parameters].[D1 (copy) (copy)_1113233589196361730] = 47 THEN IF LEN(STR([appearance_l90d])) < 2 AND NOT ISNULL(STR([appearance_l90d])) THEN '0' + STR([appearance_l90d]) ELSE STR([appearance_l90d]) END
ELSEIF [Parameters].[D1 (copy) (copy)_1113233589196361730] = 48 THEN [ATA Work]
ELSEIF [Parameters].[D1 (copy) (copy)_1113233589196361730] = 49 THEN [Calculation_499055157754740737]
ELSEIF [Parameters].[D1 (copy) (copy)_1113233589196361730] = 50 THEN IF LEN(STR([CIIC Appearance in L30D])) < 2 AND NOT ISNULL(STR([CIIC Appearance in L30D])) THEN '0' + STR([CIIC Appearance in L30D]) ELSE STR([CIIC Appearance in L30D]) END
ELSEIF [Parameters].[D1 (copy) (copy)_1113233589196361730] = 51 THEN IF LEN(STR([CIIC Appearance in L60D])) < 2 AND NOT ISNULL(STR([CIIC Appearance in L60D])) THEN '0' + STR([CIIC Appearance in L60D]) ELSE STR([CIIC Appearance in L60D]) END
ELSEIF [Parameters].[D1 (copy) (copy)_1113233589196361730] = 52 THEN IF LEN(STR([CIIC Appearance in L90D])) < 2 AND NOT ISNULL(STR([CIIC Appearance in L90D])) THEN '0' + STR([CIIC Appearance in L90D]) ELSE STR([CIIC Appearance in L90D]) END
ELSEIF [Parameters].[D1 (copy) (copy)_1113233589196361730] = 53 THEN STR([Calculation_989947527401095169])
ELSEIF [Parameters].[D1 (copy) (copy)_1113233589196361730] = 54 THEN [Calculation_1460573688699854848]
ELSEIF [Parameters].[D1 (copy) (copy)_1113233589196361730] = 55 THEN [Calculation_1006061976934187009]
ELSE 'Agg'
END",
    "name": "[D4 (copy)_6208563937532350475]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Gender",
    "datatype": "string",
    "formula": "//Updated Date: 18 May 2022
//Updated By: Manish
//Description: Converting gnder values to upper case

UPPER([Gender])",
    "name": "[gender (copy)_2399292755830108162]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "State Exclusions",
    "datatype": "string",
    "formula": "[State]",
    "name": "[state (copy)_2399292755821703168]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Helper Date",
    "datatype": "string",
    "formula": ""default"",
    "name": "[Parameter 11]",
    "role": "measure",
    "type": "nominal",
  },
  {
    "caption": "User Identifier",
    "datatype": "integer",
    "formula": "0",
    "name": "[Parameter 12]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Date Bucket",
    "datatype": "string",
    "formula": ""day"",
    "name": "[Parameter 1]",
    "role": "measure",
    "type": "nominal",
  },
  {
    "caption": "Start Date",
    "datatype": "date",
    "formula": "#2025-07-30#",
    "name": "[Parameter 5]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "End Date",
    "datatype": "date",
    "formula": "#2025-08-27#",
    "name": "[Parameter 6]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "TTW Grade",
    "datatype": "string",
    "formula": "IF [ttw_qualstatus] = 'ttw-qualified' then 'Grade A'
ELSEIF  [ttw_qualstatus] = 'ttw-nonqualified' and [TTW Explore Work Form] = 'yes' THEN 'Grade B'
ELSEIF [ttw_qualstatus] = 'ttw-nonqualified' and [TTW Explore Work Form] != 'yes' THEN 'Grade C'
ELSEIF ISNULL([ttw_qualstatus]) and [Stage3 Response] = 'Between 2 and 4 years' then 'Grade D'
ELSE 'Rest'
END",
    "name": "[Calculation_1006061976934187009]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Hour of Day",
    "datatype": "string",
    "formula": "IF LEN(STR(DATEPART('hour', [Calculation_1916563181826678784]))) = 1
THEN "0" + STR(DATEPART('hour', [Calculation_1916563181826678784]))
ELSE STR(DATEPART('hour', [Calculation_1916563181826678784]))
END",
    "name": "[Calculation_1113233589182521344]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "20hrs Disqual",
    "datatype": "integer",
    "formula": "IF [Stage6 Response] = "More than 20 hours per week" THEN 1 ELSE 0 END",
    "name": "[Calculation_1133007210546622464]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Age Disqual",
    "datatype": "integer",
    "formula": "IF INT([Age]) < 40 OR INT([Age]) > 62 THEN 1 ELSE 0 END",
    "name": "[Calculation_1133007210553298946]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Attorney Disqual",
    "datatype": "integer",
    "formula": "IF [Stage5 Response] = "Yes" THEN 1 ELSE 0 END",
    "name": "[Calculation_1133007210553425923]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Ben Disqual",
    "datatype": "integer",
    "formula": "IF IFNULL([Stage1 Response], "") != "I am not receiving any disability benefits (SSD or SSI)"
THEN 1 ELSE 0 END",
    "name": "[Calculation_1133007210553487364]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Doctor Visit Disqual",
    "datatype": "integer",
    "formula": "IF [Stage4 Response] = "No" THEN 1 ELSE 0 END",
    "name": "[Calculation_1133007210553540613]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Five Year Work Disqual",
    "datatype": "integer",
    "formula": "IF [Stage3 Response] = "Less than 2 years"
OR [Stage3 Response] = "Between 2 and 4 years"
THEN 1 ELSE 0 END",
    "name": "[Calculation_1133007210553618438]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Out of Work Disqual",
    "datatype": "integer",
    "formula": "IF [Stage2 Response] = "No" THEN 1 ELSE 0 END",
    "name": "[Calculation_1133007210553663495]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "# of Disqual",
    "datatype": "integer",
    "formula": "ZN([Calculation_1133007210553487364]) +
ZN([Calculation_1133007210553663495]) +
ZN([Calculation_1133007210553618438]) +
ZN([Calculation_1133007210553540613]) +
ZN([Calculation_1133007210553425923]) +
ZN([Calculation_1133007210546622464]) +
ZN([Calculation_1133007210553298946])",
    "name": "[Calculation_1133007210553765896]",
    "role": "dimension",
    "type": "ordinal",
  },
  {
    "caption": "Levine States ",
    "datatype": "string",
    "formula": "IF ISNULL([Levine States]) THEN 'Other'
ELSE [Levine States] END",
    "name": "[Calculation_1277614987429064704]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "DP Leak",
    "datatype": "string",
    "formula": "IF CONTAINS([clientname], 'disabilitypath')
AND [Calculation_7573084309404708864] in ('Grade A', 'Grade B')
THEN 'Yes'
ELSE 'No'
END",
    "name": "[Calculation_1460573688699854848]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Unresolved SSA Leads",
    "datatype": "string",
    "formula": "IF { FIXED [Phone] : MAX([Resolved Lead]) } = 0 THEN "SSA Unresolved Lead"
ELSEIF { FIXED [Phone] : MAX([Resolved Lead]) } = 1 THEN "SSA Resolved Lead"
END",
    "name": "[Calculation_1467962419029331969]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "CTC Lead Flag",
    "datatype": "string",
    "formula": "if [CTC Lead] = 1 then "Yes" else "No" END",
    "name": "[Calculation_1880252886088871936]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "CZ Post Hour Group",
    "datatype": "string",
    "formula": "IF DATEPART('hour', [Post Date]) >= 0 AND DATEPART('hour', [Post Date]) < 6 THEN 'Pre CC Hours'
ELSEIF DATEPART('hour', [Post Date]) >= 6 AND DATEPART('hour', [Post Date]) < 16 THEN 'CC Hours'
ELSEIF DATEPART('hour', [Post Date]) >= 16 AND DATEPART('hour', [Post Date]) < 24 THEN 'Post CC Hours'
END",
    "name": "[Calculation_1880252886125215747]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Post Date ",
    "datatype": "datetime",
    "formula": "//Updated Date: 18 May 2022
//Updated By: Manish
//Description: Formula to calculate UTC date

DATEADD("hour",0,[Post Date])",
    "name": "[Calculation_1916563181826678784]",
    "role": "dimension",
    "type": "ordinal",
  },
  {
    "caption": "Data Updated On",
    "datatype": "datetime",
    "formula": "{fixed :max([Post Date])}",
    "name": "[Calculation_2010857255412854784]",
    "role": "dimension",
    "type": "ordinal",
  },
  {
    "caption": "TOTAL([Posted #])",
    "datatype": "integer",
    "formula": "TOTAL([Calculation_99712551082803223])",
    "name": "[Calculation_2010857255434760195]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "{exclude [Source]:[Posted]}",
    "datatype": "integer",
    "formula": "{exclude [Source]:[Calculation_99712551082803223]}",
    "name": "[Calculation_2010857255441080325]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Lead Sell Type",
    "datatype": "string",
    "formula": "if contains([Transfer Info Label],'CXER') then 'Sold: Call' 
elseif 
contains([sgmt],'ql-leadbuy') or 
contains([ATA Work],'ql-leadbuy')
then 'Sold: Lead'
else 'Internal'
end",
    "name": "[Calculation_3435894714053935109]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Seg4 Control vs. Treatment",
    "datatype": "string",
    "formula": "IF [CZ Project Name] = "Mass Tort - High Intent SSDI" AND [Calculation_1880252886088871936] = "No" AND [qual_status] != "all-steps" THEN
    IF INT(RIGHT([phone masked], 3)) % 2 = 0 THEN "Control"
    ELSEIF INT(RIGHT([phone masked], 3)) % 2 != 0 THEN "Treatment"
    END
END",
    "name": "[Calculation_4531465651676315649]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Seg4 Cohort",
    "datatype": "string",
    "formula": "LOWER(IFNULL([seg4_cohort], [Calculation_4531465651676315649]))",
    "name": "[Calculation_4531465651676438530]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Time to Call (Minute)",
    "datatype": "real",
    "formula": "IF [Calculation_1880252886088871936] = 'Yes'
THEN ROUND(([CTC Time] - [Post Date]) * 24 * 60, 2)
END",
    "name": "[Calculation_499055157752631296]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Time to Call Bucket",
    "datatype": "string",
    "formula": "IF  [Calculation_499055157752631296] < 0
THEN '<0 Mins'
ELSEIF [Calculation_499055157752631296] <= 2 AND [Calculation_499055157752631296] >= 0
THEN '0-2 Mins'
ELSEIF [Calculation_499055157752631296] <= 5 AND [Calculation_499055157752631296] > 0
THEN '2-5 Mins'
ELSEIF [Calculation_499055157752631296] <= 10 AND [Calculation_499055157752631296] > 0
THEN '5-10 Mins'
ELSEIF [Calculation_499055157752631296] <= 30 AND [Calculation_499055157752631296] > 0 
THEN '10-30 Mins'
ELSEIF [Calculation_499055157752631296] <= 60 AND [Calculation_499055157752631296] > 0
THEN '30Mins-1 Hour'
ELSEIF [Calculation_499055157752631296] <= 300 AND [Calculation_499055157752631296] > 0
THEN '1-5 Hours'
ELSEIF [Calculation_499055157752631296] <= 600 AND [Calculation_499055157752631296] > 0
THEN '5-10 Hours'
ELSEIF [Calculation_499055157752631296] <= 1440 AND [Calculation_499055157752631296] > 0
THEN '10-24 Hours'
ELSEIF [Calculation_499055157752631296] <= 4320 AND [Calculation_499055157752631296] > 0
THEN '24-72 Hours'
ELSEIF [Calculation_499055157752631296] > 4320 AND [Calculation_499055157752631296] > 0
THEN '>72 Hours'
END",
    "name": "[Calculation_499055157754740737]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Project Type",
    "datatype": "string",
    "formula": "IF CONTAINS([CZ Project Name],'Aged') THEN 'Aged'
ELSE 'Live' END",
    "name": "[Calculation_5872834692856524810]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Grade",
    "datatype": "string",
    "formula": "// Grade A
IF [qual_status] = 'all-steps' THEN 'Grade A'

// Grade B
ELSEIF 
    [qual_status] IN ('fiveyrwrk-disqual','outofwrk-disqual','doc-disqual')
    AND [Calculation_1133007210553765896] = 1
THEN 'Grade B'

// Grade C
ELSEIF 
    [qual_status] <> 'age-disqual'
    AND NOT [Stage3 Response] IN ('Less than 2 years', 'Between 2 and 4 years')
    AND [Stage1 Response] <> 'Social Security Disability (SSD) Benefits'
    AND [Stage6 Response] = 'Not working'
THEN 'Grade C'

// Grade D
ELSEIF 
    // 1) Not age-disqual, Stage3 NOT in those two, Stage1 not SSD, Stage6 ≠ Not working, disqual ≤ 1
    (
      [qual_status] <> 'age-disqual'
      AND NOT [Stage3 Response] IN ('Less than 2 years', 'Between 2 and 4 years')
      AND [Stage1 Response] <> 'Social Security Disability (SSD) Benefits'
      AND [Stage6 Response] <> 'Not working'
      AND [Calculation_1133007210553765896] <= 1
    )
    // 2) Not age-disqual, Stage3 in those two, Qual Status = outofwrk-disqual
    OR
    (
      [qual_status] <> 'age-disqual'
      AND [Stage3 Response] IN ('Less than 2 years', 'Between 2 and 4 years')
      AND [qual_status] = 'outofwrk-disqual'
    )
    // 3) Not age-disqual, Stage3 in those two, Qual Status ≠ outofwrk-disqual, Stage7 = Yes
    OR
    (
      [qual_status] <> 'age-disqual'
      AND [Stage3 Response] IN ('Less than 2 years', 'Between 2 and 4 years')
      AND [qual_status] <> 'outofwrk-disqual'
      AND [Stage7 Response] = 'Yes'
    )
THEN 'Grade D'

// Rest (including age-disqual or anything else)
ELSE 'Rest'
END",
    "name": "[Calculation_7573084309404708864]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Today-28",
    "datatype": "date",
    "formula": "//Updated Date: 18 May 2022
//Updated By: Manish
//Description: Going back 28 days from today

({MAX(today()-28)})",
    "name": "[Calculation_767300790172184597]",
    "role": "dimension",
    "type": "ordinal",
  },
  {
    "caption": "SSD Age Range",
    "datatype": "string",
    "formula": "IF DATE([Calculation_1916563181826678784]) >= #18/08/2025#
THEN
    IF INT([Age]) < 40 THEN "U40"
    ELSEIF INT([Age]) >= 40 AND INT([Age]) <= 49 THEN "40 - 49"
	ELSEIF INT([Age]) >= 50 AND INT([Age]) <= 54 THEN "50 - 54"
    ELSEIF INT([Age]) >= 55 AND INT([Age]) <= 63 THEN "55 - 63"
    ELSEIF INT([Age]) >= 64 THEN "O64+"
    END
ELSEIF INT([Age]) < 40 THEN "*U40"
ELSEIF INT([Age]) >= 40 AND INT([Age]) <= 48 THEN "*40-48"
ELSEIF INT([Age]) = 49 THEN "*49"
ELSEIF INT([Age]) >= 50 AND INT([Age]) <= 62 THEN "*50-62"
ELSEIF INT([Age]) >= 63 THEN "*O63+" 
END",
    "name": "[Calculation_7690318609259716608]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Date Filter",
    "datatype": "boolean",
    "formula": "//Updated Date: 18 May 2022
//Updated By: Manish
//Description: Filtering data based on date

IF [Parameters].[Parameter 11] = 'default'
THEN [Date]>=[Parameters].[Parameter 5] AND [Date]<=[Parameters].[Parameter 6]
ELSEIF [Parameters].[Parameter 11] = 'weekly'
THEN [Date] >= TODAY()-8 AND [Date] <= TODAY()-1
END",
    "name": "[Calculation_843580506575679492]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Dial R",
    "datatype": "string",
    "formula": "IF  [Called Count] < 4 then "<=3" 
elseif [Called Count] < 8 then "4-7"
elseif [Called Count] < 11 then "8-10"
elseif [Called Count] < 16 then "11-15"
elseif [Called Count] < 20 then "16-19"
elseif [Called Count] < 26 then "20-25"
elseif [Called Count] < 31 then "25-30"
elseif [Called Count] < 36 then "30-35"
else "35+" 
END",
    "name": "[Calculation_847802666706034688]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Dial R (detail)",
    "datatype": "string",
    "formula": "STR([Called Count])",
    "name": "[Calculation_847802666706186241]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Max Date",
    "datatype": "date",
    "formula": "//Updated Date: 18 May 2022
//Updated By: Manish
//Description: Calculating max of todays date for including it in the default values of end date

{MAX(today())}",
    "name": "[Calculation_882424053213511680]",
    "role": "dimension",
    "type": "ordinal",
  },
  {
    "caption": "User Identifier",
    "datatype": "string",
    "formula": "IF [Parameters].[Parameter 12] = 0 THEN [User Id]
ELSEIF [Parameters].[Parameter 12] = 1 THEN [Phone]
END",
    "name": "[Calculation_906349454594166784]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Alt. Branding",
    "datatype": "string",
    "formula": "If int(Right([Phone],2))<30 and [Calculation_5872834692856524810]= 'Live' then 'Yes' else 'No' End",
    "name": "[Calculation_935059914517495808]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Duplicate Rejects",
    "datatype": "string",
    "formula": "if [Outcome]='rejected' and { FIXED [Phone], [Outcome]: COUNTD([User Id])}>1 then 'Yes' else 'No' end",
    "name": "[Calculation_943222690415542272]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Post Date  ",
    "datatype": "string",
    "formula": "//Updated Date: 18 May 2022
//Updated By: Manish
//Description: Calculation to apply date bucket

CASE [Parameters].[Parameter 1]
WHEN 'year' THEN str(datepart('year', [Calculation_1916563181826678784]))
WHEN 'quarter' THEN "Q" + str(datepart('quarter', [Calculation_1916563181826678784])) + " " + str(datepart('year', [Calculation_1916563181826678784]))
WHEN 'month' THEN str(datepart('month', [Calculation_1916563181826678784])) + "-" + str(datepart('year', [Calculation_1916563181826678784]))
WHEN 'day' THEN str(DATENAME('month', [Calculation_1916563181826678784]))+ "-" +str(datepart('day', [Calculation_1916563181826678784]))+ "-" + str(datepart('year', [Calculation_1916563181826678784]))
WHEN 'week' THEN "W" + str(datepart('week', [Calculation_1916563181826678784])) + "-" + str(datepart('year', [Calculation_1916563181826678784]))
WHEN "hour" THEN str(DATETRUNC('hour', [Calculation_1916563181826678784]))
WHEN "minute" THEN str(DATETRUNC('minute', [Calculation_1916563181826678784]))
END",
    "name": "[Calculation_97320012552925214]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Campaign & Date",
    "datatype": "string",
    "formula": "//Updated Date: 18 May 2022
//Updated By: Manish
//Description: Concatinating campaign and date

[CZ Project Name]+":"+[Calculation_97320012552925214]",
    "name": "[Calculation_97320012555808806]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Posted Cum %",
    "datatype": "real",
    "formula": "//Updated Date: 18 May 2022
//Updated By: Manish
//Description: Calculating the cumulative % of posted

RUNNING_SUM([Calculation_99712551082803223])/TOTAL([Calculation_99712551082803223])",
    "name": "[Calculation_97320012556873768]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Vici Post Delay (Days)",
    "datatype": "integer",
    "formula": "DATEDIFF('day', [Post Date], [Entry Time])",
    "name": "[Calculation_989947527401095169]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Posted #",
    "datatype": "integer",
    "formula": "//Updated Date: 18 May 2022
//Updated By: Manish
//Description: Calculating the sum of user id wrt to source

countd([Calculation_906349454594166784])",
    "name": "[Calculation_99712551082803223]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "State Exclusions",
    "datatype": "string",
    "formula": "[State]",
    "name": "[state (copy)_2399292755821703168]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Helper Date",
    "datatype": "string",
    "formula": ""default"",
    "name": "[Parameter 11]",
    "role": "measure",
    "type": "nominal",
  },
  {
    "caption": "Start Date",
    "datatype": "date",
    "formula": "#2025-07-30#",
    "name": "[Parameter 5]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "End Date",
    "datatype": "date",
    "formula": "#2025-08-27#",
    "name": "[Parameter 6]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Show Source",
    "datatype": "string",
    "formula": ""1"",
    "name": "[Phone (copy)_1255659924007981058]",
    "role": "measure",
    "type": "nominal",
  },
  {
    "caption": "TTW Grade",
    "datatype": "string",
    "formula": "IF [ttw_qualstatus] = 'ttw-qualified' then 'Grade A'
ELSEIF  [ttw_qualstatus] = 'ttw-nonqualified' and [TTW Explore Work Form] = 'yes' THEN 'Grade B'
ELSEIF [ttw_qualstatus] = 'ttw-nonqualified' and [TTW Explore Work Form] != 'yes' THEN 'Grade C'
ELSEIF ISNULL([ttw_qualstatus]) and [Stage3 Response] = 'Between 2 and 4 years' then 'Grade D'
ELSE 'Rest'
END",
    "name": "[Calculation_1006061976934187009]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Hour of Day",
    "datatype": "string",
    "formula": "IF LEN(STR(DATEPART('hour', [Calculation_1916563181826678784]))) = 1
THEN "0" + STR(DATEPART('hour', [Calculation_1916563181826678784]))
ELSE STR(DATEPART('hour', [Calculation_1916563181826678784]))
END",
    "name": "[Calculation_1113233589182521344]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "20hrs Disqual",
    "datatype": "integer",
    "formula": "IF [Stage6 Response] = "More than 20 hours per week" THEN 1 ELSE 0 END",
    "name": "[Calculation_1133007210546622464]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Age Disqual",
    "datatype": "integer",
    "formula": "IF INT([Age]) < 40 OR INT([Age]) > 62 THEN 1 ELSE 0 END",
    "name": "[Calculation_1133007210553298946]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Attorney Disqual",
    "datatype": "integer",
    "formula": "IF [Stage5 Response] = "Yes" THEN 1 ELSE 0 END",
    "name": "[Calculation_1133007210553425923]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Ben Disqual",
    "datatype": "integer",
    "formula": "IF IFNULL([Stage1 Response], "") != "I am not receiving any disability benefits (SSD or SSI)"
THEN 1 ELSE 0 END",
    "name": "[Calculation_1133007210553487364]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Doctor Visit Disqual",
    "datatype": "integer",
    "formula": "IF [Stage4 Response] = "No" THEN 1 ELSE 0 END",
    "name": "[Calculation_1133007210553540613]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Five Year Work Disqual",
    "datatype": "integer",
    "formula": "IF [Stage3 Response] = "Less than 2 years"
OR [Stage3 Response] = "Between 2 and 4 years"
THEN 1 ELSE 0 END",
    "name": "[Calculation_1133007210553618438]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Out of Work Disqual",
    "datatype": "integer",
    "formula": "IF [Stage2 Response] = "No" THEN 1 ELSE 0 END",
    "name": "[Calculation_1133007210553663495]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "# of Disqual",
    "datatype": "integer",
    "formula": "ZN([Calculation_1133007210553487364]) +
ZN([Calculation_1133007210553663495]) +
ZN([Calculation_1133007210553618438]) +
ZN([Calculation_1133007210553540613]) +
ZN([Calculation_1133007210553425923]) +
ZN([Calculation_1133007210546622464]) +
ZN([Calculation_1133007210553298946])",
    "name": "[Calculation_1133007210553765896]",
    "role": "dimension",
    "type": "ordinal",
  },
  {
    "caption": "Row #",
    "datatype": "integer",
    "formula": "size()",
    "name": "[Calculation_1147573533293101059]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Levine States ",
    "datatype": "string",
    "formula": "IF ISNULL([Levine States]) THEN 'Other'
ELSE [Levine States] END",
    "name": "[Calculation_1277614987429064704]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "LD Combination",
    "datatype": "string",
    "formula": "IFNULL(STR([Post Date]), '')+
IFNULL([Project Id],'')+
IFNULL([Phone],'')",
    "name": "[Calculation_1341228293763407875]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "DP Leak",
    "datatype": "string",
    "formula": "IF CONTAINS([clientname], 'disabilitypath')
AND [Calculation_7573084309404708864] in ('Grade A', 'Grade B')
THEN 'Yes'
ELSE 'No'
END",
    "name": "[Calculation_1460573688699854848]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Unresolved SSA Leads",
    "datatype": "string",
    "formula": "IF { FIXED [Phone] : MAX([Resolved Lead]) } = 0 THEN "SSA Unresolved Lead"
ELSEIF { FIXED [Phone] : MAX([Resolved Lead]) } = 1 THEN "SSA Resolved Lead"
END",
    "name": "[Calculation_1467962419029331969]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "CTC Lead Flag",
    "datatype": "string",
    "formula": "if [CTC Lead] = 1 then "Yes" else "No" END",
    "name": "[Calculation_1880252886088871936]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "CZ Post Hour Group",
    "datatype": "string",
    "formula": "IF DATEPART('hour', [Post Date]) >= 0 AND DATEPART('hour', [Post Date]) < 6 THEN 'Pre CC Hours'
ELSEIF DATEPART('hour', [Post Date]) >= 6 AND DATEPART('hour', [Post Date]) < 16 THEN 'CC Hours'
ELSEIF DATEPART('hour', [Post Date]) >= 16 AND DATEPART('hour', [Post Date]) < 24 THEN 'Post CC Hours'
END",
    "name": "[Calculation_1880252886125215747]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Post Date ",
    "datatype": "datetime",
    "formula": "//Updated Date: 18 May 2022
//Updated By: Manish
//Description: Formula to calculate UTC date

DATEADD("hour",0,[Post Date])",
    "name": "[Calculation_1916563181826678784]",
    "role": "dimension",
    "type": "ordinal",
  },
  {
    "caption": "Data Updated On",
    "datatype": "datetime",
    "formula": "{fixed :max([Post Date])}",
    "name": "[Calculation_2010857255412854784]",
    "role": "dimension",
    "type": "ordinal",
  },
  {
    "caption": "Masked Email",
    "datatype": "string",
    "formula": "Replace(Email,SPLIT([Email],'@',1),'******')",
    "name": "[Calculation_2902429233285222401]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Lead Sell Type",
    "datatype": "string",
    "formula": "if contains([Transfer Info Label],'CXER') then 'Sold: Call' 
elseif 
contains([sgmt],'ql-leadbuy') or 
contains([ATA Work],'ql-leadbuy')
then 'Sold: Lead'
else 'Internal'
end",
    "name": "[Calculation_3435894714053935109]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Seg4 Control vs. Treatment",
    "datatype": "string",
    "formula": "IF [CZ Project Name] = "Mass Tort - High Intent SSDI" AND [Calculation_1880252886088871936] = "No" AND [qual_status] != "all-steps" THEN
    IF INT(RIGHT([phone masked], 3)) % 2 = 0 THEN "Control"
    ELSEIF INT(RIGHT([phone masked], 3)) % 2 != 0 THEN "Treatment"
    END
END",
    "name": "[Calculation_4531465651676315649]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Seg4 Cohort",
    "datatype": "string",
    "formula": "LOWER(IFNULL([seg4_cohort], [Calculation_4531465651676315649]))",
    "name": "[Calculation_4531465651676438530]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Time to Call (Minute)",
    "datatype": "real",
    "formula": "IF [Calculation_1880252886088871936] = 'Yes'
THEN ROUND(([CTC Time] - [Post Date]) * 24 * 60, 2)
END",
    "name": "[Calculation_499055157752631296]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Time to Call Bucket",
    "datatype": "string",
    "formula": "IF  [Calculation_499055157752631296] < 0
THEN '<0 Mins'
ELSEIF [Calculation_499055157752631296] <= 2 AND [Calculation_499055157752631296] >= 0
THEN '0-2 Mins'
ELSEIF [Calculation_499055157752631296] <= 5 AND [Calculation_499055157752631296] > 0
THEN '2-5 Mins'
ELSEIF [Calculation_499055157752631296] <= 10 AND [Calculation_499055157752631296] > 0
THEN '5-10 Mins'
ELSEIF [Calculation_499055157752631296] <= 30 AND [Calculation_499055157752631296] > 0 
THEN '10-30 Mins'
ELSEIF [Calculation_499055157752631296] <= 60 AND [Calculation_499055157752631296] > 0
THEN '30Mins-1 Hour'
ELSEIF [Calculation_499055157752631296] <= 300 AND [Calculation_499055157752631296] > 0
THEN '1-5 Hours'
ELSEIF [Calculation_499055157752631296] <= 600 AND [Calculation_499055157752631296] > 0
THEN '5-10 Hours'
ELSEIF [Calculation_499055157752631296] <= 1440 AND [Calculation_499055157752631296] > 0
THEN '10-24 Hours'
ELSEIF [Calculation_499055157752631296] <= 4320 AND [Calculation_499055157752631296] > 0
THEN '24-72 Hours'
ELSEIF [Calculation_499055157752631296] > 4320 AND [Calculation_499055157752631296] > 0
THEN '>72 Hours'
END",
    "name": "[Calculation_499055157754740737]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Project Type",
    "datatype": "string",
    "formula": "IF CONTAINS([CZ Project Name],'Aged') THEN 'Aged'
ELSE 'Live' END",
    "name": "[Calculation_5872834692856524810]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Grade",
    "datatype": "string",
    "formula": "// Grade A
IF [qual_status] = 'all-steps' THEN 'Grade A'

// Grade B
ELSEIF 
    [qual_status] IN ('fiveyrwrk-disqual','outofwrk-disqual','doc-disqual')
    AND [Calculation_1133007210553765896] = 1
THEN 'Grade B'

// Grade C
ELSEIF 
    [qual_status] <> 'age-disqual'
    AND NOT [Stage3 Response] IN ('Less than 2 years', 'Between 2 and 4 years')
    AND [Stage1 Response] <> 'Social Security Disability (SSD) Benefits'
    AND [Stage6 Response] = 'Not working'
THEN 'Grade C'

// Grade D
ELSEIF 
    // 1) Not age-disqual, Stage3 NOT in those two, Stage1 not SSD, Stage6 ≠ Not working, disqual ≤ 1
    (
      [qual_status] <> 'age-disqual'
      AND NOT [Stage3 Response] IN ('Less than 2 years', 'Between 2 and 4 years')
      AND [Stage1 Response] <> 'Social Security Disability (SSD) Benefits'
      AND [Stage6 Response] <> 'Not working'
      AND [Calculation_1133007210553765896] <= 1
    )
    // 2) Not age-disqual, Stage3 in those two, Qual Status = outofwrk-disqual
    OR
    (
      [qual_status] <> 'age-disqual'
      AND [Stage3 Response] IN ('Less than 2 years', 'Between 2 and 4 years')
      AND [qual_status] = 'outofwrk-disqual'
    )
    // 3) Not age-disqual, Stage3 in those two, Qual Status ≠ outofwrk-disqual, Stage7 = Yes
    OR
    (
      [qual_status] <> 'age-disqual'
      AND [Stage3 Response] IN ('Less than 2 years', 'Between 2 and 4 years')
      AND [qual_status] <> 'outofwrk-disqual'
      AND [Stage7 Response] = 'Yes'
    )
THEN 'Grade D'

// Rest (including age-disqual or anything else)
ELSE 'Rest'
END",
    "name": "[Calculation_7573084309404708864]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Today-28",
    "datatype": "date",
    "formula": "//Updated Date: 18 May 2022
//Updated By: Manish
//Description: Going back 28 days from today

({MAX(today()-28)})",
    "name": "[Calculation_767300790172184597]",
    "role": "dimension",
    "type": "ordinal",
  },
  {
    "caption": "SSD Age Range",
    "datatype": "string",
    "formula": "IF DATE([Calculation_1916563181826678784]) >= #18/08/2025#
THEN
    IF INT([Age]) < 40 THEN "U40"
    ELSEIF INT([Age]) >= 40 AND INT([Age]) <= 49 THEN "40 - 49"
	ELSEIF INT([Age]) >= 50 AND INT([Age]) <= 54 THEN "50 - 54"
    ELSEIF INT([Age]) >= 55 AND INT([Age]) <= 63 THEN "55 - 63"
    ELSEIF INT([Age]) >= 64 THEN "O64+"
    END
ELSEIF INT([Age]) < 40 THEN "*U40"
ELSEIF INT([Age]) >= 40 AND INT([Age]) <= 48 THEN "*40-48"
ELSEIF INT([Age]) = 49 THEN "*49"
ELSEIF INT([Age]) >= 50 AND INT([Age]) <= 62 THEN "*50-62"
ELSEIF INT([Age]) >= 63 THEN "*O63+" 
END",
    "name": "[Calculation_7690318609259716608]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Date Filter",
    "datatype": "boolean",
    "formula": "//Updated Date: 18 May 2022
//Updated By: Manish
//Description: Filtering data based on date

IF [Parameters].[Parameter 11] = 'default'
THEN [Date]>=[Parameters].[Parameter 5] AND [Date]<=[Parameters].[Parameter 6]
ELSEIF [Parameters].[Parameter 11] = 'weekly'
THEN [Date] >= TODAY()-8 AND [Date] <= TODAY()-1
END",
    "name": "[Calculation_843580506575679492]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Dial R",
    "datatype": "string",
    "formula": "IF  [Called Count] < 4 then "<=3" 
elseif [Called Count] < 8 then "4-7"
elseif [Called Count] < 11 then "8-10"
elseif [Called Count] < 16 then "11-15"
elseif [Called Count] < 20 then "16-19"
elseif [Called Count] < 26 then "20-25"
elseif [Called Count] < 31 then "25-30"
elseif [Called Count] < 36 then "30-35"
else "35+" 
END",
    "name": "[Calculation_847802666706034688]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Dial R (detail)",
    "datatype": "string",
    "formula": "STR([Called Count])",
    "name": "[Calculation_847802666706186241]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Max Date",
    "datatype": "date",
    "formula": "//Updated Date: 18 May 2022
//Updated By: Manish
//Description: Calculating max of todays date for including it in the default values of end date

{MAX(today())}",
    "name": "[Calculation_882424053213511680]",
    "role": "dimension",
    "type": "ordinal",
  },
  {
    "caption": "Alt. Branding",
    "datatype": "string",
    "formula": "If int(Right([Phone],2))<30 and [Calculation_5872834692856524810]= 'Live' then 'Yes' else 'No' End",
    "name": "[Calculation_935059914517495808]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Duplicate Rejects",
    "datatype": "string",
    "formula": "if [Outcome]='rejected' and { FIXED [Phone], [Outcome]: COUNTD([User Id])}>1 then 'Yes' else 'No' end",
    "name": "[Calculation_943222690415542272]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "8th and 9th digit",
    "datatype": "string",
    "formula": "//Updated Date: 18 May 2022
//Updated By: Manish
//Description: Extracting the 7th and 8thdigit from phone column

MID(RIGHT([phone masked],3),1,2)",
    "name": "[Calculation_97320012553556001]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "TF present",
    "datatype": "integer",
    "formula": "//Updated Date: 18 May 2022
//Updated By: Manish//Description: Calculating max of todays date for including it in the default values of end date
//Description: Checking if trusted form link is present or not

If len([Trusted Form])>0 then 1
else 0
end",
    "name": "[Calculation_97320012555014180]",
    "role": "dimension",
    "type": "ordinal",
  },
  {
    "caption": "Blank",
    "datatype": "string",
    "formula": "//Updated Date: 18 May 2022
//Updated By: Manish
//Description: Blank column

""",
    "name": "[Calculation_97320012562538539]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Vici Post Delay (Days)",
    "datatype": "integer",
    "formula": "DATEDIFF('day', [Post Date], [Entry Time])",
    "name": "[Calculation_989947527401095169]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Source ",
    "datatype": "string",
    "formula": "CASE [Parameters].[Phone (copy)_1255659924007981058]
WHEN "0" THEN "Agg"
WHEN "1" THEN [Source]
END",
    "name": "[Phone (copy)_1255659924007964673]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "State Exclusions",
    "datatype": "string",
    "formula": "[State]",
    "name": "[state (copy)_2399292755821703168]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Helper Date",
    "datatype": "string",
    "formula": ""default"",
    "name": "[Parameter 11]",
    "role": "measure",
    "type": "nominal",
  },
  {
    "caption": "Start Date",
    "datatype": "date",
    "formula": "#2025-07-30#",
    "name": "[Parameter 5]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "End Date",
    "datatype": "date",
    "formula": "#2025-08-27#",
    "name": "[Parameter 6]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "TTW Grade",
    "datatype": "string",
    "formula": "IF [ttw_qualstatus] = 'ttw-qualified' then 'Grade A'
ELSEIF  [ttw_qualstatus] = 'ttw-nonqualified' and [TTW Explore Work Form] = 'yes' THEN 'Grade B'
ELSEIF [ttw_qualstatus] = 'ttw-nonqualified' and [TTW Explore Work Form] != 'yes' THEN 'Grade C'
ELSEIF ISNULL([ttw_qualstatus]) and [Stage3 Response] = 'Between 2 and 4 years' then 'Grade D'
ELSE 'Rest'
END",
    "name": "[Calculation_1006061976934187009]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Hour of Day",
    "datatype": "string",
    "formula": "IF LEN(STR(DATEPART('hour', [Calculation_1916563181826678784]))) = 1
THEN "0" + STR(DATEPART('hour', [Calculation_1916563181826678784]))
ELSE STR(DATEPART('hour', [Calculation_1916563181826678784]))
END",
    "name": "[Calculation_1113233589182521344]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "20hrs Disqual",
    "datatype": "integer",
    "formula": "IF [Stage6 Response] = "More than 20 hours per week" THEN 1 ELSE 0 END",
    "name": "[Calculation_1133007210546622464]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Age Disqual",
    "datatype": "integer",
    "formula": "IF INT([Age]) < 40 OR INT([Age]) > 62 THEN 1 ELSE 0 END",
    "name": "[Calculation_1133007210553298946]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Attorney Disqual",
    "datatype": "integer",
    "formula": "IF [Stage5 Response] = "Yes" THEN 1 ELSE 0 END",
    "name": "[Calculation_1133007210553425923]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Ben Disqual",
    "datatype": "integer",
    "formula": "IF IFNULL([Stage1 Response], "") != "I am not receiving any disability benefits (SSD or SSI)"
THEN 1 ELSE 0 END",
    "name": "[Calculation_1133007210553487364]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Doctor Visit Disqual",
    "datatype": "integer",
    "formula": "IF [Stage4 Response] = "No" THEN 1 ELSE 0 END",
    "name": "[Calculation_1133007210553540613]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Five Year Work Disqual",
    "datatype": "integer",
    "formula": "IF [Stage3 Response] = "Less than 2 years"
OR [Stage3 Response] = "Between 2 and 4 years"
THEN 1 ELSE 0 END",
    "name": "[Calculation_1133007210553618438]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Out of Work Disqual",
    "datatype": "integer",
    "formula": "IF [Stage2 Response] = "No" THEN 1 ELSE 0 END",
    "name": "[Calculation_1133007210553663495]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "# of Disqual",
    "datatype": "integer",
    "formula": "ZN([Calculation_1133007210553487364]) +
ZN([Calculation_1133007210553663495]) +
ZN([Calculation_1133007210553618438]) +
ZN([Calculation_1133007210553540613]) +
ZN([Calculation_1133007210553425923]) +
ZN([Calculation_1133007210546622464]) +
ZN([Calculation_1133007210553298946])",
    "name": "[Calculation_1133007210553765896]",
    "role": "dimension",
    "type": "ordinal",
  },
  {
    "caption": "Row #",
    "datatype": "integer",
    "formula": "size()",
    "name": "[Calculation_1147573533293101059]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Levine States ",
    "datatype": "string",
    "formula": "IF ISNULL([Levine States]) THEN 'Other'
ELSE [Levine States] END",
    "name": "[Calculation_1277614987429064704]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "LD Combination",
    "datatype": "string",
    "formula": "IFNULL(STR([Post Date]), '')+
IFNULL([Project Id],'')+
IFNULL([Phone],'')",
    "name": "[Calculation_1341228293763407875]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "DP Leak",
    "datatype": "string",
    "formula": "IF CONTAINS([clientname], 'disabilitypath')
AND [Calculation_7573084309404708864] in ('Grade A', 'Grade B')
THEN 'Yes'
ELSE 'No'
END",
    "name": "[Calculation_1460573688699854848]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Unresolved SSA Leads",
    "datatype": "string",
    "formula": "IF { FIXED [Phone] : MAX([Resolved Lead]) } = 0 THEN "SSA Unresolved Lead"
ELSEIF { FIXED [Phone] : MAX([Resolved Lead]) } = 1 THEN "SSA Resolved Lead"
END",
    "name": "[Calculation_1467962419029331969]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "CTC Lead Flag",
    "datatype": "string",
    "formula": "if [CTC Lead] = 1 then "Yes" else "No" END",
    "name": "[Calculation_1880252886088871936]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "CZ Post Hour Group",
    "datatype": "string",
    "formula": "IF DATEPART('hour', [Post Date]) >= 0 AND DATEPART('hour', [Post Date]) < 6 THEN 'Pre CC Hours'
ELSEIF DATEPART('hour', [Post Date]) >= 6 AND DATEPART('hour', [Post Date]) < 16 THEN 'CC Hours'
ELSEIF DATEPART('hour', [Post Date]) >= 16 AND DATEPART('hour', [Post Date]) < 24 THEN 'Post CC Hours'
END",
    "name": "[Calculation_1880252886125215747]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Post Date ",
    "datatype": "datetime",
    "formula": "//Updated Date: 18 May 2022
//Updated By: Manish
//Description: Formula to calculate UTC date

DATEADD("hour",0,[Post Date])",
    "name": "[Calculation_1916563181826678784]",
    "role": "dimension",
    "type": "ordinal",
  },
  {
    "caption": "Data Updated On",
    "datatype": "datetime",
    "formula": "{fixed :max([Post Date])}",
    "name": "[Calculation_2010857255412854784]",
    "role": "dimension",
    "type": "ordinal",
  },
  {
    "caption": "Lead Sell Type",
    "datatype": "string",
    "formula": "if contains([Transfer Info Label],'CXER') then 'Sold: Call' 
elseif 
contains([sgmt],'ql-leadbuy') or 
contains([ATA Work],'ql-leadbuy')
then 'Sold: Lead'
else 'Internal'
end",
    "name": "[Calculation_3435894714053935109]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Seg4 Control vs. Treatment",
    "datatype": "string",
    "formula": "IF [CZ Project Name] = "Mass Tort - High Intent SSDI" AND [Calculation_1880252886088871936] = "No" AND [qual_status] != "all-steps" THEN
    IF INT(RIGHT([phone masked], 3)) % 2 = 0 THEN "Control"
    ELSEIF INT(RIGHT([phone masked], 3)) % 2 != 0 THEN "Treatment"
    END
END",
    "name": "[Calculation_4531465651676315649]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Seg4 Cohort",
    "datatype": "string",
    "formula": "LOWER(IFNULL([seg4_cohort], [Calculation_4531465651676315649]))",
    "name": "[Calculation_4531465651676438530]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Time to Call (Minute)",
    "datatype": "real",
    "formula": "IF [Calculation_1880252886088871936] = 'Yes'
THEN ROUND(([CTC Time] - [Post Date]) * 24 * 60, 2)
END",
    "name": "[Calculation_499055157752631296]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Time to Call Bucket",
    "datatype": "string",
    "formula": "IF  [Calculation_499055157752631296] < 0
THEN '<0 Mins'
ELSEIF [Calculation_499055157752631296] <= 2 AND [Calculation_499055157752631296] >= 0
THEN '0-2 Mins'
ELSEIF [Calculation_499055157752631296] <= 5 AND [Calculation_499055157752631296] > 0
THEN '2-5 Mins'
ELSEIF [Calculation_499055157752631296] <= 10 AND [Calculation_499055157752631296] > 0
THEN '5-10 Mins'
ELSEIF [Calculation_499055157752631296] <= 30 AND [Calculation_499055157752631296] > 0 
THEN '10-30 Mins'
ELSEIF [Calculation_499055157752631296] <= 60 AND [Calculation_499055157752631296] > 0
THEN '30Mins-1 Hour'
ELSEIF [Calculation_499055157752631296] <= 300 AND [Calculation_499055157752631296] > 0
THEN '1-5 Hours'
ELSEIF [Calculation_499055157752631296] <= 600 AND [Calculation_499055157752631296] > 0
THEN '5-10 Hours'
ELSEIF [Calculation_499055157752631296] <= 1440 AND [Calculation_499055157752631296] > 0
THEN '10-24 Hours'
ELSEIF [Calculation_499055157752631296] <= 4320 AND [Calculation_499055157752631296] > 0
THEN '24-72 Hours'
ELSEIF [Calculation_499055157752631296] > 4320 AND [Calculation_499055157752631296] > 0
THEN '>72 Hours'
END",
    "name": "[Calculation_499055157754740737]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Project Type",
    "datatype": "string",
    "formula": "IF CONTAINS([CZ Project Name],'Aged') THEN 'Aged'
ELSE 'Live' END",
    "name": "[Calculation_5872834692856524810]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Grade",
    "datatype": "string",
    "formula": "// Grade A
IF [qual_status] = 'all-steps' THEN 'Grade A'

// Grade B
ELSEIF 
    [qual_status] IN ('fiveyrwrk-disqual','outofwrk-disqual','doc-disqual')
    AND [Calculation_1133007210553765896] = 1
THEN 'Grade B'

// Grade C
ELSEIF 
    [qual_status] <> 'age-disqual'
    AND NOT [Stage3 Response] IN ('Less than 2 years', 'Between 2 and 4 years')
    AND [Stage1 Response] <> 'Social Security Disability (SSD) Benefits'
    AND [Stage6 Response] = 'Not working'
THEN 'Grade C'

// Grade D
ELSEIF 
    // 1) Not age-disqual, Stage3 NOT in those two, Stage1 not SSD, Stage6 ≠ Not working, disqual ≤ 1
    (
      [qual_status] <> 'age-disqual'
      AND NOT [Stage3 Response] IN ('Less than 2 years', 'Between 2 and 4 years')
      AND [Stage1 Response] <> 'Social Security Disability (SSD) Benefits'
      AND [Stage6 Response] <> 'Not working'
      AND [Calculation_1133007210553765896] <= 1
    )
    // 2) Not age-disqual, Stage3 in those two, Qual Status = outofwrk-disqual
    OR
    (
      [qual_status] <> 'age-disqual'
      AND [Stage3 Response] IN ('Less than 2 years', 'Between 2 and 4 years')
      AND [qual_status] = 'outofwrk-disqual'
    )
    // 3) Not age-disqual, Stage3 in those two, Qual Status ≠ outofwrk-disqual, Stage7 = Yes
    OR
    (
      [qual_status] <> 'age-disqual'
      AND [Stage3 Response] IN ('Less than 2 years', 'Between 2 and 4 years')
      AND [qual_status] <> 'outofwrk-disqual'
      AND [Stage7 Response] = 'Yes'
    )
THEN 'Grade D'

// Rest (including age-disqual or anything else)
ELSE 'Rest'
END",
    "name": "[Calculation_7573084309404708864]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Today-28",
    "datatype": "date",
    "formula": "//Updated Date: 18 May 2022
//Updated By: Manish
//Description: Going back 28 days from today

({MAX(today()-28)})",
    "name": "[Calculation_767300790172184597]",
    "role": "dimension",
    "type": "ordinal",
  },
  {
    "caption": "SSD Age Range",
    "datatype": "string",
    "formula": "IF DATE([Calculation_1916563181826678784]) >= #18/08/2025#
THEN
    IF INT([Age]) < 40 THEN "U40"
    ELSEIF INT([Age]) >= 40 AND INT([Age]) <= 49 THEN "40 - 49"
	ELSEIF INT([Age]) >= 50 AND INT([Age]) <= 54 THEN "50 - 54"
    ELSEIF INT([Age]) >= 55 AND INT([Age]) <= 63 THEN "55 - 63"
    ELSEIF INT([Age]) >= 64 THEN "O64+"
    END
ELSEIF INT([Age]) < 40 THEN "*U40"
ELSEIF INT([Age]) >= 40 AND INT([Age]) <= 48 THEN "*40-48"
ELSEIF INT([Age]) = 49 THEN "*49"
ELSEIF INT([Age]) >= 50 AND INT([Age]) <= 62 THEN "*50-62"
ELSEIF INT([Age]) >= 63 THEN "*O63+" 
END",
    "name": "[Calculation_7690318609259716608]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Date Filter",
    "datatype": "boolean",
    "formula": "//Updated Date: 18 May 2022
//Updated By: Manish
//Description: Filtering data based on date

IF [Parameters].[Parameter 11] = 'default'
THEN [Date]>=[Parameters].[Parameter 5] AND [Date]<=[Parameters].[Parameter 6]
ELSEIF [Parameters].[Parameter 11] = 'weekly'
THEN [Date] >= TODAY()-8 AND [Date] <= TODAY()-1
END",
    "name": "[Calculation_843580506575679492]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Dial R",
    "datatype": "string",
    "formula": "IF  [Called Count] < 4 then "<=3" 
elseif [Called Count] < 8 then "4-7"
elseif [Called Count] < 11 then "8-10"
elseif [Called Count] < 16 then "11-15"
elseif [Called Count] < 20 then "16-19"
elseif [Called Count] < 26 then "20-25"
elseif [Called Count] < 31 then "25-30"
elseif [Called Count] < 36 then "30-35"
else "35+" 
END",
    "name": "[Calculation_847802666706034688]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Dial R (detail)",
    "datatype": "string",
    "formula": "STR([Called Count])",
    "name": "[Calculation_847802666706186241]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Max Date",
    "datatype": "date",
    "formula": "//Updated Date: 18 May 2022
//Updated By: Manish
//Description: Calculating max of todays date for including it in the default values of end date

{MAX(today())}",
    "name": "[Calculation_882424053213511680]",
    "role": "dimension",
    "type": "ordinal",
  },
  {
    "caption": "Alt. Branding",
    "datatype": "string",
    "formula": "If int(Right([Phone],2))<30 and [Calculation_5872834692856524810]= 'Live' then 'Yes' else 'No' End",
    "name": "[Calculation_935059914517495808]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Duplicate Rejects",
    "datatype": "string",
    "formula": "if [Outcome]='rejected' and { FIXED [Phone], [Outcome]: COUNTD([User Id])}>1 then 'Yes' else 'No' end",
    "name": "[Calculation_943222690415542272]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Blank",
    "datatype": "string",
    "formula": "//Updated Date: 18 May 2022
//Updated By: Manish
//Description: Blank column

""",
    "name": "[Calculation_97320012562538539]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Vici Post Delay (Days)",
    "datatype": "integer",
    "formula": "DATEDIFF('day', [Post Date], [Entry Time])",
    "name": "[Calculation_989947527401095169]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "State Exclusions",
    "datatype": "string",
    "formula": "[State]",
    "name": "[state (copy)_2399292755821703168]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "User Identifier",
    "datatype": "integer",
    "formula": "0",
    "name": "[Parameter 12]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "TTW Grade",
    "datatype": "string",
    "formula": "IF [ttw_qualstatus] = 'ttw-qualified' then 'Grade A'
ELSEIF  [ttw_qualstatus] = 'ttw-nonqualified' and [TTW Explore Work Form] = 'yes' THEN 'Grade B'
ELSEIF [ttw_qualstatus] = 'ttw-nonqualified' and [TTW Explore Work Form] != 'yes' THEN 'Grade C'
ELSEIF ISNULL([ttw_qualstatus]) and [Stage3 Response] = 'Between 2 and 4 years' then 'Grade D'
ELSE 'Rest'
END",
    "name": "[Calculation_1006061976934187009]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "20hrs Disqual",
    "datatype": "integer",
    "formula": "IF [Stage6 Response] = "More than 20 hours per week" THEN 1 ELSE 0 END",
    "name": "[Calculation_1133007210546622464]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Age Disqual",
    "datatype": "integer",
    "formula": "IF INT([Age]) < 40 OR INT([Age]) > 62 THEN 1 ELSE 0 END",
    "name": "[Calculation_1133007210553298946]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Attorney Disqual",
    "datatype": "integer",
    "formula": "IF [Stage5 Response] = "Yes" THEN 1 ELSE 0 END",
    "name": "[Calculation_1133007210553425923]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Ben Disqual",
    "datatype": "integer",
    "formula": "IF IFNULL([Stage1 Response], "") != "I am not receiving any disability benefits (SSD or SSI)"
THEN 1 ELSE 0 END",
    "name": "[Calculation_1133007210553487364]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Doctor Visit Disqual",
    "datatype": "integer",
    "formula": "IF [Stage4 Response] = "No" THEN 1 ELSE 0 END",
    "name": "[Calculation_1133007210553540613]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Five Year Work Disqual",
    "datatype": "integer",
    "formula": "IF [Stage3 Response] = "Less than 2 years"
OR [Stage3 Response] = "Between 2 and 4 years"
THEN 1 ELSE 0 END",
    "name": "[Calculation_1133007210553618438]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Out of Work Disqual",
    "datatype": "integer",
    "formula": "IF [Stage2 Response] = "No" THEN 1 ELSE 0 END",
    "name": "[Calculation_1133007210553663495]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "# of Disqual",
    "datatype": "integer",
    "formula": "ZN([Calculation_1133007210553487364]) +
ZN([Calculation_1133007210553663495]) +
ZN([Calculation_1133007210553618438]) +
ZN([Calculation_1133007210553540613]) +
ZN([Calculation_1133007210553425923]) +
ZN([Calculation_1133007210546622464]) +
ZN([Calculation_1133007210553298946])",
    "name": "[Calculation_1133007210553765896]",
    "role": "dimension",
    "type": "ordinal",
  },
  {
    "caption": "Date Filter Last 3 Days",
    "datatype": "boolean",
    "formula": "IF DATE([Post Date])>= TODAY()-3 AND DATE([Post Date])< TODAY() THEN TRUE ELSE FALSE END",
    "name": "[Calculation_1141381032181731330]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Unresolved SSA Leads",
    "datatype": "string",
    "formula": "IF { FIXED [Phone] : MAX([Resolved Lead]) } = 0 THEN "SSA Unresolved Lead"
ELSEIF { FIXED [Phone] : MAX([Resolved Lead]) } = 1 THEN "SSA Resolved Lead"
END",
    "name": "[Calculation_1467962419029331969]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Lead Count Color ",
    "datatype": "string",
    "formula": "IF DATE([Post Date]) = today()-1 THEN
    IF {Fixed [Campaign & Date (copy)_1141381032179245056]: [Calculation_585749428084588551]}<={Fixed [Campaign & Date (copy)_1141381032179245056]: [Today Lead Count (copy)_585749428086071304]} 
    //AND {Fixed [Campaign & Source]: [Today-2 Lead Count]}>=20
    THEN 'Red'
    ELSE 'Green' END
ELSE 'Grey'
END",
    "name": "[Calculation_585749428081770502]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Today Lead Count",
    "datatype": "integer",
    "formula": "COUNTD(IF DATE([Post Date])= today()-1 then [User Id]  END)",
    "name": "[Calculation_585749428084588551]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Grade",
    "datatype": "string",
    "formula": "// Grade A
IF [qual_status] = 'all-steps' THEN 'Grade A'

// Grade B
ELSEIF 
    [qual_status] IN ('fiveyrwrk-disqual','outofwrk-disqual','doc-disqual')
    AND [Calculation_1133007210553765896] = 1
THEN 'Grade B'

// Grade C
ELSEIF 
    [qual_status] <> 'age-disqual'
    AND NOT [Stage3 Response] IN ('Less than 2 years', 'Between 2 and 4 years')
    AND [Stage1 Response] <> 'Social Security Disability (SSD) Benefits'
    AND [Stage6 Response] = 'Not working'
THEN 'Grade C'

// Grade D
ELSEIF 
    // 1) Not age-disqual, Stage3 NOT in those two, Stage1 not SSD, Stage6 ≠ Not working, disqual ≤ 1
    (
      [qual_status] <> 'age-disqual'
      AND NOT [Stage3 Response] IN ('Less than 2 years', 'Between 2 and 4 years')
      AND [Stage1 Response] <> 'Social Security Disability (SSD) Benefits'
      AND [Stage6 Response] <> 'Not working'
      AND [Calculation_1133007210553765896] <= 1
    )
    // 2) Not age-disqual, Stage3 in those two, Qual Status = outofwrk-disqual
    OR
    (
      [qual_status] <> 'age-disqual'
      AND [Stage3 Response] IN ('Less than 2 years', 'Between 2 and 4 years')
      AND [qual_status] = 'outofwrk-disqual'
    )
    // 3) Not age-disqual, Stage3 in those two, Qual Status ≠ outofwrk-disqual, Stage7 = Yes
    OR
    (
      [qual_status] <> 'age-disqual'
      AND [Stage3 Response] IN ('Less than 2 years', 'Between 2 and 4 years')
      AND [qual_status] <> 'outofwrk-disqual'
      AND [Stage7 Response] = 'Yes'
    )
THEN 'Grade D'

// Rest (including age-disqual or anything else)
ELSE 'Rest'
END",
    "name": "[Calculation_7573084309404708864]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Dial R",
    "datatype": "string",
    "formula": "IF  [Called Count] < 4 then "<=3" 
elseif [Called Count] < 8 then "4-7"
elseif [Called Count] < 11 then "8-10"
elseif [Called Count] < 16 then "11-15"
elseif [Called Count] < 20 then "16-19"
elseif [Called Count] < 26 then "20-25"
elseif [Called Count] < 31 then "25-30"
elseif [Called Count] < 36 then "30-35"
else "35+" 
END",
    "name": "[Calculation_847802666706034688]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Dial R (detail)",
    "datatype": "string",
    "formula": "STR([Called Count])",
    "name": "[Calculation_847802666706186241]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "User Identifier",
    "datatype": "string",
    "formula": "IF [Parameters].[Parameter 12] = 0 THEN [User Id]
ELSEIF [Parameters].[Parameter 12] = 1 THEN [Phone]
END",
    "name": "[Calculation_906349454594166784]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Posted #",
    "datatype": "integer",
    "formula": "//Updated Date: 18 May 2022
//Updated By: Manish
//Description: Calculating the sum of user id wrt to source

countd([Calculation_906349454594166784])",
    "name": "[Calculation_99712551082803223]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Campaign & Source",
    "datatype": "string",
    "formula": "//Updated Date: 24 Aug 2022
//Updated By: Nithin
//Description: Concatinating campaign and Source

[CZ Project Name]+":"+[Source]",
    "name": "[Campaign & Date (copy)_1141381032179245056]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Today-1 Lead Count",
    "datatype": "integer",
    "formula": "COUNTD(IF DATE([Post Date])= today()-2 then [User Id] END)",
    "name": "[Today Lead Count (copy)_585749428086071304]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Helper Date",
    "datatype": "string",
    "formula": ""default"",
    "name": "[Parameter 11]",
    "role": "measure",
    "type": "nominal",
  },
  {
    "caption": "Start Date",
    "datatype": "date",
    "formula": "#2025-07-30#",
    "name": "[Parameter 5]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "End Date",
    "datatype": "date",
    "formula": "#2025-08-27#",
    "name": "[Parameter 6]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Show Source",
    "datatype": "string",
    "formula": ""1"",
    "name": "[Phone (copy)_1255659924007981058]",
    "role": "measure",
    "type": "nominal",
  },
  {
    "caption": "TTW Grade",
    "datatype": "string",
    "formula": "IF [ttw_qualstatus] = 'ttw-qualified' then 'Grade A'
ELSEIF  [ttw_qualstatus] = 'ttw-nonqualified' and [TTW Explore Work Form] = 'yes' THEN 'Grade B'
ELSEIF [ttw_qualstatus] = 'ttw-nonqualified' and [TTW Explore Work Form] != 'yes' THEN 'Grade C'
ELSEIF ISNULL([ttw_qualstatus]) and [Stage3 Response] = 'Between 2 and 4 years' then 'Grade D'
ELSE 'Rest'
END",
    "name": "[Calculation_1006061976934187009]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "20hrs Disqual",
    "datatype": "integer",
    "formula": "IF [Stage6 Response] = "More than 20 hours per week" THEN 1 ELSE 0 END",
    "name": "[Calculation_1133007210546622464]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Age Disqual",
    "datatype": "integer",
    "formula": "IF INT([Age]) < 40 OR INT([Age]) > 62 THEN 1 ELSE 0 END",
    "name": "[Calculation_1133007210553298946]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Attorney Disqual",
    "datatype": "integer",
    "formula": "IF [Stage5 Response] = "Yes" THEN 1 ELSE 0 END",
    "name": "[Calculation_1133007210553425923]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Ben Disqual",
    "datatype": "integer",
    "formula": "IF IFNULL([Stage1 Response], "") != "I am not receiving any disability benefits (SSD or SSI)"
THEN 1 ELSE 0 END",
    "name": "[Calculation_1133007210553487364]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Doctor Visit Disqual",
    "datatype": "integer",
    "formula": "IF [Stage4 Response] = "No" THEN 1 ELSE 0 END",
    "name": "[Calculation_1133007210553540613]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Five Year Work Disqual",
    "datatype": "integer",
    "formula": "IF [Stage3 Response] = "Less than 2 years"
OR [Stage3 Response] = "Between 2 and 4 years"
THEN 1 ELSE 0 END",
    "name": "[Calculation_1133007210553618438]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Out of Work Disqual",
    "datatype": "integer",
    "formula": "IF [Stage2 Response] = "No" THEN 1 ELSE 0 END",
    "name": "[Calculation_1133007210553663495]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "# of Disqual",
    "datatype": "integer",
    "formula": "ZN([Calculation_1133007210553487364]) +
ZN([Calculation_1133007210553663495]) +
ZN([Calculation_1133007210553618438]) +
ZN([Calculation_1133007210553540613]) +
ZN([Calculation_1133007210553425923]) +
ZN([Calculation_1133007210546622464]) +
ZN([Calculation_1133007210553298946])",
    "name": "[Calculation_1133007210553765896]",
    "role": "dimension",
    "type": "ordinal",
  },
  {
    "caption": "Unresolved SSA Leads",
    "datatype": "string",
    "formula": "IF { FIXED [Phone] : MAX([Resolved Lead]) } = 0 THEN "SSA Unresolved Lead"
ELSEIF { FIXED [Phone] : MAX([Resolved Lead]) } = 1 THEN "SSA Resolved Lead"
END",
    "name": "[Calculation_1467962419029331969]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Sample Phone 20-39",
    "datatype": "boolean",
    "formula": "int(right([Phone],2))>=20 and int(right([Phone],2))<=39
//right([Phone],2)",
    "name": "[Calculation_1773010889799946240]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Data Updated On",
    "datatype": "datetime",
    "formula": "{fixed :max([Post Date])}",
    "name": "[Calculation_2010857255412854784]",
    "role": "dimension",
    "type": "ordinal",
  },
  {
    "caption": "Masked Email",
    "datatype": "string",
    "formula": "Replace(Email,SPLIT([Email],'@',1),'******')",
    "name": "[Calculation_2902429233285222401]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Masked Address",
    "datatype": "string",
    "formula": "//Replace([Address],SPLIT([Address],' ',1),'******')
'***********' + ' ' + SPLIT([Address],' ',-1)",
    "name": "[Calculation_2902429233286373378]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Grade",
    "datatype": "string",
    "formula": "// Grade A
IF [qual_status] = 'all-steps' THEN 'Grade A'

// Grade B
ELSEIF 
    [qual_status] IN ('fiveyrwrk-disqual','outofwrk-disqual','doc-disqual')
    AND [Calculation_1133007210553765896] = 1
THEN 'Grade B'

// Grade C
ELSEIF 
    [qual_status] <> 'age-disqual'
    AND NOT [Stage3 Response] IN ('Less than 2 years', 'Between 2 and 4 years')
    AND [Stage1 Response] <> 'Social Security Disability (SSD) Benefits'
    AND [Stage6 Response] = 'Not working'
THEN 'Grade C'

// Grade D
ELSEIF 
    // 1) Not age-disqual, Stage3 NOT in those two, Stage1 not SSD, Stage6 ≠ Not working, disqual ≤ 1
    (
      [qual_status] <> 'age-disqual'
      AND NOT [Stage3 Response] IN ('Less than 2 years', 'Between 2 and 4 years')
      AND [Stage1 Response] <> 'Social Security Disability (SSD) Benefits'
      AND [Stage6 Response] <> 'Not working'
      AND [Calculation_1133007210553765896] <= 1
    )
    // 2) Not age-disqual, Stage3 in those two, Qual Status = outofwrk-disqual
    OR
    (
      [qual_status] <> 'age-disqual'
      AND [Stage3 Response] IN ('Less than 2 years', 'Between 2 and 4 years')
      AND [qual_status] = 'outofwrk-disqual'
    )
    // 3) Not age-disqual, Stage3 in those two, Qual Status ≠ outofwrk-disqual, Stage7 = Yes
    OR
    (
      [qual_status] <> 'age-disqual'
      AND [Stage3 Response] IN ('Less than 2 years', 'Between 2 and 4 years')
      AND [qual_status] <> 'outofwrk-disqual'
      AND [Stage7 Response] = 'Yes'
    )
THEN 'Grade D'

// Rest (including age-disqual or anything else)
ELSE 'Rest'
END",
    "name": "[Calculation_7573084309404708864]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Today-28",
    "datatype": "date",
    "formula": "//Updated Date: 18 May 2022
//Updated By: Manish
//Description: Going back 28 days from today

({MAX(today()-28)})",
    "name": "[Calculation_767300790172184597]",
    "role": "dimension",
    "type": "ordinal",
  },
  {
    "caption": "Date Filter",
    "datatype": "boolean",
    "formula": "//Updated Date: 18 May 2022
//Updated By: Manish
//Description: Filtering data based on date

IF [Parameters].[Parameter 11] = 'default'
THEN [Date]>=[Parameters].[Parameter 5] AND [Date]<=[Parameters].[Parameter 6]
ELSEIF [Parameters].[Parameter 11] = 'weekly'
THEN [Date] >= TODAY()-8 AND [Date] <= TODAY()-1
END",
    "name": "[Calculation_843580506575679492]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Dial R",
    "datatype": "string",
    "formula": "IF  [Called Count] < 4 then "<=3" 
elseif [Called Count] < 8 then "4-7"
elseif [Called Count] < 11 then "8-10"
elseif [Called Count] < 16 then "11-15"
elseif [Called Count] < 20 then "16-19"
elseif [Called Count] < 26 then "20-25"
elseif [Called Count] < 31 then "25-30"
elseif [Called Count] < 36 then "30-35"
else "35+" 
END",
    "name": "[Calculation_847802666706034688]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Dial R (detail)",
    "datatype": "string",
    "formula": "STR([Called Count])",
    "name": "[Calculation_847802666706186241]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Max Date",
    "datatype": "date",
    "formula": "//Updated Date: 18 May 2022
//Updated By: Manish
//Description: Calculating max of todays date for including it in the default values of end date

{MAX(today())}",
    "name": "[Calculation_882424053213511680]",
    "role": "dimension",
    "type": "ordinal",
  },
  {
    "caption": "Row Id",
    "datatype": "integer",
    "formula": "INDEX()",
    "name": "[Calculation_97320012553666594]",
    "role": "measure",
    "type": "ordinal",
  },
  {
    "caption": "TF present",
    "datatype": "integer",
    "formula": "//Updated Date: 18 May 2022
//Updated By: Manish//Description: Calculating max of todays date for including it in the default values of end date
//Description: Checking if trusted form link is present or not

If len([Trusted Form])>0 then 1
else 0
end",
    "name": "[Calculation_97320012555014180]",
    "role": "dimension",
    "type": "ordinal",
  },
  {
    "caption": "TF URL Valid",
    "datatype": "integer",
    "formula": "//Updated Date: 18 May 2022
//Updated By: Manish
//Description: Checking if the tf link is valid or not

if MID([Trusted Form],1,29)='https://cert.trustedform.com/'
AND len([Trusted Form])>29 then 1
else 0
end",
    "name": "[Calculation_97320012555231269]",
    "role": "dimension",
    "type": "ordinal",
  },
  {
    "caption": "Blank",
    "datatype": "string",
    "formula": "//Updated Date: 18 May 2022
//Updated By: Manish
//Description: Blank column

""",
    "name": "[Calculation_97320012562538539]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Source ",
    "datatype": "string",
    "formula": "CASE [Parameters].[Phone (copy)_1255659924007981058]
WHEN "0" THEN "Agg"
WHEN "1" THEN [Source]
END",
    "name": "[Phone (copy)_1255659924007964673]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Start Date",
    "datatype": "date",
    "formula": "#2025-07-30#",
    "name": "[Parameter 5]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "End Date",
    "datatype": "date",
    "formula": "#2025-08-27#",
    "name": "[Parameter 6]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "TTW Grade",
    "datatype": "string",
    "formula": "IF [ttw_qualstatus] = 'ttw-qualified' then 'Grade A'
ELSEIF  [ttw_qualstatus] = 'ttw-nonqualified' and [TTW Explore Work Form] = 'yes' THEN 'Grade B'
ELSEIF [ttw_qualstatus] = 'ttw-nonqualified' and [TTW Explore Work Form] != 'yes' THEN 'Grade C'
ELSEIF ISNULL([ttw_qualstatus]) and [Stage3 Response] = 'Between 2 and 4 years' then 'Grade D'
ELSE 'Rest'
END",
    "name": "[Calculation_1006061976934187009]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "20hrs Disqual",
    "datatype": "integer",
    "formula": "IF [Stage6 Response] = "More than 20 hours per week" THEN 1 ELSE 0 END",
    "name": "[Calculation_1133007210546622464]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Age Disqual",
    "datatype": "integer",
    "formula": "IF INT([Age]) < 40 OR INT([Age]) > 62 THEN 1 ELSE 0 END",
    "name": "[Calculation_1133007210553298946]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Attorney Disqual",
    "datatype": "integer",
    "formula": "IF [Stage5 Response] = "Yes" THEN 1 ELSE 0 END",
    "name": "[Calculation_1133007210553425923]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Ben Disqual",
    "datatype": "integer",
    "formula": "IF IFNULL([Stage1 Response], "") != "I am not receiving any disability benefits (SSD or SSI)"
THEN 1 ELSE 0 END",
    "name": "[Calculation_1133007210553487364]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Doctor Visit Disqual",
    "datatype": "integer",
    "formula": "IF [Stage4 Response] = "No" THEN 1 ELSE 0 END",
    "name": "[Calculation_1133007210553540613]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Five Year Work Disqual",
    "datatype": "integer",
    "formula": "IF [Stage3 Response] = "Less than 2 years"
OR [Stage3 Response] = "Between 2 and 4 years"
THEN 1 ELSE 0 END",
    "name": "[Calculation_1133007210553618438]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Out of Work Disqual",
    "datatype": "integer",
    "formula": "IF [Stage2 Response] = "No" THEN 1 ELSE 0 END",
    "name": "[Calculation_1133007210553663495]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "# of Disqual",
    "datatype": "integer",
    "formula": "ZN([Calculation_1133007210553487364]) +
ZN([Calculation_1133007210553663495]) +
ZN([Calculation_1133007210553618438]) +
ZN([Calculation_1133007210553540613]) +
ZN([Calculation_1133007210553425923]) +
ZN([Calculation_1133007210546622464]) +
ZN([Calculation_1133007210553298946])",
    "name": "[Calculation_1133007210553765896]",
    "role": "dimension",
    "type": "ordinal",
  },
  {
    "caption": "index()",
    "datatype": "integer",
    "formula": "index()",
    "name": "[Calculation_1300414413510774786]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Unresolved SSA Leads",
    "datatype": "string",
    "formula": "IF { FIXED [Phone] : MAX([Resolved Lead]) } = 0 THEN "SSA Unresolved Lead"
ELSEIF { FIXED [Phone] : MAX([Resolved Lead]) } = 1 THEN "SSA Resolved Lead"
END",
    "name": "[Calculation_1467962419029331969]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Post Date ",
    "datatype": "datetime",
    "formula": "//Updated Date: 18 May 2022
//Updated By: Manish
//Description: Formula to calculate UTC date

DATEADD("hour",0,[Post Date])",
    "name": "[Calculation_1916563181826678784]",
    "role": "dimension",
    "type": "ordinal",
  },
  {
    "caption": "Grade",
    "datatype": "string",
    "formula": "// Grade A
IF [qual_status] = 'all-steps' THEN 'Grade A'

// Grade B
ELSEIF 
    [qual_status] IN ('fiveyrwrk-disqual','outofwrk-disqual','doc-disqual')
    AND [Calculation_1133007210553765896] = 1
THEN 'Grade B'

// Grade C
ELSEIF 
    [qual_status] <> 'age-disqual'
    AND NOT [Stage3 Response] IN ('Less than 2 years', 'Between 2 and 4 years')
    AND [Stage1 Response] <> 'Social Security Disability (SSD) Benefits'
    AND [Stage6 Response] = 'Not working'
THEN 'Grade C'

// Grade D
ELSEIF 
    // 1) Not age-disqual, Stage3 NOT in those two, Stage1 not SSD, Stage6 ≠ Not working, disqual ≤ 1
    (
      [qual_status] <> 'age-disqual'
      AND NOT [Stage3 Response] IN ('Less than 2 years', 'Between 2 and 4 years')
      AND [Stage1 Response] <> 'Social Security Disability (SSD) Benefits'
      AND [Stage6 Response] <> 'Not working'
      AND [Calculation_1133007210553765896] <= 1
    )
    // 2) Not age-disqual, Stage3 in those two, Qual Status = outofwrk-disqual
    OR
    (
      [qual_status] <> 'age-disqual'
      AND [Stage3 Response] IN ('Less than 2 years', 'Between 2 and 4 years')
      AND [qual_status] = 'outofwrk-disqual'
    )
    // 3) Not age-disqual, Stage3 in those two, Qual Status ≠ outofwrk-disqual, Stage7 = Yes
    OR
    (
      [qual_status] <> 'age-disqual'
      AND [Stage3 Response] IN ('Less than 2 years', 'Between 2 and 4 years')
      AND [qual_status] <> 'outofwrk-disqual'
      AND [Stage7 Response] = 'Yes'
    )
THEN 'Grade D'

// Rest (including age-disqual or anything else)
ELSE 'Rest'
END",
    "name": "[Calculation_7573084309404708864]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Today-28",
    "datatype": "date",
    "formula": "//Updated Date: 18 May 2022
//Updated By: Manish
//Description: Going back 28 days from today

({MAX(today()-28)})",
    "name": "[Calculation_767300790172184597]",
    "role": "dimension",
    "type": "ordinal",
  },
  {
    "caption": "Start Time",
    "datatype": "date",
    "formula": "//DATEADD('hour',0,DATEPARSE('MMM dd, yyyy hh:mm:ss',TRIM(SPLIT([LED].[Start Time],' UTC',1))))
DATE([Calculation_1916563181826678784])",
    "name": "[Calculation_767300790176440343]",
    "role": "dimension",
    "type": "ordinal",
  },
  {
    "caption": "Phone (w/o area code)",
    "datatype": "string",
    "formula": "//Updated Date: 18 May 2022
//Updated By: Manish
//Description: Removing the area code from phone numbers

MID([Phone],4)",
    "name": "[Calculation_8176144444085837826]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Dial R",
    "datatype": "string",
    "formula": "IF  [Called Count] < 4 then "<=3" 
elseif [Called Count] < 8 then "4-7"
elseif [Called Count] < 11 then "8-10"
elseif [Called Count] < 16 then "11-15"
elseif [Called Count] < 20 then "16-19"
elseif [Called Count] < 26 then "20-25"
elseif [Called Count] < 31 then "25-30"
elseif [Called Count] < 36 then "30-35"
else "35+" 
END",
    "name": "[Calculation_847802666706034688]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Dial R (detail)",
    "datatype": "string",
    "formula": "STR([Called Count])",
    "name": "[Calculation_847802666706186241]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Max Date",
    "datatype": "date",
    "formula": "//Updated Date: 18 May 2022
//Updated By: Manish
//Description: Calculating max of todays date for including it in the default values of end date

{MAX(today())}",
    "name": "[Calculation_882424053213511680]",
    "role": "dimension",
    "type": "ordinal",
  },
  {
    "caption": "Date Filter with Post Date",
    "datatype": "boolean",
    "formula": "//Updated Date: 18 May 2022
//Updated By: Manish
//Description: Calculation to apply date filter with respect to post time

DATE([Post Date])>=[Parameters].[Parameter 5] AND DATE([Post Date])<=[Parameters].[Parameter 6]",
    "name": "[Date Filter (copy)_1300414413503598592]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "D2",
    "datatype": "integer",
    "formula": "0",
    "name": "[D1 (copy 2)_1113233589196361731]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "D3",
    "datatype": "integer",
    "formula": "0",
    "name": "[D1 (copy 3)_1113233589196374020]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "D5",
    "datatype": "integer",
    "formula": "0",
    "name": "[D1 (copy) (copy)_1113233589196361730]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "D4",
    "datatype": "integer",
    "formula": "0",
    "name": "[D1 (copy)_1113233589196333057]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "D1",
    "datatype": "integer",
    "formula": "0",
    "name": "[Parameter 10]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Helper Date",
    "datatype": "string",
    "formula": ""default"",
    "name": "[Parameter 11]",
    "role": "measure",
    "type": "nominal",
  },
  {
    "caption": "User Identifier",
    "datatype": "integer",
    "formula": "0",
    "name": "[Parameter 12]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Date Bucket",
    "datatype": "string",
    "formula": ""day"",
    "name": "[Parameter 1]",
    "role": "measure",
    "type": "nominal",
  },
  {
    "caption": "Start Date",
    "datatype": "date",
    "formula": "#2025-07-30#",
    "name": "[Parameter 5]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "End Date",
    "datatype": "date",
    "formula": "#2025-08-27#",
    "name": "[Parameter 6]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "TTW Grade",
    "datatype": "string",
    "formula": "IF [ttw_qualstatus] = 'ttw-qualified' then 'Grade A'
ELSEIF  [ttw_qualstatus] = 'ttw-nonqualified' and [TTW Explore Work Form] = 'yes' THEN 'Grade B'
ELSEIF [ttw_qualstatus] = 'ttw-nonqualified' and [TTW Explore Work Form] != 'yes' THEN 'Grade C'
ELSEIF ISNULL([ttw_qualstatus]) and [Stage3 Response] = 'Between 2 and 4 years' then 'Grade D'
ELSE 'Rest'
END",
    "name": "[Calculation_1006061976934187009]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Hour of Day",
    "datatype": "string",
    "formula": "IF LEN(STR(DATEPART('hour', [Calculation_1916563181826678784]))) = 1
THEN "0" + STR(DATEPART('hour', [Calculation_1916563181826678784]))
ELSE STR(DATEPART('hour', [Calculation_1916563181826678784]))
END",
    "name": "[Calculation_1113233589182521344]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "20hrs Disqual",
    "datatype": "integer",
    "formula": "IF [Stage6 Response] = "More than 20 hours per week" THEN 1 ELSE 0 END",
    "name": "[Calculation_1133007210546622464]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Age Disqual",
    "datatype": "integer",
    "formula": "IF INT([Age]) < 40 OR INT([Age]) > 62 THEN 1 ELSE 0 END",
    "name": "[Calculation_1133007210553298946]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Attorney Disqual",
    "datatype": "integer",
    "formula": "IF [Stage5 Response] = "Yes" THEN 1 ELSE 0 END",
    "name": "[Calculation_1133007210553425923]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Ben Disqual",
    "datatype": "integer",
    "formula": "IF IFNULL([Stage1 Response], "") != "I am not receiving any disability benefits (SSD or SSI)"
THEN 1 ELSE 0 END",
    "name": "[Calculation_1133007210553487364]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Doctor Visit Disqual",
    "datatype": "integer",
    "formula": "IF [Stage4 Response] = "No" THEN 1 ELSE 0 END",
    "name": "[Calculation_1133007210553540613]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Five Year Work Disqual",
    "datatype": "integer",
    "formula": "IF [Stage3 Response] = "Less than 2 years"
OR [Stage3 Response] = "Between 2 and 4 years"
THEN 1 ELSE 0 END",
    "name": "[Calculation_1133007210553618438]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Out of Work Disqual",
    "datatype": "integer",
    "formula": "IF [Stage2 Response] = "No" THEN 1 ELSE 0 END",
    "name": "[Calculation_1133007210553663495]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "# of Disqual",
    "datatype": "integer",
    "formula": "ZN([Calculation_1133007210553487364]) +
ZN([Calculation_1133007210553663495]) +
ZN([Calculation_1133007210553618438]) +
ZN([Calculation_1133007210553540613]) +
ZN([Calculation_1133007210553425923]) +
ZN([Calculation_1133007210546622464]) +
ZN([Calculation_1133007210553298946])",
    "name": "[Calculation_1133007210553765896]",
    "role": "dimension",
    "type": "ordinal",
  },
  {
    "caption": "Levine States ",
    "datatype": "string",
    "formula": "IF ISNULL([Levine States]) THEN 'Other'
ELSE [Levine States] END",
    "name": "[Calculation_1277614987429064704]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "DP Leak",
    "datatype": "string",
    "formula": "IF CONTAINS([clientname], 'disabilitypath')
AND [Calculation_7573084309404708864] in ('Grade A', 'Grade B')
THEN 'Yes'
ELSE 'No'
END",
    "name": "[Calculation_1460573688699854848]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Unresolved SSA Leads",
    "datatype": "string",
    "formula": "IF { FIXED [Phone] : MAX([Resolved Lead]) } = 0 THEN "SSA Unresolved Lead"
ELSEIF { FIXED [Phone] : MAX([Resolved Lead]) } = 1 THEN "SSA Resolved Lead"
END",
    "name": "[Calculation_1467962419029331969]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "CTC Lead Flag",
    "datatype": "string",
    "formula": "if [CTC Lead] = 1 then "Yes" else "No" END",
    "name": "[Calculation_1880252886088871936]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "CZ Post Hour Group",
    "datatype": "string",
    "formula": "IF DATEPART('hour', [Post Date]) >= 0 AND DATEPART('hour', [Post Date]) < 6 THEN 'Pre CC Hours'
ELSEIF DATEPART('hour', [Post Date]) >= 6 AND DATEPART('hour', [Post Date]) < 16 THEN 'CC Hours'
ELSEIF DATEPART('hour', [Post Date]) >= 16 AND DATEPART('hour', [Post Date]) < 24 THEN 'Post CC Hours'
END",
    "name": "[Calculation_1880252886125215747]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Post Date ",
    "datatype": "datetime",
    "formula": "//Updated Date: 18 May 2022
//Updated By: Manish
//Description: Formula to calculate UTC date

DATEADD("hour",0,[Post Date])",
    "name": "[Calculation_1916563181826678784]",
    "role": "dimension",
    "type": "ordinal",
  },
  {
    "caption": "PD Dimensions",
    "datatype": "string",
    "formula": "IFNULL(STR([Calculation_97320012552925214]),'')+
IFNULL([Calculation_6374000853571039236],'')+
IFNULL([D1 (copy)_6374000853573341191],'')+
IFNULL([D1 (copy) (copy)_6374000853573369864],'')+
IFNULL([D3 (copy)_6208563937532035081],'')+
IFNULL([D4 (copy)_6208563937532350475],'')",
    "name": "[Calculation_1999879738529857536]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Data Updated On",
    "datatype": "datetime",
    "formula": "{fixed :max([Post Date])}",
    "name": "[Calculation_2010857255412854784]",
    "role": "dimension",
    "type": "ordinal",
  },
  {
    "caption": "Lead Sell Type",
    "datatype": "string",
    "formula": "if contains([Transfer Info Label],'CXER') then 'Sold: Call' 
elseif 
contains([sgmt],'ql-leadbuy') or 
contains([ATA Work],'ql-leadbuy')
then 'Sold: Lead'
else 'Internal'
end",
    "name": "[Calculation_3435894714053935109]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Seg4 Control vs. Treatment",
    "datatype": "string",
    "formula": "IF [CZ Project Name] = "Mass Tort - High Intent SSDI" AND [Calculation_1880252886088871936] = "No" AND [qual_status] != "all-steps" THEN
    IF INT(RIGHT([phone masked], 3)) % 2 = 0 THEN "Control"
    ELSEIF INT(RIGHT([phone masked], 3)) % 2 != 0 THEN "Treatment"
    END
END",
    "name": "[Calculation_4531465651676315649]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Seg4 Cohort",
    "datatype": "string",
    "formula": "LOWER(IFNULL([seg4_cohort], [Calculation_4531465651676315649]))",
    "name": "[Calculation_4531465651676438530]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Posted ",
    "datatype": "string",
    "formula": "//Updated Date: 18 May 2022
//Updated By: Manish
//Description: blank column

""",
    "name": "[Calculation_4891401821043871748]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Time to Call (Minute)",
    "datatype": "real",
    "formula": "IF [Calculation_1880252886088871936] = 'Yes'
THEN ROUND(([CTC Time] - [Post Date]) * 24 * 60, 2)
END",
    "name": "[Calculation_499055157752631296]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Time to Call Bucket",
    "datatype": "string",
    "formula": "IF  [Calculation_499055157752631296] < 0
THEN '<0 Mins'
ELSEIF [Calculation_499055157752631296] <= 2 AND [Calculation_499055157752631296] >= 0
THEN '0-2 Mins'
ELSEIF [Calculation_499055157752631296] <= 5 AND [Calculation_499055157752631296] > 0
THEN '2-5 Mins'
ELSEIF [Calculation_499055157752631296] <= 10 AND [Calculation_499055157752631296] > 0
THEN '5-10 Mins'
ELSEIF [Calculation_499055157752631296] <= 30 AND [Calculation_499055157752631296] > 0 
THEN '10-30 Mins'
ELSEIF [Calculation_499055157752631296] <= 60 AND [Calculation_499055157752631296] > 0
THEN '30Mins-1 Hour'
ELSEIF [Calculation_499055157752631296] <= 300 AND [Calculation_499055157752631296] > 0
THEN '1-5 Hours'
ELSEIF [Calculation_499055157752631296] <= 600 AND [Calculation_499055157752631296] > 0
THEN '5-10 Hours'
ELSEIF [Calculation_499055157752631296] <= 1440 AND [Calculation_499055157752631296] > 0
THEN '10-24 Hours'
ELSEIF [Calculation_499055157752631296] <= 4320 AND [Calculation_499055157752631296] > 0
THEN '24-72 Hours'
ELSEIF [Calculation_499055157752631296] > 4320 AND [Calculation_499055157752631296] > 0
THEN '>72 Hours'
END",
    "name": "[Calculation_499055157754740737]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Project Type",
    "datatype": "string",
    "formula": "IF CONTAINS([CZ Project Name],'Aged') THEN 'Aged'
ELSE 'Live' END",
    "name": "[Calculation_5872834692856524810]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "BLA Status",
    "datatype": "string",
    "formula": "IF [bla_blacklisted] = 'true' THEN 'Blacklisted'
ELSEIF [bla_blacklisted] = 'false' THEN 'Passed'
ELSE NULL
END",
    "name": "[Calculation_6374000853565702144]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "BLA Code",
    "datatype": "string",
    "formula": "[bla_rejectcodes]",
    "name": "[Calculation_6374000853566275585]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "D1 ('+' to add dim)",
    "datatype": "string",
    "formula": "IF [Parameters].[Parameter 10] = 1 THEN [Calculation_6374000853566275585]
ELSEIF [Parameters].[Parameter 10] = 2 THEN [bla_carrierdata_type]
ELSEIF [Parameters].[Parameter 10] = 3 THEN [Calculation_6374000853565702144]
ELSEIF [Parameters].[Parameter 10] = 4 THEN [Phone Carrier]
ELSEIF [Parameters].[Parameter 10] = 5 THEN [CZ Project Name]
ELSEIF [Parameters].[Parameter 10] = 6 THEN [Phone Type]
ELSEIF [Parameters].[Parameter 10] = 7 THEN [normalized carrier]
ELSEIF [Parameters].[Parameter 10] = 8 THEN [Outcome]
ELSEIF [Parameters].[Parameter 10] = 9 THEN [qual_status]
ELSEIF [Parameters].[Parameter 10] = 10 THEN [Source]
ELSEIF [Parameters].[Parameter 10] = 11 THEN [Sub Id]
ELSEIF [Parameters].[Parameter 10] = 12 THEN [gender (copy)_2399292755830108162]
ELSEIF [Parameters].[Parameter 10] = 13 THEN [Creative]
ELSEIF [Parameters].[Parameter 10] = 14 THEN [CL Diagnosis Injury Tiers]
ELSEIF [Parameters].[Parameter 10] = 15 THEN [Calculation_935059914517495808]
ELSEIF [Parameters].[Parameter 10] = 16 THEN [Ad Name]
ELSEIF [Parameters].[Parameter 10] = 17 THEN [Adset Name]
ELSEIF [Parameters].[Parameter 10] = 18 THEN [campaign_id]
ELSEIF [Parameters].[Parameter 10] = 19 THEN [Labels]
ELSEIF [Parameters].[Parameter 10] = 20 THEN [Calculation_5872834692856524810]
ELSEIF [Parameters].[Parameter 10] = 21 THEN [State]
ELSEIF [Parameters].[Parameter 10] = 22 THEN [Phone]
// ELSEIF [D1] = 23 THEN [Tier]
ELSEIF [Parameters].[Parameter 10] = 23 THEN [Calculation_1277614987429064704]
ELSEIF [Parameters].[Parameter 10] = 25 THEN [Result Type]
ELSEIF [Parameters].[Parameter 10] = 26 THEN [placement]
ELSEIF [Parameters].[Parameter 10] = 27 THEN [Calculation_7690318609259716608]
ELSEIF [Parameters].[Parameter 10] = 28 THEN [label]
ELSEIF [Parameters].[Parameter 10] = 29 THEN STR([Calculation_1880252886088871936])
ELSEIF [Parameters].[Parameter 10] = 30 THEN [clientname]
ELSEIF [Parameters].[Parameter 10] = 31 THEN [page_path]
ELSEIF [Parameters].[Parameter 10] = 32 THEN [sgmt]
ELSEIF [Parameters].[Parameter 10] = 33 THEN [ctcphone]
ELSEIF [Parameters].[Parameter 10] = 34 THEN [Calculation_3435894714053935109]
ELSEIF [Parameters].[Parameter 10] = 35 THEN [ltdinoworkmedicalconditions]
ELSEIF [Parameters].[Parameter 10] = 36 THEN [ds_qualstatus]
ELSEIF [Parameters].[Parameter 10] = 37 THEN [ad_id]
ELSEIF [Parameters].[Parameter 10] = 38 THEN [adset_id]
ELSEIF [Parameters].[Parameter 10] = 39 THEN [Calculation_1113233589182521344]
ELSEIF [Parameters].[Parameter 10] = 40 THEN [Calculation_1880252886125215747]
ELSEIF [Parameters].[Parameter 10] = 41 THEN [SubSegment]
ELSEIF [Parameters].[Parameter 10] = 42 THEN STR([Calculation_1133007210553765896])
ELSEIF [Parameters].[Parameter 10] = 43 THEN [Calculation_7573084309404708864]
ELSEIF [Parameters].[Parameter 10] = 44 THEN [Calculation_4531465651676438530]
ELSEIF [Parameters].[Parameter 10] = 45 THEN IF LEN(STR([appearance_l30d])) < 2 AND NOT ISNULL(STR([appearance_l30d])) THEN '0' + STR([appearance_l30d]) ELSE STR([appearance_l30d]) END
ELSEIF [Parameters].[Parameter 10] = 46 THEN IF LEN(STR([appearance_l60d])) < 2 AND NOT ISNULL(STR([appearance_l60d])) THEN '0' + STR([appearance_l60d]) ELSE STR([appearance_l60d]) END
ELSEIF [Parameters].[Parameter 10] = 47 THEN IF LEN(STR([appearance_l90d])) < 2 AND NOT ISNULL(STR([appearance_l90d])) THEN '0' + STR([appearance_l90d]) ELSE STR([appearance_l90d]) END
ELSEIF [Parameters].[Parameter 10] = 48 THEN [ATA Work]
ELSEIF [Parameters].[Parameter 10] = 49 THEN [Calculation_499055157754740737]
ELSEIF [Parameters].[Parameter 10] = 50 THEN IF LEN(STR([CIIC Appearance in L30D])) < 2 AND NOT ISNULL(STR([CIIC Appearance in L30D])) THEN '0' + STR([CIIC Appearance in L30D]) ELSE STR([CIIC Appearance in L30D]) END
ELSEIF [Parameters].[Parameter 10] = 51 THEN IF LEN(STR([CIIC Appearance in L60D])) < 2 AND NOT ISNULL(STR([CIIC Appearance in L60D])) THEN '0' + STR([CIIC Appearance in L60D]) ELSE STR([CIIC Appearance in L60D]) END
ELSEIF [Parameters].[Parameter 10] = 52 THEN IF LEN(STR([CIIC Appearance in L90D])) < 2 AND NOT ISNULL(STR([CIIC Appearance in L90D])) THEN '0' + STR([CIIC Appearance in L90D]) ELSE STR([CIIC Appearance in L90D]) END
ELSEIF [Parameters].[Parameter 10] = 53 THEN STR([Calculation_989947527401095169])
ELSEIF [Parameters].[Parameter 10] = 54 THEN [Calculation_1460573688699854848]
ELSEIF [Parameters].[Parameter 10] = 55 THEN [Calculation_1006061976934187009]
ELSE 'Agg'
END",
    "name": "[Calculation_6374000853571039236]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Grade",
    "datatype": "string",
    "formula": "// Grade A
IF [qual_status] = 'all-steps' THEN 'Grade A'

// Grade B
ELSEIF 
    [qual_status] IN ('fiveyrwrk-disqual','outofwrk-disqual','doc-disqual')
    AND [Calculation_1133007210553765896] = 1
THEN 'Grade B'

// Grade C
ELSEIF 
    [qual_status] <> 'age-disqual'
    AND NOT [Stage3 Response] IN ('Less than 2 years', 'Between 2 and 4 years')
    AND [Stage1 Response] <> 'Social Security Disability (SSD) Benefits'
    AND [Stage6 Response] = 'Not working'
THEN 'Grade C'

// Grade D
ELSEIF 
    // 1) Not age-disqual, Stage3 NOT in those two, Stage1 not SSD, Stage6 ≠ Not working, disqual ≤ 1
    (
      [qual_status] <> 'age-disqual'
      AND NOT [Stage3 Response] IN ('Less than 2 years', 'Between 2 and 4 years')
      AND [Stage1 Response] <> 'Social Security Disability (SSD) Benefits'
      AND [Stage6 Response] <> 'Not working'
      AND [Calculation_1133007210553765896] <= 1
    )
    // 2) Not age-disqual, Stage3 in those two, Qual Status = outofwrk-disqual
    OR
    (
      [qual_status] <> 'age-disqual'
      AND [Stage3 Response] IN ('Less than 2 years', 'Between 2 and 4 years')
      AND [qual_status] = 'outofwrk-disqual'
    )
    // 3) Not age-disqual, Stage3 in those two, Qual Status ≠ outofwrk-disqual, Stage7 = Yes
    OR
    (
      [qual_status] <> 'age-disqual'
      AND [Stage3 Response] IN ('Less than 2 years', 'Between 2 and 4 years')
      AND [qual_status] <> 'outofwrk-disqual'
      AND [Stage7 Response] = 'Yes'
    )
THEN 'Grade D'

// Rest (including age-disqual or anything else)
ELSE 'Rest'
END",
    "name": "[Calculation_7573084309404708864]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Today-28",
    "datatype": "date",
    "formula": "//Updated Date: 18 May 2022
//Updated By: Manish
//Description: Going back 28 days from today

({MAX(today()-28)})",
    "name": "[Calculation_767300790172184597]",
    "role": "dimension",
    "type": "ordinal",
  },
  {
    "caption": "SSD Age Range",
    "datatype": "string",
    "formula": "IF DATE([Calculation_1916563181826678784]) >= #18/08/2025#
THEN
    IF INT([Age]) < 40 THEN "U40"
    ELSEIF INT([Age]) >= 40 AND INT([Age]) <= 49 THEN "40 - 49"
	ELSEIF INT([Age]) >= 50 AND INT([Age]) <= 54 THEN "50 - 54"
    ELSEIF INT([Age]) >= 55 AND INT([Age]) <= 63 THEN "55 - 63"
    ELSEIF INT([Age]) >= 64 THEN "O64+"
    END
ELSEIF INT([Age]) < 40 THEN "*U40"
ELSEIF INT([Age]) >= 40 AND INT([Age]) <= 48 THEN "*40-48"
ELSEIF INT([Age]) = 49 THEN "*49"
ELSEIF INT([Age]) >= 50 AND INT([Age]) <= 62 THEN "*50-62"
ELSEIF INT([Age]) >= 63 THEN "*O63+" 
END",
    "name": "[Calculation_7690318609259716608]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Date Filter",
    "datatype": "boolean",
    "formula": "//Updated Date: 18 May 2022
//Updated By: Manish
//Description: Filtering data based on date

IF [Parameters].[Parameter 11] = 'default'
THEN [Date]>=[Parameters].[Parameter 5] AND [Date]<=[Parameters].[Parameter 6]
ELSEIF [Parameters].[Parameter 11] = 'weekly'
THEN [Date] >= TODAY()-8 AND [Date] <= TODAY()-1
END",
    "name": "[Calculation_843580506575679492]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Dial R",
    "datatype": "string",
    "formula": "IF  [Called Count] < 4 then "<=3" 
elseif [Called Count] < 8 then "4-7"
elseif [Called Count] < 11 then "8-10"
elseif [Called Count] < 16 then "11-15"
elseif [Called Count] < 20 then "16-19"
elseif [Called Count] < 26 then "20-25"
elseif [Called Count] < 31 then "25-30"
elseif [Called Count] < 36 then "30-35"
else "35+" 
END",
    "name": "[Calculation_847802666706034688]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Dial R (detail)",
    "datatype": "string",
    "formula": "STR([Called Count])",
    "name": "[Calculation_847802666706186241]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Max Date",
    "datatype": "date",
    "formula": "//Updated Date: 18 May 2022
//Updated By: Manish
//Description: Calculating max of todays date for including it in the default values of end date

{MAX(today())}",
    "name": "[Calculation_882424053213511680]",
    "role": "dimension",
    "type": "ordinal",
  },
  {
    "caption": "User Identifier",
    "datatype": "string",
    "formula": "IF [Parameters].[Parameter 12] = 0 THEN [User Id]
ELSEIF [Parameters].[Parameter 12] = 1 THEN [Phone]
END",
    "name": "[Calculation_906349454594166784]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Alt. Branding",
    "datatype": "string",
    "formula": "If int(Right([Phone],2))<30 and [Calculation_5872834692856524810]= 'Live' then 'Yes' else 'No' End",
    "name": "[Calculation_935059914517495808]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Duplicate Rejects",
    "datatype": "string",
    "formula": "if [Outcome]='rejected' and { FIXED [Phone], [Outcome]: COUNTD([User Id])}>1 then 'Yes' else 'No' end",
    "name": "[Calculation_943222690415542272]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Post Date  ",
    "datatype": "string",
    "formula": "//Updated Date: 18 May 2022
//Updated By: Manish
//Description: Calculation to apply date bucket

CASE [Parameters].[Parameter 1]
WHEN 'year' THEN str(datepart('year', [Calculation_1916563181826678784]))
WHEN 'quarter' THEN "Q" + str(datepart('quarter', [Calculation_1916563181826678784])) + " " + str(datepart('year', [Calculation_1916563181826678784]))
WHEN 'month' THEN str(datepart('month', [Calculation_1916563181826678784])) + "-" + str(datepart('year', [Calculation_1916563181826678784]))
WHEN 'day' THEN str(DATENAME('month', [Calculation_1916563181826678784]))+ "-" +str(datepart('day', [Calculation_1916563181826678784]))+ "-" + str(datepart('year', [Calculation_1916563181826678784]))
WHEN 'week' THEN "W" + str(datepart('week', [Calculation_1916563181826678784])) + "-" + str(datepart('year', [Calculation_1916563181826678784]))
WHEN "hour" THEN str(DATETRUNC('hour', [Calculation_1916563181826678784]))
WHEN "minute" THEN str(DATETRUNC('minute', [Calculation_1916563181826678784]))
END",
    "name": "[Calculation_97320012552925214]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Vici Post Delay (Days)",
    "datatype": "integer",
    "formula": "DATEDIFF('day', [Post Date], [Entry Time])",
    "name": "[Calculation_989947527401095169]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Posted #",
    "datatype": "integer",
    "formula": "//Updated Date: 18 May 2022
//Updated By: Manish
//Description: Calculating the sum of user id wrt to source

countd([Calculation_906349454594166784])",
    "name": "[Calculation_99712551082803223]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "D3",
    "datatype": "string",
    "formula": "IF [Parameters].[D1 (copy 3)_1113233589196374020] = 1 THEN [Calculation_6374000853566275585]
ELSEIF [Parameters].[D1 (copy 3)_1113233589196374020] = 2 THEN [bla_carrierdata_type]
ELSEIF [Parameters].[D1 (copy 3)_1113233589196374020] = 3 THEN [Calculation_6374000853565702144]
ELSEIF [Parameters].[D1 (copy 3)_1113233589196374020] = 4 THEN [Phone Carrier]
ELSEIF [Parameters].[D1 (copy 3)_1113233589196374020] = 5 THEN [CZ Project Name]
ELSEIF [Parameters].[D1 (copy 3)_1113233589196374020] = 6 THEN [Phone Type]
ELSEIF [Parameters].[D1 (copy 3)_1113233589196374020] = 7 THEN [normalized carrier]
ELSEIF [Parameters].[D1 (copy 3)_1113233589196374020] = 8 THEN [Outcome]
ELSEIF [Parameters].[D1 (copy 3)_1113233589196374020] = 9 THEN [qual_status]
ELSEIF [Parameters].[D1 (copy 3)_1113233589196374020] = 10 THEN [Source]
ELSEIF [Parameters].[D1 (copy 3)_1113233589196374020] = 11 THEN [Sub Id]
ELSEIF [Parameters].[D1 (copy 3)_1113233589196374020] = 12 THEN [gender (copy)_2399292755830108162]
ELSEIF [Parameters].[D1 (copy 3)_1113233589196374020] = 13 THEN [Creative]
ELSEIF [Parameters].[D1 (copy 3)_1113233589196374020] = 14 THEN [CL Diagnosis Injury Tiers]
ELSEIF [Parameters].[D1 (copy 3)_1113233589196374020] = 15 THEN [Calculation_935059914517495808]
ELSEIF [Parameters].[D1 (copy 3)_1113233589196374020] = 16 THEN [Ad Name]
ELSEIF [Parameters].[D1 (copy 3)_1113233589196374020] = 17 THEN [Adset Name]
ELSEIF [Parameters].[D1 (copy 3)_1113233589196374020] = 18 THEN [campaign_id]
ELSEIF [Parameters].[D1 (copy 3)_1113233589196374020] = 19 THEN [Labels]
ELSEIF [Parameters].[D1 (copy 3)_1113233589196374020] = 20 THEN [Calculation_5872834692856524810]
ELSEIF [Parameters].[D1 (copy 3)_1113233589196374020] = 21 THEN [State]
ELSEIF [Parameters].[D1 (copy 3)_1113233589196374020] = 22 THEN [Phone]
// ELSEIF [Parameters].[D3] = 23 THEN [Tier]
ELSEIF [Parameters].[D1 (copy 3)_1113233589196374020] = 23 THEN [Calculation_1277614987429064704]
ELSEIF [Parameters].[D1 (copy 3)_1113233589196374020] = 25 THEN [Result Type]
ELSEIF [Parameters].[D1 (copy 3)_1113233589196374020] = 26 THEN [placement]
ELSEIF [Parameters].[D1 (copy 3)_1113233589196374020] = 27 THEN [Calculation_7690318609259716608]
ELSEIF [Parameters].[D1 (copy 3)_1113233589196374020] = 28 THEN [label]
ELSEIF [Parameters].[D1 (copy 3)_1113233589196374020] = 29 THEN STR([Calculation_1880252886088871936])
ELSEIF [Parameters].[D1 (copy 3)_1113233589196374020] = 30 THEN [clientname]
ELSEIF [Parameters].[D1 (copy 3)_1113233589196374020] = 31 THEN [page_path]
ELSEIF [Parameters].[D1 (copy 3)_1113233589196374020] = 32 THEN [sgmt]
ELSEIF [Parameters].[D1 (copy 3)_1113233589196374020] = 33 THEN [ctcphone]
ELSEIF [Parameters].[D1 (copy 3)_1113233589196374020] = 34 THEN [Calculation_3435894714053935109]
ELSEIF [Parameters].[D1 (copy 3)_1113233589196374020] = 35 THEN [ltdinoworkmedicalconditions]
ELSEIF [Parameters].[D1 (copy 3)_1113233589196374020] = 36 THEN [ds_qualstatus]
ELSEIF [Parameters].[D1 (copy 3)_1113233589196374020] = 37 THEN [ad_id]
ELSEIF [Parameters].[D1 (copy 3)_1113233589196374020] = 38 THEN [adset_id]
ELSEIF [Parameters].[D1 (copy 3)_1113233589196374020] = 39 THEN [Calculation_1113233589182521344]
ELSEIF [Parameters].[D1 (copy 3)_1113233589196374020] = 40 THEN [Calculation_1880252886125215747]
ELSEIF [Parameters].[D1 (copy 3)_1113233589196374020] = 41 THEN [SubSegment]
ELSEIF [Parameters].[D1 (copy 3)_1113233589196374020] = 42 THEN STR([Calculation_1133007210553765896])
ELSEIF [Parameters].[D1 (copy 3)_1113233589196374020] = 43 THEN [Calculation_7573084309404708864]
ELSEIF [Parameters].[D1 (copy 3)_1113233589196374020] = 44 THEN [Calculation_4531465651676438530]
ELSEIF [Parameters].[D1 (copy 3)_1113233589196374020] = 45 THEN IF LEN(STR([appearance_l30d])) < 2 AND NOT ISNULL(STR([appearance_l30d])) THEN '0' + STR([appearance_l30d]) ELSE STR([appearance_l30d]) END
ELSEIF [Parameters].[D1 (copy 3)_1113233589196374020] = 46 THEN IF LEN(STR([appearance_l60d])) < 2 AND NOT ISNULL(STR([appearance_l60d])) THEN '0' + STR([appearance_l60d]) ELSE STR([appearance_l60d]) END
ELSEIF [Parameters].[D1 (copy 3)_1113233589196374020] = 47 THEN IF LEN(STR([appearance_l90d])) < 2 AND NOT ISNULL(STR([appearance_l90d])) THEN '0' + STR([appearance_l90d]) ELSE STR([appearance_l90d]) END
ELSEIF [Parameters].[D1 (copy 3)_1113233589196374020] = 48 THEN [ATA Work]
ELSEIF [Parameters].[D1 (copy 3)_1113233589196374020] = 49 THEN [Calculation_499055157754740737]
ELSEIF [Parameters].[D1 (copy 3)_1113233589196374020] = 50 THEN IF LEN(STR([CIIC Appearance in L30D])) < 2 AND NOT ISNULL(STR([CIIC Appearance in L30D])) THEN '0' + STR([CIIC Appearance in L30D]) ELSE STR([CIIC Appearance in L30D]) END
ELSEIF [Parameters].[D1 (copy 3)_1113233589196374020] = 51 THEN IF LEN(STR([CIIC Appearance in L60D])) < 2 AND NOT ISNULL(STR([CIIC Appearance in L60D])) THEN '0' + STR([CIIC Appearance in L60D]) ELSE STR([CIIC Appearance in L60D]) END
ELSEIF [Parameters].[D1 (copy 3)_1113233589196374020] = 52 THEN IF LEN(STR([CIIC Appearance in L90D])) < 2 AND NOT ISNULL(STR([CIIC Appearance in L90D])) THEN '0' + STR([CIIC Appearance in L90D]) ELSE STR([CIIC Appearance in L90D]) END
ELSEIF [Parameters].[D1 (copy 3)_1113233589196374020] = 53 THEN STR([Calculation_989947527401095169])
ELSEIF [Parameters].[D1 (copy 3)_1113233589196374020] = 54 THEN [Calculation_1460573688699854848]
ELSEIF [Parameters].[D1 (copy 3)_1113233589196374020] = 55 THEN [Calculation_1006061976934187009]
ELSE 'Agg'
END",
    "name": "[D1 (copy) (copy)_6374000853573369864]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "D2",
    "datatype": "string",
    "formula": "IF [Parameters].[D1 (copy 2)_1113233589196361731] = 1 THEN [Calculation_6374000853566275585]
ELSEIF [Parameters].[D1 (copy 2)_1113233589196361731]  = 2 THEN [bla_carrierdata_type]
ELSEIF [Parameters].[D1 (copy 2)_1113233589196361731]  = 3 THEN [Calculation_6374000853565702144]
ELSEIF [Parameters].[D1 (copy 2)_1113233589196361731]  = 4 THEN [Phone Carrier]
ELSEIF [Parameters].[D1 (copy 2)_1113233589196361731]  = 5 THEN [CZ Project Name]
ELSEIF [Parameters].[D1 (copy 2)_1113233589196361731]  = 6 THEN [Phone Type]
ELSEIF [Parameters].[D1 (copy 2)_1113233589196361731]  = 7 THEN [normalized carrier]
ELSEIF [Parameters].[D1 (copy 2)_1113233589196361731]  = 8 THEN [Outcome]
ELSEIF [Parameters].[D1 (copy 2)_1113233589196361731]  = 9 THEN [qual_status]
ELSEIF [Parameters].[D1 (copy 2)_1113233589196361731]  = 10 THEN [Source]
ELSEIF [Parameters].[D1 (copy 2)_1113233589196361731]  = 11 THEN [Sub Id]
ELSEIF [Parameters].[D1 (copy 2)_1113233589196361731]  = 12 THEN [gender (copy)_2399292755830108162]
ELSEIF [Parameters].[D1 (copy 2)_1113233589196361731]  = 13 THEN [Creative]
ELSEIF [Parameters].[D1 (copy 2)_1113233589196361731]  = 14 THEN [CL Diagnosis Injury Tiers]
ELSEIF [Parameters].[D1 (copy 2)_1113233589196361731]  = 15 THEN [Calculation_935059914517495808]
ELSEIF [Parameters].[D1 (copy 2)_1113233589196361731]  = 16 THEN [Ad Name]
ELSEIF [Parameters].[D1 (copy 2)_1113233589196361731]  = 17 THEN [Adset Name]
ELSEIF [Parameters].[D1 (copy 2)_1113233589196361731]  = 18 THEN [campaign_id]
ELSEIF [Parameters].[D1 (copy 2)_1113233589196361731]  = 19 THEN [Labels]
ELSEIF [Parameters].[D1 (copy 2)_1113233589196361731]  = 20 THEN [Calculation_5872834692856524810]
ELSEIF [Parameters].[D1 (copy 2)_1113233589196361731]  = 21 THEN [State]
ELSEIF [Parameters].[D1 (copy 2)_1113233589196361731]  = 22 THEN [Phone]
// ELSEIF [Parameters].[D2] = 23 THEN [Tier]
ELSEIF [Parameters].[D1 (copy 2)_1113233589196361731]  = 23 THEN [Calculation_1277614987429064704]
ELSEIF [Parameters].[D1 (copy 2)_1113233589196361731]  = 25 THEN [Result Type]
ELSEIF [Parameters].[D1 (copy 2)_1113233589196361731]  = 26 THEN [placement]
ELSEIF [Parameters].[D1 (copy 2)_1113233589196361731]  = 27 THEN [Calculation_7690318609259716608]
ELSEIF [Parameters].[D1 (copy 2)_1113233589196361731]  = 28 THEN [label]
ELSEIF [Parameters].[D1 (copy 2)_1113233589196361731]  = 29 THEN STR([Calculation_1880252886088871936])
ELSEIF [Parameters].[D1 (copy 2)_1113233589196361731]  = 30 THEN [clientname]
ELSEIF [Parameters].[D1 (copy 2)_1113233589196361731]  = 31 THEN [page_path]
ELSEIF [Parameters].[D1 (copy 2)_1113233589196361731]  = 32 THEN [sgmt]
ELSEIF [Parameters].[D1 (copy 2)_1113233589196361731]  = 33 THEN [ctcphone]
ELSEIF [Parameters].[D1 (copy 2)_1113233589196361731]  = 34 THEN [Calculation_3435894714053935109]
ELSEIF [Parameters].[D1 (copy 2)_1113233589196361731]  = 35 THEN [ltdinoworkmedicalconditions]
ELSEIF [Parameters].[D1 (copy 2)_1113233589196361731]  = 36 THEN [ds_qualstatus]
ELSEIF [Parameters].[D1 (copy 2)_1113233589196361731]  = 37 THEN [ad_id]
ELSEIF [Parameters].[D1 (copy 2)_1113233589196361731]  = 38 THEN [adset_id]
ELSEIF [Parameters].[D1 (copy 2)_1113233589196361731]  = 39 THEN [Calculation_1113233589182521344]
ELSEIF [Parameters].[D1 (copy 2)_1113233589196361731]  = 40 THEN [Calculation_1880252886125215747]
ELSEIF [Parameters].[D1 (copy 2)_1113233589196361731]  = 41 THEN [SubSegment]
ELSEIF [Parameters].[D1 (copy 2)_1113233589196361731] = 42 THEN STR([Calculation_1133007210553765896])
ELSEIF [Parameters].[D1 (copy 2)_1113233589196361731] = 43 THEN [Calculation_7573084309404708864]
ELSEIF [Parameters].[D1 (copy 2)_1113233589196361731] = 44 THEN [Calculation_4531465651676438530]
ELSEIF [Parameters].[D1 (copy 2)_1113233589196361731] = 45 THEN IF LEN(STR([appearance_l30d])) < 2 AND NOT ISNULL(STR([appearance_l30d])) THEN '0' + STR([appearance_l30d]) ELSE STR([appearance_l30d]) END
ELSEIF [Parameters].[D1 (copy 2)_1113233589196361731] = 46 THEN IF LEN(STR([appearance_l60d])) < 2 AND NOT ISNULL(STR([appearance_l60d])) THEN '0' + STR([appearance_l60d]) ELSE STR([appearance_l60d]) END
ELSEIF [Parameters].[D1 (copy 2)_1113233589196361731] = 47 THEN IF LEN(STR([appearance_l90d])) < 2 AND NOT ISNULL(STR([appearance_l90d])) THEN '0' + STR([appearance_l90d]) ELSE STR([appearance_l90d]) END
ELSEIF [Parameters].[D1 (copy 2)_1113233589196361731] = 48 THEN [ATA Work]
ELSEIF [Parameters].[D1 (copy 2)_1113233589196361731] = 49 THEN [Calculation_499055157754740737]
ELSEIF [Parameters].[D1 (copy 2)_1113233589196361731] = 50 THEN IF LEN(STR([CIIC Appearance in L30D])) < 2 AND NOT ISNULL(STR([CIIC Appearance in L30D])) THEN '0' + STR([CIIC Appearance in L30D]) ELSE STR([CIIC Appearance in L30D]) END
ELSEIF [Parameters].[D1 (copy 2)_1113233589196361731] = 51 THEN IF LEN(STR([CIIC Appearance in L60D])) < 2 AND NOT ISNULL(STR([CIIC Appearance in L60D])) THEN '0' + STR([CIIC Appearance in L60D]) ELSE STR([CIIC Appearance in L60D]) END
ELSEIF [Parameters].[D1 (copy 2)_1113233589196361731] = 52 THEN IF LEN(STR([CIIC Appearance in L90D])) < 2 AND NOT ISNULL(STR([CIIC Appearance in L90D])) THEN '0' + STR([CIIC Appearance in L90D]) ELSE STR([CIIC Appearance in L90D]) END
ELSEIF [Parameters].[D1 (copy 2)_1113233589196361731] = 53 THEN STR([Calculation_989947527401095169])
ELSEIF [Parameters].[D1 (copy 2)_1113233589196361731] = 54 THEN [Calculation_1460573688699854848]
ELSEIF [Parameters].[D1 (copy 2)_1113233589196361731] = 55 THEN [Calculation_1006061976934187009]
ELSE 'Agg'
END",
    "name": "[D1 (copy)_6374000853573341191]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "D4",
    "datatype": "string",
    "formula": "IF [Parameters].[D1 (copy)_1113233589196333057] = 1 THEN [Calculation_6374000853566275585]
ELSEIF [Parameters].[D1 (copy)_1113233589196333057] = 2 THEN [bla_carrierdata_type]
ELSEIF [Parameters].[D1 (copy)_1113233589196333057] = 3 THEN [Calculation_6374000853565702144]
ELSEIF [Parameters].[D1 (copy)_1113233589196333057] = 4 THEN [Phone Carrier]
ELSEIF [Parameters].[D1 (copy)_1113233589196333057] = 5 THEN [CZ Project Name]
ELSEIF [Parameters].[D1 (copy)_1113233589196333057] = 6 THEN [Phone Type]
ELSEIF [Parameters].[D1 (copy)_1113233589196333057] = 7 THEN [normalized carrier]
ELSEIF [Parameters].[D1 (copy)_1113233589196333057] = 8 THEN [Outcome]
ELSEIF [Parameters].[D1 (copy)_1113233589196333057] = 9 THEN [qual_status]
ELSEIF [Parameters].[D1 (copy)_1113233589196333057] = 10 THEN [Source]
ELSEIF [Parameters].[D1 (copy)_1113233589196333057] = 11 THEN [Sub Id]
ELSEIF [Parameters].[D1 (copy)_1113233589196333057] = 12 THEN [gender (copy)_2399292755830108162]
ELSEIF [Parameters].[D1 (copy)_1113233589196333057] = 13 THEN [Creative]
ELSEIF [Parameters].[D1 (copy)_1113233589196333057] = 14 THEN [CL Diagnosis Injury Tiers]
ELSEIF [Parameters].[D1 (copy)_1113233589196333057] = 15 THEN [Calculation_935059914517495808]
ELSEIF [Parameters].[D1 (copy)_1113233589196333057] = 16 THEN [Ad Name]
ELSEIF [Parameters].[D1 (copy)_1113233589196333057] = 17 THEN [Adset Name]
ELSEIF [Parameters].[D1 (copy)_1113233589196333057] = 18 THEN [campaign_id]
ELSEIF [Parameters].[D1 (copy)_1113233589196333057] = 19 THEN [Labels]
ELSEIF [Parameters].[D1 (copy)_1113233589196333057] = 20 THEN [Calculation_5872834692856524810]
ELSEIF [Parameters].[D1 (copy)_1113233589196333057] = 21 THEN [State]
ELSEIF [Parameters].[D1 (copy)_1113233589196333057] = 22 THEN [Phone]
// ELSEIF [Parameters].[D4] = 23 THEN [Tier]
ELSEIF [Parameters].[D1 (copy)_1113233589196333057] = 23 THEN [Calculation_1277614987429064704]
ELSEIF [Parameters].[D1 (copy)_1113233589196333057] = 25 THEN [Result Type]
ELSEIF [Parameters].[D1 (copy)_1113233589196333057] = 26 THEN [placement]
ELSEIF [Parameters].[D1 (copy)_1113233589196333057] = 27 THEN [Calculation_7690318609259716608]
ELSEIF [Parameters].[D1 (copy)_1113233589196333057] = 28 THEN [label]
ELSEIF [Parameters].[D1 (copy)_1113233589196333057] = 29 THEN STR([Calculation_1880252886088871936])
ELSEIF [Parameters].[D1 (copy)_1113233589196333057] = 30 THEN [clientname]
ELSEIF [Parameters].[D1 (copy)_1113233589196333057] = 31 THEN [page_path]
ELSEIF [Parameters].[D1 (copy)_1113233589196333057] = 32 THEN [sgmt]
ELSEIF [Parameters].[D1 (copy)_1113233589196333057] = 33 THEN [ctcphone]
ELSEIF [Parameters].[D1 (copy)_1113233589196333057] = 34 THEN [Calculation_3435894714053935109]
ELSEIF [Parameters].[D1 (copy)_1113233589196333057] = 35 THEN [ltdinoworkmedicalconditions]
ELSEIF [Parameters].[D1 (copy)_1113233589196333057] = 36 THEN [ds_qualstatus]
ELSEIF [Parameters].[D1 (copy)_1113233589196333057] = 37 THEN [ad_id]
ELSEIF [Parameters].[D1 (copy)_1113233589196333057] = 38 THEN [adset_id]
ELSEIF [Parameters].[D1 (copy)_1113233589196333057] = 39 THEN [Calculation_1113233589182521344]
ELSEIF [Parameters].[D1 (copy)_1113233589196333057] = 40 THEN [Calculation_1880252886125215747]
ELSEIF [Parameters].[D1 (copy)_1113233589196333057] = 41 THEN [SubSegment]
ELSEIF [Parameters].[D1 (copy)_1113233589196333057] = 42 THEN STR([Calculation_1133007210553765896])
ELSEIF [Parameters].[D1 (copy)_1113233589196333057] = 43 THEN [Calculation_7573084309404708864]
ELSEIF [Parameters].[D1 (copy)_1113233589196333057] = 44 THEN [Calculation_4531465651676438530]
ELSEIF [Parameters].[D1 (copy)_1113233589196333057] = 45 THEN IF LEN(STR([appearance_l30d])) < 2 AND NOT ISNULL(STR([appearance_l30d])) THEN '0' + STR([appearance_l30d]) ELSE STR([appearance_l30d]) END
ELSEIF [Parameters].[D1 (copy)_1113233589196333057] = 46 THEN IF LEN(STR([appearance_l60d])) < 2 AND NOT ISNULL(STR([appearance_l60d])) THEN '0' + STR([appearance_l60d]) ELSE STR([appearance_l60d]) END
ELSEIF [Parameters].[D1 (copy)_1113233589196333057] = 47 THEN IF LEN(STR([appearance_l90d])) < 2 AND NOT ISNULL(STR([appearance_l90d])) THEN '0' + STR([appearance_l90d]) ELSE STR([appearance_l90d]) END
ELSEIF [Parameters].[D1 (copy)_1113233589196333057] = 48 THEN [ATA Work]
ELSEIF [Parameters].[D1 (copy)_1113233589196333057] = 49 THEN [Calculation_499055157754740737]
ELSEIF [Parameters].[D1 (copy)_1113233589196333057] = 50 THEN IF LEN(STR([CIIC Appearance in L30D])) < 2 AND NOT ISNULL(STR([CIIC Appearance in L30D])) THEN '0' + STR([CIIC Appearance in L30D]) ELSE STR([CIIC Appearance in L30D]) END
ELSEIF [Parameters].[D1 (copy)_1113233589196333057] = 51 THEN IF LEN(STR([CIIC Appearance in L60D])) < 2 AND NOT ISNULL(STR([CIIC Appearance in L60D])) THEN '0' + STR([CIIC Appearance in L60D]) ELSE STR([CIIC Appearance in L60D]) END
ELSEIF [Parameters].[D1 (copy)_1113233589196333057] = 52 THEN IF LEN(STR([CIIC Appearance in L90D])) < 2 AND NOT ISNULL(STR([CIIC Appearance in L90D])) THEN '0' + STR([CIIC Appearance in L90D]) ELSE STR([CIIC Appearance in L90D]) END
ELSEIF [Parameters].[D1 (copy)_1113233589196333057] = 53 THEN STR([Calculation_989947527401095169])
ELSEIF [Parameters].[D1 (copy)_1113233589196333057] = 54 THEN [Calculation_1460573688699854848]
ELSEIF [Parameters].[D1 (copy)_1113233589196333057] = 55 THEN [Calculation_1006061976934187009]
ELSE 'Agg'
END",
    "name": "[D3 (copy)_6208563937532035081]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "D5",
    "datatype": "string",
    "formula": "IF [Parameters].[D1 (copy) (copy)_1113233589196361730] = 1 THEN [Calculation_6374000853566275585]
ELSEIF [Parameters].[D1 (copy) (copy)_1113233589196361730] = 2 THEN [bla_carrierdata_type]
ELSEIF [Parameters].[D1 (copy) (copy)_1113233589196361730] = 3 THEN [Calculation_6374000853565702144]
ELSEIF [Parameters].[D1 (copy) (copy)_1113233589196361730] = 4 THEN [Phone Carrier]
ELSEIF [Parameters].[D1 (copy) (copy)_1113233589196361730] = 5 THEN [CZ Project Name]
ELSEIF [Parameters].[D1 (copy) (copy)_1113233589196361730] = 6 THEN [Phone Type]
ELSEIF [Parameters].[D1 (copy) (copy)_1113233589196361730] = 7 THEN [normalized carrier]
ELSEIF [Parameters].[D1 (copy) (copy)_1113233589196361730] = 8 THEN [Outcome]
ELSEIF [Parameters].[D1 (copy) (copy)_1113233589196361730] = 9 THEN [qual_status]
ELSEIF [Parameters].[D1 (copy) (copy)_1113233589196361730] = 10 THEN [Source]
ELSEIF [Parameters].[D1 (copy) (copy)_1113233589196361730] = 11 THEN [Sub Id]
ELSEIF [Parameters].[D1 (copy) (copy)_1113233589196361730] = 12 THEN [gender (copy)_2399292755830108162]
ELSEIF [Parameters].[D1 (copy) (copy)_1113233589196361730] = 13 THEN [Creative]
ELSEIF [Parameters].[D1 (copy) (copy)_1113233589196361730] = 14 THEN [CL Diagnosis Injury Tiers]
ELSEIF [Parameters].[D1 (copy) (copy)_1113233589196361730] = 15 THEN [Calculation_935059914517495808]
ELSEIF [Parameters].[D1 (copy) (copy)_1113233589196361730] = 16 THEN [Ad Name]
ELSEIF [Parameters].[D1 (copy) (copy)_1113233589196361730] = 17 THEN [Adset Name]
ELSEIF [Parameters].[D1 (copy) (copy)_1113233589196361730] = 18 THEN [campaign_id]
ELSEIF [Parameters].[D1 (copy) (copy)_1113233589196361730] = 19 THEN [Labels]
ELSEIF [Parameters].[D1 (copy) (copy)_1113233589196361730] = 20 THEN [Calculation_5872834692856524810]
ELSEIF [Parameters].[D1 (copy) (copy)_1113233589196361730] = 21 THEN [State]
ELSEIF [Parameters].[D1 (copy) (copy)_1113233589196361730] = 22 THEN [Phone]
// ELSEIF [Parameters].[D5] = 23 THEN [Tier]
ELSEIF [Parameters].[D1 (copy) (copy)_1113233589196361730] = 23 THEN [Calculation_1277614987429064704]
ELSEIF [Parameters].[D1 (copy) (copy)_1113233589196361730] = 25 THEN [Result Type]
ELSEIF [Parameters].[D1 (copy) (copy)_1113233589196361730] = 26 THEN [placement]
ELSEIF [Parameters].[D1 (copy) (copy)_1113233589196361730] = 27 THEN [Calculation_7690318609259716608]
ELSEIF [Parameters].[D1 (copy) (copy)_1113233589196361730] = 28 THEN [label]
ELSEIF [Parameters].[D1 (copy) (copy)_1113233589196361730] = 29 THEN STR([Calculation_1880252886088871936])
ELSEIF [Parameters].[D1 (copy) (copy)_1113233589196361730] = 30 THEN [clientname]
ELSEIF [Parameters].[D1 (copy) (copy)_1113233589196361730] = 31 THEN [page_path]
ELSEIF [Parameters].[D1 (copy) (copy)_1113233589196361730] = 32 THEN [sgmt]
ELSEIF [Parameters].[D1 (copy) (copy)_1113233589196361730] = 33 THEN [ctcphone]
ELSEIF [Parameters].[D1 (copy) (copy)_1113233589196361730] = 34 THEN [Calculation_3435894714053935109]
ELSEIF [Parameters].[D1 (copy) (copy)_1113233589196361730] = 35 THEN [ltdinoworkmedicalconditions]
ELSEIF [Parameters].[D1 (copy) (copy)_1113233589196361730] = 36 THEN [ds_qualstatus]
ELSEIF [Parameters].[D1 (copy) (copy)_1113233589196361730] = 37 THEN [ad_id]
ELSEIF [Parameters].[D1 (copy) (copy)_1113233589196361730] = 38 THEN [adset_id]
ELSEIF [Parameters].[D1 (copy) (copy)_1113233589196361730] = 39 THEN [Calculation_1113233589182521344]
ELSEIF [Parameters].[D1 (copy) (copy)_1113233589196361730] = 40 THEN [Calculation_1880252886125215747]
ELSEIF [Parameters].[D1 (copy) (copy)_1113233589196361730] = 41 THEN [SubSegment]
ELSEIF [Parameters].[D1 (copy) (copy)_1113233589196361730] = 42 THEN STR([Calculation_1133007210553765896])
ELSEIF [Parameters].[D1 (copy) (copy)_1113233589196361730] = 43 THEN [Calculation_7573084309404708864]
ELSEIF [Parameters].[D1 (copy) (copy)_1113233589196361730] = 44 THEN [Calculation_4531465651676438530]
ELSEIF [Parameters].[D1 (copy) (copy)_1113233589196361730] = 45 THEN IF LEN(STR([appearance_l30d])) < 2 AND NOT ISNULL(STR([appearance_l30d])) THEN '0' + STR([appearance_l30d]) ELSE STR([appearance_l30d]) END
ELSEIF [Parameters].[D1 (copy) (copy)_1113233589196361730] = 46 THEN IF LEN(STR([appearance_l60d])) < 2 AND NOT ISNULL(STR([appearance_l60d])) THEN '0' + STR([appearance_l60d]) ELSE STR([appearance_l60d]) END
ELSEIF [Parameters].[D1 (copy) (copy)_1113233589196361730] = 47 THEN IF LEN(STR([appearance_l90d])) < 2 AND NOT ISNULL(STR([appearance_l90d])) THEN '0' + STR([appearance_l90d]) ELSE STR([appearance_l90d]) END
ELSEIF [Parameters].[D1 (copy) (copy)_1113233589196361730] = 48 THEN [ATA Work]
ELSEIF [Parameters].[D1 (copy) (copy)_1113233589196361730] = 49 THEN [Calculation_499055157754740737]
ELSEIF [Parameters].[D1 (copy) (copy)_1113233589196361730] = 50 THEN IF LEN(STR([CIIC Appearance in L30D])) < 2 AND NOT ISNULL(STR([CIIC Appearance in L30D])) THEN '0' + STR([CIIC Appearance in L30D]) ELSE STR([CIIC Appearance in L30D]) END
ELSEIF [Parameters].[D1 (copy) (copy)_1113233589196361730] = 51 THEN IF LEN(STR([CIIC Appearance in L60D])) < 2 AND NOT ISNULL(STR([CIIC Appearance in L60D])) THEN '0' + STR([CIIC Appearance in L60D]) ELSE STR([CIIC Appearance in L60D]) END
ELSEIF [Parameters].[D1 (copy) (copy)_1113233589196361730] = 52 THEN IF LEN(STR([CIIC Appearance in L90D])) < 2 AND NOT ISNULL(STR([CIIC Appearance in L90D])) THEN '0' + STR([CIIC Appearance in L90D]) ELSE STR([CIIC Appearance in L90D]) END
ELSEIF [Parameters].[D1 (copy) (copy)_1113233589196361730] = 53 THEN STR([Calculation_989947527401095169])
ELSEIF [Parameters].[D1 (copy) (copy)_1113233589196361730] = 54 THEN [Calculation_1460573688699854848]
ELSEIF [Parameters].[D1 (copy) (copy)_1113233589196361730] = 55 THEN [Calculation_1006061976934187009]
ELSE 'Agg'
END",
    "name": "[D4 (copy)_6208563937532350475]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Gender",
    "datatype": "string",
    "formula": "//Updated Date: 18 May 2022
//Updated By: Manish
//Description: Converting gnder values to upper case

UPPER([Gender])",
    "name": "[gender (copy)_2399292755830108162]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "State Exclusions",
    "datatype": "string",
    "formula": "[State]",
    "name": "[state (copy)_2399292755821703168]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "TTW Grade",
    "datatype": "string",
    "formula": "IF [ttw_qualstatus] = 'ttw-qualified' then 'Grade A'
ELSEIF  [ttw_qualstatus] = 'ttw-nonqualified' and [TTW Explore Work Form] = 'yes' THEN 'Grade B'
ELSEIF [ttw_qualstatus] = 'ttw-nonqualified' and [TTW Explore Work Form] != 'yes' THEN 'Grade C'
ELSEIF ISNULL([ttw_qualstatus]) and [Stage3 Response] = 'Between 2 and 4 years' then 'Grade D'
ELSE 'Rest'
END",
    "name": "[Calculation_1006061976934187009]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "20hrs Disqual",
    "datatype": "integer",
    "formula": "IF [Stage6 Response] = "More than 20 hours per week" THEN 1 ELSE 0 END",
    "name": "[Calculation_1133007210546622464]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Age Disqual",
    "datatype": "integer",
    "formula": "IF INT([Age]) < 40 OR INT([Age]) > 62 THEN 1 ELSE 0 END",
    "name": "[Calculation_1133007210553298946]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Attorney Disqual",
    "datatype": "integer",
    "formula": "IF [Stage5 Response] = "Yes" THEN 1 ELSE 0 END",
    "name": "[Calculation_1133007210553425923]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Ben Disqual",
    "datatype": "integer",
    "formula": "IF IFNULL([Stage1 Response], "") != "I am not receiving any disability benefits (SSD or SSI)"
THEN 1 ELSE 0 END",
    "name": "[Calculation_1133007210553487364]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Doctor Visit Disqual",
    "datatype": "integer",
    "formula": "IF [Stage4 Response] = "No" THEN 1 ELSE 0 END",
    "name": "[Calculation_1133007210553540613]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Five Year Work Disqual",
    "datatype": "integer",
    "formula": "IF [Stage3 Response] = "Less than 2 years"
OR [Stage3 Response] = "Between 2 and 4 years"
THEN 1 ELSE 0 END",
    "name": "[Calculation_1133007210553618438]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Out of Work Disqual",
    "datatype": "integer",
    "formula": "IF [Stage2 Response] = "No" THEN 1 ELSE 0 END",
    "name": "[Calculation_1133007210553663495]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "# of Disqual",
    "datatype": "integer",
    "formula": "ZN([Calculation_1133007210553487364]) +
ZN([Calculation_1133007210553663495]) +
ZN([Calculation_1133007210553618438]) +
ZN([Calculation_1133007210553540613]) +
ZN([Calculation_1133007210553425923]) +
ZN([Calculation_1133007210546622464]) +
ZN([Calculation_1133007210553298946])",
    "name": "[Calculation_1133007210553765896]",
    "role": "dimension",
    "type": "ordinal",
  },
  {
    "caption": "Unresolved SSA Leads",
    "datatype": "string",
    "formula": "IF { FIXED [Phone] : MAX([Resolved Lead]) } = 0 THEN "SSA Unresolved Lead"
ELSEIF { FIXED [Phone] : MAX([Resolved Lead]) } = 1 THEN "SSA Resolved Lead"
END",
    "name": "[Calculation_1467962419029331969]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Post Date ",
    "datatype": "datetime",
    "formula": "//Updated Date: 18 May 2022
//Updated By: Manish
//Description: Formula to calculate UTC date

DATEADD("hour",0,[Post Date])",
    "name": "[Calculation_1916563181826678784]",
    "role": "dimension",
    "type": "ordinal",
  },
  {
    "caption": "Data Updated On",
    "datatype": "datetime",
    "formula": "{fixed :max([Post Date])}",
    "name": "[Calculation_2010857255412854784]",
    "role": "dimension",
    "type": "ordinal",
  },
  {
    "caption": "Date filter for 301-Days",
    "datatype": "boolean",
    "formula": "//Updated Date: 18 May 2022
//Updated By: Manish
//Description: Filtering data based from 28th day to got back 300 days based on start time


[Calculation_767300790176440343]>=today()-301 AND [Calculation_767300790176440343]<=today()",
    "name": "[Calculation_6274992047113019392]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Grade",
    "datatype": "string",
    "formula": "// Grade A
IF [qual_status] = 'all-steps' THEN 'Grade A'

// Grade B
ELSEIF 
    [qual_status] IN ('fiveyrwrk-disqual','outofwrk-disqual','doc-disqual')
    AND [Calculation_1133007210553765896] = 1
THEN 'Grade B'

// Grade C
ELSEIF 
    [qual_status] <> 'age-disqual'
    AND NOT [Stage3 Response] IN ('Less than 2 years', 'Between 2 and 4 years')
    AND [Stage1 Response] <> 'Social Security Disability (SSD) Benefits'
    AND [Stage6 Response] = 'Not working'
THEN 'Grade C'

// Grade D
ELSEIF 
    // 1) Not age-disqual, Stage3 NOT in those two, Stage1 not SSD, Stage6 ≠ Not working, disqual ≤ 1
    (
      [qual_status] <> 'age-disqual'
      AND NOT [Stage3 Response] IN ('Less than 2 years', 'Between 2 and 4 years')
      AND [Stage1 Response] <> 'Social Security Disability (SSD) Benefits'
      AND [Stage6 Response] <> 'Not working'
      AND [Calculation_1133007210553765896] <= 1
    )
    // 2) Not age-disqual, Stage3 in those two, Qual Status = outofwrk-disqual
    OR
    (
      [qual_status] <> 'age-disqual'
      AND [Stage3 Response] IN ('Less than 2 years', 'Between 2 and 4 years')
      AND [qual_status] = 'outofwrk-disqual'
    )
    // 3) Not age-disqual, Stage3 in those two, Qual Status ≠ outofwrk-disqual, Stage7 = Yes
    OR
    (
      [qual_status] <> 'age-disqual'
      AND [Stage3 Response] IN ('Less than 2 years', 'Between 2 and 4 years')
      AND [qual_status] <> 'outofwrk-disqual'
      AND [Stage7 Response] = 'Yes'
    )
THEN 'Grade D'

// Rest (including age-disqual or anything else)
ELSE 'Rest'
END",
    "name": "[Calculation_7573084309404708864]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Start Time",
    "datatype": "date",
    "formula": "//DATEADD('hour',0,DATEPARSE('MMM dd, yyyy hh:mm:ss',TRIM(SPLIT([LED].[Start Time],' UTC',1))))
DATE([Calculation_1916563181826678784])",
    "name": "[Calculation_767300790176440343]",
    "role": "dimension",
    "type": "ordinal",
  },
  {
    "caption": "'Leads'",
    "datatype": "string",
    "formula": "'Leads'",
    "name": "[Calculation_767300790206898204]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Day of Post Date (Copy)",
    "datatype": "date",
    "formula": "//Updated Date: 18 May 2022
//Updated By: Manish
//Description: Formula to include date conversion from UTC to PT

DATE(DATEADD("hour",0,[Post Date]))",
    "name": "[Calculation_8176144444085592065]",
    "role": "dimension",
    "type": "ordinal",
  },
  {
    "caption": "Phone (w/o area code)",
    "datatype": "string",
    "formula": "//Updated Date: 18 May 2022
//Updated By: Manish
//Description: Removing the area code from phone numbers

MID([Phone],4)",
    "name": "[Calculation_8176144444085837826]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Dial R",
    "datatype": "string",
    "formula": "IF  [Called Count] < 4 then "<=3" 
elseif [Called Count] < 8 then "4-7"
elseif [Called Count] < 11 then "8-10"
elseif [Called Count] < 16 then "11-15"
elseif [Called Count] < 20 then "16-19"
elseif [Called Count] < 26 then "20-25"
elseif [Called Count] < 31 then "25-30"
elseif [Called Count] < 36 then "30-35"
else "35+" 
END",
    "name": "[Calculation_847802666706034688]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Dial R (detail)",
    "datatype": "string",
    "formula": "STR([Called Count])",
    "name": "[Calculation_847802666706186241]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Filter to Remove Dup Leads",
    "datatype": "boolean",
    "formula": "[Calculation_767300790176440343]={fixed [Phone],[CZ Project Name],[Outcome],[Status]:max([Calculation_767300790176440343])}",
    "name": "[Calculation_987132781714386944]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Helper Date",
    "datatype": "string",
    "formula": ""default"",
    "name": "[Parameter 11]",
    "role": "measure",
    "type": "nominal",
  },
  {
    "caption": "Start Date",
    "datatype": "date",
    "formula": "#2025-07-30#",
    "name": "[Parameter 5]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "End Date",
    "datatype": "date",
    "formula": "#2025-08-27#",
    "name": "[Parameter 6]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Show Source",
    "datatype": "string",
    "formula": ""1"",
    "name": "[Phone (copy)_1255659924007981058]",
    "role": "measure",
    "type": "nominal",
  },
  {
    "caption": "TTW Grade",
    "datatype": "string",
    "formula": "IF [ttw_qualstatus] = 'ttw-qualified' then 'Grade A'
ELSEIF  [ttw_qualstatus] = 'ttw-nonqualified' and [TTW Explore Work Form] = 'yes' THEN 'Grade B'
ELSEIF [ttw_qualstatus] = 'ttw-nonqualified' and [TTW Explore Work Form] != 'yes' THEN 'Grade C'
ELSEIF ISNULL([ttw_qualstatus]) and [Stage3 Response] = 'Between 2 and 4 years' then 'Grade D'
ELSE 'Rest'
END",
    "name": "[Calculation_1006061976934187009]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Hour of Day",
    "datatype": "string",
    "formula": "IF LEN(STR(DATEPART('hour', [Calculation_1916563181826678784]))) = 1
THEN "0" + STR(DATEPART('hour', [Calculation_1916563181826678784]))
ELSE STR(DATEPART('hour', [Calculation_1916563181826678784]))
END",
    "name": "[Calculation_1113233589182521344]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "20hrs Disqual",
    "datatype": "integer",
    "formula": "IF [Stage6 Response] = "More than 20 hours per week" THEN 1 ELSE 0 END",
    "name": "[Calculation_1133007210546622464]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Age Disqual",
    "datatype": "integer",
    "formula": "IF INT([Age]) < 40 OR INT([Age]) > 62 THEN 1 ELSE 0 END",
    "name": "[Calculation_1133007210553298946]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Attorney Disqual",
    "datatype": "integer",
    "formula": "IF [Stage5 Response] = "Yes" THEN 1 ELSE 0 END",
    "name": "[Calculation_1133007210553425923]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Ben Disqual",
    "datatype": "integer",
    "formula": "IF IFNULL([Stage1 Response], "") != "I am not receiving any disability benefits (SSD or SSI)"
THEN 1 ELSE 0 END",
    "name": "[Calculation_1133007210553487364]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Doctor Visit Disqual",
    "datatype": "integer",
    "formula": "IF [Stage4 Response] = "No" THEN 1 ELSE 0 END",
    "name": "[Calculation_1133007210553540613]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Five Year Work Disqual",
    "datatype": "integer",
    "formula": "IF [Stage3 Response] = "Less than 2 years"
OR [Stage3 Response] = "Between 2 and 4 years"
THEN 1 ELSE 0 END",
    "name": "[Calculation_1133007210553618438]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Out of Work Disqual",
    "datatype": "integer",
    "formula": "IF [Stage2 Response] = "No" THEN 1 ELSE 0 END",
    "name": "[Calculation_1133007210553663495]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "# of Disqual",
    "datatype": "integer",
    "formula": "ZN([Calculation_1133007210553487364]) +
ZN([Calculation_1133007210553663495]) +
ZN([Calculation_1133007210553618438]) +
ZN([Calculation_1133007210553540613]) +
ZN([Calculation_1133007210553425923]) +
ZN([Calculation_1133007210546622464]) +
ZN([Calculation_1133007210553298946])",
    "name": "[Calculation_1133007210553765896]",
    "role": "dimension",
    "type": "ordinal",
  },
  {
    "caption": "Row #",
    "datatype": "integer",
    "formula": "size()",
    "name": "[Calculation_1147573533293101059]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Mod Orig User Id",
    "datatype": "string",
    "formula": "if CONTAINS([CZ Project Name],'Aged') then [Orig User Id]
ELSE [User Id]
END",
    "name": "[Calculation_1189020709117038593]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "User Id ('orig_')",
    "datatype": "string",
    "formula": "'orig_' + [User Id]",
    "name": "[Calculation_1189020709117194242]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Unresolved SSA Leads",
    "datatype": "string",
    "formula": "IF { FIXED [Phone] : MAX([Resolved Lead]) } = 0 THEN "SSA Unresolved Lead"
ELSEIF { FIXED [Phone] : MAX([Resolved Lead]) } = 1 THEN "SSA Resolved Lead"
END",
    "name": "[Calculation_1467962419029331969]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Leads Age",
    "datatype": "integer",
    "formula": "If (DATEDIFF('day',[Calculation_767300790176440343],TODAY()))>=0 Then 
(DATEDIFF('day',[Calculation_767300790176440343],TODAY()))
ELSE 0
END",
    "name": "[Calculation_1621014427239342104]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Text Response",
    "datatype": "string",
    "formula": "str(IF SUM([Inbound Messages]) >= 1 THEN 1 else 0 end)",
    "name": "[Calculation_1717560316595126272]",
    "role": "measure",
    "type": "nominal",
  },
  {
    "caption": "CZ Post Hour Group",
    "datatype": "string",
    "formula": "IF DATEPART('hour', [Post Date]) >= 0 AND DATEPART('hour', [Post Date]) < 6 THEN 'Pre CC Hours'
ELSEIF DATEPART('hour', [Post Date]) >= 6 AND DATEPART('hour', [Post Date]) < 16 THEN 'CC Hours'
ELSEIF DATEPART('hour', [Post Date]) >= 16 AND DATEPART('hour', [Post Date]) < 24 THEN 'Post CC Hours'
END",
    "name": "[Calculation_1880252886125215747]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Post Date ",
    "datatype": "datetime",
    "formula": "//Updated Date: 18 May 2022
//Updated By: Manish
//Description: Formula to calculate UTC date

DATEADD("hour",0,[Post Date])",
    "name": "[Calculation_1916563181826678784]",
    "role": "dimension",
    "type": "ordinal",
  },
  {
    "caption": "Data Updated On",
    "datatype": "datetime",
    "formula": "{fixed :max([Post Date])}",
    "name": "[Calculation_2010857255412854784]",
    "role": "dimension",
    "type": "ordinal",
  },
  {
    "caption": "rowid",
    "datatype": "integer",
    "formula": "INDEX()",
    "name": "[Calculation_2146317124280909824]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Grade",
    "datatype": "string",
    "formula": "// Grade A
IF [qual_status] = 'all-steps' THEN 'Grade A'

// Grade B
ELSEIF 
    [qual_status] IN ('fiveyrwrk-disqual','outofwrk-disqual','doc-disqual')
    AND [Calculation_1133007210553765896] = 1
THEN 'Grade B'

// Grade C
ELSEIF 
    [qual_status] <> 'age-disqual'
    AND NOT [Stage3 Response] IN ('Less than 2 years', 'Between 2 and 4 years')
    AND [Stage1 Response] <> 'Social Security Disability (SSD) Benefits'
    AND [Stage6 Response] = 'Not working'
THEN 'Grade C'

// Grade D
ELSEIF 
    // 1) Not age-disqual, Stage3 NOT in those two, Stage1 not SSD, Stage6 ≠ Not working, disqual ≤ 1
    (
      [qual_status] <> 'age-disqual'
      AND NOT [Stage3 Response] IN ('Less than 2 years', 'Between 2 and 4 years')
      AND [Stage1 Response] <> 'Social Security Disability (SSD) Benefits'
      AND [Stage6 Response] <> 'Not working'
      AND [Calculation_1133007210553765896] <= 1
    )
    // 2) Not age-disqual, Stage3 in those two, Qual Status = outofwrk-disqual
    OR
    (
      [qual_status] <> 'age-disqual'
      AND [Stage3 Response] IN ('Less than 2 years', 'Between 2 and 4 years')
      AND [qual_status] = 'outofwrk-disqual'
    )
    // 3) Not age-disqual, Stage3 in those two, Qual Status ≠ outofwrk-disqual, Stage7 = Yes
    OR
    (
      [qual_status] <> 'age-disqual'
      AND [Stage3 Response] IN ('Less than 2 years', 'Between 2 and 4 years')
      AND [qual_status] <> 'outofwrk-disqual'
      AND [Stage7 Response] = 'Yes'
    )
THEN 'Grade D'

// Rest (including age-disqual or anything else)
ELSE 'Rest'
END",
    "name": "[Calculation_7573084309404708864]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Today-28",
    "datatype": "date",
    "formula": "//Updated Date: 18 May 2022
//Updated By: Manish
//Description: Going back 28 days from today

({MAX(today()-28)})",
    "name": "[Calculation_767300790172184597]",
    "role": "dimension",
    "type": "ordinal",
  },
  {
    "caption": "Start Time",
    "datatype": "date",
    "formula": "//DATEADD('hour',0,DATEPARSE('MMM dd, yyyy hh:mm:ss',TRIM(SPLIT([LED].[Start Time],' UTC',1))))
DATE([Calculation_1916563181826678784])",
    "name": "[Calculation_767300790176440343]",
    "role": "dimension",
    "type": "ordinal",
  },
  {
    "caption": "Day of Post Date (Copy)",
    "datatype": "date",
    "formula": "//Updated Date: 18 May 2022
//Updated By: Manish
//Description: Formula to include date conversion from UTC to PT

DATE(DATEADD("hour",0,[Post Date]))",
    "name": "[Calculation_8176144444085592065]",
    "role": "dimension",
    "type": "ordinal",
  },
  {
    "caption": "Orig Source Id",
    "datatype": "string",
    "formula": "//Updated Date: 18 May 2022
//Updated By: Manish
//Description: Extracting the orig source id from source id column

IF CONTAINS([CZ Project Name],'Aged') Then [Aged Orig Source Id]
ELSE ifnull(MID([Source Id],FINDNTH([Source Id],'|',2)+1),"")
END",
    "name": "[Calculation_8402872493470011392]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Date Filter",
    "datatype": "boolean",
    "formula": "//Updated Date: 18 May 2022
//Updated By: Manish
//Description: Filtering data based on date

IF [Parameters].[Parameter 11] = 'default'
THEN [Date]>=[Parameters].[Parameter 5] AND [Date]<=[Parameters].[Parameter 6]
ELSEIF [Parameters].[Parameter 11] = 'weekly'
THEN [Date] >= TODAY()-8 AND [Date] <= TODAY()-1
END",
    "name": "[Calculation_843580506575679492]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Dial R",
    "datatype": "string",
    "formula": "IF  [Called Count] < 4 then "<=3" 
elseif [Called Count] < 8 then "4-7"
elseif [Called Count] < 11 then "8-10"
elseif [Called Count] < 16 then "11-15"
elseif [Called Count] < 20 then "16-19"
elseif [Called Count] < 26 then "20-25"
elseif [Called Count] < 31 then "25-30"
elseif [Called Count] < 36 then "30-35"
else "35+" 
END",
    "name": "[Calculation_847802666706034688]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Dial R (detail)",
    "datatype": "string",
    "formula": "STR([Called Count])",
    "name": "[Calculation_847802666706186241]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Max Date",
    "datatype": "date",
    "formula": "//Updated Date: 18 May 2022
//Updated By: Manish
//Description: Calculating max of todays date for including it in the default values of end date

{MAX(today())}",
    "name": "[Calculation_882424053213511680]",
    "role": "dimension",
    "type": "ordinal",
  },
  {
    "caption": "Filter to Remove Dup Leads",
    "datatype": "boolean",
    "formula": "[Calculation_767300790176440343]={fixed [Phone],[CZ Project Name],[Outcome],[Status]:max([Calculation_767300790176440343])}",
    "name": "[Calculation_987132781714386944]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Source ",
    "datatype": "string",
    "formula": "CASE [Parameters].[Phone (copy)_1255659924007981058]
WHEN "0" THEN "Agg"
WHEN "1" THEN [Source]
END",
    "name": "[Phone (copy)_1255659924007964673]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Start Date",
    "datatype": "date",
    "formula": "#2025-07-30#",
    "name": "[Parameter 5]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "End Date",
    "datatype": "date",
    "formula": "#2025-08-27#",
    "name": "[Parameter 6]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "TTW Grade",
    "datatype": "string",
    "formula": "IF [ttw_qualstatus] = 'ttw-qualified' then 'Grade A'
ELSEIF  [ttw_qualstatus] = 'ttw-nonqualified' and [TTW Explore Work Form] = 'yes' THEN 'Grade B'
ELSEIF [ttw_qualstatus] = 'ttw-nonqualified' and [TTW Explore Work Form] != 'yes' THEN 'Grade C'
ELSEIF ISNULL([ttw_qualstatus]) and [Stage3 Response] = 'Between 2 and 4 years' then 'Grade D'
ELSE 'Rest'
END",
    "name": "[Calculation_1006061976934187009]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "20hrs Disqual",
    "datatype": "integer",
    "formula": "IF [Stage6 Response] = "More than 20 hours per week" THEN 1 ELSE 0 END",
    "name": "[Calculation_1133007210546622464]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Age Disqual",
    "datatype": "integer",
    "formula": "IF INT([Age]) < 40 OR INT([Age]) > 62 THEN 1 ELSE 0 END",
    "name": "[Calculation_1133007210553298946]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Attorney Disqual",
    "datatype": "integer",
    "formula": "IF [Stage5 Response] = "Yes" THEN 1 ELSE 0 END",
    "name": "[Calculation_1133007210553425923]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Ben Disqual",
    "datatype": "integer",
    "formula": "IF IFNULL([Stage1 Response], "") != "I am not receiving any disability benefits (SSD or SSI)"
THEN 1 ELSE 0 END",
    "name": "[Calculation_1133007210553487364]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Doctor Visit Disqual",
    "datatype": "integer",
    "formula": "IF [Stage4 Response] = "No" THEN 1 ELSE 0 END",
    "name": "[Calculation_1133007210553540613]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Five Year Work Disqual",
    "datatype": "integer",
    "formula": "IF [Stage3 Response] = "Less than 2 years"
OR [Stage3 Response] = "Between 2 and 4 years"
THEN 1 ELSE 0 END",
    "name": "[Calculation_1133007210553618438]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Out of Work Disqual",
    "datatype": "integer",
    "formula": "IF [Stage2 Response] = "No" THEN 1 ELSE 0 END",
    "name": "[Calculation_1133007210553663495]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "# of Disqual",
    "datatype": "integer",
    "formula": "ZN([Calculation_1133007210553487364]) +
ZN([Calculation_1133007210553663495]) +
ZN([Calculation_1133007210553618438]) +
ZN([Calculation_1133007210553540613]) +
ZN([Calculation_1133007210553425923]) +
ZN([Calculation_1133007210546622464]) +
ZN([Calculation_1133007210553298946])",
    "name": "[Calculation_1133007210553765896]",
    "role": "dimension",
    "type": "ordinal",
  },
  {
    "caption": "Unresolved SSA Leads",
    "datatype": "string",
    "formula": "IF { FIXED [Phone] : MAX([Resolved Lead]) } = 0 THEN "SSA Unresolved Lead"
ELSEIF { FIXED [Phone] : MAX([Resolved Lead]) } = 1 THEN "SSA Resolved Lead"
END",
    "name": "[Calculation_1467962419029331969]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Post Date ",
    "datatype": "datetime",
    "formula": "//Updated Date: 18 May 2022
//Updated By: Manish
//Description: Formula to calculate UTC date

DATEADD("hour",0,[Post Date])",
    "name": "[Calculation_1916563181826678784]",
    "role": "dimension",
    "type": "ordinal",
  },
  {
    "caption": "rowid",
    "datatype": "integer",
    "formula": "INDEX()",
    "name": "[Calculation_2146317124280909824]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Grade",
    "datatype": "string",
    "formula": "// Grade A
IF [qual_status] = 'all-steps' THEN 'Grade A'

// Grade B
ELSEIF 
    [qual_status] IN ('fiveyrwrk-disqual','outofwrk-disqual','doc-disqual')
    AND [Calculation_1133007210553765896] = 1
THEN 'Grade B'

// Grade C
ELSEIF 
    [qual_status] <> 'age-disqual'
    AND NOT [Stage3 Response] IN ('Less than 2 years', 'Between 2 and 4 years')
    AND [Stage1 Response] <> 'Social Security Disability (SSD) Benefits'
    AND [Stage6 Response] = 'Not working'
THEN 'Grade C'

// Grade D
ELSEIF 
    // 1) Not age-disqual, Stage3 NOT in those two, Stage1 not SSD, Stage6 ≠ Not working, disqual ≤ 1
    (
      [qual_status] <> 'age-disqual'
      AND NOT [Stage3 Response] IN ('Less than 2 years', 'Between 2 and 4 years')
      AND [Stage1 Response] <> 'Social Security Disability (SSD) Benefits'
      AND [Stage6 Response] <> 'Not working'
      AND [Calculation_1133007210553765896] <= 1
    )
    // 2) Not age-disqual, Stage3 in those two, Qual Status = outofwrk-disqual
    OR
    (
      [qual_status] <> 'age-disqual'
      AND [Stage3 Response] IN ('Less than 2 years', 'Between 2 and 4 years')
      AND [qual_status] = 'outofwrk-disqual'
    )
    // 3) Not age-disqual, Stage3 in those two, Qual Status ≠ outofwrk-disqual, Stage7 = Yes
    OR
    (
      [qual_status] <> 'age-disqual'
      AND [Stage3 Response] IN ('Less than 2 years', 'Between 2 and 4 years')
      AND [qual_status] <> 'outofwrk-disqual'
      AND [Stage7 Response] = 'Yes'
    )
THEN 'Grade D'

// Rest (including age-disqual or anything else)
ELSE 'Rest'
END",
    "name": "[Calculation_7573084309404708864]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Today-28",
    "datatype": "date",
    "formula": "//Updated Date: 18 May 2022
//Updated By: Manish
//Description: Going back 28 days from today

({MAX(today()-28)})",
    "name": "[Calculation_767300790172184597]",
    "role": "dimension",
    "type": "ordinal",
  },
  {
    "caption": "Start Time",
    "datatype": "date",
    "formula": "//DATEADD('hour',0,DATEPARSE('MMM dd, yyyy hh:mm:ss',TRIM(SPLIT([LED].[Start Time],' UTC',1))))
DATE([Calculation_1916563181826678784])",
    "name": "[Calculation_767300790176440343]",
    "role": "dimension",
    "type": "ordinal",
  },
  {
    "caption": "Phone (w/o area code)",
    "datatype": "string",
    "formula": "//Updated Date: 18 May 2022
//Updated By: Manish
//Description: Removing the area code from phone numbers

MID([Phone],4)",
    "name": "[Calculation_8176144444085837826]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Dial R",
    "datatype": "string",
    "formula": "IF  [Called Count] < 4 then "<=3" 
elseif [Called Count] < 8 then "4-7"
elseif [Called Count] < 11 then "8-10"
elseif [Called Count] < 16 then "11-15"
elseif [Called Count] < 20 then "16-19"
elseif [Called Count] < 26 then "20-25"
elseif [Called Count] < 31 then "25-30"
elseif [Called Count] < 36 then "30-35"
else "35+" 
END",
    "name": "[Calculation_847802666706034688]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Dial R (detail)",
    "datatype": "string",
    "formula": "STR([Called Count])",
    "name": "[Calculation_847802666706186241]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Max Date",
    "datatype": "date",
    "formula": "//Updated Date: 18 May 2022
//Updated By: Manish
//Description: Calculating max of todays date for including it in the default values of end date

{MAX(today())}",
    "name": "[Calculation_882424053213511680]",
    "role": "dimension",
    "type": "ordinal",
  },
  {
    "caption": "Date Filter with Post Date",
    "datatype": "boolean",
    "formula": "//Updated Date: 18 May 2022
//Updated By: Manish
//Description: Calculation to apply date filter with respect to post time

DATE([Post Date])>=[Parameters].[Parameter 5] AND DATE([Post Date])<=[Parameters].[Parameter 6]",
    "name": "[Date Filter (copy)_1300414413503598592]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "TTW Grade",
    "datatype": "string",
    "formula": "IF [ttw_qualstatus] = 'ttw-qualified' then 'Grade A'
ELSEIF  [ttw_qualstatus] = 'ttw-nonqualified' and [TTW Explore Work Form] = 'yes' THEN 'Grade B'
ELSEIF [ttw_qualstatus] = 'ttw-nonqualified' and [TTW Explore Work Form] != 'yes' THEN 'Grade C'
ELSEIF ISNULL([ttw_qualstatus]) and [Stage3 Response] = 'Between 2 and 4 years' then 'Grade D'
ELSE 'Rest'
END",
    "name": "[Calculation_1006061976934187009]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "20hrs Disqual",
    "datatype": "integer",
    "formula": "IF [Stage6 Response] = "More than 20 hours per week" THEN 1 ELSE 0 END",
    "name": "[Calculation_1133007210546622464]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Age Disqual",
    "datatype": "integer",
    "formula": "IF INT([Age]) < 40 OR INT([Age]) > 62 THEN 1 ELSE 0 END",
    "name": "[Calculation_1133007210553298946]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Attorney Disqual",
    "datatype": "integer",
    "formula": "IF [Stage5 Response] = "Yes" THEN 1 ELSE 0 END",
    "name": "[Calculation_1133007210553425923]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Ben Disqual",
    "datatype": "integer",
    "formula": "IF IFNULL([Stage1 Response], "") != "I am not receiving any disability benefits (SSD or SSI)"
THEN 1 ELSE 0 END",
    "name": "[Calculation_1133007210553487364]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Doctor Visit Disqual",
    "datatype": "integer",
    "formula": "IF [Stage4 Response] = "No" THEN 1 ELSE 0 END",
    "name": "[Calculation_1133007210553540613]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Five Year Work Disqual",
    "datatype": "integer",
    "formula": "IF [Stage3 Response] = "Less than 2 years"
OR [Stage3 Response] = "Between 2 and 4 years"
THEN 1 ELSE 0 END",
    "name": "[Calculation_1133007210553618438]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Out of Work Disqual",
    "datatype": "integer",
    "formula": "IF [Stage2 Response] = "No" THEN 1 ELSE 0 END",
    "name": "[Calculation_1133007210553663495]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "# of Disqual",
    "datatype": "integer",
    "formula": "ZN([Calculation_1133007210553487364]) +
ZN([Calculation_1133007210553663495]) +
ZN([Calculation_1133007210553618438]) +
ZN([Calculation_1133007210553540613]) +
ZN([Calculation_1133007210553425923]) +
ZN([Calculation_1133007210546622464]) +
ZN([Calculation_1133007210553298946])",
    "name": "[Calculation_1133007210553765896]",
    "role": "dimension",
    "type": "ordinal",
  },
  {
    "caption": "Unresolved SSA Leads",
    "datatype": "string",
    "formula": "IF { FIXED [Phone] : MAX([Resolved Lead]) } = 0 THEN "SSA Unresolved Lead"
ELSEIF { FIXED [Phone] : MAX([Resolved Lead]) } = 1 THEN "SSA Resolved Lead"
END",
    "name": "[Calculation_1467962419029331969]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Month",
    "datatype": "string",
    "formula": "//Updated Date: 18 May 2022
//Updated By: Manish
//Description: Concatinating the month and year name from post name

//DATENAME('month', [Post Time])

Left(DATENAME('month',[Calculation_8176144444085592065]), 3)+"-"+DATENAME('year',[Calculation_8176144444085592065])",
    "name": "[Calculation_2146317124290002947]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Leads_userid",
    "datatype": "integer",
    "formula": "//Updated Date: 18 May 2022
//Updated By: Manish
//Description: Calculating the unique count of user ids

COUNTD([User Id])",
    "name": "[Calculation_4201436298028802048]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Source-Month",
    "datatype": "string",
    "formula": "//Updated Date: 18 May 2022
//Updated By: Manish//Description: Calculating max of todays date for including it in the default values of end date
//Description: Concatinating source and month column

[Source]+[Calculation_2146317124290002947]",
    "name": "[Calculation_5504876552026787843]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Grade",
    "datatype": "string",
    "formula": "// Grade A
IF [qual_status] = 'all-steps' THEN 'Grade A'

// Grade B
ELSEIF 
    [qual_status] IN ('fiveyrwrk-disqual','outofwrk-disqual','doc-disqual')
    AND [Calculation_1133007210553765896] = 1
THEN 'Grade B'

// Grade C
ELSEIF 
    [qual_status] <> 'age-disqual'
    AND NOT [Stage3 Response] IN ('Less than 2 years', 'Between 2 and 4 years')
    AND [Stage1 Response] <> 'Social Security Disability (SSD) Benefits'
    AND [Stage6 Response] = 'Not working'
THEN 'Grade C'

// Grade D
ELSEIF 
    // 1) Not age-disqual, Stage3 NOT in those two, Stage1 not SSD, Stage6 ≠ Not working, disqual ≤ 1
    (
      [qual_status] <> 'age-disqual'
      AND NOT [Stage3 Response] IN ('Less than 2 years', 'Between 2 and 4 years')
      AND [Stage1 Response] <> 'Social Security Disability (SSD) Benefits'
      AND [Stage6 Response] <> 'Not working'
      AND [Calculation_1133007210553765896] <= 1
    )
    // 2) Not age-disqual, Stage3 in those two, Qual Status = outofwrk-disqual
    OR
    (
      [qual_status] <> 'age-disqual'
      AND [Stage3 Response] IN ('Less than 2 years', 'Between 2 and 4 years')
      AND [qual_status] = 'outofwrk-disqual'
    )
    // 3) Not age-disqual, Stage3 in those two, Qual Status ≠ outofwrk-disqual, Stage7 = Yes
    OR
    (
      [qual_status] <> 'age-disqual'
      AND [Stage3 Response] IN ('Less than 2 years', 'Between 2 and 4 years')
      AND [qual_status] <> 'outofwrk-disqual'
      AND [Stage7 Response] = 'Yes'
    )
THEN 'Grade D'

// Rest (including age-disqual or anything else)
ELSE 'Rest'
END",
    "name": "[Calculation_7573084309404708864]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Day of Post Date (Copy)",
    "datatype": "date",
    "formula": "//Updated Date: 18 May 2022
//Updated By: Manish
//Description: Formula to include date conversion from UTC to PT

DATE(DATEADD("hour",0,[Post Date]))",
    "name": "[Calculation_8176144444085592065]",
    "role": "dimension",
    "type": "ordinal",
  },
  {
    "caption": "Dial R",
    "datatype": "string",
    "formula": "IF  [Called Count] < 4 then "<=3" 
elseif [Called Count] < 8 then "4-7"
elseif [Called Count] < 11 then "8-10"
elseif [Called Count] < 16 then "11-15"
elseif [Called Count] < 20 then "16-19"
elseif [Called Count] < 26 then "20-25"
elseif [Called Count] < 31 then "25-30"
elseif [Called Count] < 36 then "30-35"
else "35+" 
END",
    "name": "[Calculation_847802666706034688]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Dial R (detail)",
    "datatype": "string",
    "formula": "STR([Called Count])",
    "name": "[Calculation_847802666706186241]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "User Identifier",
    "datatype": "integer",
    "formula": "0",
    "name": "[Parameter 12]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "TTW Grade",
    "datatype": "string",
    "formula": "IF [ttw_qualstatus] = 'ttw-qualified' then 'Grade A'
ELSEIF  [ttw_qualstatus] = 'ttw-nonqualified' and [TTW Explore Work Form] = 'yes' THEN 'Grade B'
ELSEIF [ttw_qualstatus] = 'ttw-nonqualified' and [TTW Explore Work Form] != 'yes' THEN 'Grade C'
ELSEIF ISNULL([ttw_qualstatus]) and [Stage3 Response] = 'Between 2 and 4 years' then 'Grade D'
ELSE 'Rest'
END",
    "name": "[Calculation_1006061976934187009]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Hour of Day",
    "datatype": "string",
    "formula": "IF LEN(STR(DATEPART('hour', [Calculation_1916563181826678784]))) = 1
THEN "0" + STR(DATEPART('hour', [Calculation_1916563181826678784]))
ELSE STR(DATEPART('hour', [Calculation_1916563181826678784]))
END",
    "name": "[Calculation_1113233589182521344]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "20hrs Disqual",
    "datatype": "integer",
    "formula": "IF [Stage6 Response] = "More than 20 hours per week" THEN 1 ELSE 0 END",
    "name": "[Calculation_1133007210546622464]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Age Disqual",
    "datatype": "integer",
    "formula": "IF INT([Age]) < 40 OR INT([Age]) > 62 THEN 1 ELSE 0 END",
    "name": "[Calculation_1133007210553298946]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Attorney Disqual",
    "datatype": "integer",
    "formula": "IF [Stage5 Response] = "Yes" THEN 1 ELSE 0 END",
    "name": "[Calculation_1133007210553425923]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Ben Disqual",
    "datatype": "integer",
    "formula": "IF IFNULL([Stage1 Response], "") != "I am not receiving any disability benefits (SSD or SSI)"
THEN 1 ELSE 0 END",
    "name": "[Calculation_1133007210553487364]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Doctor Visit Disqual",
    "datatype": "integer",
    "formula": "IF [Stage4 Response] = "No" THEN 1 ELSE 0 END",
    "name": "[Calculation_1133007210553540613]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Five Year Work Disqual",
    "datatype": "integer",
    "formula": "IF [Stage3 Response] = "Less than 2 years"
OR [Stage3 Response] = "Between 2 and 4 years"
THEN 1 ELSE 0 END",
    "name": "[Calculation_1133007210553618438]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Out of Work Disqual",
    "datatype": "integer",
    "formula": "IF [Stage2 Response] = "No" THEN 1 ELSE 0 END",
    "name": "[Calculation_1133007210553663495]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "# of Disqual",
    "datatype": "integer",
    "formula": "ZN([Calculation_1133007210553487364]) +
ZN([Calculation_1133007210553663495]) +
ZN([Calculation_1133007210553618438]) +
ZN([Calculation_1133007210553540613]) +
ZN([Calculation_1133007210553425923]) +
ZN([Calculation_1133007210546622464]) +
ZN([Calculation_1133007210553298946])",
    "name": "[Calculation_1133007210553765896]",
    "role": "dimension",
    "type": "ordinal",
  },
  {
    "caption": "Date Filter Last 3 Days",
    "datatype": "boolean",
    "formula": "IF DATE([Post Date])>= TODAY()-3 AND DATE([Post Date])< TODAY() THEN TRUE ELSE FALSE END",
    "name": "[Calculation_1141381032181731330]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Unresolved SSA Leads",
    "datatype": "string",
    "formula": "IF { FIXED [Phone] : MAX([Resolved Lead]) } = 0 THEN "SSA Unresolved Lead"
ELSEIF { FIXED [Phone] : MAX([Resolved Lead]) } = 1 THEN "SSA Resolved Lead"
END",
    "name": "[Calculation_1467962419029331969]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "CZ Post Hour Group",
    "datatype": "string",
    "formula": "IF DATEPART('hour', [Post Date]) >= 0 AND DATEPART('hour', [Post Date]) < 6 THEN 'Pre CC Hours'
ELSEIF DATEPART('hour', [Post Date]) >= 6 AND DATEPART('hour', [Post Date]) < 16 THEN 'CC Hours'
ELSEIF DATEPART('hour', [Post Date]) >= 16 AND DATEPART('hour', [Post Date]) < 24 THEN 'Post CC Hours'
END",
    "name": "[Calculation_1880252886125215747]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Post Date ",
    "datatype": "datetime",
    "formula": "//Updated Date: 18 May 2022
//Updated By: Manish
//Description: Formula to calculate UTC date

DATEADD("hour",0,[Post Date])",
    "name": "[Calculation_1916563181826678784]",
    "role": "dimension",
    "type": "ordinal",
  },
  {
    "caption": "Data Updated On",
    "datatype": "datetime",
    "formula": "{fixed :max([Post Date])}",
    "name": "[Calculation_2010857255412854784]",
    "role": "dimension",
    "type": "ordinal",
  },
  {
    "caption": "Grade",
    "datatype": "string",
    "formula": "// Grade A
IF [qual_status] = 'all-steps' THEN 'Grade A'

// Grade B
ELSEIF 
    [qual_status] IN ('fiveyrwrk-disqual','outofwrk-disqual','doc-disqual')
    AND [Calculation_1133007210553765896] = 1
THEN 'Grade B'

// Grade C
ELSEIF 
    [qual_status] <> 'age-disqual'
    AND NOT [Stage3 Response] IN ('Less than 2 years', 'Between 2 and 4 years')
    AND [Stage1 Response] <> 'Social Security Disability (SSD) Benefits'
    AND [Stage6 Response] = 'Not working'
THEN 'Grade C'

// Grade D
ELSEIF 
    // 1) Not age-disqual, Stage3 NOT in those two, Stage1 not SSD, Stage6 ≠ Not working, disqual ≤ 1
    (
      [qual_status] <> 'age-disqual'
      AND NOT [Stage3 Response] IN ('Less than 2 years', 'Between 2 and 4 years')
      AND [Stage1 Response] <> 'Social Security Disability (SSD) Benefits'
      AND [Stage6 Response] <> 'Not working'
      AND [Calculation_1133007210553765896] <= 1
    )
    // 2) Not age-disqual, Stage3 in those two, Qual Status = outofwrk-disqual
    OR
    (
      [qual_status] <> 'age-disqual'
      AND [Stage3 Response] IN ('Less than 2 years', 'Between 2 and 4 years')
      AND [qual_status] = 'outofwrk-disqual'
    )
    // 3) Not age-disqual, Stage3 in those two, Qual Status ≠ outofwrk-disqual, Stage7 = Yes
    OR
    (
      [qual_status] <> 'age-disqual'
      AND [Stage3 Response] IN ('Less than 2 years', 'Between 2 and 4 years')
      AND [qual_status] <> 'outofwrk-disqual'
      AND [Stage7 Response] = 'Yes'
    )
THEN 'Grade D'

// Rest (including age-disqual or anything else)
ELSE 'Rest'
END",
    "name": "[Calculation_7573084309404708864]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Dial R",
    "datatype": "string",
    "formula": "IF  [Called Count] < 4 then "<=3" 
elseif [Called Count] < 8 then "4-7"
elseif [Called Count] < 11 then "8-10"
elseif [Called Count] < 16 then "11-15"
elseif [Called Count] < 20 then "16-19"
elseif [Called Count] < 26 then "20-25"
elseif [Called Count] < 31 then "25-30"
elseif [Called Count] < 36 then "30-35"
else "35+" 
END",
    "name": "[Calculation_847802666706034688]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Dial R (detail)",
    "datatype": "string",
    "formula": "STR([Called Count])",
    "name": "[Calculation_847802666706186241]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "User Identifier",
    "datatype": "string",
    "formula": "IF [Parameters].[Parameter 12] = 0 THEN [User Id]
ELSEIF [Parameters].[Parameter 12] = 1 THEN [Phone]
END",
    "name": "[Calculation_906349454594166784]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Posted #",
    "datatype": "integer",
    "formula": "//Updated Date: 18 May 2022
//Updated By: Manish
//Description: Calculating the sum of user id wrt to source

countd([Calculation_906349454594166784])",
    "name": "[Calculation_99712551082803223]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Campaign & Source",
    "datatype": "string",
    "formula": "//Updated Date: 24 Aug 2022
//Updated By: Nithin
//Description: Concatinating campaign and Source

[CZ Project Name]+":"+[Source]",
    "name": "[Campaign & Date (copy)_1141381032179245056]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Exclude 2 days before Today",
    "datatype": "string",
    "formula": "IF DATE([Post Date])= TODAY()-1  THEN 'Today'
ELSEIF DATE([Post Date]) = TODAY()-2 THEN 'Yesterday'
ELSEIF DATE([Post Date]) = TODAY()-3 THEN 'Day Before Yesterday'
END",
    "name": "[Date Filter Last 3 Days (copy)_1141381032257052686]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Missing Fields",
    "datatype": "string",
    "formula": ""All"",
    "name": "[Parameter 7]",
    "role": "measure",
    "type": "nominal",
  },
  {
    "caption": "TTW Grade",
    "datatype": "string",
    "formula": "IF [ttw_qualstatus] = 'ttw-qualified' then 'Grade A'
ELSEIF  [ttw_qualstatus] = 'ttw-nonqualified' and [TTW Explore Work Form] = 'yes' THEN 'Grade B'
ELSEIF [ttw_qualstatus] = 'ttw-nonqualified' and [TTW Explore Work Form] != 'yes' THEN 'Grade C'
ELSEIF ISNULL([ttw_qualstatus]) and [Stage3 Response] = 'Between 2 and 4 years' then 'Grade D'
ELSE 'Rest'
END",
    "name": "[Calculation_1006061976934187009]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Missing LastName",
    "datatype": "integer",
    "formula": "COUNT(IF ISNULL([Last Name]) OR [Last Name] = '' THEN [User Id] END)",
    "name": "[Calculation_1022317140785389568]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Missing Fields Mapping",
    "datatype": "integer",
    "formula": "IF [Parameters].[Parameter 7] = 'First Name' THEN [Missing LastName (copy)_1022317140785614849]
ELSEIF [Parameters].[Parameter 7] = 'Last Name' THEN [Calculation_1022317140785389568]
ELSEIF [Parameters].[Parameter 7] = 'City' THEN [Missing LastName (copy)_1022317140785823746]
ELSEIF [Parameters].[Parameter 7] = 'State' THEN [Missing City (copy)_1022317140786008067]
ELSEIF [Parameters].[Parameter 7] = 'IP' THEN [Missing City (copy)_1022317140786180100]
ELSEIF [Parameters].[Parameter 7] = 'Subid' THEN [Missing Zip Code (copy)_1022317140786438149]
ELSEIF [Parameters].[Parameter 7] = 'TF' THEN [Missing Subid (copy)_1022317140787544070]
ELSEIF [Parameters].[Parameter 7] = 'ZipCode' THEN [Missing TF (copy)_1022317140793171977]
ELSEIF [Parameters].[Parameter 7] = 'DOB' THEN [Missing TF (copy)_1022317140793491466]
ELSE [Calculation_2489223969907380226 1]
END",
    "name": "[Calculation_1022317140793761803]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "20hrs Disqual",
    "datatype": "integer",
    "formula": "IF [Stage6 Response] = "More than 20 hours per week" THEN 1 ELSE 0 END",
    "name": "[Calculation_1133007210546622464]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Age Disqual",
    "datatype": "integer",
    "formula": "IF INT([Age]) < 40 OR INT([Age]) > 62 THEN 1 ELSE 0 END",
    "name": "[Calculation_1133007210553298946]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Attorney Disqual",
    "datatype": "integer",
    "formula": "IF [Stage5 Response] = "Yes" THEN 1 ELSE 0 END",
    "name": "[Calculation_1133007210553425923]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Ben Disqual",
    "datatype": "integer",
    "formula": "IF IFNULL([Stage1 Response], "") != "I am not receiving any disability benefits (SSD or SSI)"
THEN 1 ELSE 0 END",
    "name": "[Calculation_1133007210553487364]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Doctor Visit Disqual",
    "datatype": "integer",
    "formula": "IF [Stage4 Response] = "No" THEN 1 ELSE 0 END",
    "name": "[Calculation_1133007210553540613]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Five Year Work Disqual",
    "datatype": "integer",
    "formula": "IF [Stage3 Response] = "Less than 2 years"
OR [Stage3 Response] = "Between 2 and 4 years"
THEN 1 ELSE 0 END",
    "name": "[Calculation_1133007210553618438]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Out of Work Disqual",
    "datatype": "integer",
    "formula": "IF [Stage2 Response] = "No" THEN 1 ELSE 0 END",
    "name": "[Calculation_1133007210553663495]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "# of Disqual",
    "datatype": "integer",
    "formula": "ZN([Calculation_1133007210553487364]) +
ZN([Calculation_1133007210553663495]) +
ZN([Calculation_1133007210553618438]) +
ZN([Calculation_1133007210553540613]) +
ZN([Calculation_1133007210553425923]) +
ZN([Calculation_1133007210546622464]) +
ZN([Calculation_1133007210553298946])",
    "name": "[Calculation_1133007210553765896]",
    "role": "dimension",
    "type": "ordinal",
  },
  {
    "caption": "MF Combination",
    "datatype": "string",
    "formula": "IFNULL(STR([Date]),'')+
IFNULL([User Id],'')+
IFNULL([Phone],'')",
    "name": "[Calculation_1341228293762342914]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Unresolved SSA Leads",
    "datatype": "string",
    "formula": "IF { FIXED [Phone] : MAX([Resolved Lead]) } = 0 THEN "SSA Unresolved Lead"
ELSEIF { FIXED [Phone] : MAX([Resolved Lead]) } = 1 THEN "SSA Resolved Lead"
END",
    "name": "[Calculation_1467962419029331969]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Data Updated On",
    "datatype": "datetime",
    "formula": "{fixed :max([Post Date])}",
    "name": "[Calculation_2010857255412854784]",
    "role": "dimension",
    "type": "ordinal",
  },
  {
    "caption": "Missing Fields with Trusted Form",
    "datatype": "integer",
    "formula": "//Last name, Subid, Zip, City, State by source.


COUNT(IF ISNULL([Last Name]) OR [Last Name] = ''
OR ISNULL([First Name]) OR [First Name] = ''
OR ISNULL([Sub Id]) OR [Sub Id] = '' 
OR ISNULL([Postal Code]) OR [Postal Code] = ''
OR ISNULL([IP]) OR [IP] = ''
OR ISNULL([Trusted Form]) OR [Trusted Form] = ''
OR ISNULL([DOB]) OR [DOB] = ''
OR ISNULL([City]) OR [City] = ''
OR ISNULL([State]) OR [State] = '' THEN [User Id] END)",
    "name": "[Calculation_2489223969907380226 1]",
    "role": "measure",
    "type": "ordinal",
  },
  {
    "caption": "Exclude Aged",
    "datatype": "boolean",
    "formula": "if CONTAINS([CZ Project Name],'Aged') then false else true end",
    "name": "[Calculation_3490641600574599172]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Grade",
    "datatype": "string",
    "formula": "// Grade A
IF [qual_status] = 'all-steps' THEN 'Grade A'

// Grade B
ELSEIF 
    [qual_status] IN ('fiveyrwrk-disqual','outofwrk-disqual','doc-disqual')
    AND [Calculation_1133007210553765896] = 1
THEN 'Grade B'

// Grade C
ELSEIF 
    [qual_status] <> 'age-disqual'
    AND NOT [Stage3 Response] IN ('Less than 2 years', 'Between 2 and 4 years')
    AND [Stage1 Response] <> 'Social Security Disability (SSD) Benefits'
    AND [Stage6 Response] = 'Not working'
THEN 'Grade C'

// Grade D
ELSEIF 
    // 1) Not age-disqual, Stage3 NOT in those two, Stage1 not SSD, Stage6 ≠ Not working, disqual ≤ 1
    (
      [qual_status] <> 'age-disqual'
      AND NOT [Stage3 Response] IN ('Less than 2 years', 'Between 2 and 4 years')
      AND [Stage1 Response] <> 'Social Security Disability (SSD) Benefits'
      AND [Stage6 Response] <> 'Not working'
      AND [Calculation_1133007210553765896] <= 1
    )
    // 2) Not age-disqual, Stage3 in those two, Qual Status = outofwrk-disqual
    OR
    (
      [qual_status] <> 'age-disqual'
      AND [Stage3 Response] IN ('Less than 2 years', 'Between 2 and 4 years')
      AND [qual_status] = 'outofwrk-disqual'
    )
    // 3) Not age-disqual, Stage3 in those two, Qual Status ≠ outofwrk-disqual, Stage7 = Yes
    OR
    (
      [qual_status] <> 'age-disqual'
      AND [Stage3 Response] IN ('Less than 2 years', 'Between 2 and 4 years')
      AND [qual_status] <> 'outofwrk-disqual'
      AND [Stage7 Response] = 'Yes'
    )
THEN 'Grade D'

// Rest (including age-disqual or anything else)
ELSE 'Rest'
END",
    "name": "[Calculation_7573084309404708864]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Dial R",
    "datatype": "string",
    "formula": "IF  [Called Count] < 4 then "<=3" 
elseif [Called Count] < 8 then "4-7"
elseif [Called Count] < 11 then "8-10"
elseif [Called Count] < 16 then "11-15"
elseif [Called Count] < 20 then "16-19"
elseif [Called Count] < 26 then "20-25"
elseif [Called Count] < 31 then "25-30"
elseif [Called Count] < 36 then "30-35"
else "35+" 
END",
    "name": "[Calculation_847802666706034688]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Dial R (detail)",
    "datatype": "string",
    "formula": "STR([Called Count])",
    "name": "[Calculation_847802666706186241]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "TF present",
    "datatype": "integer",
    "formula": "//Updated Date: 18 May 2022
//Updated By: Manish//Description: Calculating max of todays date for including it in the default values of end date
//Description: Checking if trusted form link is present or not

If len([Trusted Form])>0 then 1
else 0
end",
    "name": "[Calculation_97320012555014180]",
    "role": "dimension",
    "type": "ordinal",
  },
  {
    "caption": "Date Filter Yeaterday",
    "datatype": "boolean",
    "formula": "//Updated Date: 18 May 2022
//Updated By: Manish
//Description: Filtering the date wrt yesterday

[Date]=today()-1",
    "name": "[Date Filter (copy)_7495186061619691521]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Missing State",
    "datatype": "integer",
    "formula": "COUNT(IF ISNULL([State]) OR [State] = '' THEN [User Id] END)


//COUNT(IF ISNULL([lastname]) OR [lastname] = ''
//OR ISNULL([subid]) OR [subid] = '' 
//OR ISNULL([postalcode]) OR [postalcode] = ''
//OR ISNULL([city]) OR [city] = ''
//OR ISNULL([state]) OR [state] = '' THEN [userid] END)",
    "name": "[Missing City (copy)_1022317140786008067]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Missing IP",
    "datatype": "integer",
    "formula": "COUNT(IF ISNULL([IP]) OR [IP] = '' THEN [User Id] END)


//COUNT(IF ISNULL([lastname]) OR [lastname] = ''
//OR ISNULL([subid]) OR [subid] = '' 
//OR ISNULL([postalcode]) OR [postalcode] = ''
//OR ISNULL([city]) OR [city] = ''
//OR ISNULL([state]) OR [state] = '' THEN [userid] END)",
    "name": "[Missing City (copy)_1022317140786180100]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Missing First Name",
    "datatype": "integer",
    "formula": "COUNT(IF ISNULL([First Name]) OR [First Name] = '' THEN [User Id] END)


//COUNT(IF ISNULL([lastname]) OR [lastname] = ''
//OR ISNULL([subid]) OR [subid] = '' 
//OR ISNULL([postalcode]) OR [postalcode] = ''
//OR ISNULL([city]) OR [city] = ''
//OR ISNULL([state]) OR [state] = '' THEN [userid] END)",
    "name": "[Missing LastName (copy)_1022317140785614849]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Missing City",
    "datatype": "integer",
    "formula": "COUNT(IF ISNULL([City]) OR [City] = '' THEN [User Id] END)


//COUNT(IF ISNULL([lastname]) OR [lastname] = ''
//OR ISNULL([subid]) OR [subid] = '' 
//OR ISNULL([postalcode]) OR [postalcode] = ''
//OR ISNULL([city]) OR [city] = ''
//OR ISNULL([state]) OR [state] = '' THEN [userid] END)",
    "name": "[Missing LastName (copy)_1022317140785823746]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Missing TF",
    "datatype": "integer",
    "formula": "COUNT(IF ISNULL([Calculation_97320012555014180]) or [Calculation_97320012555014180] = 0 THEN [User Id] END)


//COUNT(IF ISNULL([lastname]) OR [lastname] = ''
//OR ISNULL([subid]) OR [subid] = '' 
//OR ISNULL([postalcode]) OR [postalcode] = ''
//OR ISNULL([city]) OR [city] = ''
//OR ISNULL([state]) OR [state] = '' THEN [userid] END)",
    "name": "[Missing Subid (copy)_1022317140787544070]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Missing PostalCode",
    "datatype": "integer",
    "formula": "COUNT(IF ISNULL([Postal Code]) or [Postal Code] = '' THEN [User Id] END)


//COUNT(IF ISNULL([lastname]) OR [lastname] = ''
//OR ISNULL([subid]) OR [subid] = '' 
//OR ISNULL([postalcode]) OR [postalcode] = ''
//OR ISNULL([city]) OR [city] = ''
//OR ISNULL([state]) OR [state] = '' THEN [userid] END)",
    "name": "[Missing TF (copy)_1022317140793171977]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Missing DOB",
    "datatype": "integer",
    "formula": "COUNT(IF ISNULL([DOB]) or [DOB] = '' THEN [User Id] END)


//COUNT(IF ISNULL([lastname]) OR [lastname] = ''
//OR ISNULL([subid]) OR [subid] = '' 
//OR ISNULL([postalcode]) OR [postalcode] = ''
//OR ISNULL([city]) OR [city] = ''
//OR ISNULL([state]) OR [state] = '' THEN [userid] END)",
    "name": "[Missing TF (copy)_1022317140793491466]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Missing Subid",
    "datatype": "integer",
    "formula": "COUNT(IF ISNULL([Sub Id]) OR [Sub Id] = '' THEN [User Id] END)


//COUNT(IF ISNULL([lastname]) OR [lastname] = ''
//OR ISNULL([subid]) OR [subid] = '' 
//OR ISNULL([postalcode]) OR [postalcode] = ''
//OR ISNULL([city]) OR [city] = ''
//OR ISNULL([state]) OR [state] = '' THEN [userid] END)",
    "name": "[Missing Zip Code (copy)_1022317140786438149]",
    "role": "measure",
    "type": "ordinal",
  },
  {
    "caption": "Date Bucket",
    "datatype": "string",
    "formula": ""day"",
    "name": "[Parameter 1]",
    "role": "measure",
    "type": "nominal",
  },
  {
    "caption": "TTW Grade",
    "datatype": "string",
    "formula": "IF [ttw_qualstatus] = 'ttw-qualified' then 'Grade A'
ELSEIF  [ttw_qualstatus] = 'ttw-nonqualified' and [TTW Explore Work Form] = 'yes' THEN 'Grade B'
ELSEIF [ttw_qualstatus] = 'ttw-nonqualified' and [TTW Explore Work Form] != 'yes' THEN 'Grade C'
ELSEIF ISNULL([ttw_qualstatus]) and [Stage3 Response] = 'Between 2 and 4 years' then 'Grade D'
ELSE 'Rest'
END",
    "name": "[Calculation_1006061976934187009]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "20hrs Disqual",
    "datatype": "integer",
    "formula": "IF [Stage6 Response] = "More than 20 hours per week" THEN 1 ELSE 0 END",
    "name": "[Calculation_1133007210546622464]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Age Disqual",
    "datatype": "integer",
    "formula": "IF INT([Age]) < 40 OR INT([Age]) > 62 THEN 1 ELSE 0 END",
    "name": "[Calculation_1133007210553298946]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Attorney Disqual",
    "datatype": "integer",
    "formula": "IF [Stage5 Response] = "Yes" THEN 1 ELSE 0 END",
    "name": "[Calculation_1133007210553425923]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Ben Disqual",
    "datatype": "integer",
    "formula": "IF IFNULL([Stage1 Response], "") != "I am not receiving any disability benefits (SSD or SSI)"
THEN 1 ELSE 0 END",
    "name": "[Calculation_1133007210553487364]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Doctor Visit Disqual",
    "datatype": "integer",
    "formula": "IF [Stage4 Response] = "No" THEN 1 ELSE 0 END",
    "name": "[Calculation_1133007210553540613]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Five Year Work Disqual",
    "datatype": "integer",
    "formula": "IF [Stage3 Response] = "Less than 2 years"
OR [Stage3 Response] = "Between 2 and 4 years"
THEN 1 ELSE 0 END",
    "name": "[Calculation_1133007210553618438]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Out of Work Disqual",
    "datatype": "integer",
    "formula": "IF [Stage2 Response] = "No" THEN 1 ELSE 0 END",
    "name": "[Calculation_1133007210553663495]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "# of Disqual",
    "datatype": "integer",
    "formula": "ZN([Calculation_1133007210553487364]) +
ZN([Calculation_1133007210553663495]) +
ZN([Calculation_1133007210553618438]) +
ZN([Calculation_1133007210553540613]) +
ZN([Calculation_1133007210553425923]) +
ZN([Calculation_1133007210546622464]) +
ZN([Calculation_1133007210553298946])",
    "name": "[Calculation_1133007210553765896]",
    "role": "dimension",
    "type": "ordinal",
  },
  {
    "caption": "Unresolved SSA Leads",
    "datatype": "string",
    "formula": "IF { FIXED [Phone] : MAX([Resolved Lead]) } = 0 THEN "SSA Unresolved Lead"
ELSEIF { FIXED [Phone] : MAX([Resolved Lead]) } = 1 THEN "SSA Resolved Lead"
END",
    "name": "[Calculation_1467962419029331969]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Post Date ",
    "datatype": "datetime",
    "formula": "//Updated Date: 18 May 2022
//Updated By: Manish
//Description: Formula to calculate UTC date

DATEADD("hour",0,[Post Date])",
    "name": "[Calculation_1916563181826678784]",
    "role": "dimension",
    "type": "ordinal",
  },
  {
    "caption": "Data Updated On",
    "datatype": "datetime",
    "formula": "{fixed :max([Post Date])}",
    "name": "[Calculation_2010857255412854784]",
    "role": "dimension",
    "type": "ordinal",
  },
  {
    "caption": "Grade",
    "datatype": "string",
    "formula": "// Grade A
IF [qual_status] = 'all-steps' THEN 'Grade A'

// Grade B
ELSEIF 
    [qual_status] IN ('fiveyrwrk-disqual','outofwrk-disqual','doc-disqual')
    AND [Calculation_1133007210553765896] = 1
THEN 'Grade B'

// Grade C
ELSEIF 
    [qual_status] <> 'age-disqual'
    AND NOT [Stage3 Response] IN ('Less than 2 years', 'Between 2 and 4 years')
    AND [Stage1 Response] <> 'Social Security Disability (SSD) Benefits'
    AND [Stage6 Response] = 'Not working'
THEN 'Grade C'

// Grade D
ELSEIF 
    // 1) Not age-disqual, Stage3 NOT in those two, Stage1 not SSD, Stage6 ≠ Not working, disqual ≤ 1
    (
      [qual_status] <> 'age-disqual'
      AND NOT [Stage3 Response] IN ('Less than 2 years', 'Between 2 and 4 years')
      AND [Stage1 Response] <> 'Social Security Disability (SSD) Benefits'
      AND [Stage6 Response] <> 'Not working'
      AND [Calculation_1133007210553765896] <= 1
    )
    // 2) Not age-disqual, Stage3 in those two, Qual Status = outofwrk-disqual
    OR
    (
      [qual_status] <> 'age-disqual'
      AND [Stage3 Response] IN ('Less than 2 years', 'Between 2 and 4 years')
      AND [qual_status] = 'outofwrk-disqual'
    )
    // 3) Not age-disqual, Stage3 in those two, Qual Status ≠ outofwrk-disqual, Stage7 = Yes
    OR
    (
      [qual_status] <> 'age-disqual'
      AND [Stage3 Response] IN ('Less than 2 years', 'Between 2 and 4 years')
      AND [qual_status] <> 'outofwrk-disqual'
      AND [Stage7 Response] = 'Yes'
    )
THEN 'Grade D'

// Rest (including age-disqual or anything else)
ELSE 'Rest'
END",
    "name": "[Calculation_7573084309404708864]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Time-Source-Subid",
    "datatype": "string",
    "formula": "//Updated Date: 18 May 2022
//Updated By: Manish
//Description: Changing the data type to string of Time-Source-Subid column

STR([Date])+'-'+[Source]+'-'+[Sub Id]",
    "name": "[Calculation_7746824680808361990]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Dial R",
    "datatype": "string",
    "formula": "IF  [Called Count] < 4 then "<=3" 
elseif [Called Count] < 8 then "4-7"
elseif [Called Count] < 11 then "8-10"
elseif [Called Count] < 16 then "11-15"
elseif [Called Count] < 20 then "16-19"
elseif [Called Count] < 26 then "20-25"
elseif [Called Count] < 31 then "25-30"
elseif [Called Count] < 36 then "30-35"
else "35+" 
END",
    "name": "[Calculation_847802666706034688]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Dial R (detail)",
    "datatype": "string",
    "formula": "STR([Called Count])",
    "name": "[Calculation_847802666706186241]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Post Date  ",
    "datatype": "string",
    "formula": "//Updated Date: 18 May 2022
//Updated By: Manish
//Description: Calculation to apply date bucket

CASE [Parameters].[Parameter 1]
WHEN 'year' THEN str(datepart('year', [Calculation_1916563181826678784]))
WHEN 'quarter' THEN "Q" + str(datepart('quarter', [Calculation_1916563181826678784])) + " " + str(datepart('year', [Calculation_1916563181826678784]))
WHEN 'month' THEN str(datepart('month', [Calculation_1916563181826678784])) + "-" + str(datepart('year', [Calculation_1916563181826678784]))
WHEN 'day' THEN str(DATENAME('month', [Calculation_1916563181826678784]))+ "-" +str(datepart('day', [Calculation_1916563181826678784]))+ "-" + str(datepart('year', [Calculation_1916563181826678784]))
WHEN 'week' THEN "W" + str(datepart('week', [Calculation_1916563181826678784])) + "-" + str(datepart('year', [Calculation_1916563181826678784]))
WHEN "hour" THEN str(DATETRUNC('hour', [Calculation_1916563181826678784]))
WHEN "minute" THEN str(DATETRUNC('minute', [Calculation_1916563181826678784]))
END",
    "name": "[Calculation_97320012552925214]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Source - Date",
    "datatype": "string",
    "formula": "//Updated Date: 18 May 2022
//Updated By: Manish//Description: Calculating max of todays date for including it in the default values of end date
//Description: Concatinating source and date column

[Source]+":"+[Calculation_97320012552925214]",
    "name": "[Calculation_99712551088799768]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Date Filter Yeaterday",
    "datatype": "boolean",
    "formula": "//Updated Date: 18 May 2022
//Updated By: Manish
//Description: Filtering the date wrt yesterday

[Date]=today()-1",
    "name": "[Date Filter (copy)_7495186061619691521]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "TTW Grade",
    "datatype": "string",
    "formula": "IF [ttw_qualstatus] = 'ttw-qualified' then 'Grade A'
ELSEIF  [ttw_qualstatus] = 'ttw-nonqualified' and [TTW Explore Work Form] = 'yes' THEN 'Grade B'
ELSEIF [ttw_qualstatus] = 'ttw-nonqualified' and [TTW Explore Work Form] != 'yes' THEN 'Grade C'
ELSEIF ISNULL([ttw_qualstatus]) and [Stage3 Response] = 'Between 2 and 4 years' then 'Grade D'
ELSE 'Rest'
END",
    "name": "[Calculation_1006061976934187009]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Missing LastName",
    "datatype": "integer",
    "formula": "COUNT(IF ISNULL([Last Name]) OR [Last Name] = '' THEN [User Id] END)",
    "name": "[Calculation_1022317140785389568]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "20hrs Disqual",
    "datatype": "integer",
    "formula": "IF [Stage6 Response] = "More than 20 hours per week" THEN 1 ELSE 0 END",
    "name": "[Calculation_1133007210546622464]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Age Disqual",
    "datatype": "integer",
    "formula": "IF INT([Age]) < 40 OR INT([Age]) > 62 THEN 1 ELSE 0 END",
    "name": "[Calculation_1133007210553298946]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Attorney Disqual",
    "datatype": "integer",
    "formula": "IF [Stage5 Response] = "Yes" THEN 1 ELSE 0 END",
    "name": "[Calculation_1133007210553425923]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Ben Disqual",
    "datatype": "integer",
    "formula": "IF IFNULL([Stage1 Response], "") != "I am not receiving any disability benefits (SSD or SSI)"
THEN 1 ELSE 0 END",
    "name": "[Calculation_1133007210553487364]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Doctor Visit Disqual",
    "datatype": "integer",
    "formula": "IF [Stage4 Response] = "No" THEN 1 ELSE 0 END",
    "name": "[Calculation_1133007210553540613]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Five Year Work Disqual",
    "datatype": "integer",
    "formula": "IF [Stage3 Response] = "Less than 2 years"
OR [Stage3 Response] = "Between 2 and 4 years"
THEN 1 ELSE 0 END",
    "name": "[Calculation_1133007210553618438]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Out of Work Disqual",
    "datatype": "integer",
    "formula": "IF [Stage2 Response] = "No" THEN 1 ELSE 0 END",
    "name": "[Calculation_1133007210553663495]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "# of Disqual",
    "datatype": "integer",
    "formula": "ZN([Calculation_1133007210553487364]) +
ZN([Calculation_1133007210553663495]) +
ZN([Calculation_1133007210553618438]) +
ZN([Calculation_1133007210553540613]) +
ZN([Calculation_1133007210553425923]) +
ZN([Calculation_1133007210546622464]) +
ZN([Calculation_1133007210553298946])",
    "name": "[Calculation_1133007210553765896]",
    "role": "dimension",
    "type": "ordinal",
  },
  {
    "caption": "Unresolved SSA Leads",
    "datatype": "string",
    "formula": "IF { FIXED [Phone] : MAX([Resolved Lead]) } = 0 THEN "SSA Unresolved Lead"
ELSEIF { FIXED [Phone] : MAX([Resolved Lead]) } = 1 THEN "SSA Resolved Lead"
END",
    "name": "[Calculation_1467962419029331969]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Data Updated On",
    "datatype": "datetime",
    "formula": "{fixed :max([Post Date])}",
    "name": "[Calculation_2010857255412854784]",
    "role": "dimension",
    "type": "ordinal",
  },
  {
    "caption": "Exclude Aged",
    "datatype": "boolean",
    "formula": "if CONTAINS([CZ Project Name],'Aged') then false else true end",
    "name": "[Calculation_3490641600574599172]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Grade",
    "datatype": "string",
    "formula": "// Grade A
IF [qual_status] = 'all-steps' THEN 'Grade A'

// Grade B
ELSEIF 
    [qual_status] IN ('fiveyrwrk-disqual','outofwrk-disqual','doc-disqual')
    AND [Calculation_1133007210553765896] = 1
THEN 'Grade B'

// Grade C
ELSEIF 
    [qual_status] <> 'age-disqual'
    AND NOT [Stage3 Response] IN ('Less than 2 years', 'Between 2 and 4 years')
    AND [Stage1 Response] <> 'Social Security Disability (SSD) Benefits'
    AND [Stage6 Response] = 'Not working'
THEN 'Grade C'

// Grade D
ELSEIF 
    // 1) Not age-disqual, Stage3 NOT in those two, Stage1 not SSD, Stage6 ≠ Not working, disqual ≤ 1
    (
      [qual_status] <> 'age-disqual'
      AND NOT [Stage3 Response] IN ('Less than 2 years', 'Between 2 and 4 years')
      AND [Stage1 Response] <> 'Social Security Disability (SSD) Benefits'
      AND [Stage6 Response] <> 'Not working'
      AND [Calculation_1133007210553765896] <= 1
    )
    // 2) Not age-disqual, Stage3 in those two, Qual Status = outofwrk-disqual
    OR
    (
      [qual_status] <> 'age-disqual'
      AND [Stage3 Response] IN ('Less than 2 years', 'Between 2 and 4 years')
      AND [qual_status] = 'outofwrk-disqual'
    )
    // 3) Not age-disqual, Stage3 in those two, Qual Status ≠ outofwrk-disqual, Stage7 = Yes
    OR
    (
      [qual_status] <> 'age-disqual'
      AND [Stage3 Response] IN ('Less than 2 years', 'Between 2 and 4 years')
      AND [qual_status] <> 'outofwrk-disqual'
      AND [Stage7 Response] = 'Yes'
    )
THEN 'Grade D'

// Rest (including age-disqual or anything else)
ELSE 'Rest'
END",
    "name": "[Calculation_7573084309404708864]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Dial R",
    "datatype": "string",
    "formula": "IF  [Called Count] < 4 then "<=3" 
elseif [Called Count] < 8 then "4-7"
elseif [Called Count] < 11 then "8-10"
elseif [Called Count] < 16 then "11-15"
elseif [Called Count] < 20 then "16-19"
elseif [Called Count] < 26 then "20-25"
elseif [Called Count] < 31 then "25-30"
elseif [Called Count] < 36 then "30-35"
else "35+" 
END",
    "name": "[Calculation_847802666706034688]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Dial R (detail)",
    "datatype": "string",
    "formula": "STR([Called Count])",
    "name": "[Calculation_847802666706186241]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "TF present",
    "datatype": "integer",
    "formula": "//Updated Date: 18 May 2022
//Updated By: Manish//Description: Calculating max of todays date for including it in the default values of end date
//Description: Checking if trusted form link is present or not

If len([Trusted Form])>0 then 1
else 0
end",
    "name": "[Calculation_97320012555014180]",
    "role": "dimension",
    "type": "ordinal",
  },
  {
    "caption": "Date Filter Yeaterday",
    "datatype": "boolean",
    "formula": "//Updated Date: 18 May 2022
//Updated By: Manish
//Description: Filtering the date wrt yesterday

[Date]=today()-1",
    "name": "[Date Filter (copy)_7495186061619691521]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Missing State",
    "datatype": "integer",
    "formula": "COUNT(IF ISNULL([State]) OR [State] = '' THEN [User Id] END)


//COUNT(IF ISNULL([lastname]) OR [lastname] = ''
//OR ISNULL([subid]) OR [subid] = '' 
//OR ISNULL([postalcode]) OR [postalcode] = ''
//OR ISNULL([city]) OR [city] = ''
//OR ISNULL([state]) OR [state] = '' THEN [userid] END)",
    "name": "[Missing City (copy)_1022317140786008067]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Missing IP",
    "datatype": "integer",
    "formula": "COUNT(IF ISNULL([IP]) OR [IP] = '' THEN [User Id] END)


//COUNT(IF ISNULL([lastname]) OR [lastname] = ''
//OR ISNULL([subid]) OR [subid] = '' 
//OR ISNULL([postalcode]) OR [postalcode] = ''
//OR ISNULL([city]) OR [city] = ''
//OR ISNULL([state]) OR [state] = '' THEN [userid] END)",
    "name": "[Missing City (copy)_1022317140786180100]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Missing First Name",
    "datatype": "integer",
    "formula": "COUNT(IF ISNULL([First Name]) OR [First Name] = '' THEN [User Id] END)


//COUNT(IF ISNULL([lastname]) OR [lastname] = ''
//OR ISNULL([subid]) OR [subid] = '' 
//OR ISNULL([postalcode]) OR [postalcode] = ''
//OR ISNULL([city]) OR [city] = ''
//OR ISNULL([state]) OR [state] = '' THEN [userid] END)",
    "name": "[Missing LastName (copy)_1022317140785614849]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Missing City",
    "datatype": "integer",
    "formula": "COUNT(IF ISNULL([City]) OR [City] = '' THEN [User Id] END)


//COUNT(IF ISNULL([lastname]) OR [lastname] = ''
//OR ISNULL([subid]) OR [subid] = '' 
//OR ISNULL([postalcode]) OR [postalcode] = ''
//OR ISNULL([city]) OR [city] = ''
//OR ISNULL([state]) OR [state] = '' THEN [userid] END)",
    "name": "[Missing LastName (copy)_1022317140785823746]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Missing TF",
    "datatype": "integer",
    "formula": "COUNT(IF ISNULL([Calculation_97320012555014180]) or [Calculation_97320012555014180] = 0 THEN [User Id] END)


//COUNT(IF ISNULL([lastname]) OR [lastname] = ''
//OR ISNULL([subid]) OR [subid] = '' 
//OR ISNULL([postalcode]) OR [postalcode] = ''
//OR ISNULL([city]) OR [city] = ''
//OR ISNULL([state]) OR [state] = '' THEN [userid] END)",
    "name": "[Missing Subid (copy)_1022317140787544070]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Missing PostalCode",
    "datatype": "integer",
    "formula": "COUNT(IF ISNULL([Postal Code]) or [Postal Code] = '' THEN [User Id] END)


//COUNT(IF ISNULL([lastname]) OR [lastname] = ''
//OR ISNULL([subid]) OR [subid] = '' 
//OR ISNULL([postalcode]) OR [postalcode] = ''
//OR ISNULL([city]) OR [city] = ''
//OR ISNULL([state]) OR [state] = '' THEN [userid] END)",
    "name": "[Missing TF (copy)_1022317140793171977]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Missing DOB",
    "datatype": "integer",
    "formula": "COUNT(IF ISNULL([DOB]) or [DOB] = '' THEN [User Id] END)


//COUNT(IF ISNULL([lastname]) OR [lastname] = ''
//OR ISNULL([subid]) OR [subid] = '' 
//OR ISNULL([postalcode]) OR [postalcode] = ''
//OR ISNULL([city]) OR [city] = ''
//OR ISNULL([state]) OR [state] = '' THEN [userid] END)",
    "name": "[Missing TF (copy)_1022317140793491466]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Missing Subid",
    "datatype": "integer",
    "formula": "COUNT(IF ISNULL([Sub Id]) OR [Sub Id] = '' THEN [User Id] END)


//COUNT(IF ISNULL([lastname]) OR [lastname] = ''
//OR ISNULL([subid]) OR [subid] = '' 
//OR ISNULL([postalcode]) OR [postalcode] = ''
//OR ISNULL([city]) OR [city] = ''
//OR ISNULL([state]) OR [state] = '' THEN [userid] END)",
    "name": "[Missing Zip Code (copy)_1022317140786438149]",
    "role": "measure",
    "type": "ordinal",
  },
  {
    "caption": "Helper Date",
    "datatype": "string",
    "formula": ""default"",
    "name": "[Parameter 11]",
    "role": "measure",
    "type": "nominal",
  },
  {
    "caption": "Date Bucket",
    "datatype": "string",
    "formula": ""day"",
    "name": "[Parameter 1]",
    "role": "measure",
    "type": "nominal",
  },
  {
    "caption": "Start Date",
    "datatype": "date",
    "formula": "#2025-07-30#",
    "name": "[Parameter 5]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "End Date",
    "datatype": "date",
    "formula": "#2025-08-27#",
    "name": "[Parameter 6]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "TTW Grade",
    "datatype": "string",
    "formula": "IF [ttw_qualstatus] = 'ttw-qualified' then 'Grade A'
ELSEIF  [ttw_qualstatus] = 'ttw-nonqualified' and [TTW Explore Work Form] = 'yes' THEN 'Grade B'
ELSEIF [ttw_qualstatus] = 'ttw-nonqualified' and [TTW Explore Work Form] != 'yes' THEN 'Grade C'
ELSEIF ISNULL([ttw_qualstatus]) and [Stage3 Response] = 'Between 2 and 4 years' then 'Grade D'
ELSE 'Rest'
END",
    "name": "[Calculation_1006061976934187009]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Hour of Day",
    "datatype": "string",
    "formula": "IF LEN(STR(DATEPART('hour', [Calculation_1916563181826678784]))) = 1
THEN "0" + STR(DATEPART('hour', [Calculation_1916563181826678784]))
ELSE STR(DATEPART('hour', [Calculation_1916563181826678784]))
END",
    "name": "[Calculation_1113233589182521344]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "20hrs Disqual",
    "datatype": "integer",
    "formula": "IF [Stage6 Response] = "More than 20 hours per week" THEN 1 ELSE 0 END",
    "name": "[Calculation_1133007210546622464]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Age Disqual",
    "datatype": "integer",
    "formula": "IF INT([Age]) < 40 OR INT([Age]) > 62 THEN 1 ELSE 0 END",
    "name": "[Calculation_1133007210553298946]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Attorney Disqual",
    "datatype": "integer",
    "formula": "IF [Stage5 Response] = "Yes" THEN 1 ELSE 0 END",
    "name": "[Calculation_1133007210553425923]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Ben Disqual",
    "datatype": "integer",
    "formula": "IF IFNULL([Stage1 Response], "") != "I am not receiving any disability benefits (SSD or SSI)"
THEN 1 ELSE 0 END",
    "name": "[Calculation_1133007210553487364]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Doctor Visit Disqual",
    "datatype": "integer",
    "formula": "IF [Stage4 Response] = "No" THEN 1 ELSE 0 END",
    "name": "[Calculation_1133007210553540613]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Five Year Work Disqual",
    "datatype": "integer",
    "formula": "IF [Stage3 Response] = "Less than 2 years"
OR [Stage3 Response] = "Between 2 and 4 years"
THEN 1 ELSE 0 END",
    "name": "[Calculation_1133007210553618438]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Out of Work Disqual",
    "datatype": "integer",
    "formula": "IF [Stage2 Response] = "No" THEN 1 ELSE 0 END",
    "name": "[Calculation_1133007210553663495]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "# of Disqual",
    "datatype": "integer",
    "formula": "ZN([Calculation_1133007210553487364]) +
ZN([Calculation_1133007210553663495]) +
ZN([Calculation_1133007210553618438]) +
ZN([Calculation_1133007210553540613]) +
ZN([Calculation_1133007210553425923]) +
ZN([Calculation_1133007210546622464]) +
ZN([Calculation_1133007210553298946])",
    "name": "[Calculation_1133007210553765896]",
    "role": "dimension",
    "type": "ordinal",
  },
  {
    "caption": "Month - Year",
    "datatype": "string",
    "formula": "DATENAME('month',[Post Date])+' '+ STR(YEAR([Post Date]))",
    "name": "[Calculation_1232578966341357571]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Leads Missing in Vici #",
    "datatype": "integer",
    "formula": "COUNTD(if isnull([Vici User Flag]) 
and [Status] != "CONVERTED" 
and [Status] != "STOP" then [User Id] end)",
    "name": "[Calculation_1419196839344672769]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Unresolved SSA Leads",
    "datatype": "string",
    "formula": "IF { FIXED [Phone] : MAX([Resolved Lead]) } = 0 THEN "SSA Unresolved Lead"
ELSEIF { FIXED [Phone] : MAX([Resolved Lead]) } = 1 THEN "SSA Resolved Lead"
END",
    "name": "[Calculation_1467962419029331969]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "CZ Post Hour Group",
    "datatype": "string",
    "formula": "IF DATEPART('hour', [Post Date]) >= 0 AND DATEPART('hour', [Post Date]) < 6 THEN 'Pre CC Hours'
ELSEIF DATEPART('hour', [Post Date]) >= 6 AND DATEPART('hour', [Post Date]) < 16 THEN 'CC Hours'
ELSEIF DATEPART('hour', [Post Date]) >= 16 AND DATEPART('hour', [Post Date]) < 24 THEN 'Post CC Hours'
END",
    "name": "[Calculation_1880252886125215747]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Post Date ",
    "datatype": "datetime",
    "formula": "//Updated Date: 18 May 2022
//Updated By: Manish
//Description: Formula to calculate UTC date

DATEADD("hour",0,[Post Date])",
    "name": "[Calculation_1916563181826678784]",
    "role": "dimension",
    "type": "ordinal",
  },
  {
    "caption": "Data Updated On",
    "datatype": "datetime",
    "formula": "{fixed :max([Post Date])}",
    "name": "[Calculation_2010857255412854784]",
    "role": "dimension",
    "type": "ordinal",
  },
  {
    "caption": "% Missing in Vici",
    "datatype": "real",
    "formula": "[Calculation_1419196839344672769]/sum({exclude [CZ Project Name]:[Calculation_97320012564762668]})",
    "name": "[Calculation_5751800461652443136]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Project Type",
    "datatype": "string",
    "formula": "IF CONTAINS([CZ Project Name],'Aged') THEN 'Aged'
ELSE 'Live' END",
    "name": "[Calculation_5872834692856524810]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Grade",
    "datatype": "string",
    "formula": "// Grade A
IF [qual_status] = 'all-steps' THEN 'Grade A'

// Grade B
ELSEIF 
    [qual_status] IN ('fiveyrwrk-disqual','outofwrk-disqual','doc-disqual')
    AND [Calculation_1133007210553765896] = 1
THEN 'Grade B'

// Grade C
ELSEIF 
    [qual_status] <> 'age-disqual'
    AND NOT [Stage3 Response] IN ('Less than 2 years', 'Between 2 and 4 years')
    AND [Stage1 Response] <> 'Social Security Disability (SSD) Benefits'
    AND [Stage6 Response] = 'Not working'
THEN 'Grade C'

// Grade D
ELSEIF 
    // 1) Not age-disqual, Stage3 NOT in those two, Stage1 not SSD, Stage6 ≠ Not working, disqual ≤ 1
    (
      [qual_status] <> 'age-disqual'
      AND NOT [Stage3 Response] IN ('Less than 2 years', 'Between 2 and 4 years')
      AND [Stage1 Response] <> 'Social Security Disability (SSD) Benefits'
      AND [Stage6 Response] <> 'Not working'
      AND [Calculation_1133007210553765896] <= 1
    )
    // 2) Not age-disqual, Stage3 in those two, Qual Status = outofwrk-disqual
    OR
    (
      [qual_status] <> 'age-disqual'
      AND [Stage3 Response] IN ('Less than 2 years', 'Between 2 and 4 years')
      AND [qual_status] = 'outofwrk-disqual'
    )
    // 3) Not age-disqual, Stage3 in those two, Qual Status ≠ outofwrk-disqual, Stage7 = Yes
    OR
    (
      [qual_status] <> 'age-disqual'
      AND [Stage3 Response] IN ('Less than 2 years', 'Between 2 and 4 years')
      AND [qual_status] <> 'outofwrk-disqual'
      AND [Stage7 Response] = 'Yes'
    )
THEN 'Grade D'

// Rest (including age-disqual or anything else)
ELSE 'Rest'
END",
    "name": "[Calculation_7573084309404708864]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Today-28",
    "datatype": "date",
    "formula": "//Updated Date: 18 May 2022
//Updated By: Manish
//Description: Going back 28 days from today

({MAX(today()-28)})",
    "name": "[Calculation_767300790172184597]",
    "role": "dimension",
    "type": "ordinal",
  },
  {
    "caption": "Date Filter",
    "datatype": "boolean",
    "formula": "//Updated Date: 18 May 2022
//Updated By: Manish
//Description: Filtering data based on date

IF [Parameters].[Parameter 11] = 'default'
THEN [Date]>=[Parameters].[Parameter 5] AND [Date]<=[Parameters].[Parameter 6]
ELSEIF [Parameters].[Parameter 11] = 'weekly'
THEN [Date] >= TODAY()-8 AND [Date] <= TODAY()-1
END",
    "name": "[Calculation_843580506575679492]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Dial R",
    "datatype": "string",
    "formula": "IF  [Called Count] < 4 then "<=3" 
elseif [Called Count] < 8 then "4-7"
elseif [Called Count] < 11 then "8-10"
elseif [Called Count] < 16 then "11-15"
elseif [Called Count] < 20 then "16-19"
elseif [Called Count] < 26 then "20-25"
elseif [Called Count] < 31 then "25-30"
elseif [Called Count] < 36 then "30-35"
else "35+" 
END",
    "name": "[Calculation_847802666706034688]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Dial R (detail)",
    "datatype": "string",
    "formula": "STR([Called Count])",
    "name": "[Calculation_847802666706186241]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Max Date",
    "datatype": "date",
    "formula": "//Updated Date: 18 May 2022
//Updated By: Manish
//Description: Calculating max of todays date for including it in the default values of end date

{MAX(today())}",
    "name": "[Calculation_882424053213511680]",
    "role": "dimension",
    "type": "ordinal",
  },
  {
    "caption": "Alt. Branding",
    "datatype": "string",
    "formula": "If int(Right([Phone],2))<30 and [Calculation_5872834692856524810]= 'Live' then 'Yes' else 'No' End",
    "name": "[Calculation_935059914517495808]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Post Date  ",
    "datatype": "string",
    "formula": "//Updated Date: 18 May 2022
//Updated By: Manish
//Description: Calculation to apply date bucket

CASE [Parameters].[Parameter 1]
WHEN 'year' THEN str(datepart('year', [Calculation_1916563181826678784]))
WHEN 'quarter' THEN "Q" + str(datepart('quarter', [Calculation_1916563181826678784])) + " " + str(datepart('year', [Calculation_1916563181826678784]))
WHEN 'month' THEN str(datepart('month', [Calculation_1916563181826678784])) + "-" + str(datepart('year', [Calculation_1916563181826678784]))
WHEN 'day' THEN str(DATENAME('month', [Calculation_1916563181826678784]))+ "-" +str(datepart('day', [Calculation_1916563181826678784]))+ "-" + str(datepart('year', [Calculation_1916563181826678784]))
WHEN 'week' THEN "W" + str(datepart('week', [Calculation_1916563181826678784])) + "-" + str(datepart('year', [Calculation_1916563181826678784]))
WHEN "hour" THEN str(DATETRUNC('hour', [Calculation_1916563181826678784]))
WHEN "minute" THEN str(DATETRUNC('minute', [Calculation_1916563181826678784]))
END",
    "name": "[Calculation_97320012552925214]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Lead",
    "datatype": "integer",
    "formula": "//Updated Date: 18 May 2022
//Updated By: Manish
//Description: Calculating the unique count of user ids

COUNTD([User Id])",
    "name": "[Calculation_97320012564762668]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Age Exclusions",
    "datatype": "string",
    "formula": "[Age Range]",
    "name": "[age range (copy)_99712551094624281]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Helper Date",
    "datatype": "string",
    "formula": ""default"",
    "name": "[Parameter 11]",
    "role": "measure",
    "type": "nominal",
  },
  {
    "caption": "Date Bucket",
    "datatype": "string",
    "formula": ""day"",
    "name": "[Parameter 1]",
    "role": "measure",
    "type": "nominal",
  },
  {
    "caption": "Start Date",
    "datatype": "date",
    "formula": "#2025-07-30#",
    "name": "[Parameter 5]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "End Date",
    "datatype": "date",
    "formula": "#2025-08-27#",
    "name": "[Parameter 6]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "TTW Grade",
    "datatype": "string",
    "formula": "IF [ttw_qualstatus] = 'ttw-qualified' then 'Grade A'
ELSEIF  [ttw_qualstatus] = 'ttw-nonqualified' and [TTW Explore Work Form] = 'yes' THEN 'Grade B'
ELSEIF [ttw_qualstatus] = 'ttw-nonqualified' and [TTW Explore Work Form] != 'yes' THEN 'Grade C'
ELSEIF ISNULL([ttw_qualstatus]) and [Stage3 Response] = 'Between 2 and 4 years' then 'Grade D'
ELSE 'Rest'
END",
    "name": "[Calculation_1006061976934187009]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Hour of Day",
    "datatype": "string",
    "formula": "IF LEN(STR(DATEPART('hour', [Calculation_1916563181826678784]))) = 1
THEN "0" + STR(DATEPART('hour', [Calculation_1916563181826678784]))
ELSE STR(DATEPART('hour', [Calculation_1916563181826678784]))
END",
    "name": "[Calculation_1113233589182521344]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "20hrs Disqual",
    "datatype": "integer",
    "formula": "IF [Stage6 Response] = "More than 20 hours per week" THEN 1 ELSE 0 END",
    "name": "[Calculation_1133007210546622464]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Age Disqual",
    "datatype": "integer",
    "formula": "IF INT([Age]) < 40 OR INT([Age]) > 62 THEN 1 ELSE 0 END",
    "name": "[Calculation_1133007210553298946]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Attorney Disqual",
    "datatype": "integer",
    "formula": "IF [Stage5 Response] = "Yes" THEN 1 ELSE 0 END",
    "name": "[Calculation_1133007210553425923]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Ben Disqual",
    "datatype": "integer",
    "formula": "IF IFNULL([Stage1 Response], "") != "I am not receiving any disability benefits (SSD or SSI)"
THEN 1 ELSE 0 END",
    "name": "[Calculation_1133007210553487364]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Doctor Visit Disqual",
    "datatype": "integer",
    "formula": "IF [Stage4 Response] = "No" THEN 1 ELSE 0 END",
    "name": "[Calculation_1133007210553540613]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Five Year Work Disqual",
    "datatype": "integer",
    "formula": "IF [Stage3 Response] = "Less than 2 years"
OR [Stage3 Response] = "Between 2 and 4 years"
THEN 1 ELSE 0 END",
    "name": "[Calculation_1133007210553618438]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Out of Work Disqual",
    "datatype": "integer",
    "formula": "IF [Stage2 Response] = "No" THEN 1 ELSE 0 END",
    "name": "[Calculation_1133007210553663495]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "# of Disqual",
    "datatype": "integer",
    "formula": "ZN([Calculation_1133007210553487364]) +
ZN([Calculation_1133007210553663495]) +
ZN([Calculation_1133007210553618438]) +
ZN([Calculation_1133007210553540613]) +
ZN([Calculation_1133007210553425923]) +
ZN([Calculation_1133007210546622464]) +
ZN([Calculation_1133007210553298946])",
    "name": "[Calculation_1133007210553765896]",
    "role": "dimension",
    "type": "ordinal",
  },
  {
    "caption": "Month - Year",
    "datatype": "string",
    "formula": "DATENAME('month',[Post Date])+' '+ STR(YEAR([Post Date]))",
    "name": "[Calculation_1232578966341357571]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Missing Leads in Vici %",
    "datatype": "real",
    "formula": "[Calculation_1419196839344672769]/sum({exclude [CZ Project Name]:[Calculation_97320012564762668]})",
    "name": "[Calculation_1419196839322677248]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Leads Missing in Vici #",
    "datatype": "integer",
    "formula": "COUNTD(if isnull([Vici User Flag]) 
and [Status] != "CONVERTED" 
and [Status] != "STOP" then [User Id] end)",
    "name": "[Calculation_1419196839344672769]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Unresolved SSA Leads",
    "datatype": "string",
    "formula": "IF { FIXED [Phone] : MAX([Resolved Lead]) } = 0 THEN "SSA Unresolved Lead"
ELSEIF { FIXED [Phone] : MAX([Resolved Lead]) } = 1 THEN "SSA Resolved Lead"
END",
    "name": "[Calculation_1467962419029331969]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "CZ Post Hour Group",
    "datatype": "string",
    "formula": "IF DATEPART('hour', [Post Date]) >= 0 AND DATEPART('hour', [Post Date]) < 6 THEN 'Pre CC Hours'
ELSEIF DATEPART('hour', [Post Date]) >= 6 AND DATEPART('hour', [Post Date]) < 16 THEN 'CC Hours'
ELSEIF DATEPART('hour', [Post Date]) >= 16 AND DATEPART('hour', [Post Date]) < 24 THEN 'Post CC Hours'
END",
    "name": "[Calculation_1880252886125215747]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Post Date ",
    "datatype": "datetime",
    "formula": "//Updated Date: 18 May 2022
//Updated By: Manish
//Description: Formula to calculate UTC date

DATEADD("hour",0,[Post Date])",
    "name": "[Calculation_1916563181826678784]",
    "role": "dimension",
    "type": "ordinal",
  },
  {
    "caption": "Data Updated On",
    "datatype": "datetime",
    "formula": "{fixed :max([Post Date])}",
    "name": "[Calculation_2010857255412854784]",
    "role": "dimension",
    "type": "ordinal",
  },
  {
    "caption": "Project Type",
    "datatype": "string",
    "formula": "IF CONTAINS([CZ Project Name],'Aged') THEN 'Aged'
ELSE 'Live' END",
    "name": "[Calculation_5872834692856524810]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Grade",
    "datatype": "string",
    "formula": "// Grade A
IF [qual_status] = 'all-steps' THEN 'Grade A'

// Grade B
ELSEIF 
    [qual_status] IN ('fiveyrwrk-disqual','outofwrk-disqual','doc-disqual')
    AND [Calculation_1133007210553765896] = 1
THEN 'Grade B'

// Grade C
ELSEIF 
    [qual_status] <> 'age-disqual'
    AND NOT [Stage3 Response] IN ('Less than 2 years', 'Between 2 and 4 years')
    AND [Stage1 Response] <> 'Social Security Disability (SSD) Benefits'
    AND [Stage6 Response] = 'Not working'
THEN 'Grade C'

// Grade D
ELSEIF 
    // 1) Not age-disqual, Stage3 NOT in those two, Stage1 not SSD, Stage6 ≠ Not working, disqual ≤ 1
    (
      [qual_status] <> 'age-disqual'
      AND NOT [Stage3 Response] IN ('Less than 2 years', 'Between 2 and 4 years')
      AND [Stage1 Response] <> 'Social Security Disability (SSD) Benefits'
      AND [Stage6 Response] <> 'Not working'
      AND [Calculation_1133007210553765896] <= 1
    )
    // 2) Not age-disqual, Stage3 in those two, Qual Status = outofwrk-disqual
    OR
    (
      [qual_status] <> 'age-disqual'
      AND [Stage3 Response] IN ('Less than 2 years', 'Between 2 and 4 years')
      AND [qual_status] = 'outofwrk-disqual'
    )
    // 3) Not age-disqual, Stage3 in those two, Qual Status ≠ outofwrk-disqual, Stage7 = Yes
    OR
    (
      [qual_status] <> 'age-disqual'
      AND [Stage3 Response] IN ('Less than 2 years', 'Between 2 and 4 years')
      AND [qual_status] <> 'outofwrk-disqual'
      AND [Stage7 Response] = 'Yes'
    )
THEN 'Grade D'

// Rest (including age-disqual or anything else)
ELSE 'Rest'
END",
    "name": "[Calculation_7573084309404708864]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Today-28",
    "datatype": "date",
    "formula": "//Updated Date: 18 May 2022
//Updated By: Manish
//Description: Going back 28 days from today

({MAX(today()-28)})",
    "name": "[Calculation_767300790172184597]",
    "role": "dimension",
    "type": "ordinal",
  },
  {
    "caption": "Date Filter",
    "datatype": "boolean",
    "formula": "//Updated Date: 18 May 2022
//Updated By: Manish
//Description: Filtering data based on date

IF [Parameters].[Parameter 11] = 'default'
THEN [Date]>=[Parameters].[Parameter 5] AND [Date]<=[Parameters].[Parameter 6]
ELSEIF [Parameters].[Parameter 11] = 'weekly'
THEN [Date] >= TODAY()-8 AND [Date] <= TODAY()-1
END",
    "name": "[Calculation_843580506575679492]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Dial R",
    "datatype": "string",
    "formula": "IF  [Called Count] < 4 then "<=3" 
elseif [Called Count] < 8 then "4-7"
elseif [Called Count] < 11 then "8-10"
elseif [Called Count] < 16 then "11-15"
elseif [Called Count] < 20 then "16-19"
elseif [Called Count] < 26 then "20-25"
elseif [Called Count] < 31 then "25-30"
elseif [Called Count] < 36 then "30-35"
else "35+" 
END",
    "name": "[Calculation_847802666706034688]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Dial R (detail)",
    "datatype": "string",
    "formula": "STR([Called Count])",
    "name": "[Calculation_847802666706186241]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Max Date",
    "datatype": "date",
    "formula": "//Updated Date: 18 May 2022
//Updated By: Manish
//Description: Calculating max of todays date for including it in the default values of end date

{MAX(today())}",
    "name": "[Calculation_882424053213511680]",
    "role": "dimension",
    "type": "ordinal",
  },
  {
    "caption": "Alt. Branding",
    "datatype": "string",
    "formula": "If int(Right([Phone],2))<30 and [Calculation_5872834692856524810]= 'Live' then 'Yes' else 'No' End",
    "name": "[Calculation_935059914517495808]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Post Date  ",
    "datatype": "string",
    "formula": "//Updated Date: 18 May 2022
//Updated By: Manish
//Description: Calculation to apply date bucket

CASE [Parameters].[Parameter 1]
WHEN 'year' THEN str(datepart('year', [Calculation_1916563181826678784]))
WHEN 'quarter' THEN "Q" + str(datepart('quarter', [Calculation_1916563181826678784])) + " " + str(datepart('year', [Calculation_1916563181826678784]))
WHEN 'month' THEN str(datepart('month', [Calculation_1916563181826678784])) + "-" + str(datepart('year', [Calculation_1916563181826678784]))
WHEN 'day' THEN str(DATENAME('month', [Calculation_1916563181826678784]))+ "-" +str(datepart('day', [Calculation_1916563181826678784]))+ "-" + str(datepart('year', [Calculation_1916563181826678784]))
WHEN 'week' THEN "W" + str(datepart('week', [Calculation_1916563181826678784])) + "-" + str(datepart('year', [Calculation_1916563181826678784]))
WHEN "hour" THEN str(DATETRUNC('hour', [Calculation_1916563181826678784]))
WHEN "minute" THEN str(DATETRUNC('minute', [Calculation_1916563181826678784]))
END",
    "name": "[Calculation_97320012552925214]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Lead",
    "datatype": "integer",
    "formula": "//Updated Date: 18 May 2022
//Updated By: Manish
//Description: Calculating the unique count of user ids

COUNTD([User Id])",
    "name": "[Calculation_97320012564762668]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Age Exclusions",
    "datatype": "string",
    "formula": "[Age Range]",
    "name": "[age range (copy)_99712551094624281]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Helper Date",
    "datatype": "string",
    "formula": ""default"",
    "name": "[Parameter 11]",
    "role": "measure",
    "type": "nominal",
  },
  {
    "caption": "Start Date",
    "datatype": "date",
    "formula": "#2025-07-30#",
    "name": "[Parameter 5]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "End Date",
    "datatype": "date",
    "formula": "#2025-08-27#",
    "name": "[Parameter 6]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "TTW Grade",
    "datatype": "string",
    "formula": "IF [ttw_qualstatus] = 'ttw-qualified' then 'Grade A'
ELSEIF  [ttw_qualstatus] = 'ttw-nonqualified' and [TTW Explore Work Form] = 'yes' THEN 'Grade B'
ELSEIF [ttw_qualstatus] = 'ttw-nonqualified' and [TTW Explore Work Form] != 'yes' THEN 'Grade C'
ELSEIF ISNULL([ttw_qualstatus]) and [Stage3 Response] = 'Between 2 and 4 years' then 'Grade D'
ELSE 'Rest'
END",
    "name": "[Calculation_1006061976934187009]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "20hrs Disqual",
    "datatype": "integer",
    "formula": "IF [Stage6 Response] = "More than 20 hours per week" THEN 1 ELSE 0 END",
    "name": "[Calculation_1133007210546622464]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Age Disqual",
    "datatype": "integer",
    "formula": "IF INT([Age]) < 40 OR INT([Age]) > 62 THEN 1 ELSE 0 END",
    "name": "[Calculation_1133007210553298946]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Attorney Disqual",
    "datatype": "integer",
    "formula": "IF [Stage5 Response] = "Yes" THEN 1 ELSE 0 END",
    "name": "[Calculation_1133007210553425923]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Ben Disqual",
    "datatype": "integer",
    "formula": "IF IFNULL([Stage1 Response], "") != "I am not receiving any disability benefits (SSD or SSI)"
THEN 1 ELSE 0 END",
    "name": "[Calculation_1133007210553487364]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Doctor Visit Disqual",
    "datatype": "integer",
    "formula": "IF [Stage4 Response] = "No" THEN 1 ELSE 0 END",
    "name": "[Calculation_1133007210553540613]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Five Year Work Disqual",
    "datatype": "integer",
    "formula": "IF [Stage3 Response] = "Less than 2 years"
OR [Stage3 Response] = "Between 2 and 4 years"
THEN 1 ELSE 0 END",
    "name": "[Calculation_1133007210553618438]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Out of Work Disqual",
    "datatype": "integer",
    "formula": "IF [Stage2 Response] = "No" THEN 1 ELSE 0 END",
    "name": "[Calculation_1133007210553663495]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "# of Disqual",
    "datatype": "integer",
    "formula": "ZN([Calculation_1133007210553487364]) +
ZN([Calculation_1133007210553663495]) +
ZN([Calculation_1133007210553618438]) +
ZN([Calculation_1133007210553540613]) +
ZN([Calculation_1133007210553425923]) +
ZN([Calculation_1133007210546622464]) +
ZN([Calculation_1133007210553298946])",
    "name": "[Calculation_1133007210553765896]",
    "role": "dimension",
    "type": "ordinal",
  },
  {
    "caption": "Leads Missing in Vici #",
    "datatype": "integer",
    "formula": "COUNTD(if isnull([Vici User Flag]) 
and [Status] != "CONVERTED" 
and [Status] != "STOP" then [User Id] end)",
    "name": "[Calculation_1419196839344672769]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Unresolved SSA Leads",
    "datatype": "string",
    "formula": "IF { FIXED [Phone] : MAX([Resolved Lead]) } = 0 THEN "SSA Unresolved Lead"
ELSEIF { FIXED [Phone] : MAX([Resolved Lead]) } = 1 THEN "SSA Resolved Lead"
END",
    "name": "[Calculation_1467962419029331969]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Data Updated On",
    "datatype": "datetime",
    "formula": "{fixed :max([Post Date])}",
    "name": "[Calculation_2010857255412854784]",
    "role": "dimension",
    "type": "ordinal",
  },
  {
    "caption": "% Missing in Vici",
    "datatype": "real",
    "formula": "[Calculation_1419196839344672769]/sum({exclude [CZ Project Name]:[Calculation_97320012564762668]})",
    "name": "[Calculation_5751800461652443136]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Grade",
    "datatype": "string",
    "formula": "// Grade A
IF [qual_status] = 'all-steps' THEN 'Grade A'

// Grade B
ELSEIF 
    [qual_status] IN ('fiveyrwrk-disqual','outofwrk-disqual','doc-disqual')
    AND [Calculation_1133007210553765896] = 1
THEN 'Grade B'

// Grade C
ELSEIF 
    [qual_status] <> 'age-disqual'
    AND NOT [Stage3 Response] IN ('Less than 2 years', 'Between 2 and 4 years')
    AND [Stage1 Response] <> 'Social Security Disability (SSD) Benefits'
    AND [Stage6 Response] = 'Not working'
THEN 'Grade C'

// Grade D
ELSEIF 
    // 1) Not age-disqual, Stage3 NOT in those two, Stage1 not SSD, Stage6 ≠ Not working, disqual ≤ 1
    (
      [qual_status] <> 'age-disqual'
      AND NOT [Stage3 Response] IN ('Less than 2 years', 'Between 2 and 4 years')
      AND [Stage1 Response] <> 'Social Security Disability (SSD) Benefits'
      AND [Stage6 Response] <> 'Not working'
      AND [Calculation_1133007210553765896] <= 1
    )
    // 2) Not age-disqual, Stage3 in those two, Qual Status = outofwrk-disqual
    OR
    (
      [qual_status] <> 'age-disqual'
      AND [Stage3 Response] IN ('Less than 2 years', 'Between 2 and 4 years')
      AND [qual_status] = 'outofwrk-disqual'
    )
    // 3) Not age-disqual, Stage3 in those two, Qual Status ≠ outofwrk-disqual, Stage7 = Yes
    OR
    (
      [qual_status] <> 'age-disqual'
      AND [Stage3 Response] IN ('Less than 2 years', 'Between 2 and 4 years')
      AND [qual_status] <> 'outofwrk-disqual'
      AND [Stage7 Response] = 'Yes'
    )
THEN 'Grade D'

// Rest (including age-disqual or anything else)
ELSE 'Rest'
END",
    "name": "[Calculation_7573084309404708864]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Today-28",
    "datatype": "date",
    "formula": "//Updated Date: 18 May 2022
//Updated By: Manish
//Description: Going back 28 days from today

({MAX(today()-28)})",
    "name": "[Calculation_767300790172184597]",
    "role": "dimension",
    "type": "ordinal",
  },
  {
    "caption": "Date Filter",
    "datatype": "boolean",
    "formula": "//Updated Date: 18 May 2022
//Updated By: Manish
//Description: Filtering data based on date

IF [Parameters].[Parameter 11] = 'default'
THEN [Date]>=[Parameters].[Parameter 5] AND [Date]<=[Parameters].[Parameter 6]
ELSEIF [Parameters].[Parameter 11] = 'weekly'
THEN [Date] >= TODAY()-8 AND [Date] <= TODAY()-1
END",
    "name": "[Calculation_843580506575679492]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Dial R",
    "datatype": "string",
    "formula": "IF  [Called Count] < 4 then "<=3" 
elseif [Called Count] < 8 then "4-7"
elseif [Called Count] < 11 then "8-10"
elseif [Called Count] < 16 then "11-15"
elseif [Called Count] < 20 then "16-19"
elseif [Called Count] < 26 then "20-25"
elseif [Called Count] < 31 then "25-30"
elseif [Called Count] < 36 then "30-35"
else "35+" 
END",
    "name": "[Calculation_847802666706034688]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Dial R (detail)",
    "datatype": "string",
    "formula": "STR([Called Count])",
    "name": "[Calculation_847802666706186241]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Max Date",
    "datatype": "date",
    "formula": "//Updated Date: 18 May 2022
//Updated By: Manish
//Description: Calculating max of todays date for including it in the default values of end date

{MAX(today())}",
    "name": "[Calculation_882424053213511680]",
    "role": "dimension",
    "type": "ordinal",
  },
  {
    "caption": "Lead",
    "datatype": "integer",
    "formula": "//Updated Date: 18 May 2022
//Updated By: Manish
//Description: Calculating the unique count of user ids

COUNTD([User Id])",
    "name": "[Calculation_97320012564762668]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "D2",
    "datatype": "integer",
    "formula": "0",
    "name": "[D1 (copy 2)_1113233589196361731]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "D3",
    "datatype": "integer",
    "formula": "0",
    "name": "[D1 (copy 3)_1113233589196374020]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "D5",
    "datatype": "integer",
    "formula": "0",
    "name": "[D1 (copy) (copy)_1113233589196361730]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "D4",
    "datatype": "integer",
    "formula": "0",
    "name": "[D1 (copy)_1113233589196333057]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "D1",
    "datatype": "integer",
    "formula": "0",
    "name": "[Parameter 10]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Date Bucket",
    "datatype": "string",
    "formula": ""day"",
    "name": "[Parameter 1]",
    "role": "measure",
    "type": "nominal",
  },
  {
    "caption": "TTW Grade",
    "datatype": "string",
    "formula": "IF [ttw_qualstatus] = 'ttw-qualified' then 'Grade A'
ELSEIF  [ttw_qualstatus] = 'ttw-nonqualified' and [TTW Explore Work Form] = 'yes' THEN 'Grade B'
ELSEIF [ttw_qualstatus] = 'ttw-nonqualified' and [TTW Explore Work Form] != 'yes' THEN 'Grade C'
ELSEIF ISNULL([ttw_qualstatus]) and [Stage3 Response] = 'Between 2 and 4 years' then 'Grade D'
ELSE 'Rest'
END",
    "name": "[Calculation_1006061976934187009]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Hour of Day",
    "datatype": "string",
    "formula": "IF LEN(STR(DATEPART('hour', [Calculation_1916563181826678784]))) = 1
THEN "0" + STR(DATEPART('hour', [Calculation_1916563181826678784]))
ELSE STR(DATEPART('hour', [Calculation_1916563181826678784]))
END",
    "name": "[Calculation_1113233589182521344]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "20hrs Disqual",
    "datatype": "integer",
    "formula": "IF [Stage6 Response] = "More than 20 hours per week" THEN 1 ELSE 0 END",
    "name": "[Calculation_1133007210546622464]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Age Disqual",
    "datatype": "integer",
    "formula": "IF INT([Age]) < 40 OR INT([Age]) > 62 THEN 1 ELSE 0 END",
    "name": "[Calculation_1133007210553298946]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Attorney Disqual",
    "datatype": "integer",
    "formula": "IF [Stage5 Response] = "Yes" THEN 1 ELSE 0 END",
    "name": "[Calculation_1133007210553425923]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Ben Disqual",
    "datatype": "integer",
    "formula": "IF IFNULL([Stage1 Response], "") != "I am not receiving any disability benefits (SSD or SSI)"
THEN 1 ELSE 0 END",
    "name": "[Calculation_1133007210553487364]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Doctor Visit Disqual",
    "datatype": "integer",
    "formula": "IF [Stage4 Response] = "No" THEN 1 ELSE 0 END",
    "name": "[Calculation_1133007210553540613]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Five Year Work Disqual",
    "datatype": "integer",
    "formula": "IF [Stage3 Response] = "Less than 2 years"
OR [Stage3 Response] = "Between 2 and 4 years"
THEN 1 ELSE 0 END",
    "name": "[Calculation_1133007210553618438]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Out of Work Disqual",
    "datatype": "integer",
    "formula": "IF [Stage2 Response] = "No" THEN 1 ELSE 0 END",
    "name": "[Calculation_1133007210553663495]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "# of Disqual",
    "datatype": "integer",
    "formula": "ZN([Calculation_1133007210553487364]) +
ZN([Calculation_1133007210553663495]) +
ZN([Calculation_1133007210553618438]) +
ZN([Calculation_1133007210553540613]) +
ZN([Calculation_1133007210553425923]) +
ZN([Calculation_1133007210546622464]) +
ZN([Calculation_1133007210553298946])",
    "name": "[Calculation_1133007210553765896]",
    "role": "dimension",
    "type": "ordinal",
  },
  {
    "caption": "Month - Year",
    "datatype": "string",
    "formula": "DATENAME('month',[Post Date])+' '+ STR(YEAR([Post Date]))",
    "name": "[Calculation_1232578966341357571]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "'Leads #'",
    "datatype": "string",
    "formula": "'Leads #'",
    "name": "[Calculation_1232578966344339462]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Levine States ",
    "datatype": "string",
    "formula": "IF ISNULL([Levine States]) THEN 'Other'
ELSE [Levine States] END",
    "name": "[Calculation_1277614987429064704]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "PD Dimensions  Combination",
    "datatype": "string",
    "formula": "IFNULL([Calculation_1232578966341357571],'')+
IFNULL([Calculation_6374000853571039236],'')+
IFNULL([D1 (copy)_6374000853573341191],'')+
IFNULL([D1 (copy) (copy)_6374000853573369864],'')+
IFNULL([D3 (copy)_6208563937532035081],'')+
IFNULL([D4 (copy)_6208563937532350475],'')",
    "name": "[Calculation_1341228293759967232]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "DP Leak",
    "datatype": "string",
    "formula": "IF CONTAINS([clientname], 'disabilitypath')
AND [Calculation_7573084309404708864] in ('Grade A', 'Grade B')
THEN 'Yes'
ELSE 'No'
END",
    "name": "[Calculation_1460573688699854848]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Unresolved SSA Leads",
    "datatype": "string",
    "formula": "IF { FIXED [Phone] : MAX([Resolved Lead]) } = 0 THEN "SSA Unresolved Lead"
ELSEIF { FIXED [Phone] : MAX([Resolved Lead]) } = 1 THEN "SSA Resolved Lead"
END",
    "name": "[Calculation_1467962419029331969]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "CTC Lead Flag",
    "datatype": "string",
    "formula": "if [CTC Lead] = 1 then "Yes" else "No" END",
    "name": "[Calculation_1880252886088871936]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "CZ Post Hour Group",
    "datatype": "string",
    "formula": "IF DATEPART('hour', [Post Date]) >= 0 AND DATEPART('hour', [Post Date]) < 6 THEN 'Pre CC Hours'
ELSEIF DATEPART('hour', [Post Date]) >= 6 AND DATEPART('hour', [Post Date]) < 16 THEN 'CC Hours'
ELSEIF DATEPART('hour', [Post Date]) >= 16 AND DATEPART('hour', [Post Date]) < 24 THEN 'Post CC Hours'
END",
    "name": "[Calculation_1880252886125215747]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Post Date ",
    "datatype": "datetime",
    "formula": "//Updated Date: 18 May 2022
//Updated By: Manish
//Description: Formula to calculate UTC date

DATEADD("hour",0,[Post Date])",
    "name": "[Calculation_1916563181826678784]",
    "role": "dimension",
    "type": "ordinal",
  },
  {
    "caption": "Data Updated On",
    "datatype": "datetime",
    "formula": "{fixed :max([Post Date])}",
    "name": "[Calculation_2010857255412854784]",
    "role": "dimension",
    "type": "ordinal",
  },
  {
    "caption": "Lead Sell Type",
    "datatype": "string",
    "formula": "if contains([Transfer Info Label],'CXER') then 'Sold: Call' 
elseif 
contains([sgmt],'ql-leadbuy') or 
contains([ATA Work],'ql-leadbuy')
then 'Sold: Lead'
else 'Internal'
end",
    "name": "[Calculation_3435894714053935109]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Seg4 Control vs. Treatment",
    "datatype": "string",
    "formula": "IF [CZ Project Name] = "Mass Tort - High Intent SSDI" AND [Calculation_1880252886088871936] = "No" AND [qual_status] != "all-steps" THEN
    IF INT(RIGHT([phone masked], 3)) % 2 = 0 THEN "Control"
    ELSEIF INT(RIGHT([phone masked], 3)) % 2 != 0 THEN "Treatment"
    END
END",
    "name": "[Calculation_4531465651676315649]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Seg4 Cohort",
    "datatype": "string",
    "formula": "LOWER(IFNULL([seg4_cohort], [Calculation_4531465651676315649]))",
    "name": "[Calculation_4531465651676438530]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Time to Call (Minute)",
    "datatype": "real",
    "formula": "IF [Calculation_1880252886088871936] = 'Yes'
THEN ROUND(([CTC Time] - [Post Date]) * 24 * 60, 2)
END",
    "name": "[Calculation_499055157752631296]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Time to Call Bucket",
    "datatype": "string",
    "formula": "IF  [Calculation_499055157752631296] < 0
THEN '<0 Mins'
ELSEIF [Calculation_499055157752631296] <= 2 AND [Calculation_499055157752631296] >= 0
THEN '0-2 Mins'
ELSEIF [Calculation_499055157752631296] <= 5 AND [Calculation_499055157752631296] > 0
THEN '2-5 Mins'
ELSEIF [Calculation_499055157752631296] <= 10 AND [Calculation_499055157752631296] > 0
THEN '5-10 Mins'
ELSEIF [Calculation_499055157752631296] <= 30 AND [Calculation_499055157752631296] > 0 
THEN '10-30 Mins'
ELSEIF [Calculation_499055157752631296] <= 60 AND [Calculation_499055157752631296] > 0
THEN '30Mins-1 Hour'
ELSEIF [Calculation_499055157752631296] <= 300 AND [Calculation_499055157752631296] > 0
THEN '1-5 Hours'
ELSEIF [Calculation_499055157752631296] <= 600 AND [Calculation_499055157752631296] > 0
THEN '5-10 Hours'
ELSEIF [Calculation_499055157752631296] <= 1440 AND [Calculation_499055157752631296] > 0
THEN '10-24 Hours'
ELSEIF [Calculation_499055157752631296] <= 4320 AND [Calculation_499055157752631296] > 0
THEN '24-72 Hours'
ELSEIF [Calculation_499055157752631296] > 4320 AND [Calculation_499055157752631296] > 0
THEN '>72 Hours'
END",
    "name": "[Calculation_499055157754740737]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Project Type",
    "datatype": "string",
    "formula": "IF CONTAINS([CZ Project Name],'Aged') THEN 'Aged'
ELSE 'Live' END",
    "name": "[Calculation_5872834692856524810]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "BLA Status",
    "datatype": "string",
    "formula": "IF [bla_blacklisted] = 'true' THEN 'Blacklisted'
ELSEIF [bla_blacklisted] = 'false' THEN 'Passed'
ELSE NULL
END",
    "name": "[Calculation_6374000853565702144]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "BLA Code",
    "datatype": "string",
    "formula": "[bla_rejectcodes]",
    "name": "[Calculation_6374000853566275585]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "D1 ('+' to add dim)",
    "datatype": "string",
    "formula": "IF [Parameters].[Parameter 10] = 1 THEN [Calculation_6374000853566275585]
ELSEIF [Parameters].[Parameter 10] = 2 THEN [bla_carrierdata_type]
ELSEIF [Parameters].[Parameter 10] = 3 THEN [Calculation_6374000853565702144]
ELSEIF [Parameters].[Parameter 10] = 4 THEN [Phone Carrier]
ELSEIF [Parameters].[Parameter 10] = 5 THEN [CZ Project Name]
ELSEIF [Parameters].[Parameter 10] = 6 THEN [Phone Type]
ELSEIF [Parameters].[Parameter 10] = 7 THEN [normalized carrier]
ELSEIF [Parameters].[Parameter 10] = 8 THEN [Outcome]
ELSEIF [Parameters].[Parameter 10] = 9 THEN [qual_status]
ELSEIF [Parameters].[Parameter 10] = 10 THEN [Source]
ELSEIF [Parameters].[Parameter 10] = 11 THEN [Sub Id]
ELSEIF [Parameters].[Parameter 10] = 12 THEN [gender (copy)_2399292755830108162]
ELSEIF [Parameters].[Parameter 10] = 13 THEN [Creative]
ELSEIF [Parameters].[Parameter 10] = 14 THEN [CL Diagnosis Injury Tiers]
ELSEIF [Parameters].[Parameter 10] = 15 THEN [Calculation_935059914517495808]
ELSEIF [Parameters].[Parameter 10] = 16 THEN [Ad Name]
ELSEIF [Parameters].[Parameter 10] = 17 THEN [Adset Name]
ELSEIF [Parameters].[Parameter 10] = 18 THEN [campaign_id]
ELSEIF [Parameters].[Parameter 10] = 19 THEN [Labels]
ELSEIF [Parameters].[Parameter 10] = 20 THEN [Calculation_5872834692856524810]
ELSEIF [Parameters].[Parameter 10] = 21 THEN [State]
ELSEIF [Parameters].[Parameter 10] = 22 THEN [Phone]
// ELSEIF [D1] = 23 THEN [Tier]
ELSEIF [Parameters].[Parameter 10] = 23 THEN [Calculation_1277614987429064704]
ELSEIF [Parameters].[Parameter 10] = 25 THEN [Result Type]
ELSEIF [Parameters].[Parameter 10] = 26 THEN [placement]
ELSEIF [Parameters].[Parameter 10] = 27 THEN [Calculation_7690318609259716608]
ELSEIF [Parameters].[Parameter 10] = 28 THEN [label]
ELSEIF [Parameters].[Parameter 10] = 29 THEN STR([Calculation_1880252886088871936])
ELSEIF [Parameters].[Parameter 10] = 30 THEN [clientname]
ELSEIF [Parameters].[Parameter 10] = 31 THEN [page_path]
ELSEIF [Parameters].[Parameter 10] = 32 THEN [sgmt]
ELSEIF [Parameters].[Parameter 10] = 33 THEN [ctcphone]
ELSEIF [Parameters].[Parameter 10] = 34 THEN [Calculation_3435894714053935109]
ELSEIF [Parameters].[Parameter 10] = 35 THEN [ltdinoworkmedicalconditions]
ELSEIF [Parameters].[Parameter 10] = 36 THEN [ds_qualstatus]
ELSEIF [Parameters].[Parameter 10] = 37 THEN [ad_id]
ELSEIF [Parameters].[Parameter 10] = 38 THEN [adset_id]
ELSEIF [Parameters].[Parameter 10] = 39 THEN [Calculation_1113233589182521344]
ELSEIF [Parameters].[Parameter 10] = 40 THEN [Calculation_1880252886125215747]
ELSEIF [Parameters].[Parameter 10] = 41 THEN [SubSegment]
ELSEIF [Parameters].[Parameter 10] = 42 THEN STR([Calculation_1133007210553765896])
ELSEIF [Parameters].[Parameter 10] = 43 THEN [Calculation_7573084309404708864]
ELSEIF [Parameters].[Parameter 10] = 44 THEN [Calculation_4531465651676438530]
ELSEIF [Parameters].[Parameter 10] = 45 THEN IF LEN(STR([appearance_l30d])) < 2 AND NOT ISNULL(STR([appearance_l30d])) THEN '0' + STR([appearance_l30d]) ELSE STR([appearance_l30d]) END
ELSEIF [Parameters].[Parameter 10] = 46 THEN IF LEN(STR([appearance_l60d])) < 2 AND NOT ISNULL(STR([appearance_l60d])) THEN '0' + STR([appearance_l60d]) ELSE STR([appearance_l60d]) END
ELSEIF [Parameters].[Parameter 10] = 47 THEN IF LEN(STR([appearance_l90d])) < 2 AND NOT ISNULL(STR([appearance_l90d])) THEN '0' + STR([appearance_l90d]) ELSE STR([appearance_l90d]) END
ELSEIF [Parameters].[Parameter 10] = 48 THEN [ATA Work]
ELSEIF [Parameters].[Parameter 10] = 49 THEN [Calculation_499055157754740737]
ELSEIF [Parameters].[Parameter 10] = 50 THEN IF LEN(STR([CIIC Appearance in L30D])) < 2 AND NOT ISNULL(STR([CIIC Appearance in L30D])) THEN '0' + STR([CIIC Appearance in L30D]) ELSE STR([CIIC Appearance in L30D]) END
ELSEIF [Parameters].[Parameter 10] = 51 THEN IF LEN(STR([CIIC Appearance in L60D])) < 2 AND NOT ISNULL(STR([CIIC Appearance in L60D])) THEN '0' + STR([CIIC Appearance in L60D]) ELSE STR([CIIC Appearance in L60D]) END
ELSEIF [Parameters].[Parameter 10] = 52 THEN IF LEN(STR([CIIC Appearance in L90D])) < 2 AND NOT ISNULL(STR([CIIC Appearance in L90D])) THEN '0' + STR([CIIC Appearance in L90D]) ELSE STR([CIIC Appearance in L90D]) END
ELSEIF [Parameters].[Parameter 10] = 53 THEN STR([Calculation_989947527401095169])
ELSEIF [Parameters].[Parameter 10] = 54 THEN [Calculation_1460573688699854848]
ELSEIF [Parameters].[Parameter 10] = 55 THEN [Calculation_1006061976934187009]
ELSE 'Agg'
END",
    "name": "[Calculation_6374000853571039236]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Grade",
    "datatype": "string",
    "formula": "// Grade A
IF [qual_status] = 'all-steps' THEN 'Grade A'

// Grade B
ELSEIF 
    [qual_status] IN ('fiveyrwrk-disqual','outofwrk-disqual','doc-disqual')
    AND [Calculation_1133007210553765896] = 1
THEN 'Grade B'

// Grade C
ELSEIF 
    [qual_status] <> 'age-disqual'
    AND NOT [Stage3 Response] IN ('Less than 2 years', 'Between 2 and 4 years')
    AND [Stage1 Response] <> 'Social Security Disability (SSD) Benefits'
    AND [Stage6 Response] = 'Not working'
THEN 'Grade C'

// Grade D
ELSEIF 
    // 1) Not age-disqual, Stage3 NOT in those two, Stage1 not SSD, Stage6 ≠ Not working, disqual ≤ 1
    (
      [qual_status] <> 'age-disqual'
      AND NOT [Stage3 Response] IN ('Less than 2 years', 'Between 2 and 4 years')
      AND [Stage1 Response] <> 'Social Security Disability (SSD) Benefits'
      AND [Stage6 Response] <> 'Not working'
      AND [Calculation_1133007210553765896] <= 1
    )
    // 2) Not age-disqual, Stage3 in those two, Qual Status = outofwrk-disqual
    OR
    (
      [qual_status] <> 'age-disqual'
      AND [Stage3 Response] IN ('Less than 2 years', 'Between 2 and 4 years')
      AND [qual_status] = 'outofwrk-disqual'
    )
    // 3) Not age-disqual, Stage3 in those two, Qual Status ≠ outofwrk-disqual, Stage7 = Yes
    OR
    (
      [qual_status] <> 'age-disqual'
      AND [Stage3 Response] IN ('Less than 2 years', 'Between 2 and 4 years')
      AND [qual_status] <> 'outofwrk-disqual'
      AND [Stage7 Response] = 'Yes'
    )
THEN 'Grade D'

// Rest (including age-disqual or anything else)
ELSE 'Rest'
END",
    "name": "[Calculation_7573084309404708864]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "SSD Age Range",
    "datatype": "string",
    "formula": "IF DATE([Calculation_1916563181826678784]) >= #18/08/2025#
THEN
    IF INT([Age]) < 40 THEN "U40"
    ELSEIF INT([Age]) >= 40 AND INT([Age]) <= 49 THEN "40 - 49"
	ELSEIF INT([Age]) >= 50 AND INT([Age]) <= 54 THEN "50 - 54"
    ELSEIF INT([Age]) >= 55 AND INT([Age]) <= 63 THEN "55 - 63"
    ELSEIF INT([Age]) >= 64 THEN "O64+"
    END
ELSEIF INT([Age]) < 40 THEN "*U40"
ELSEIF INT([Age]) >= 40 AND INT([Age]) <= 48 THEN "*40-48"
ELSEIF INT([Age]) = 49 THEN "*49"
ELSEIF INT([Age]) >= 50 AND INT([Age]) <= 62 THEN "*50-62"
ELSEIF INT([Age]) >= 63 THEN "*O63+" 
END",
    "name": "[Calculation_7690318609259716608]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Dial R",
    "datatype": "string",
    "formula": "IF  [Called Count] < 4 then "<=3" 
elseif [Called Count] < 8 then "4-7"
elseif [Called Count] < 11 then "8-10"
elseif [Called Count] < 16 then "11-15"
elseif [Called Count] < 20 then "16-19"
elseif [Called Count] < 26 then "20-25"
elseif [Called Count] < 31 then "25-30"
elseif [Called Count] < 36 then "30-35"
else "35+" 
END",
    "name": "[Calculation_847802666706034688]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Dial R (detail)",
    "datatype": "string",
    "formula": "STR([Called Count])",
    "name": "[Calculation_847802666706186241]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Alt. Branding",
    "datatype": "string",
    "formula": "If int(Right([Phone],2))<30 and [Calculation_5872834692856524810]= 'Live' then 'Yes' else 'No' End",
    "name": "[Calculation_935059914517495808]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Post Date  ",
    "datatype": "string",
    "formula": "//Updated Date: 18 May 2022
//Updated By: Manish
//Description: Calculation to apply date bucket

CASE [Parameters].[Parameter 1]
WHEN 'year' THEN str(datepart('year', [Calculation_1916563181826678784]))
WHEN 'quarter' THEN "Q" + str(datepart('quarter', [Calculation_1916563181826678784])) + " " + str(datepart('year', [Calculation_1916563181826678784]))
WHEN 'month' THEN str(datepart('month', [Calculation_1916563181826678784])) + "-" + str(datepart('year', [Calculation_1916563181826678784]))
WHEN 'day' THEN str(DATENAME('month', [Calculation_1916563181826678784]))+ "-" +str(datepart('day', [Calculation_1916563181826678784]))+ "-" + str(datepart('year', [Calculation_1916563181826678784]))
WHEN 'week' THEN "W" + str(datepart('week', [Calculation_1916563181826678784])) + "-" + str(datepart('year', [Calculation_1916563181826678784]))
WHEN "hour" THEN str(DATETRUNC('hour', [Calculation_1916563181826678784]))
WHEN "minute" THEN str(DATETRUNC('minute', [Calculation_1916563181826678784]))
END",
    "name": "[Calculation_97320012552925214]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Lead",
    "datatype": "integer",
    "formula": "//Updated Date: 18 May 2022
//Updated By: Manish
//Description: Calculating the unique count of user ids

COUNTD([User Id])",
    "name": "[Calculation_97320012564762668]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Vici Post Delay (Days)",
    "datatype": "integer",
    "formula": "DATEDIFF('day', [Post Date], [Entry Time])",
    "name": "[Calculation_989947527401095169]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "D3",
    "datatype": "string",
    "formula": "IF [Parameters].[D1 (copy 3)_1113233589196374020] = 1 THEN [Calculation_6374000853566275585]
ELSEIF [Parameters].[D1 (copy 3)_1113233589196374020] = 2 THEN [bla_carrierdata_type]
ELSEIF [Parameters].[D1 (copy 3)_1113233589196374020] = 3 THEN [Calculation_6374000853565702144]
ELSEIF [Parameters].[D1 (copy 3)_1113233589196374020] = 4 THEN [Phone Carrier]
ELSEIF [Parameters].[D1 (copy 3)_1113233589196374020] = 5 THEN [CZ Project Name]
ELSEIF [Parameters].[D1 (copy 3)_1113233589196374020] = 6 THEN [Phone Type]
ELSEIF [Parameters].[D1 (copy 3)_1113233589196374020] = 7 THEN [normalized carrier]
ELSEIF [Parameters].[D1 (copy 3)_1113233589196374020] = 8 THEN [Outcome]
ELSEIF [Parameters].[D1 (copy 3)_1113233589196374020] = 9 THEN [qual_status]
ELSEIF [Parameters].[D1 (copy 3)_1113233589196374020] = 10 THEN [Source]
ELSEIF [Parameters].[D1 (copy 3)_1113233589196374020] = 11 THEN [Sub Id]
ELSEIF [Parameters].[D1 (copy 3)_1113233589196374020] = 12 THEN [gender (copy)_2399292755830108162]
ELSEIF [Parameters].[D1 (copy 3)_1113233589196374020] = 13 THEN [Creative]
ELSEIF [Parameters].[D1 (copy 3)_1113233589196374020] = 14 THEN [CL Diagnosis Injury Tiers]
ELSEIF [Parameters].[D1 (copy 3)_1113233589196374020] = 15 THEN [Calculation_935059914517495808]
ELSEIF [Parameters].[D1 (copy 3)_1113233589196374020] = 16 THEN [Ad Name]
ELSEIF [Parameters].[D1 (copy 3)_1113233589196374020] = 17 THEN [Adset Name]
ELSEIF [Parameters].[D1 (copy 3)_1113233589196374020] = 18 THEN [campaign_id]
ELSEIF [Parameters].[D1 (copy 3)_1113233589196374020] = 19 THEN [Labels]
ELSEIF [Parameters].[D1 (copy 3)_1113233589196374020] = 20 THEN [Calculation_5872834692856524810]
ELSEIF [Parameters].[D1 (copy 3)_1113233589196374020] = 21 THEN [State]
ELSEIF [Parameters].[D1 (copy 3)_1113233589196374020] = 22 THEN [Phone]
// ELSEIF [Parameters].[D3] = 23 THEN [Tier]
ELSEIF [Parameters].[D1 (copy 3)_1113233589196374020] = 23 THEN [Calculation_1277614987429064704]
ELSEIF [Parameters].[D1 (copy 3)_1113233589196374020] = 25 THEN [Result Type]
ELSEIF [Parameters].[D1 (copy 3)_1113233589196374020] = 26 THEN [placement]
ELSEIF [Parameters].[D1 (copy 3)_1113233589196374020] = 27 THEN [Calculation_7690318609259716608]
ELSEIF [Parameters].[D1 (copy 3)_1113233589196374020] = 28 THEN [label]
ELSEIF [Parameters].[D1 (copy 3)_1113233589196374020] = 29 THEN STR([Calculation_1880252886088871936])
ELSEIF [Parameters].[D1 (copy 3)_1113233589196374020] = 30 THEN [clientname]
ELSEIF [Parameters].[D1 (copy 3)_1113233589196374020] = 31 THEN [page_path]
ELSEIF [Parameters].[D1 (copy 3)_1113233589196374020] = 32 THEN [sgmt]
ELSEIF [Parameters].[D1 (copy 3)_1113233589196374020] = 33 THEN [ctcphone]
ELSEIF [Parameters].[D1 (copy 3)_1113233589196374020] = 34 THEN [Calculation_3435894714053935109]
ELSEIF [Parameters].[D1 (copy 3)_1113233589196374020] = 35 THEN [ltdinoworkmedicalconditions]
ELSEIF [Parameters].[D1 (copy 3)_1113233589196374020] = 36 THEN [ds_qualstatus]
ELSEIF [Parameters].[D1 (copy 3)_1113233589196374020] = 37 THEN [ad_id]
ELSEIF [Parameters].[D1 (copy 3)_1113233589196374020] = 38 THEN [adset_id]
ELSEIF [Parameters].[D1 (copy 3)_1113233589196374020] = 39 THEN [Calculation_1113233589182521344]
ELSEIF [Parameters].[D1 (copy 3)_1113233589196374020] = 40 THEN [Calculation_1880252886125215747]
ELSEIF [Parameters].[D1 (copy 3)_1113233589196374020] = 41 THEN [SubSegment]
ELSEIF [Parameters].[D1 (copy 3)_1113233589196374020] = 42 THEN STR([Calculation_1133007210553765896])
ELSEIF [Parameters].[D1 (copy 3)_1113233589196374020] = 43 THEN [Calculation_7573084309404708864]
ELSEIF [Parameters].[D1 (copy 3)_1113233589196374020] = 44 THEN [Calculation_4531465651676438530]
ELSEIF [Parameters].[D1 (copy 3)_1113233589196374020] = 45 THEN IF LEN(STR([appearance_l30d])) < 2 AND NOT ISNULL(STR([appearance_l30d])) THEN '0' + STR([appearance_l30d]) ELSE STR([appearance_l30d]) END
ELSEIF [Parameters].[D1 (copy 3)_1113233589196374020] = 46 THEN IF LEN(STR([appearance_l60d])) < 2 AND NOT ISNULL(STR([appearance_l60d])) THEN '0' + STR([appearance_l60d]) ELSE STR([appearance_l60d]) END
ELSEIF [Parameters].[D1 (copy 3)_1113233589196374020] = 47 THEN IF LEN(STR([appearance_l90d])) < 2 AND NOT ISNULL(STR([appearance_l90d])) THEN '0' + STR([appearance_l90d]) ELSE STR([appearance_l90d]) END
ELSEIF [Parameters].[D1 (copy 3)_1113233589196374020] = 48 THEN [ATA Work]
ELSEIF [Parameters].[D1 (copy 3)_1113233589196374020] = 49 THEN [Calculation_499055157754740737]
ELSEIF [Parameters].[D1 (copy 3)_1113233589196374020] = 50 THEN IF LEN(STR([CIIC Appearance in L30D])) < 2 AND NOT ISNULL(STR([CIIC Appearance in L30D])) THEN '0' + STR([CIIC Appearance in L30D]) ELSE STR([CIIC Appearance in L30D]) END
ELSEIF [Parameters].[D1 (copy 3)_1113233589196374020] = 51 THEN IF LEN(STR([CIIC Appearance in L60D])) < 2 AND NOT ISNULL(STR([CIIC Appearance in L60D])) THEN '0' + STR([CIIC Appearance in L60D]) ELSE STR([CIIC Appearance in L60D]) END
ELSEIF [Parameters].[D1 (copy 3)_1113233589196374020] = 52 THEN IF LEN(STR([CIIC Appearance in L90D])) < 2 AND NOT ISNULL(STR([CIIC Appearance in L90D])) THEN '0' + STR([CIIC Appearance in L90D]) ELSE STR([CIIC Appearance in L90D]) END
ELSEIF [Parameters].[D1 (copy 3)_1113233589196374020] = 53 THEN STR([Calculation_989947527401095169])
ELSEIF [Parameters].[D1 (copy 3)_1113233589196374020] = 54 THEN [Calculation_1460573688699854848]
ELSEIF [Parameters].[D1 (copy 3)_1113233589196374020] = 55 THEN [Calculation_1006061976934187009]
ELSE 'Agg'
END",
    "name": "[D1 (copy) (copy)_6374000853573369864]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "D2",
    "datatype": "string",
    "formula": "IF [Parameters].[D1 (copy 2)_1113233589196361731] = 1 THEN [Calculation_6374000853566275585]
ELSEIF [Parameters].[D1 (copy 2)_1113233589196361731]  = 2 THEN [bla_carrierdata_type]
ELSEIF [Parameters].[D1 (copy 2)_1113233589196361731]  = 3 THEN [Calculation_6374000853565702144]
ELSEIF [Parameters].[D1 (copy 2)_1113233589196361731]  = 4 THEN [Phone Carrier]
ELSEIF [Parameters].[D1 (copy 2)_1113233589196361731]  = 5 THEN [CZ Project Name]
ELSEIF [Parameters].[D1 (copy 2)_1113233589196361731]  = 6 THEN [Phone Type]
ELSEIF [Parameters].[D1 (copy 2)_1113233589196361731]  = 7 THEN [normalized carrier]
ELSEIF [Parameters].[D1 (copy 2)_1113233589196361731]  = 8 THEN [Outcome]
ELSEIF [Parameters].[D1 (copy 2)_1113233589196361731]  = 9 THEN [qual_status]
ELSEIF [Parameters].[D1 (copy 2)_1113233589196361731]  = 10 THEN [Source]
ELSEIF [Parameters].[D1 (copy 2)_1113233589196361731]  = 11 THEN [Sub Id]
ELSEIF [Parameters].[D1 (copy 2)_1113233589196361731]  = 12 THEN [gender (copy)_2399292755830108162]
ELSEIF [Parameters].[D1 (copy 2)_1113233589196361731]  = 13 THEN [Creative]
ELSEIF [Parameters].[D1 (copy 2)_1113233589196361731]  = 14 THEN [CL Diagnosis Injury Tiers]
ELSEIF [Parameters].[D1 (copy 2)_1113233589196361731]  = 15 THEN [Calculation_935059914517495808]
ELSEIF [Parameters].[D1 (copy 2)_1113233589196361731]  = 16 THEN [Ad Name]
ELSEIF [Parameters].[D1 (copy 2)_1113233589196361731]  = 17 THEN [Adset Name]
ELSEIF [Parameters].[D1 (copy 2)_1113233589196361731]  = 18 THEN [campaign_id]
ELSEIF [Parameters].[D1 (copy 2)_1113233589196361731]  = 19 THEN [Labels]
ELSEIF [Parameters].[D1 (copy 2)_1113233589196361731]  = 20 THEN [Calculation_5872834692856524810]
ELSEIF [Parameters].[D1 (copy 2)_1113233589196361731]  = 21 THEN [State]
ELSEIF [Parameters].[D1 (copy 2)_1113233589196361731]  = 22 THEN [Phone]
// ELSEIF [Parameters].[D2] = 23 THEN [Tier]
ELSEIF [Parameters].[D1 (copy 2)_1113233589196361731]  = 23 THEN [Calculation_1277614987429064704]
ELSEIF [Parameters].[D1 (copy 2)_1113233589196361731]  = 25 THEN [Result Type]
ELSEIF [Parameters].[D1 (copy 2)_1113233589196361731]  = 26 THEN [placement]
ELSEIF [Parameters].[D1 (copy 2)_1113233589196361731]  = 27 THEN [Calculation_7690318609259716608]
ELSEIF [Parameters].[D1 (copy 2)_1113233589196361731]  = 28 THEN [label]
ELSEIF [Parameters].[D1 (copy 2)_1113233589196361731]  = 29 THEN STR([Calculation_1880252886088871936])
ELSEIF [Parameters].[D1 (copy 2)_1113233589196361731]  = 30 THEN [clientname]
ELSEIF [Parameters].[D1 (copy 2)_1113233589196361731]  = 31 THEN [page_path]
ELSEIF [Parameters].[D1 (copy 2)_1113233589196361731]  = 32 THEN [sgmt]
ELSEIF [Parameters].[D1 (copy 2)_1113233589196361731]  = 33 THEN [ctcphone]
ELSEIF [Parameters].[D1 (copy 2)_1113233589196361731]  = 34 THEN [Calculation_3435894714053935109]
ELSEIF [Parameters].[D1 (copy 2)_1113233589196361731]  = 35 THEN [ltdinoworkmedicalconditions]
ELSEIF [Parameters].[D1 (copy 2)_1113233589196361731]  = 36 THEN [ds_qualstatus]
ELSEIF [Parameters].[D1 (copy 2)_1113233589196361731]  = 37 THEN [ad_id]
ELSEIF [Parameters].[D1 (copy 2)_1113233589196361731]  = 38 THEN [adset_id]
ELSEIF [Parameters].[D1 (copy 2)_1113233589196361731]  = 39 THEN [Calculation_1113233589182521344]
ELSEIF [Parameters].[D1 (copy 2)_1113233589196361731]  = 40 THEN [Calculation_1880252886125215747]
ELSEIF [Parameters].[D1 (copy 2)_1113233589196361731]  = 41 THEN [SubSegment]
ELSEIF [Parameters].[D1 (copy 2)_1113233589196361731] = 42 THEN STR([Calculation_1133007210553765896])
ELSEIF [Parameters].[D1 (copy 2)_1113233589196361731] = 43 THEN [Calculation_7573084309404708864]
ELSEIF [Parameters].[D1 (copy 2)_1113233589196361731] = 44 THEN [Calculation_4531465651676438530]
ELSEIF [Parameters].[D1 (copy 2)_1113233589196361731] = 45 THEN IF LEN(STR([appearance_l30d])) < 2 AND NOT ISNULL(STR([appearance_l30d])) THEN '0' + STR([appearance_l30d]) ELSE STR([appearance_l30d]) END
ELSEIF [Parameters].[D1 (copy 2)_1113233589196361731] = 46 THEN IF LEN(STR([appearance_l60d])) < 2 AND NOT ISNULL(STR([appearance_l60d])) THEN '0' + STR([appearance_l60d]) ELSE STR([appearance_l60d]) END
ELSEIF [Parameters].[D1 (copy 2)_1113233589196361731] = 47 THEN IF LEN(STR([appearance_l90d])) < 2 AND NOT ISNULL(STR([appearance_l90d])) THEN '0' + STR([appearance_l90d]) ELSE STR([appearance_l90d]) END
ELSEIF [Parameters].[D1 (copy 2)_1113233589196361731] = 48 THEN [ATA Work]
ELSEIF [Parameters].[D1 (copy 2)_1113233589196361731] = 49 THEN [Calculation_499055157754740737]
ELSEIF [Parameters].[D1 (copy 2)_1113233589196361731] = 50 THEN IF LEN(STR([CIIC Appearance in L30D])) < 2 AND NOT ISNULL(STR([CIIC Appearance in L30D])) THEN '0' + STR([CIIC Appearance in L30D]) ELSE STR([CIIC Appearance in L30D]) END
ELSEIF [Parameters].[D1 (copy 2)_1113233589196361731] = 51 THEN IF LEN(STR([CIIC Appearance in L60D])) < 2 AND NOT ISNULL(STR([CIIC Appearance in L60D])) THEN '0' + STR([CIIC Appearance in L60D]) ELSE STR([CIIC Appearance in L60D]) END
ELSEIF [Parameters].[D1 (copy 2)_1113233589196361731] = 52 THEN IF LEN(STR([CIIC Appearance in L90D])) < 2 AND NOT ISNULL(STR([CIIC Appearance in L90D])) THEN '0' + STR([CIIC Appearance in L90D]) ELSE STR([CIIC Appearance in L90D]) END
ELSEIF [Parameters].[D1 (copy 2)_1113233589196361731] = 53 THEN STR([Calculation_989947527401095169])
ELSEIF [Parameters].[D1 (copy 2)_1113233589196361731] = 54 THEN [Calculation_1460573688699854848]
ELSEIF [Parameters].[D1 (copy 2)_1113233589196361731] = 55 THEN [Calculation_1006061976934187009]
ELSE 'Agg'
END",
    "name": "[D1 (copy)_6374000853573341191]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "D4",
    "datatype": "string",
    "formula": "IF [Parameters].[D1 (copy)_1113233589196333057] = 1 THEN [Calculation_6374000853566275585]
ELSEIF [Parameters].[D1 (copy)_1113233589196333057] = 2 THEN [bla_carrierdata_type]
ELSEIF [Parameters].[D1 (copy)_1113233589196333057] = 3 THEN [Calculation_6374000853565702144]
ELSEIF [Parameters].[D1 (copy)_1113233589196333057] = 4 THEN [Phone Carrier]
ELSEIF [Parameters].[D1 (copy)_1113233589196333057] = 5 THEN [CZ Project Name]
ELSEIF [Parameters].[D1 (copy)_1113233589196333057] = 6 THEN [Phone Type]
ELSEIF [Parameters].[D1 (copy)_1113233589196333057] = 7 THEN [normalized carrier]
ELSEIF [Parameters].[D1 (copy)_1113233589196333057] = 8 THEN [Outcome]
ELSEIF [Parameters].[D1 (copy)_1113233589196333057] = 9 THEN [qual_status]
ELSEIF [Parameters].[D1 (copy)_1113233589196333057] = 10 THEN [Source]
ELSEIF [Parameters].[D1 (copy)_1113233589196333057] = 11 THEN [Sub Id]
ELSEIF [Parameters].[D1 (copy)_1113233589196333057] = 12 THEN [gender (copy)_2399292755830108162]
ELSEIF [Parameters].[D1 (copy)_1113233589196333057] = 13 THEN [Creative]
ELSEIF [Parameters].[D1 (copy)_1113233589196333057] = 14 THEN [CL Diagnosis Injury Tiers]
ELSEIF [Parameters].[D1 (copy)_1113233589196333057] = 15 THEN [Calculation_935059914517495808]
ELSEIF [Parameters].[D1 (copy)_1113233589196333057] = 16 THEN [Ad Name]
ELSEIF [Parameters].[D1 (copy)_1113233589196333057] = 17 THEN [Adset Name]
ELSEIF [Parameters].[D1 (copy)_1113233589196333057] = 18 THEN [campaign_id]
ELSEIF [Parameters].[D1 (copy)_1113233589196333057] = 19 THEN [Labels]
ELSEIF [Parameters].[D1 (copy)_1113233589196333057] = 20 THEN [Calculation_5872834692856524810]
ELSEIF [Parameters].[D1 (copy)_1113233589196333057] = 21 THEN [State]
ELSEIF [Parameters].[D1 (copy)_1113233589196333057] = 22 THEN [Phone]
// ELSEIF [Parameters].[D4] = 23 THEN [Tier]
ELSEIF [Parameters].[D1 (copy)_1113233589196333057] = 23 THEN [Calculation_1277614987429064704]
ELSEIF [Parameters].[D1 (copy)_1113233589196333057] = 25 THEN [Result Type]
ELSEIF [Parameters].[D1 (copy)_1113233589196333057] = 26 THEN [placement]
ELSEIF [Parameters].[D1 (copy)_1113233589196333057] = 27 THEN [Calculation_7690318609259716608]
ELSEIF [Parameters].[D1 (copy)_1113233589196333057] = 28 THEN [label]
ELSEIF [Parameters].[D1 (copy)_1113233589196333057] = 29 THEN STR([Calculation_1880252886088871936])
ELSEIF [Parameters].[D1 (copy)_1113233589196333057] = 30 THEN [clientname]
ELSEIF [Parameters].[D1 (copy)_1113233589196333057] = 31 THEN [page_path]
ELSEIF [Parameters].[D1 (copy)_1113233589196333057] = 32 THEN [sgmt]
ELSEIF [Parameters].[D1 (copy)_1113233589196333057] = 33 THEN [ctcphone]
ELSEIF [Parameters].[D1 (copy)_1113233589196333057] = 34 THEN [Calculation_3435894714053935109]
ELSEIF [Parameters].[D1 (copy)_1113233589196333057] = 35 THEN [ltdinoworkmedicalconditions]
ELSEIF [Parameters].[D1 (copy)_1113233589196333057] = 36 THEN [ds_qualstatus]
ELSEIF [Parameters].[D1 (copy)_1113233589196333057] = 37 THEN [ad_id]
ELSEIF [Parameters].[D1 (copy)_1113233589196333057] = 38 THEN [adset_id]
ELSEIF [Parameters].[D1 (copy)_1113233589196333057] = 39 THEN [Calculation_1113233589182521344]
ELSEIF [Parameters].[D1 (copy)_1113233589196333057] = 40 THEN [Calculation_1880252886125215747]
ELSEIF [Parameters].[D1 (copy)_1113233589196333057] = 41 THEN [SubSegment]
ELSEIF [Parameters].[D1 (copy)_1113233589196333057] = 42 THEN STR([Calculation_1133007210553765896])
ELSEIF [Parameters].[D1 (copy)_1113233589196333057] = 43 THEN [Calculation_7573084309404708864]
ELSEIF [Parameters].[D1 (copy)_1113233589196333057] = 44 THEN [Calculation_4531465651676438530]
ELSEIF [Parameters].[D1 (copy)_1113233589196333057] = 45 THEN IF LEN(STR([appearance_l30d])) < 2 AND NOT ISNULL(STR([appearance_l30d])) THEN '0' + STR([appearance_l30d]) ELSE STR([appearance_l30d]) END
ELSEIF [Parameters].[D1 (copy)_1113233589196333057] = 46 THEN IF LEN(STR([appearance_l60d])) < 2 AND NOT ISNULL(STR([appearance_l60d])) THEN '0' + STR([appearance_l60d]) ELSE STR([appearance_l60d]) END
ELSEIF [Parameters].[D1 (copy)_1113233589196333057] = 47 THEN IF LEN(STR([appearance_l90d])) < 2 AND NOT ISNULL(STR([appearance_l90d])) THEN '0' + STR([appearance_l90d]) ELSE STR([appearance_l90d]) END
ELSEIF [Parameters].[D1 (copy)_1113233589196333057] = 48 THEN [ATA Work]
ELSEIF [Parameters].[D1 (copy)_1113233589196333057] = 49 THEN [Calculation_499055157754740737]
ELSEIF [Parameters].[D1 (copy)_1113233589196333057] = 50 THEN IF LEN(STR([CIIC Appearance in L30D])) < 2 AND NOT ISNULL(STR([CIIC Appearance in L30D])) THEN '0' + STR([CIIC Appearance in L30D]) ELSE STR([CIIC Appearance in L30D]) END
ELSEIF [Parameters].[D1 (copy)_1113233589196333057] = 51 THEN IF LEN(STR([CIIC Appearance in L60D])) < 2 AND NOT ISNULL(STR([CIIC Appearance in L60D])) THEN '0' + STR([CIIC Appearance in L60D]) ELSE STR([CIIC Appearance in L60D]) END
ELSEIF [Parameters].[D1 (copy)_1113233589196333057] = 52 THEN IF LEN(STR([CIIC Appearance in L90D])) < 2 AND NOT ISNULL(STR([CIIC Appearance in L90D])) THEN '0' + STR([CIIC Appearance in L90D]) ELSE STR([CIIC Appearance in L90D]) END
ELSEIF [Parameters].[D1 (copy)_1113233589196333057] = 53 THEN STR([Calculation_989947527401095169])
ELSEIF [Parameters].[D1 (copy)_1113233589196333057] = 54 THEN [Calculation_1460573688699854848]
ELSEIF [Parameters].[D1 (copy)_1113233589196333057] = 55 THEN [Calculation_1006061976934187009]
ELSE 'Agg'
END",
    "name": "[D3 (copy)_6208563937532035081]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "D5",
    "datatype": "string",
    "formula": "IF [Parameters].[D1 (copy) (copy)_1113233589196361730] = 1 THEN [Calculation_6374000853566275585]
ELSEIF [Parameters].[D1 (copy) (copy)_1113233589196361730] = 2 THEN [bla_carrierdata_type]
ELSEIF [Parameters].[D1 (copy) (copy)_1113233589196361730] = 3 THEN [Calculation_6374000853565702144]
ELSEIF [Parameters].[D1 (copy) (copy)_1113233589196361730] = 4 THEN [Phone Carrier]
ELSEIF [Parameters].[D1 (copy) (copy)_1113233589196361730] = 5 THEN [CZ Project Name]
ELSEIF [Parameters].[D1 (copy) (copy)_1113233589196361730] = 6 THEN [Phone Type]
ELSEIF [Parameters].[D1 (copy) (copy)_1113233589196361730] = 7 THEN [normalized carrier]
ELSEIF [Parameters].[D1 (copy) (copy)_1113233589196361730] = 8 THEN [Outcome]
ELSEIF [Parameters].[D1 (copy) (copy)_1113233589196361730] = 9 THEN [qual_status]
ELSEIF [Parameters].[D1 (copy) (copy)_1113233589196361730] = 10 THEN [Source]
ELSEIF [Parameters].[D1 (copy) (copy)_1113233589196361730] = 11 THEN [Sub Id]
ELSEIF [Parameters].[D1 (copy) (copy)_1113233589196361730] = 12 THEN [gender (copy)_2399292755830108162]
ELSEIF [Parameters].[D1 (copy) (copy)_1113233589196361730] = 13 THEN [Creative]
ELSEIF [Parameters].[D1 (copy) (copy)_1113233589196361730] = 14 THEN [CL Diagnosis Injury Tiers]
ELSEIF [Parameters].[D1 (copy) (copy)_1113233589196361730] = 15 THEN [Calculation_935059914517495808]
ELSEIF [Parameters].[D1 (copy) (copy)_1113233589196361730] = 16 THEN [Ad Name]
ELSEIF [Parameters].[D1 (copy) (copy)_1113233589196361730] = 17 THEN [Adset Name]
ELSEIF [Parameters].[D1 (copy) (copy)_1113233589196361730] = 18 THEN [campaign_id]
ELSEIF [Parameters].[D1 (copy) (copy)_1113233589196361730] = 19 THEN [Labels]
ELSEIF [Parameters].[D1 (copy) (copy)_1113233589196361730] = 20 THEN [Calculation_5872834692856524810]
ELSEIF [Parameters].[D1 (copy) (copy)_1113233589196361730] = 21 THEN [State]
ELSEIF [Parameters].[D1 (copy) (copy)_1113233589196361730] = 22 THEN [Phone]
// ELSEIF [Parameters].[D5] = 23 THEN [Tier]
ELSEIF [Parameters].[D1 (copy) (copy)_1113233589196361730] = 23 THEN [Calculation_1277614987429064704]
ELSEIF [Parameters].[D1 (copy) (copy)_1113233589196361730] = 25 THEN [Result Type]
ELSEIF [Parameters].[D1 (copy) (copy)_1113233589196361730] = 26 THEN [placement]
ELSEIF [Parameters].[D1 (copy) (copy)_1113233589196361730] = 27 THEN [Calculation_7690318609259716608]
ELSEIF [Parameters].[D1 (copy) (copy)_1113233589196361730] = 28 THEN [label]
ELSEIF [Parameters].[D1 (copy) (copy)_1113233589196361730] = 29 THEN STR([Calculation_1880252886088871936])
ELSEIF [Parameters].[D1 (copy) (copy)_1113233589196361730] = 30 THEN [clientname]
ELSEIF [Parameters].[D1 (copy) (copy)_1113233589196361730] = 31 THEN [page_path]
ELSEIF [Parameters].[D1 (copy) (copy)_1113233589196361730] = 32 THEN [sgmt]
ELSEIF [Parameters].[D1 (copy) (copy)_1113233589196361730] = 33 THEN [ctcphone]
ELSEIF [Parameters].[D1 (copy) (copy)_1113233589196361730] = 34 THEN [Calculation_3435894714053935109]
ELSEIF [Parameters].[D1 (copy) (copy)_1113233589196361730] = 35 THEN [ltdinoworkmedicalconditions]
ELSEIF [Parameters].[D1 (copy) (copy)_1113233589196361730] = 36 THEN [ds_qualstatus]
ELSEIF [Parameters].[D1 (copy) (copy)_1113233589196361730] = 37 THEN [ad_id]
ELSEIF [Parameters].[D1 (copy) (copy)_1113233589196361730] = 38 THEN [adset_id]
ELSEIF [Parameters].[D1 (copy) (copy)_1113233589196361730] = 39 THEN [Calculation_1113233589182521344]
ELSEIF [Parameters].[D1 (copy) (copy)_1113233589196361730] = 40 THEN [Calculation_1880252886125215747]
ELSEIF [Parameters].[D1 (copy) (copy)_1113233589196361730] = 41 THEN [SubSegment]
ELSEIF [Parameters].[D1 (copy) (copy)_1113233589196361730] = 42 THEN STR([Calculation_1133007210553765896])
ELSEIF [Parameters].[D1 (copy) (copy)_1113233589196361730] = 43 THEN [Calculation_7573084309404708864]
ELSEIF [Parameters].[D1 (copy) (copy)_1113233589196361730] = 44 THEN [Calculation_4531465651676438530]
ELSEIF [Parameters].[D1 (copy) (copy)_1113233589196361730] = 45 THEN IF LEN(STR([appearance_l30d])) < 2 AND NOT ISNULL(STR([appearance_l30d])) THEN '0' + STR([appearance_l30d]) ELSE STR([appearance_l30d]) END
ELSEIF [Parameters].[D1 (copy) (copy)_1113233589196361730] = 46 THEN IF LEN(STR([appearance_l60d])) < 2 AND NOT ISNULL(STR([appearance_l60d])) THEN '0' + STR([appearance_l60d]) ELSE STR([appearance_l60d]) END
ELSEIF [Parameters].[D1 (copy) (copy)_1113233589196361730] = 47 THEN IF LEN(STR([appearance_l90d])) < 2 AND NOT ISNULL(STR([appearance_l90d])) THEN '0' + STR([appearance_l90d]) ELSE STR([appearance_l90d]) END
ELSEIF [Parameters].[D1 (copy) (copy)_1113233589196361730] = 48 THEN [ATA Work]
ELSEIF [Parameters].[D1 (copy) (copy)_1113233589196361730] = 49 THEN [Calculation_499055157754740737]
ELSEIF [Parameters].[D1 (copy) (copy)_1113233589196361730] = 50 THEN IF LEN(STR([CIIC Appearance in L30D])) < 2 AND NOT ISNULL(STR([CIIC Appearance in L30D])) THEN '0' + STR([CIIC Appearance in L30D]) ELSE STR([CIIC Appearance in L30D]) END
ELSEIF [Parameters].[D1 (copy) (copy)_1113233589196361730] = 51 THEN IF LEN(STR([CIIC Appearance in L60D])) < 2 AND NOT ISNULL(STR([CIIC Appearance in L60D])) THEN '0' + STR([CIIC Appearance in L60D]) ELSE STR([CIIC Appearance in L60D]) END
ELSEIF [Parameters].[D1 (copy) (copy)_1113233589196361730] = 52 THEN IF LEN(STR([CIIC Appearance in L90D])) < 2 AND NOT ISNULL(STR([CIIC Appearance in L90D])) THEN '0' + STR([CIIC Appearance in L90D]) ELSE STR([CIIC Appearance in L90D]) END
ELSEIF [Parameters].[D1 (copy) (copy)_1113233589196361730] = 53 THEN STR([Calculation_989947527401095169])
ELSEIF [Parameters].[D1 (copy) (copy)_1113233589196361730] = 54 THEN [Calculation_1460573688699854848]
ELSEIF [Parameters].[D1 (copy) (copy)_1113233589196361730] = 55 THEN [Calculation_1006061976934187009]
ELSE 'Agg'
END",
    "name": "[D4 (copy)_6208563937532350475]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Age Exclusions",
    "datatype": "string",
    "formula": "[Age Range]",
    "name": "[age range (copy)_99712551094624281]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Gender",
    "datatype": "string",
    "formula": "//Updated Date: 18 May 2022
//Updated By: Manish
//Description: Converting gnder values to upper case

UPPER([Gender])",
    "name": "[gender (copy)_2399292755830108162]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Show Source",
    "datatype": "string",
    "formula": ""1"",
    "name": "[Phone (copy)_1255659924007981058]",
    "role": "measure",
    "type": "nominal",
  },
  {
    "caption": "TTW Grade",
    "datatype": "string",
    "formula": "IF [ttw_qualstatus] = 'ttw-qualified' then 'Grade A'
ELSEIF  [ttw_qualstatus] = 'ttw-nonqualified' and [TTW Explore Work Form] = 'yes' THEN 'Grade B'
ELSEIF [ttw_qualstatus] = 'ttw-nonqualified' and [TTW Explore Work Form] != 'yes' THEN 'Grade C'
ELSEIF ISNULL([ttw_qualstatus]) and [Stage3 Response] = 'Between 2 and 4 years' then 'Grade D'
ELSE 'Rest'
END",
    "name": "[Calculation_1006061976934187009]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "20hrs Disqual",
    "datatype": "integer",
    "formula": "IF [Stage6 Response] = "More than 20 hours per week" THEN 1 ELSE 0 END",
    "name": "[Calculation_1133007210546622464]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Age Disqual",
    "datatype": "integer",
    "formula": "IF INT([Age]) < 40 OR INT([Age]) > 62 THEN 1 ELSE 0 END",
    "name": "[Calculation_1133007210553298946]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Attorney Disqual",
    "datatype": "integer",
    "formula": "IF [Stage5 Response] = "Yes" THEN 1 ELSE 0 END",
    "name": "[Calculation_1133007210553425923]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Ben Disqual",
    "datatype": "integer",
    "formula": "IF IFNULL([Stage1 Response], "") != "I am not receiving any disability benefits (SSD or SSI)"
THEN 1 ELSE 0 END",
    "name": "[Calculation_1133007210553487364]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Doctor Visit Disqual",
    "datatype": "integer",
    "formula": "IF [Stage4 Response] = "No" THEN 1 ELSE 0 END",
    "name": "[Calculation_1133007210553540613]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Five Year Work Disqual",
    "datatype": "integer",
    "formula": "IF [Stage3 Response] = "Less than 2 years"
OR [Stage3 Response] = "Between 2 and 4 years"
THEN 1 ELSE 0 END",
    "name": "[Calculation_1133007210553618438]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Out of Work Disqual",
    "datatype": "integer",
    "formula": "IF [Stage2 Response] = "No" THEN 1 ELSE 0 END",
    "name": "[Calculation_1133007210553663495]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "# of Disqual",
    "datatype": "integer",
    "formula": "ZN([Calculation_1133007210553487364]) +
ZN([Calculation_1133007210553663495]) +
ZN([Calculation_1133007210553618438]) +
ZN([Calculation_1133007210553540613]) +
ZN([Calculation_1133007210553425923]) +
ZN([Calculation_1133007210546622464]) +
ZN([Calculation_1133007210553298946])",
    "name": "[Calculation_1133007210553765896]",
    "role": "dimension",
    "type": "ordinal",
  },
  {
    "caption": "Unresolved SSA Leads",
    "datatype": "string",
    "formula": "IF { FIXED [Phone] : MAX([Resolved Lead]) } = 0 THEN "SSA Unresolved Lead"
ELSEIF { FIXED [Phone] : MAX([Resolved Lead]) } = 1 THEN "SSA Resolved Lead"
END",
    "name": "[Calculation_1467962419029331969]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Data Updated On",
    "datatype": "datetime",
    "formula": "{fixed :max([Post Date])}",
    "name": "[Calculation_2010857255412854784]",
    "role": "dimension",
    "type": "ordinal",
  },
  {
    "caption": "Grade",
    "datatype": "string",
    "formula": "// Grade A
IF [qual_status] = 'all-steps' THEN 'Grade A'

// Grade B
ELSEIF 
    [qual_status] IN ('fiveyrwrk-disqual','outofwrk-disqual','doc-disqual')
    AND [Calculation_1133007210553765896] = 1
THEN 'Grade B'

// Grade C
ELSEIF 
    [qual_status] <> 'age-disqual'
    AND NOT [Stage3 Response] IN ('Less than 2 years', 'Between 2 and 4 years')
    AND [Stage1 Response] <> 'Social Security Disability (SSD) Benefits'
    AND [Stage6 Response] = 'Not working'
THEN 'Grade C'

// Grade D
ELSEIF 
    // 1) Not age-disqual, Stage3 NOT in those two, Stage1 not SSD, Stage6 ≠ Not working, disqual ≤ 1
    (
      [qual_status] <> 'age-disqual'
      AND NOT [Stage3 Response] IN ('Less than 2 years', 'Between 2 and 4 years')
      AND [Stage1 Response] <> 'Social Security Disability (SSD) Benefits'
      AND [Stage6 Response] <> 'Not working'
      AND [Calculation_1133007210553765896] <= 1
    )
    // 2) Not age-disqual, Stage3 in those two, Qual Status = outofwrk-disqual
    OR
    (
      [qual_status] <> 'age-disqual'
      AND [Stage3 Response] IN ('Less than 2 years', 'Between 2 and 4 years')
      AND [qual_status] = 'outofwrk-disqual'
    )
    // 3) Not age-disqual, Stage3 in those two, Qual Status ≠ outofwrk-disqual, Stage7 = Yes
    OR
    (
      [qual_status] <> 'age-disqual'
      AND [Stage3 Response] IN ('Less than 2 years', 'Between 2 and 4 years')
      AND [qual_status] <> 'outofwrk-disqual'
      AND [Stage7 Response] = 'Yes'
    )
THEN 'Grade D'

// Rest (including age-disqual or anything else)
ELSE 'Rest'
END",
    "name": "[Calculation_7573084309404708864]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Time-Source-Subid",
    "datatype": "string",
    "formula": "//Updated Date: 18 May 2022
//Updated By: Manish
//Description: Changing the data type to string of Time-Source-Subid column

STR([Date])+'-'+[Source]+'-'+[Sub Id]",
    "name": "[Calculation_7746824680808361990]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Dial R",
    "datatype": "string",
    "formula": "IF  [Called Count] < 4 then "<=3" 
elseif [Called Count] < 8 then "4-7"
elseif [Called Count] < 11 then "8-10"
elseif [Called Count] < 16 then "11-15"
elseif [Called Count] < 20 then "16-19"
elseif [Called Count] < 26 then "20-25"
elseif [Called Count] < 31 then "25-30"
elseif [Called Count] < 36 then "30-35"
else "35+" 
END",
    "name": "[Calculation_847802666706034688]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Dial R (detail)",
    "datatype": "string",
    "formula": "STR([Called Count])",
    "name": "[Calculation_847802666706186241]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Source ",
    "datatype": "string",
    "formula": "CASE [Parameters].[Phone (copy)_1255659924007981058]
WHEN "0" THEN "Agg"
WHEN "1" THEN [Source]
END",
    "name": "[Phone (copy)_1255659924007964673]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "TTW Grade",
    "datatype": "string",
    "formula": "IF [ttw_qualstatus] = 'ttw-qualified' then 'Grade A'
ELSEIF  [ttw_qualstatus] = 'ttw-nonqualified' and [TTW Explore Work Form] = 'yes' THEN 'Grade B'
ELSEIF [ttw_qualstatus] = 'ttw-nonqualified' and [TTW Explore Work Form] != 'yes' THEN 'Grade C'
ELSEIF ISNULL([ttw_qualstatus]) and [Stage3 Response] = 'Between 2 and 4 years' then 'Grade D'
ELSE 'Rest'
END",
    "name": "[Calculation_1006061976934187009]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "20hrs Disqual",
    "datatype": "integer",
    "formula": "IF [Stage6 Response] = "More than 20 hours per week" THEN 1 ELSE 0 END",
    "name": "[Calculation_1133007210546622464]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Age Disqual",
    "datatype": "integer",
    "formula": "IF INT([Age]) < 40 OR INT([Age]) > 62 THEN 1 ELSE 0 END",
    "name": "[Calculation_1133007210553298946]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Attorney Disqual",
    "datatype": "integer",
    "formula": "IF [Stage5 Response] = "Yes" THEN 1 ELSE 0 END",
    "name": "[Calculation_1133007210553425923]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Ben Disqual",
    "datatype": "integer",
    "formula": "IF IFNULL([Stage1 Response], "") != "I am not receiving any disability benefits (SSD or SSI)"
THEN 1 ELSE 0 END",
    "name": "[Calculation_1133007210553487364]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Doctor Visit Disqual",
    "datatype": "integer",
    "formula": "IF [Stage4 Response] = "No" THEN 1 ELSE 0 END",
    "name": "[Calculation_1133007210553540613]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Five Year Work Disqual",
    "datatype": "integer",
    "formula": "IF [Stage3 Response] = "Less than 2 years"
OR [Stage3 Response] = "Between 2 and 4 years"
THEN 1 ELSE 0 END",
    "name": "[Calculation_1133007210553618438]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Out of Work Disqual",
    "datatype": "integer",
    "formula": "IF [Stage2 Response] = "No" THEN 1 ELSE 0 END",
    "name": "[Calculation_1133007210553663495]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "# of Disqual",
    "datatype": "integer",
    "formula": "ZN([Calculation_1133007210553487364]) +
ZN([Calculation_1133007210553663495]) +
ZN([Calculation_1133007210553618438]) +
ZN([Calculation_1133007210553540613]) +
ZN([Calculation_1133007210553425923]) +
ZN([Calculation_1133007210546622464]) +
ZN([Calculation_1133007210553298946])",
    "name": "[Calculation_1133007210553765896]",
    "role": "dimension",
    "type": "ordinal",
  },
  {
    "caption": "Unresolved SSA Leads",
    "datatype": "string",
    "formula": "IF { FIXED [Phone] : MAX([Resolved Lead]) } = 0 THEN "SSA Unresolved Lead"
ELSEIF { FIXED [Phone] : MAX([Resolved Lead]) } = 1 THEN "SSA Resolved Lead"
END",
    "name": "[Calculation_1467962419029331969]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Data Updated On",
    "datatype": "datetime",
    "formula": "{fixed :max([Post Date])}",
    "name": "[Calculation_2010857255412854784]",
    "role": "dimension",
    "type": "ordinal",
  },
  {
    "caption": "Last 7 Days",
    "datatype": "integer",
    "formula": "//Updated Date: 18 May 2022
//Updated By: Manish
//Description: Counting the unique count of user id in the last 7 days

COUNTD(IF [Date]>=DATEADD('day',-7,TODAY()) THEN [User Id] END)",
    "name": "[Calculation_2120632528687255559]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Grade",
    "datatype": "string",
    "formula": "// Grade A
IF [qual_status] = 'all-steps' THEN 'Grade A'

// Grade B
ELSEIF 
    [qual_status] IN ('fiveyrwrk-disqual','outofwrk-disqual','doc-disqual')
    AND [Calculation_1133007210553765896] = 1
THEN 'Grade B'

// Grade C
ELSEIF 
    [qual_status] <> 'age-disqual'
    AND NOT [Stage3 Response] IN ('Less than 2 years', 'Between 2 and 4 years')
    AND [Stage1 Response] <> 'Social Security Disability (SSD) Benefits'
    AND [Stage6 Response] = 'Not working'
THEN 'Grade C'

// Grade D
ELSEIF 
    // 1) Not age-disqual, Stage3 NOT in those two, Stage1 not SSD, Stage6 ≠ Not working, disqual ≤ 1
    (
      [qual_status] <> 'age-disqual'
      AND NOT [Stage3 Response] IN ('Less than 2 years', 'Between 2 and 4 years')
      AND [Stage1 Response] <> 'Social Security Disability (SSD) Benefits'
      AND [Stage6 Response] <> 'Not working'
      AND [Calculation_1133007210553765896] <= 1
    )
    // 2) Not age-disqual, Stage3 in those two, Qual Status = outofwrk-disqual
    OR
    (
      [qual_status] <> 'age-disqual'
      AND [Stage3 Response] IN ('Less than 2 years', 'Between 2 and 4 years')
      AND [qual_status] = 'outofwrk-disqual'
    )
    // 3) Not age-disqual, Stage3 in those two, Qual Status ≠ outofwrk-disqual, Stage7 = Yes
    OR
    (
      [qual_status] <> 'age-disqual'
      AND [Stage3 Response] IN ('Less than 2 years', 'Between 2 and 4 years')
      AND [qual_status] <> 'outofwrk-disqual'
      AND [Stage7 Response] = 'Yes'
    )
THEN 'Grade D'

// Rest (including age-disqual or anything else)
ELSE 'Rest'
END",
    "name": "[Calculation_7573084309404708864]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Time-Source-Subid",
    "datatype": "string",
    "formula": "//Updated Date: 18 May 2022
//Updated By: Manish
//Description: Changing the data type to string of Time-Source-Subid column

STR([Date])+'-'+[Source]+'-'+[Sub Id]",
    "name": "[Calculation_7746824680808361990]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Dial R",
    "datatype": "string",
    "formula": "IF  [Called Count] < 4 then "<=3" 
elseif [Called Count] < 8 then "4-7"
elseif [Called Count] < 11 then "8-10"
elseif [Called Count] < 16 then "11-15"
elseif [Called Count] < 20 then "16-19"
elseif [Called Count] < 26 then "20-25"
elseif [Called Count] < 31 then "25-30"
elseif [Called Count] < 36 then "30-35"
else "35+" 
END",
    "name": "[Calculation_847802666706034688]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Dial R (detail)",
    "datatype": "string",
    "formula": "STR([Called Count])",
    "name": "[Calculation_847802666706186241]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Row Id",
    "datatype": "integer",
    "formula": "INDEX()",
    "name": "[Calculation_97320012553666594]",
    "role": "measure",
    "type": "ordinal",
  },
  {
    "caption": "Source-subid ",
    "datatype": "string",
    "formula": "//Updated Date: 18 May 2022
//Updated By: Manish//Description: Calculating max of todays date for including it in the default values of end date
//Description: Concatinating source and subid column

[Source]+" : "+[Sub Id]",
    "name": "[Source-Subid (copy)_2399292755892068371]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Helper Date",
    "datatype": "string",
    "formula": ""default"",
    "name": "[Parameter 11]",
    "role": "measure",
    "type": "nominal",
  },
  {
    "caption": "Date Bucket",
    "datatype": "string",
    "formula": ""day"",
    "name": "[Parameter 1]",
    "role": "measure",
    "type": "nominal",
  },
  {
    "caption": "5% Cutoff",
    "datatype": "real",
    "formula": "0.2",
    "name": "[Parameter 3]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Min Threshold",
    "datatype": "integer",
    "formula": "2",
    "name": "[Parameter 4]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Start Date",
    "datatype": "date",
    "formula": "#2025-07-30#",
    "name": "[Parameter 5]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "End Date",
    "datatype": "date",
    "formula": "#2025-08-27#",
    "name": "[Parameter 6]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "% <5s",
    "datatype": "real",
    "formula": "//Updated Date: 18 May 2022
//Updated By: Manish
//Description: Calculating the percentage of ping age <5s

[Calculation_172262731327561728]/[Calculation_2399292755836653580]",
    "name": "[% <5s (copy)_2399292755838119952]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "<005",
    "datatype": "integer",
    "formula": "//Updated Date: 18 May 2022
//Updated By: Manish
//Description: Calculating the unique count of userid when ping age is <=5s

COUNTD(IF [Ping Age (s)]>0 and [Ping Age (s)]<=5 then [User Id] end)",
    "name": "[0 (copy)_2399292755834134533]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "MinThreshold Filter",
    "datatype": "string",
    "formula": "//Updated Date: 18 May 2022
//Updated By: Manish
//Description: Filtering data to exclude minimum threshold of total value


IF ZN([Calculation_2399292755836653580])<=[Parameters].[Parameter 4] THEN "Hide"
ELSE "Show" END",
    "name": "[5% Cutoff Filter (copy)_2399292755843940370]",
    "role": "measure",
    "type": "nominal",
  },
  {
    "caption": "<010",
    "datatype": "integer",
    "formula": "//Updated Date: 18 May 2022
//Updated By: Manish
//Description: Calculating the unique count of userid when ping age is between 5 and 10s

COUNTD(IF [Ping Age (s)]>5 and [Ping Age (s)]<=10 then [User Id] end)",
    "name": "[<005 (copy)_2399292755834429446]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "<025",
    "datatype": "integer",
    "formula": "//Updated Date: 18 May 2022
//Updated By: Manish
//Description: Calculating the unique count of userid when ping age is between 10 and 25s

COUNTD(IF [Ping Age (s)]>10 and [Ping Age (s)]<=25 then [User Id] end)",
    "name": "[<005 (copy)_2399292755835043847]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "<100",
    "datatype": "integer",
    "formula": "//Updated Date: 18 May 2022
//Updated By: Manish
//Description: Calculating the unique count of userid when ping age is between 25 and 100s

COUNTD(IF [Ping Age (s)]>25 and [Ping Age (s)]<=100 then [User Id] end)",
    "name": "[<010 (copy)_2399292755836125192]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "<200",
    "datatype": "integer",
    "formula": "//Updated Date: 18 May 2022
//Updated By: Manish
//Description: Calculating the unique count of userid when ping age is between 100 and 200s

COUNTD(IF [Ping Age (s)]>100 and [Ping Age (s)]<=200 then [User Id] end)",
    "name": "[<100 (copy)_2399292755836203017]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": ">200",
    "datatype": "integer",
    "formula": "//Updated Date: 18 May 2022
//Updated By: Manish
//Description: Calculating the unique count of userid when ping age is greater than 200s

COUNTD(IF [Ping Age (s)]>200 then [User Id] end)",
    "name": "[<200 (copy)_2399292755836375050]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "<10s Cumulative",
    "datatype": "integer",
    "formula": "//Updated Date: 18 May 2022
//Updated By: Manish
//Description: Calculating the sum of userid when ping age is between 0 and 10s

[Ping age (copy)_2399292755833638916]+[0 (copy)_2399292755834134533]+[<005 (copy)_2399292755834429446]",
    "name": "[<5s Cumulative (copy)_2399292755837362190]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "TTW Grade",
    "datatype": "string",
    "formula": "IF [ttw_qualstatus] = 'ttw-qualified' then 'Grade A'
ELSEIF  [ttw_qualstatus] = 'ttw-nonqualified' and [TTW Explore Work Form] = 'yes' THEN 'Grade B'
ELSEIF [ttw_qualstatus] = 'ttw-nonqualified' and [TTW Explore Work Form] != 'yes' THEN 'Grade C'
ELSEIF ISNULL([ttw_qualstatus]) and [Stage3 Response] = 'Between 2 and 4 years' then 'Grade D'
ELSE 'Rest'
END",
    "name": "[Calculation_1006061976934187009]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "20hrs Disqual",
    "datatype": "integer",
    "formula": "IF [Stage6 Response] = "More than 20 hours per week" THEN 1 ELSE 0 END",
    "name": "[Calculation_1133007210546622464]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Age Disqual",
    "datatype": "integer",
    "formula": "IF INT([Age]) < 40 OR INT([Age]) > 62 THEN 1 ELSE 0 END",
    "name": "[Calculation_1133007210553298946]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Attorney Disqual",
    "datatype": "integer",
    "formula": "IF [Stage5 Response] = "Yes" THEN 1 ELSE 0 END",
    "name": "[Calculation_1133007210553425923]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Ben Disqual",
    "datatype": "integer",
    "formula": "IF IFNULL([Stage1 Response], "") != "I am not receiving any disability benefits (SSD or SSI)"
THEN 1 ELSE 0 END",
    "name": "[Calculation_1133007210553487364]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Doctor Visit Disqual",
    "datatype": "integer",
    "formula": "IF [Stage4 Response] = "No" THEN 1 ELSE 0 END",
    "name": "[Calculation_1133007210553540613]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Five Year Work Disqual",
    "datatype": "integer",
    "formula": "IF [Stage3 Response] = "Less than 2 years"
OR [Stage3 Response] = "Between 2 and 4 years"
THEN 1 ELSE 0 END",
    "name": "[Calculation_1133007210553618438]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Out of Work Disqual",
    "datatype": "integer",
    "formula": "IF [Stage2 Response] = "No" THEN 1 ELSE 0 END",
    "name": "[Calculation_1133007210553663495]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "# of Disqual",
    "datatype": "integer",
    "formula": "ZN([Calculation_1133007210553487364]) +
ZN([Calculation_1133007210553663495]) +
ZN([Calculation_1133007210553618438]) +
ZN([Calculation_1133007210553540613]) +
ZN([Calculation_1133007210553425923]) +
ZN([Calculation_1133007210546622464]) +
ZN([Calculation_1133007210553298946])",
    "name": "[Calculation_1133007210553765896]",
    "role": "dimension",
    "type": "ordinal",
  },
  {
    "caption": "Unresolved SSA Leads",
    "datatype": "string",
    "formula": "IF { FIXED [Phone] : MAX([Resolved Lead]) } = 0 THEN "SSA Unresolved Lead"
ELSEIF { FIXED [Phone] : MAX([Resolved Lead]) } = 1 THEN "SSA Resolved Lead"
END",
    "name": "[Calculation_1467962419029331969]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "<5s Cumulative",
    "datatype": "integer",
    "formula": "//Updated Date: 18 May 2022
//Updated By: Manish
//Description: Calculating the sum of userid when ping age is between 0 and 5s

[Ping age (copy)_2399292755833638916]+[0 (copy)_2399292755834134533]",
    "name": "[Calculation_172262731327561728]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Post Date ",
    "datatype": "datetime",
    "formula": "//Updated Date: 18 May 2022
//Updated By: Manish
//Description: Formula to calculate UTC date

DATEADD("hour",0,[Post Date])",
    "name": "[Calculation_1916563181826678784]",
    "role": "dimension",
    "type": "ordinal",
  },
  {
    "caption": "Data Updated On",
    "datatype": "datetime",
    "formula": "{fixed :max([Post Date])}",
    "name": "[Calculation_2010857255412854784]",
    "role": "dimension",
    "type": "ordinal",
  },
  {
    "caption": "Total",
    "datatype": "integer",
    "formula": "//Updated Date: 18 May 2022
//Updated By: Manish
//Description: Calculating the total of ping age

[0 (copy)_2399292755834134533]+[<005 (copy)_2399292755834429446]+[<005 (copy)_2399292755835043847]+[<010 (copy)_2399292755836125192]+[<100 (copy)_2399292755836203017]+[<200 (copy)_2399292755836375050]+[Ping age (copy)_2399292755833638916]",
    "name": "[Calculation_2399292755836653580]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "% <10s",
    "datatype": "real",
    "formula": "//Updated Date: 18 May 2022
//Updated By: Manish
//Description: Calculating the percentage of ping age <10s

[<5s Cumulative (copy)_2399292755837362190]/[Calculation_2399292755836653580]",
    "name": "[Calculation_2399292755837702159]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "5% Cutoff Filter",
    "datatype": "string",
    "formula": "//Updated Date: 18 May 2022
//Updated By: Manish
//Description: Filtering date based on 5% of ping age as cut off 

IF ZN([% <5s (copy)_2399292755838119952])<=[Parameters].[Parameter 3] THEN "Hide"
ELSE "Show" END",
    "name": "[Calculation_2399292755839614993]",
    "role": "measure",
    "type": "nominal",
  },
  {
    "caption": "Grade",
    "datatype": "string",
    "formula": "// Grade A
IF [qual_status] = 'all-steps' THEN 'Grade A'

// Grade B
ELSEIF 
    [qual_status] IN ('fiveyrwrk-disqual','outofwrk-disqual','doc-disqual')
    AND [Calculation_1133007210553765896] = 1
THEN 'Grade B'

// Grade C
ELSEIF 
    [qual_status] <> 'age-disqual'
    AND NOT [Stage3 Response] IN ('Less than 2 years', 'Between 2 and 4 years')
    AND [Stage1 Response] <> 'Social Security Disability (SSD) Benefits'
    AND [Stage6 Response] = 'Not working'
THEN 'Grade C'

// Grade D
ELSEIF 
    // 1) Not age-disqual, Stage3 NOT in those two, Stage1 not SSD, Stage6 ≠ Not working, disqual ≤ 1
    (
      [qual_status] <> 'age-disqual'
      AND NOT [Stage3 Response] IN ('Less than 2 years', 'Between 2 and 4 years')
      AND [Stage1 Response] <> 'Social Security Disability (SSD) Benefits'
      AND [Stage6 Response] <> 'Not working'
      AND [Calculation_1133007210553765896] <= 1
    )
    // 2) Not age-disqual, Stage3 in those two, Qual Status = outofwrk-disqual
    OR
    (
      [qual_status] <> 'age-disqual'
      AND [Stage3 Response] IN ('Less than 2 years', 'Between 2 and 4 years')
      AND [qual_status] = 'outofwrk-disqual'
    )
    // 3) Not age-disqual, Stage3 in those two, Qual Status ≠ outofwrk-disqual, Stage7 = Yes
    OR
    (
      [qual_status] <> 'age-disqual'
      AND [Stage3 Response] IN ('Less than 2 years', 'Between 2 and 4 years')
      AND [qual_status] <> 'outofwrk-disqual'
      AND [Stage7 Response] = 'Yes'
    )
THEN 'Grade D'

// Rest (including age-disqual or anything else)
ELSE 'Rest'
END",
    "name": "[Calculation_7573084309404708864]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Today-28",
    "datatype": "date",
    "formula": "//Updated Date: 18 May 2022
//Updated By: Manish
//Description: Going back 28 days from today

({MAX(today()-28)})",
    "name": "[Calculation_767300790172184597]",
    "role": "dimension",
    "type": "ordinal",
  },
  {
    "caption": "Time-Source-Subid",
    "datatype": "string",
    "formula": "//Updated Date: 18 May 2022
//Updated By: Manish
//Description: Changing the data type to string of Time-Source-Subid column

STR([Date])+'-'+[Source]+'-'+[Sub Id]",
    "name": "[Calculation_7746824680808361990]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Date Filter",
    "datatype": "boolean",
    "formula": "//Updated Date: 18 May 2022
//Updated By: Manish
//Description: Filtering data based on date

IF [Parameters].[Parameter 11] = 'default'
THEN [Date]>=[Parameters].[Parameter 5] AND [Date]<=[Parameters].[Parameter 6]
ELSEIF [Parameters].[Parameter 11] = 'weekly'
THEN [Date] >= TODAY()-8 AND [Date] <= TODAY()-1
END",
    "name": "[Calculation_843580506575679492]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Dial R",
    "datatype": "string",
    "formula": "IF  [Called Count] < 4 then "<=3" 
elseif [Called Count] < 8 then "4-7"
elseif [Called Count] < 11 then "8-10"
elseif [Called Count] < 16 then "11-15"
elseif [Called Count] < 20 then "16-19"
elseif [Called Count] < 26 then "20-25"
elseif [Called Count] < 31 then "25-30"
elseif [Called Count] < 36 then "30-35"
else "35+" 
END",
    "name": "[Calculation_847802666706034688]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Dial R (detail)",
    "datatype": "string",
    "formula": "STR([Called Count])",
    "name": "[Calculation_847802666706186241]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Max Date",
    "datatype": "date",
    "formula": "//Updated Date: 18 May 2022
//Updated By: Manish
//Description: Calculating max of todays date for including it in the default values of end date

{MAX(today())}",
    "name": "[Calculation_882424053213511680]",
    "role": "dimension",
    "type": "ordinal",
  },
  {
    "caption": "Post Date  ",
    "datatype": "string",
    "formula": "//Updated Date: 18 May 2022
//Updated By: Manish
//Description: Calculation to apply date bucket

CASE [Parameters].[Parameter 1]
WHEN 'year' THEN str(datepart('year', [Calculation_1916563181826678784]))
WHEN 'quarter' THEN "Q" + str(datepart('quarter', [Calculation_1916563181826678784])) + " " + str(datepart('year', [Calculation_1916563181826678784]))
WHEN 'month' THEN str(datepart('month', [Calculation_1916563181826678784])) + "-" + str(datepart('year', [Calculation_1916563181826678784]))
WHEN 'day' THEN str(DATENAME('month', [Calculation_1916563181826678784]))+ "-" +str(datepart('day', [Calculation_1916563181826678784]))+ "-" + str(datepart('year', [Calculation_1916563181826678784]))
WHEN 'week' THEN "W" + str(datepart('week', [Calculation_1916563181826678784])) + "-" + str(datepart('year', [Calculation_1916563181826678784]))
WHEN "hour" THEN str(DATETRUNC('hour', [Calculation_1916563181826678784]))
WHEN "minute" THEN str(DATETRUNC('minute', [Calculation_1916563181826678784]))
END",
    "name": "[Calculation_97320012552925214]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Source - Date",
    "datatype": "string",
    "formula": "//Updated Date: 18 May 2022
//Updated By: Manish//Description: Calculating max of todays date for including it in the default values of end date
//Description: Concatinating source and date column

[Source]+":"+[Calculation_97320012552925214]",
    "name": "[Calculation_99712551088799768]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Source-Subid",
    "datatype": "string",
    "formula": "//Updated Date: 18 May 2022
//Updated By: Manish//Description: Calculating max of todays date for including it in the default values of end date
//Description: Concatinating source and subid column

[Source]+" : "+[Sub Id]",
    "name": "[Calculation_99712551105503258]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "0",
    "datatype": "integer",
    "formula": "COUNTD(IF [Ping Age (s)]= 0 then [User Id] end)",
    "name": "[Ping age (copy)_2399292755833638916]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Helper Date",
    "datatype": "string",
    "formula": ""default"",
    "name": "[Parameter 11]",
    "role": "measure",
    "type": "nominal",
  },
  {
    "caption": "User Identifier",
    "datatype": "integer",
    "formula": "0",
    "name": "[Parameter 12]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Start Date",
    "datatype": "date",
    "formula": "#2025-07-30#",
    "name": "[Parameter 5]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "End Date",
    "datatype": "date",
    "formula": "#2025-08-27#",
    "name": "[Parameter 6]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "TTW Grade",
    "datatype": "string",
    "formula": "IF [ttw_qualstatus] = 'ttw-qualified' then 'Grade A'
ELSEIF  [ttw_qualstatus] = 'ttw-nonqualified' and [TTW Explore Work Form] = 'yes' THEN 'Grade B'
ELSEIF [ttw_qualstatus] = 'ttw-nonqualified' and [TTW Explore Work Form] != 'yes' THEN 'Grade C'
ELSEIF ISNULL([ttw_qualstatus]) and [Stage3 Response] = 'Between 2 and 4 years' then 'Grade D'
ELSE 'Rest'
END",
    "name": "[Calculation_1006061976934187009]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "20hrs Disqual",
    "datatype": "integer",
    "formula": "IF [Stage6 Response] = "More than 20 hours per week" THEN 1 ELSE 0 END",
    "name": "[Calculation_1133007210546622464]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Age Disqual",
    "datatype": "integer",
    "formula": "IF INT([Age]) < 40 OR INT([Age]) > 62 THEN 1 ELSE 0 END",
    "name": "[Calculation_1133007210553298946]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Attorney Disqual",
    "datatype": "integer",
    "formula": "IF [Stage5 Response] = "Yes" THEN 1 ELSE 0 END",
    "name": "[Calculation_1133007210553425923]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Ben Disqual",
    "datatype": "integer",
    "formula": "IF IFNULL([Stage1 Response], "") != "I am not receiving any disability benefits (SSD or SSI)"
THEN 1 ELSE 0 END",
    "name": "[Calculation_1133007210553487364]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Doctor Visit Disqual",
    "datatype": "integer",
    "formula": "IF [Stage4 Response] = "No" THEN 1 ELSE 0 END",
    "name": "[Calculation_1133007210553540613]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Five Year Work Disqual",
    "datatype": "integer",
    "formula": "IF [Stage3 Response] = "Less than 2 years"
OR [Stage3 Response] = "Between 2 and 4 years"
THEN 1 ELSE 0 END",
    "name": "[Calculation_1133007210553618438]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Out of Work Disqual",
    "datatype": "integer",
    "formula": "IF [Stage2 Response] = "No" THEN 1 ELSE 0 END",
    "name": "[Calculation_1133007210553663495]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "# of Disqual",
    "datatype": "integer",
    "formula": "ZN([Calculation_1133007210553487364]) +
ZN([Calculation_1133007210553663495]) +
ZN([Calculation_1133007210553618438]) +
ZN([Calculation_1133007210553540613]) +
ZN([Calculation_1133007210553425923]) +
ZN([Calculation_1133007210546622464]) +
ZN([Calculation_1133007210553298946])",
    "name": "[Calculation_1133007210553765896]",
    "role": "dimension",
    "type": "ordinal",
  },
  {
    "caption": "Unresolved SSA Leads",
    "datatype": "string",
    "formula": "IF { FIXED [Phone] : MAX([Resolved Lead]) } = 0 THEN "SSA Unresolved Lead"
ELSEIF { FIXED [Phone] : MAX([Resolved Lead]) } = 1 THEN "SSA Resolved Lead"
END",
    "name": "[Calculation_1467962419029331969]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Data Updated On",
    "datatype": "datetime",
    "formula": "{fixed :max([Post Date])}",
    "name": "[Calculation_2010857255412854784]",
    "role": "dimension",
    "type": "ordinal",
  },
  {
    "caption": "{ EXCLUDE [Ping age]: [Posted #]}",
    "datatype": "integer",
    "formula": "{ EXCLUDE [Calculation_97320012553744419]: [Calculation_99712551082803223]}",
    "name": "[Calculation_390968786033696771]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Grade",
    "datatype": "string",
    "formula": "// Grade A
IF [qual_status] = 'all-steps' THEN 'Grade A'

// Grade B
ELSEIF 
    [qual_status] IN ('fiveyrwrk-disqual','outofwrk-disqual','doc-disqual')
    AND [Calculation_1133007210553765896] = 1
THEN 'Grade B'

// Grade C
ELSEIF 
    [qual_status] <> 'age-disqual'
    AND NOT [Stage3 Response] IN ('Less than 2 years', 'Between 2 and 4 years')
    AND [Stage1 Response] <> 'Social Security Disability (SSD) Benefits'
    AND [Stage6 Response] = 'Not working'
THEN 'Grade C'

// Grade D
ELSEIF 
    // 1) Not age-disqual, Stage3 NOT in those two, Stage1 not SSD, Stage6 ≠ Not working, disqual ≤ 1
    (
      [qual_status] <> 'age-disqual'
      AND NOT [Stage3 Response] IN ('Less than 2 years', 'Between 2 and 4 years')
      AND [Stage1 Response] <> 'Social Security Disability (SSD) Benefits'
      AND [Stage6 Response] <> 'Not working'
      AND [Calculation_1133007210553765896] <= 1
    )
    // 2) Not age-disqual, Stage3 in those two, Qual Status = outofwrk-disqual
    OR
    (
      [qual_status] <> 'age-disqual'
      AND [Stage3 Response] IN ('Less than 2 years', 'Between 2 and 4 years')
      AND [qual_status] = 'outofwrk-disqual'
    )
    // 3) Not age-disqual, Stage3 in those two, Qual Status ≠ outofwrk-disqual, Stage7 = Yes
    OR
    (
      [qual_status] <> 'age-disqual'
      AND [Stage3 Response] IN ('Less than 2 years', 'Between 2 and 4 years')
      AND [qual_status] <> 'outofwrk-disqual'
      AND [Stage7 Response] = 'Yes'
    )
THEN 'Grade D'

// Rest (including age-disqual or anything else)
ELSE 'Rest'
END",
    "name": "[Calculation_7573084309404708864]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Today-28",
    "datatype": "date",
    "formula": "//Updated Date: 18 May 2022
//Updated By: Manish
//Description: Going back 28 days from today

({MAX(today()-28)})",
    "name": "[Calculation_767300790172184597]",
    "role": "dimension",
    "type": "ordinal",
  },
  {
    "caption": "Time-Source-Subid",
    "datatype": "string",
    "formula": "//Updated Date: 18 May 2022
//Updated By: Manish
//Description: Changing the data type to string of Time-Source-Subid column

STR([Date])+'-'+[Source]+'-'+[Sub Id]",
    "name": "[Calculation_7746824680808361990]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Date Filter",
    "datatype": "boolean",
    "formula": "//Updated Date: 18 May 2022
//Updated By: Manish
//Description: Filtering data based on date

IF [Parameters].[Parameter 11] = 'default'
THEN [Date]>=[Parameters].[Parameter 5] AND [Date]<=[Parameters].[Parameter 6]
ELSEIF [Parameters].[Parameter 11] = 'weekly'
THEN [Date] >= TODAY()-8 AND [Date] <= TODAY()-1
END",
    "name": "[Calculation_843580506575679492]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Dial R",
    "datatype": "string",
    "formula": "IF  [Called Count] < 4 then "<=3" 
elseif [Called Count] < 8 then "4-7"
elseif [Called Count] < 11 then "8-10"
elseif [Called Count] < 16 then "11-15"
elseif [Called Count] < 20 then "16-19"
elseif [Called Count] < 26 then "20-25"
elseif [Called Count] < 31 then "25-30"
elseif [Called Count] < 36 then "30-35"
else "35+" 
END",
    "name": "[Calculation_847802666706034688]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Dial R (detail)",
    "datatype": "string",
    "formula": "STR([Called Count])",
    "name": "[Calculation_847802666706186241]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Max Date",
    "datatype": "date",
    "formula": "//Updated Date: 18 May 2022
//Updated By: Manish
//Description: Calculating max of todays date for including it in the default values of end date

{MAX(today())}",
    "name": "[Calculation_882424053213511680]",
    "role": "dimension",
    "type": "ordinal",
  },
  {
    "caption": "User Identifier",
    "datatype": "string",
    "formula": "IF [Parameters].[Parameter 12] = 0 THEN [User Id]
ELSEIF [Parameters].[Parameter 12] = 1 THEN [Phone]
END",
    "name": "[Calculation_906349454594166784]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Ping age",
    "datatype": "string",
    "formula": "//Updated Date: 18 May 2022
//Updated By: Manish
//Description: Bucketing the ping age column wrt seconds

IF [Ping Age (s)]= 0 then '0'
ELSEIF [Ping Age (s)]>0 and [Ping Age (s)]<=5 then '<005'
ELSEIF [Ping Age (s)]>5 and [Ping Age (s)]<=10 then '<010'
ELSEIF [Ping Age (s)]>10 and [Ping Age (s)]<=25 then '<025'
ELSEIF [Ping Age (s)]>25 and [Ping Age (s)]<=100 then '<100'
ELSEIF [Ping Age (s)]>100 and [Ping Age (s)]<=200 then '<200'
else '>200'
end",
    "name": "[Calculation_97320012553744419]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Posted #",
    "datatype": "integer",
    "formula": "//Updated Date: 18 May 2022
//Updated By: Manish
//Description: Calculating the sum of user id wrt to source

countd([Calculation_906349454594166784])",
    "name": "[Calculation_99712551082803223]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Helper Date",
    "datatype": "string",
    "formula": ""default"",
    "name": "[Parameter 11]",
    "role": "measure",
    "type": "nominal",
  },
  {
    "caption": "Start Date",
    "datatype": "date",
    "formula": "#2025-07-30#",
    "name": "[Parameter 5]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "End Date",
    "datatype": "date",
    "formula": "#2025-08-27#",
    "name": "[Parameter 6]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "30 Day Window Apps #",
    "datatype": "integer",
    "formula": "//IF {include:sum({fixed [CZ Project Name],[Source]: countd(if [Last 15 to 45 day Window]= true and CONTAINS(LOWER([Status]),'ap') then [User Id] end)})} !=0

//THEN
{include:sum({fixed [CZ Project Name],[Source]: countd(if [Calculation_2006635132526440448]= true and CONTAINS(LOWER([Status]),'ap') then [User Id] end)})}
//ELSE

//{exclude [Day of Post Date],[Source] :sum({fixed [CZ Project Name],[Source]: countd(if [Last 15 to 45 day Window]= true and CONTAINS(LOWER([Status]),'ap') then [User Id] end)})}

//END",
    "name": "[30 Day Window Leads # (copy)_2006635132547117058]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "TTW Grade",
    "datatype": "string",
    "formula": "IF [ttw_qualstatus] = 'ttw-qualified' then 'Grade A'
ELSEIF  [ttw_qualstatus] = 'ttw-nonqualified' and [TTW Explore Work Form] = 'yes' THEN 'Grade B'
ELSEIF [ttw_qualstatus] = 'ttw-nonqualified' and [TTW Explore Work Form] != 'yes' THEN 'Grade C'
ELSEIF ISNULL([ttw_qualstatus]) and [Stage3 Response] = 'Between 2 and 4 years' then 'Grade D'
ELSE 'Rest'
END",
    "name": "[Calculation_1006061976934187009]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "20hrs Disqual",
    "datatype": "integer",
    "formula": "IF [Stage6 Response] = "More than 20 hours per week" THEN 1 ELSE 0 END",
    "name": "[Calculation_1133007210546622464]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Age Disqual",
    "datatype": "integer",
    "formula": "IF INT([Age]) < 40 OR INT([Age]) > 62 THEN 1 ELSE 0 END",
    "name": "[Calculation_1133007210553298946]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Attorney Disqual",
    "datatype": "integer",
    "formula": "IF [Stage5 Response] = "Yes" THEN 1 ELSE 0 END",
    "name": "[Calculation_1133007210553425923]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Ben Disqual",
    "datatype": "integer",
    "formula": "IF IFNULL([Stage1 Response], "") != "I am not receiving any disability benefits (SSD or SSI)"
THEN 1 ELSE 0 END",
    "name": "[Calculation_1133007210553487364]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Doctor Visit Disqual",
    "datatype": "integer",
    "formula": "IF [Stage4 Response] = "No" THEN 1 ELSE 0 END",
    "name": "[Calculation_1133007210553540613]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Five Year Work Disqual",
    "datatype": "integer",
    "formula": "IF [Stage3 Response] = "Less than 2 years"
OR [Stage3 Response] = "Between 2 and 4 years"
THEN 1 ELSE 0 END",
    "name": "[Calculation_1133007210553618438]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Out of Work Disqual",
    "datatype": "integer",
    "formula": "IF [Stage2 Response] = "No" THEN 1 ELSE 0 END",
    "name": "[Calculation_1133007210553663495]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "# of Disqual",
    "datatype": "integer",
    "formula": "ZN([Calculation_1133007210553487364]) +
ZN([Calculation_1133007210553663495]) +
ZN([Calculation_1133007210553618438]) +
ZN([Calculation_1133007210553540613]) +
ZN([Calculation_1133007210553425923]) +
ZN([Calculation_1133007210546622464]) +
ZN([Calculation_1133007210553298946])",
    "name": "[Calculation_1133007210553765896]",
    "role": "dimension",
    "type": "ordinal",
  },
  {
    "caption": "Unresolved SSA Leads",
    "datatype": "string",
    "formula": "IF { FIXED [Phone] : MAX([Resolved Lead]) } = 0 THEN "SSA Unresolved Lead"
ELSEIF { FIXED [Phone] : MAX([Resolved Lead]) } = 1 THEN "SSA Resolved Lead"
END",
    "name": "[Calculation_1467962419029331969]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Last 15 to 45 day Window",
    "datatype": "boolean",
    "formula": "if [Date]<= [Parameters].[Parameter 5]-15 AND [Date]>=[Parameters].[Parameter 5]-45 then true else false end",
    "name": "[Calculation_2006635132526440448]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "30 Day Window Leads #",
    "datatype": "integer",
    "formula": "IF {include :sum({fixed [CZ Project Name],[Source]: countd(if [Calculation_2006635132526440448]= true then [User Id] end)})} >= 10 then 

{include :sum({fixed [CZ Project Name],[Source]: countd(if [Calculation_2006635132526440448]= true then [User Id] end)})}

ELSE 

{exclude [Source],[Date] :sum({fixed [CZ Project Name]: countd(if [Calculation_2006635132526440448]= true then [User Id] end)})}

END",
    "name": "[Calculation_2006635132542951425]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "30 day Conv %",
    "datatype": "real",
    "formula": "ZN(sum([30 Day Window Leads # (copy)_2006635132547117058])/sum([Calculation_2006635132542951425]))",
    "name": "[Calculation_2006635132553568259]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Predicted Apps",
    "datatype": "integer",
    "formula": "CEILING(COUNTD([User Id])*[Calculation_2006635132553568259])",
    "name": "[Calculation_2006635132591812613]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Grade",
    "datatype": "string",
    "formula": "// Grade A
IF [qual_status] = 'all-steps' THEN 'Grade A'

// Grade B
ELSEIF 
    [qual_status] IN ('fiveyrwrk-disqual','outofwrk-disqual','doc-disqual')
    AND [Calculation_1133007210553765896] = 1
THEN 'Grade B'

// Grade C
ELSEIF 
    [qual_status] <> 'age-disqual'
    AND NOT [Stage3 Response] IN ('Less than 2 years', 'Between 2 and 4 years')
    AND [Stage1 Response] <> 'Social Security Disability (SSD) Benefits'
    AND [Stage6 Response] = 'Not working'
THEN 'Grade C'

// Grade D
ELSEIF 
    // 1) Not age-disqual, Stage3 NOT in those two, Stage1 not SSD, Stage6 ≠ Not working, disqual ≤ 1
    (
      [qual_status] <> 'age-disqual'
      AND NOT [Stage3 Response] IN ('Less than 2 years', 'Between 2 and 4 years')
      AND [Stage1 Response] <> 'Social Security Disability (SSD) Benefits'
      AND [Stage6 Response] <> 'Not working'
      AND [Calculation_1133007210553765896] <= 1
    )
    // 2) Not age-disqual, Stage3 in those two, Qual Status = outofwrk-disqual
    OR
    (
      [qual_status] <> 'age-disqual'
      AND [Stage3 Response] IN ('Less than 2 years', 'Between 2 and 4 years')
      AND [qual_status] = 'outofwrk-disqual'
    )
    // 3) Not age-disqual, Stage3 in those two, Qual Status ≠ outofwrk-disqual, Stage7 = Yes
    OR
    (
      [qual_status] <> 'age-disqual'
      AND [Stage3 Response] IN ('Less than 2 years', 'Between 2 and 4 years')
      AND [qual_status] <> 'outofwrk-disqual'
      AND [Stage7 Response] = 'Yes'
    )
THEN 'Grade D'

// Rest (including age-disqual or anything else)
ELSE 'Rest'
END",
    "name": "[Calculation_7573084309404708864]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Today-28",
    "datatype": "date",
    "formula": "//Updated Date: 18 May 2022
//Updated By: Manish
//Description: Going back 28 days from today

({MAX(today()-28)})",
    "name": "[Calculation_767300790172184597]",
    "role": "dimension",
    "type": "ordinal",
  },
  {
    "caption": "Date Filter",
    "datatype": "boolean",
    "formula": "//Updated Date: 18 May 2022
//Updated By: Manish
//Description: Filtering data based on date

IF [Parameters].[Parameter 11] = 'default'
THEN [Date]>=[Parameters].[Parameter 5] AND [Date]<=[Parameters].[Parameter 6]
ELSEIF [Parameters].[Parameter 11] = 'weekly'
THEN [Date] >= TODAY()-8 AND [Date] <= TODAY()-1
END",
    "name": "[Calculation_843580506575679492]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Dial R",
    "datatype": "string",
    "formula": "IF  [Called Count] < 4 then "<=3" 
elseif [Called Count] < 8 then "4-7"
elseif [Called Count] < 11 then "8-10"
elseif [Called Count] < 16 then "11-15"
elseif [Called Count] < 20 then "16-19"
elseif [Called Count] < 26 then "20-25"
elseif [Called Count] < 31 then "25-30"
elseif [Called Count] < 36 then "30-35"
else "35+" 
END",
    "name": "[Calculation_847802666706034688]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Dial R (detail)",
    "datatype": "string",
    "formula": "STR([Called Count])",
    "name": "[Calculation_847802666706186241]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Max Date",
    "datatype": "date",
    "formula": "//Updated Date: 18 May 2022
//Updated By: Manish
//Description: Calculating max of todays date for including it in the default values of end date

{MAX(today())}",
    "name": "[Calculation_882424053213511680]",
    "role": "dimension",
    "type": "ordinal",
  },
  {
    "caption": "Lead",
    "datatype": "integer",
    "formula": "//Updated Date: 18 May 2022
//Updated By: Manish
//Description: Calculating the unique count of user ids

COUNTD([User Id])",
    "name": "[Calculation_97320012564762668]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Helper Date",
    "datatype": "string",
    "formula": ""default"",
    "name": "[Parameter 11]",
    "role": "measure",
    "type": "nominal",
  },
  {
    "caption": "Start Date",
    "datatype": "date",
    "formula": "#2025-07-30#",
    "name": "[Parameter 5]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "End Date",
    "datatype": "date",
    "formula": "#2025-08-27#",
    "name": "[Parameter 6]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "30 Day Window Apps #",
    "datatype": "integer",
    "formula": "//IF {include:sum({fixed [CZ Project Name],[Source]: countd(if [Last 15 to 45 day Window]= true and CONTAINS(LOWER([Status]),'ap') then [User Id] end)})} !=0

//THEN
{include:sum({fixed [CZ Project Name],[Source]: countd(if [Calculation_2006635132526440448]= true and CONTAINS(LOWER([Status]),'ap') then [User Id] end)})}
//ELSE

//{exclude [Day of Post Date],[Source] :sum({fixed [CZ Project Name],[Source]: countd(if [Last 15 to 45 day Window]= true and CONTAINS(LOWER([Status]),'ap') then [User Id] end)})}

//END",
    "name": "[30 Day Window Leads # (copy)_2006635132547117058]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "TTW Grade",
    "datatype": "string",
    "formula": "IF [ttw_qualstatus] = 'ttw-qualified' then 'Grade A'
ELSEIF  [ttw_qualstatus] = 'ttw-nonqualified' and [TTW Explore Work Form] = 'yes' THEN 'Grade B'
ELSEIF [ttw_qualstatus] = 'ttw-nonqualified' and [TTW Explore Work Form] != 'yes' THEN 'Grade C'
ELSEIF ISNULL([ttw_qualstatus]) and [Stage3 Response] = 'Between 2 and 4 years' then 'Grade D'
ELSE 'Rest'
END",
    "name": "[Calculation_1006061976934187009]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "20hrs Disqual",
    "datatype": "integer",
    "formula": "IF [Stage6 Response] = "More than 20 hours per week" THEN 1 ELSE 0 END",
    "name": "[Calculation_1133007210546622464]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Age Disqual",
    "datatype": "integer",
    "formula": "IF INT([Age]) < 40 OR INT([Age]) > 62 THEN 1 ELSE 0 END",
    "name": "[Calculation_1133007210553298946]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Attorney Disqual",
    "datatype": "integer",
    "formula": "IF [Stage5 Response] = "Yes" THEN 1 ELSE 0 END",
    "name": "[Calculation_1133007210553425923]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Ben Disqual",
    "datatype": "integer",
    "formula": "IF IFNULL([Stage1 Response], "") != "I am not receiving any disability benefits (SSD or SSI)"
THEN 1 ELSE 0 END",
    "name": "[Calculation_1133007210553487364]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Doctor Visit Disqual",
    "datatype": "integer",
    "formula": "IF [Stage4 Response] = "No" THEN 1 ELSE 0 END",
    "name": "[Calculation_1133007210553540613]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Five Year Work Disqual",
    "datatype": "integer",
    "formula": "IF [Stage3 Response] = "Less than 2 years"
OR [Stage3 Response] = "Between 2 and 4 years"
THEN 1 ELSE 0 END",
    "name": "[Calculation_1133007210553618438]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Out of Work Disqual",
    "datatype": "integer",
    "formula": "IF [Stage2 Response] = "No" THEN 1 ELSE 0 END",
    "name": "[Calculation_1133007210553663495]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "# of Disqual",
    "datatype": "integer",
    "formula": "ZN([Calculation_1133007210553487364]) +
ZN([Calculation_1133007210553663495]) +
ZN([Calculation_1133007210553618438]) +
ZN([Calculation_1133007210553540613]) +
ZN([Calculation_1133007210553425923]) +
ZN([Calculation_1133007210546622464]) +
ZN([Calculation_1133007210553298946])",
    "name": "[Calculation_1133007210553765896]",
    "role": "dimension",
    "type": "ordinal",
  },
  {
    "caption": "Unresolved SSA Leads",
    "datatype": "string",
    "formula": "IF { FIXED [Phone] : MAX([Resolved Lead]) } = 0 THEN "SSA Unresolved Lead"
ELSEIF { FIXED [Phone] : MAX([Resolved Lead]) } = 1 THEN "SSA Resolved Lead"
END",
    "name": "[Calculation_1467962419029331969]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "index()",
    "datatype": "integer",
    "formula": "index()",
    "name": "[Calculation_1968354535979569153]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "'Predicted Apps'",
    "datatype": "string",
    "formula": "'Predicted Apps'",
    "name": "[Calculation_1968354535997501443]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Last 15 to 45 day Window",
    "datatype": "boolean",
    "formula": "if [Date]<= [Parameters].[Parameter 5]-15 AND [Date]>=[Parameters].[Parameter 5]-45 then true else false end",
    "name": "[Calculation_2006635132526440448]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "30 Day Window Leads #",
    "datatype": "integer",
    "formula": "IF {include :sum({fixed [CZ Project Name],[Source]: countd(if [Calculation_2006635132526440448]= true then [User Id] end)})} >= 10 then 

{include :sum({fixed [CZ Project Name],[Source]: countd(if [Calculation_2006635132526440448]= true then [User Id] end)})}

ELSE 

{exclude [Source],[Date] :sum({fixed [CZ Project Name]: countd(if [Calculation_2006635132526440448]= true then [User Id] end)})}

END",
    "name": "[Calculation_2006635132542951425]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "30 day Conv %",
    "datatype": "real",
    "formula": "ZN(sum([30 Day Window Leads # (copy)_2006635132547117058])/sum([Calculation_2006635132542951425]))",
    "name": "[Calculation_2006635132553568259]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Predicted Apps",
    "datatype": "integer",
    "formula": "CEILING(COUNTD([User Id])*[Calculation_2006635132553568259])",
    "name": "[Calculation_2006635132591812613]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Grade",
    "datatype": "string",
    "formula": "// Grade A
IF [qual_status] = 'all-steps' THEN 'Grade A'

// Grade B
ELSEIF 
    [qual_status] IN ('fiveyrwrk-disqual','outofwrk-disqual','doc-disqual')
    AND [Calculation_1133007210553765896] = 1
THEN 'Grade B'

// Grade C
ELSEIF 
    [qual_status] <> 'age-disqual'
    AND NOT [Stage3 Response] IN ('Less than 2 years', 'Between 2 and 4 years')
    AND [Stage1 Response] <> 'Social Security Disability (SSD) Benefits'
    AND [Stage6 Response] = 'Not working'
THEN 'Grade C'

// Grade D
ELSEIF 
    // 1) Not age-disqual, Stage3 NOT in those two, Stage1 not SSD, Stage6 ≠ Not working, disqual ≤ 1
    (
      [qual_status] <> 'age-disqual'
      AND NOT [Stage3 Response] IN ('Less than 2 years', 'Between 2 and 4 years')
      AND [Stage1 Response] <> 'Social Security Disability (SSD) Benefits'
      AND [Stage6 Response] <> 'Not working'
      AND [Calculation_1133007210553765896] <= 1
    )
    // 2) Not age-disqual, Stage3 in those two, Qual Status = outofwrk-disqual
    OR
    (
      [qual_status] <> 'age-disqual'
      AND [Stage3 Response] IN ('Less than 2 years', 'Between 2 and 4 years')
      AND [qual_status] = 'outofwrk-disqual'
    )
    // 3) Not age-disqual, Stage3 in those two, Qual Status ≠ outofwrk-disqual, Stage7 = Yes
    OR
    (
      [qual_status] <> 'age-disqual'
      AND [Stage3 Response] IN ('Less than 2 years', 'Between 2 and 4 years')
      AND [qual_status] <> 'outofwrk-disqual'
      AND [Stage7 Response] = 'Yes'
    )
THEN 'Grade D'

// Rest (including age-disqual or anything else)
ELSE 'Rest'
END",
    "name": "[Calculation_7573084309404708864]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Today-28",
    "datatype": "date",
    "formula": "//Updated Date: 18 May 2022
//Updated By: Manish
//Description: Going back 28 days from today

({MAX(today()-28)})",
    "name": "[Calculation_767300790172184597]",
    "role": "dimension",
    "type": "ordinal",
  },
  {
    "caption": "Date Filter",
    "datatype": "boolean",
    "formula": "//Updated Date: 18 May 2022
//Updated By: Manish
//Description: Filtering data based on date

IF [Parameters].[Parameter 11] = 'default'
THEN [Date]>=[Parameters].[Parameter 5] AND [Date]<=[Parameters].[Parameter 6]
ELSEIF [Parameters].[Parameter 11] = 'weekly'
THEN [Date] >= TODAY()-8 AND [Date] <= TODAY()-1
END",
    "name": "[Calculation_843580506575679492]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Dial R",
    "datatype": "string",
    "formula": "IF  [Called Count] < 4 then "<=3" 
elseif [Called Count] < 8 then "4-7"
elseif [Called Count] < 11 then "8-10"
elseif [Called Count] < 16 then "11-15"
elseif [Called Count] < 20 then "16-19"
elseif [Called Count] < 26 then "20-25"
elseif [Called Count] < 31 then "25-30"
elseif [Called Count] < 36 then "30-35"
else "35+" 
END",
    "name": "[Calculation_847802666706034688]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Dial R (detail)",
    "datatype": "string",
    "formula": "STR([Called Count])",
    "name": "[Calculation_847802666706186241]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Max Date",
    "datatype": "date",
    "formula": "//Updated Date: 18 May 2022
//Updated By: Manish
//Description: Calculating max of todays date for including it in the default values of end date

{MAX(today())}",
    "name": "[Calculation_882424053213511680]",
    "role": "dimension",
    "type": "ordinal",
  },
  {
    "caption": "Lead",
    "datatype": "integer",
    "formula": "//Updated Date: 18 May 2022
//Updated By: Manish
//Description: Calculating the unique count of user ids

COUNTD([User Id])",
    "name": "[Calculation_97320012564762668]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "% Posted Wk2",
    "datatype": "real",
    "formula": "ifnull([Last Week Leads (copy)_535928404290809858]/{exclude [Sub Id]: countD(if [Date]< dateadd('day',-7,datetrunc('week',today(),'sunday')) then [User Id] end)},0)",
    "name": "[% Last week Leads (copy)_535928404325892101]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "TTW Grade",
    "datatype": "string",
    "formula": "IF [ttw_qualstatus] = 'ttw-qualified' then 'Grade A'
ELSEIF  [ttw_qualstatus] = 'ttw-nonqualified' and [TTW Explore Work Form] = 'yes' THEN 'Grade B'
ELSEIF [ttw_qualstatus] = 'ttw-nonqualified' and [TTW Explore Work Form] != 'yes' THEN 'Grade C'
ELSEIF ISNULL([ttw_qualstatus]) and [Stage3 Response] = 'Between 2 and 4 years' then 'Grade D'
ELSE 'Rest'
END",
    "name": "[Calculation_1006061976934187009]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "20hrs Disqual",
    "datatype": "integer",
    "formula": "IF [Stage6 Response] = "More than 20 hours per week" THEN 1 ELSE 0 END",
    "name": "[Calculation_1133007210546622464]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Age Disqual",
    "datatype": "integer",
    "formula": "IF INT([Age]) < 40 OR INT([Age]) > 62 THEN 1 ELSE 0 END",
    "name": "[Calculation_1133007210553298946]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Attorney Disqual",
    "datatype": "integer",
    "formula": "IF [Stage5 Response] = "Yes" THEN 1 ELSE 0 END",
    "name": "[Calculation_1133007210553425923]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Ben Disqual",
    "datatype": "integer",
    "formula": "IF IFNULL([Stage1 Response], "") != "I am not receiving any disability benefits (SSD or SSI)"
THEN 1 ELSE 0 END",
    "name": "[Calculation_1133007210553487364]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Doctor Visit Disqual",
    "datatype": "integer",
    "formula": "IF [Stage4 Response] = "No" THEN 1 ELSE 0 END",
    "name": "[Calculation_1133007210553540613]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Five Year Work Disqual",
    "datatype": "integer",
    "formula": "IF [Stage3 Response] = "Less than 2 years"
OR [Stage3 Response] = "Between 2 and 4 years"
THEN 1 ELSE 0 END",
    "name": "[Calculation_1133007210553618438]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Out of Work Disqual",
    "datatype": "integer",
    "formula": "IF [Stage2 Response] = "No" THEN 1 ELSE 0 END",
    "name": "[Calculation_1133007210553663495]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "# of Disqual",
    "datatype": "integer",
    "formula": "ZN([Calculation_1133007210553487364]) +
ZN([Calculation_1133007210553663495]) +
ZN([Calculation_1133007210553618438]) +
ZN([Calculation_1133007210553540613]) +
ZN([Calculation_1133007210553425923]) +
ZN([Calculation_1133007210546622464]) +
ZN([Calculation_1133007210553298946])",
    "name": "[Calculation_1133007210553765896]",
    "role": "dimension",
    "type": "ordinal",
  },
  {
    "caption": "Unresolved SSA Leads",
    "datatype": "string",
    "formula": "IF { FIXED [Phone] : MAX([Resolved Lead]) } = 0 THEN "SSA Unresolved Lead"
ELSEIF { FIXED [Phone] : MAX([Resolved Lead]) } = 1 THEN "SSA Resolved Lead"
END",
    "name": "[Calculation_1467962419029331969]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Data Updated On",
    "datatype": "datetime",
    "formula": "{fixed :max([Post Date])}",
    "name": "[Calculation_2010857255412854784]",
    "role": "dimension",
    "type": "ordinal",
  },
  {
    "caption": "Date Filter last 2 weeks",
    "datatype": "boolean",
    "formula": "IF [Date]>= dateadd('day',-14,datetrunc('week',today(),'sunday')) then true else false end",
    "name": "[Calculation_535928404275974144]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Posted Wk1",
    "datatype": "integer",
    "formula": "({include [Sub Id]: countD(if [Date]>= dateadd('day',-7,datetrunc('week',today(),'sunday')) then [User Id] end)})",
    "name": "[Calculation_535928404288794625]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "% Posted Wk1",
    "datatype": "real",
    "formula": "ifnull([Calculation_535928404288794625]/{exclude [Sub Id]: countD(if [Date]>= dateadd('day',-7,datetrunc('week',today(),'sunday')) then [User Id] end)},0)",
    "name": "[Calculation_535928404317847556]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Square of Diff",
    "datatype": "real",
    "formula": "SQUARE([% Last week Leads (copy)_535928404325892101]-[Calculation_535928404317847556])",
    "name": "[Calculation_535928404326711302]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "RMSD Score",
    "datatype": "real",
    "formula": "SQRT(SUM([Calculation_535928404326711302])/COUNTD([Sub Id]))",
    "name": "[Calculation_535928404332609544]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "RSMD",
    "datatype": "string",
    "formula": "'RMSD Score'",
    "name": "[Calculation_535928404338208781]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Grade",
    "datatype": "string",
    "formula": "// Grade A
IF [qual_status] = 'all-steps' THEN 'Grade A'

// Grade B
ELSEIF 
    [qual_status] IN ('fiveyrwrk-disqual','outofwrk-disqual','doc-disqual')
    AND [Calculation_1133007210553765896] = 1
THEN 'Grade B'

// Grade C
ELSEIF 
    [qual_status] <> 'age-disqual'
    AND NOT [Stage3 Response] IN ('Less than 2 years', 'Between 2 and 4 years')
    AND [Stage1 Response] <> 'Social Security Disability (SSD) Benefits'
    AND [Stage6 Response] = 'Not working'
THEN 'Grade C'

// Grade D
ELSEIF 
    // 1) Not age-disqual, Stage3 NOT in those two, Stage1 not SSD, Stage6 ≠ Not working, disqual ≤ 1
    (
      [qual_status] <> 'age-disqual'
      AND NOT [Stage3 Response] IN ('Less than 2 years', 'Between 2 and 4 years')
      AND [Stage1 Response] <> 'Social Security Disability (SSD) Benefits'
      AND [Stage6 Response] <> 'Not working'
      AND [Calculation_1133007210553765896] <= 1
    )
    // 2) Not age-disqual, Stage3 in those two, Qual Status = outofwrk-disqual
    OR
    (
      [qual_status] <> 'age-disqual'
      AND [Stage3 Response] IN ('Less than 2 years', 'Between 2 and 4 years')
      AND [qual_status] = 'outofwrk-disqual'
    )
    // 3) Not age-disqual, Stage3 in those two, Qual Status ≠ outofwrk-disqual, Stage7 = Yes
    OR
    (
      [qual_status] <> 'age-disqual'
      AND [Stage3 Response] IN ('Less than 2 years', 'Between 2 and 4 years')
      AND [qual_status] <> 'outofwrk-disqual'
      AND [Stage7 Response] = 'Yes'
    )
THEN 'Grade D'

// Rest (including age-disqual or anything else)
ELSE 'Rest'
END",
    "name": "[Calculation_7573084309404708864]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Dial R",
    "datatype": "string",
    "formula": "IF  [Called Count] < 4 then "<=3" 
elseif [Called Count] < 8 then "4-7"
elseif [Called Count] < 11 then "8-10"
elseif [Called Count] < 16 then "11-15"
elseif [Called Count] < 20 then "16-19"
elseif [Called Count] < 26 then "20-25"
elseif [Called Count] < 31 then "25-30"
elseif [Called Count] < 36 then "30-35"
else "35+" 
END",
    "name": "[Calculation_847802666706034688]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Dial R (detail)",
    "datatype": "string",
    "formula": "STR([Called Count])",
    "name": "[Calculation_847802666706186241]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Posted Wk2",
    "datatype": "integer",
    "formula": "({include [Sub Id]: countD(if [Date]< dateadd('day',-7,datetrunc('week',today(),'sunday')) then [User Id] end)})",
    "name": "[Last Week Leads (copy)_535928404290809858]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "% Posted Wk2",
    "datatype": "real",
    "formula": "ifnull([Last Week Leads (copy)_535928404290809858]/{exclude [Sub Id]: countD(if [Date]< dateadd('day',-7,datetrunc('week',today(),'sunday')) then [User Id] end)},0)",
    "name": "[% Last week Leads (copy)_535928404325892101]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "TTW Grade",
    "datatype": "string",
    "formula": "IF [ttw_qualstatus] = 'ttw-qualified' then 'Grade A'
ELSEIF  [ttw_qualstatus] = 'ttw-nonqualified' and [TTW Explore Work Form] = 'yes' THEN 'Grade B'
ELSEIF [ttw_qualstatus] = 'ttw-nonqualified' and [TTW Explore Work Form] != 'yes' THEN 'Grade C'
ELSEIF ISNULL([ttw_qualstatus]) and [Stage3 Response] = 'Between 2 and 4 years' then 'Grade D'
ELSE 'Rest'
END",
    "name": "[Calculation_1006061976934187009]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "20hrs Disqual",
    "datatype": "integer",
    "formula": "IF [Stage6 Response] = "More than 20 hours per week" THEN 1 ELSE 0 END",
    "name": "[Calculation_1133007210546622464]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Age Disqual",
    "datatype": "integer",
    "formula": "IF INT([Age]) < 40 OR INT([Age]) > 62 THEN 1 ELSE 0 END",
    "name": "[Calculation_1133007210553298946]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Attorney Disqual",
    "datatype": "integer",
    "formula": "IF [Stage5 Response] = "Yes" THEN 1 ELSE 0 END",
    "name": "[Calculation_1133007210553425923]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Ben Disqual",
    "datatype": "integer",
    "formula": "IF IFNULL([Stage1 Response], "") != "I am not receiving any disability benefits (SSD or SSI)"
THEN 1 ELSE 0 END",
    "name": "[Calculation_1133007210553487364]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Doctor Visit Disqual",
    "datatype": "integer",
    "formula": "IF [Stage4 Response] = "No" THEN 1 ELSE 0 END",
    "name": "[Calculation_1133007210553540613]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Five Year Work Disqual",
    "datatype": "integer",
    "formula": "IF [Stage3 Response] = "Less than 2 years"
OR [Stage3 Response] = "Between 2 and 4 years"
THEN 1 ELSE 0 END",
    "name": "[Calculation_1133007210553618438]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Out of Work Disqual",
    "datatype": "integer",
    "formula": "IF [Stage2 Response] = "No" THEN 1 ELSE 0 END",
    "name": "[Calculation_1133007210553663495]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "# of Disqual",
    "datatype": "integer",
    "formula": "ZN([Calculation_1133007210553487364]) +
ZN([Calculation_1133007210553663495]) +
ZN([Calculation_1133007210553618438]) +
ZN([Calculation_1133007210553540613]) +
ZN([Calculation_1133007210553425923]) +
ZN([Calculation_1133007210546622464]) +
ZN([Calculation_1133007210553298946])",
    "name": "[Calculation_1133007210553765896]",
    "role": "dimension",
    "type": "ordinal",
  },
  {
    "caption": "Unresolved SSA Leads",
    "datatype": "string",
    "formula": "IF { FIXED [Phone] : MAX([Resolved Lead]) } = 0 THEN "SSA Unresolved Lead"
ELSEIF { FIXED [Phone] : MAX([Resolved Lead]) } = 1 THEN "SSA Resolved Lead"
END",
    "name": "[Calculation_1467962419029331969]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Data Updated On",
    "datatype": "datetime",
    "formula": "{fixed :max([Post Date])}",
    "name": "[Calculation_2010857255412854784]",
    "role": "dimension",
    "type": "ordinal",
  },
  {
    "caption": "Date Filter last 2 weeks",
    "datatype": "boolean",
    "formula": "IF [Date]>= dateadd('day',-14,datetrunc('week',today(),'sunday')) then true else false end",
    "name": "[Calculation_535928404275974144]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Posted Wk1",
    "datatype": "integer",
    "formula": "({include [Sub Id]: countD(if [Date]>= dateadd('day',-7,datetrunc('week',today(),'sunday')) then [User Id] end)})",
    "name": "[Calculation_535928404288794625]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "% Posted Wk1",
    "datatype": "real",
    "formula": "ifnull([Calculation_535928404288794625]/{exclude [Sub Id]: countD(if [Date]>= dateadd('day',-7,datetrunc('week',today(),'sunday')) then [User Id] end)},0)",
    "name": "[Calculation_535928404317847556]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Square of Diff",
    "datatype": "real",
    "formula": "SQUARE([% Last week Leads (copy)_535928404325892101]-[Calculation_535928404317847556])",
    "name": "[Calculation_535928404326711302]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "RMSD Score",
    "datatype": "real",
    "formula": "SQRT(SUM([Calculation_535928404326711302])/COUNTD([Sub Id]))",
    "name": "[Calculation_535928404332609544]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Grade",
    "datatype": "string",
    "formula": "// Grade A
IF [qual_status] = 'all-steps' THEN 'Grade A'

// Grade B
ELSEIF 
    [qual_status] IN ('fiveyrwrk-disqual','outofwrk-disqual','doc-disqual')
    AND [Calculation_1133007210553765896] = 1
THEN 'Grade B'

// Grade C
ELSEIF 
    [qual_status] <> 'age-disqual'
    AND NOT [Stage3 Response] IN ('Less than 2 years', 'Between 2 and 4 years')
    AND [Stage1 Response] <> 'Social Security Disability (SSD) Benefits'
    AND [Stage6 Response] = 'Not working'
THEN 'Grade C'

// Grade D
ELSEIF 
    // 1) Not age-disqual, Stage3 NOT in those two, Stage1 not SSD, Stage6 ≠ Not working, disqual ≤ 1
    (
      [qual_status] <> 'age-disqual'
      AND NOT [Stage3 Response] IN ('Less than 2 years', 'Between 2 and 4 years')
      AND [Stage1 Response] <> 'Social Security Disability (SSD) Benefits'
      AND [Stage6 Response] <> 'Not working'
      AND [Calculation_1133007210553765896] <= 1
    )
    // 2) Not age-disqual, Stage3 in those two, Qual Status = outofwrk-disqual
    OR
    (
      [qual_status] <> 'age-disqual'
      AND [Stage3 Response] IN ('Less than 2 years', 'Between 2 and 4 years')
      AND [qual_status] = 'outofwrk-disqual'
    )
    // 3) Not age-disqual, Stage3 in those two, Qual Status ≠ outofwrk-disqual, Stage7 = Yes
    OR
    (
      [qual_status] <> 'age-disqual'
      AND [Stage3 Response] IN ('Less than 2 years', 'Between 2 and 4 years')
      AND [qual_status] <> 'outofwrk-disqual'
      AND [Stage7 Response] = 'Yes'
    )
THEN 'Grade D'

// Rest (including age-disqual or anything else)
ELSE 'Rest'
END",
    "name": "[Calculation_7573084309404708864]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Dial R",
    "datatype": "string",
    "formula": "IF  [Called Count] < 4 then "<=3" 
elseif [Called Count] < 8 then "4-7"
elseif [Called Count] < 11 then "8-10"
elseif [Called Count] < 16 then "11-15"
elseif [Called Count] < 20 then "16-19"
elseif [Called Count] < 26 then "20-25"
elseif [Called Count] < 31 then "25-30"
elseif [Called Count] < 36 then "30-35"
else "35+" 
END",
    "name": "[Calculation_847802666706034688]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Dial R (detail)",
    "datatype": "string",
    "formula": "STR([Called Count])",
    "name": "[Calculation_847802666706186241]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Posted Wk2",
    "datatype": "integer",
    "formula": "({include [Sub Id]: countD(if [Date]< dateadd('day',-7,datetrunc('week',today(),'sunday')) then [User Id] end)})",
    "name": "[Last Week Leads (copy)_535928404290809858]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "% Posted Wk2",
    "datatype": "real",
    "formula": "ifnull([Last Week Leads (copy)_535928404290809858]/{exclude [Sub Id]: countD(if [Date]< dateadd('day',-7,datetrunc('week',today(),'sunday')) then [User Id] end)},0)",
    "name": "[% Last week Leads (copy)_535928404325892101]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "TTW Grade",
    "datatype": "string",
    "formula": "IF [ttw_qualstatus] = 'ttw-qualified' then 'Grade A'
ELSEIF  [ttw_qualstatus] = 'ttw-nonqualified' and [TTW Explore Work Form] = 'yes' THEN 'Grade B'
ELSEIF [ttw_qualstatus] = 'ttw-nonqualified' and [TTW Explore Work Form] != 'yes' THEN 'Grade C'
ELSEIF ISNULL([ttw_qualstatus]) and [Stage3 Response] = 'Between 2 and 4 years' then 'Grade D'
ELSE 'Rest'
END",
    "name": "[Calculation_1006061976934187009]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "20hrs Disqual",
    "datatype": "integer",
    "formula": "IF [Stage6 Response] = "More than 20 hours per week" THEN 1 ELSE 0 END",
    "name": "[Calculation_1133007210546622464]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Age Disqual",
    "datatype": "integer",
    "formula": "IF INT([Age]) < 40 OR INT([Age]) > 62 THEN 1 ELSE 0 END",
    "name": "[Calculation_1133007210553298946]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Attorney Disqual",
    "datatype": "integer",
    "formula": "IF [Stage5 Response] = "Yes" THEN 1 ELSE 0 END",
    "name": "[Calculation_1133007210553425923]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Ben Disqual",
    "datatype": "integer",
    "formula": "IF IFNULL([Stage1 Response], "") != "I am not receiving any disability benefits (SSD or SSI)"
THEN 1 ELSE 0 END",
    "name": "[Calculation_1133007210553487364]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Doctor Visit Disqual",
    "datatype": "integer",
    "formula": "IF [Stage4 Response] = "No" THEN 1 ELSE 0 END",
    "name": "[Calculation_1133007210553540613]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Five Year Work Disqual",
    "datatype": "integer",
    "formula": "IF [Stage3 Response] = "Less than 2 years"
OR [Stage3 Response] = "Between 2 and 4 years"
THEN 1 ELSE 0 END",
    "name": "[Calculation_1133007210553618438]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Out of Work Disqual",
    "datatype": "integer",
    "formula": "IF [Stage2 Response] = "No" THEN 1 ELSE 0 END",
    "name": "[Calculation_1133007210553663495]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "# of Disqual",
    "datatype": "integer",
    "formula": "ZN([Calculation_1133007210553487364]) +
ZN([Calculation_1133007210553663495]) +
ZN([Calculation_1133007210553618438]) +
ZN([Calculation_1133007210553540613]) +
ZN([Calculation_1133007210553425923]) +
ZN([Calculation_1133007210546622464]) +
ZN([Calculation_1133007210553298946])",
    "name": "[Calculation_1133007210553765896]",
    "role": "dimension",
    "type": "ordinal",
  },
  {
    "caption": "Row No",
    "datatype": "integer",
    "formula": "index()",
    "name": "[Calculation_1232578966339391490]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Unresolved SSA Leads",
    "datatype": "string",
    "formula": "IF { FIXED [Phone] : MAX([Resolved Lead]) } = 0 THEN "SSA Unresolved Lead"
ELSEIF { FIXED [Phone] : MAX([Resolved Lead]) } = 1 THEN "SSA Resolved Lead"
END",
    "name": "[Calculation_1467962419029331969]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Data Updated On",
    "datatype": "datetime",
    "formula": "{fixed :max([Post Date])}",
    "name": "[Calculation_2010857255412854784]",
    "role": "dimension",
    "type": "ordinal",
  },
  {
    "caption": "Date Filter last 2 weeks",
    "datatype": "boolean",
    "formula": "IF [Date]>= dateadd('day',-14,datetrunc('week',today(),'sunday')) then true else false end",
    "name": "[Calculation_535928404275974144]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Posted Wk1",
    "datatype": "integer",
    "formula": "({include [Sub Id]: countD(if [Date]>= dateadd('day',-7,datetrunc('week',today(),'sunday')) then [User Id] end)})",
    "name": "[Calculation_535928404288794625]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "% Posted Wk1",
    "datatype": "real",
    "formula": "ifnull([Calculation_535928404288794625]/{exclude [Sub Id]: countD(if [Date]>= dateadd('day',-7,datetrunc('week',today(),'sunday')) then [User Id] end)},0)",
    "name": "[Calculation_535928404317847556]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Square of Diff",
    "datatype": "real",
    "formula": "SQUARE([% Last week Leads (copy)_535928404325892101]-[Calculation_535928404317847556])",
    "name": "[Calculation_535928404326711302]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "RMSD Score",
    "datatype": "real",
    "formula": "SQRT(SUM([Calculation_535928404326711302])/COUNTD([Sub Id]))",
    "name": "[Calculation_535928404332609544]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "RSMD",
    "datatype": "string",
    "formula": "'RMSD Score'",
    "name": "[Calculation_535928404338208781]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Grade",
    "datatype": "string",
    "formula": "// Grade A
IF [qual_status] = 'all-steps' THEN 'Grade A'

// Grade B
ELSEIF 
    [qual_status] IN ('fiveyrwrk-disqual','outofwrk-disqual','doc-disqual')
    AND [Calculation_1133007210553765896] = 1
THEN 'Grade B'

// Grade C
ELSEIF 
    [qual_status] <> 'age-disqual'
    AND NOT [Stage3 Response] IN ('Less than 2 years', 'Between 2 and 4 years')
    AND [Stage1 Response] <> 'Social Security Disability (SSD) Benefits'
    AND [Stage6 Response] = 'Not working'
THEN 'Grade C'

// Grade D
ELSEIF 
    // 1) Not age-disqual, Stage3 NOT in those two, Stage1 not SSD, Stage6 ≠ Not working, disqual ≤ 1
    (
      [qual_status] <> 'age-disqual'
      AND NOT [Stage3 Response] IN ('Less than 2 years', 'Between 2 and 4 years')
      AND [Stage1 Response] <> 'Social Security Disability (SSD) Benefits'
      AND [Stage6 Response] <> 'Not working'
      AND [Calculation_1133007210553765896] <= 1
    )
    // 2) Not age-disqual, Stage3 in those two, Qual Status = outofwrk-disqual
    OR
    (
      [qual_status] <> 'age-disqual'
      AND [Stage3 Response] IN ('Less than 2 years', 'Between 2 and 4 years')
      AND [qual_status] = 'outofwrk-disqual'
    )
    // 3) Not age-disqual, Stage3 in those two, Qual Status ≠ outofwrk-disqual, Stage7 = Yes
    OR
    (
      [qual_status] <> 'age-disqual'
      AND [Stage3 Response] IN ('Less than 2 years', 'Between 2 and 4 years')
      AND [qual_status] <> 'outofwrk-disqual'
      AND [Stage7 Response] = 'Yes'
    )
THEN 'Grade D'

// Rest (including age-disqual or anything else)
ELSE 'Rest'
END",
    "name": "[Calculation_7573084309404708864]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Dial R",
    "datatype": "string",
    "formula": "IF  [Called Count] < 4 then "<=3" 
elseif [Called Count] < 8 then "4-7"
elseif [Called Count] < 11 then "8-10"
elseif [Called Count] < 16 then "11-15"
elseif [Called Count] < 20 then "16-19"
elseif [Called Count] < 26 then "20-25"
elseif [Called Count] < 31 then "25-30"
elseif [Called Count] < 36 then "30-35"
else "35+" 
END",
    "name": "[Calculation_847802666706034688]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Dial R (detail)",
    "datatype": "string",
    "formula": "STR([Called Count])",
    "name": "[Calculation_847802666706186241]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Posted Wk2",
    "datatype": "integer",
    "formula": "({include [Sub Id]: countD(if [Date]< dateadd('day',-7,datetrunc('week',today(),'sunday')) then [User Id] end)})",
    "name": "[Last Week Leads (copy)_535928404290809858]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "20hrs Disqual",
    "datatype": "integer",
    "formula": "IF [Stage6 Response] = "More than 20 hours per week" THEN 1 ELSE 0 END",
    "name": "[Calculation_1133007210546622464]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Age Disqual",
    "datatype": "integer",
    "formula": "IF INT([Age]) < 40 OR INT([Age]) > 62 THEN 1 ELSE 0 END",
    "name": "[Calculation_1133007210553298946]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Attorney Disqual",
    "datatype": "integer",
    "formula": "IF [Stage5 Response] = "Yes" THEN 1 ELSE 0 END",
    "name": "[Calculation_1133007210553425923]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Ben Disqual",
    "datatype": "integer",
    "formula": "IF IFNULL([Stage1 Response], "") != "I am not receiving any disability benefits (SSD or SSI)"
THEN 1 ELSE 0 END",
    "name": "[Calculation_1133007210553487364]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Doctor Visit Disqual",
    "datatype": "integer",
    "formula": "IF [Stage4 Response] = "No" THEN 1 ELSE 0 END",
    "name": "[Calculation_1133007210553540613]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Five Year Work Disqual",
    "datatype": "integer",
    "formula": "IF [Stage3 Response] = "Less than 2 years"
OR [Stage3 Response] = "Between 2 and 4 years"
THEN 1 ELSE 0 END",
    "name": "[Calculation_1133007210553618438]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Out of Work Disqual",
    "datatype": "integer",
    "formula": "IF [Stage2 Response] = "No" THEN 1 ELSE 0 END",
    "name": "[Calculation_1133007210553663495]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "# of Disqual",
    "datatype": "integer",
    "formula": "ZN([Calculation_1133007210553487364]) +
ZN([Calculation_1133007210553663495]) +
ZN([Calculation_1133007210553618438]) +
ZN([Calculation_1133007210553540613]) +
ZN([Calculation_1133007210553425923]) +
ZN([Calculation_1133007210546622464]) +
ZN([Calculation_1133007210553298946])",
    "name": "[Calculation_1133007210553765896]",
    "role": "dimension",
    "type": "ordinal",
  },
  {
    "caption": "'RESET FILTERS'",
    "datatype": "string",
    "formula": "'RESET FILTERS'",
    "name": "[Calculation_1346576327884931073]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Unresolved SSA Leads",
    "datatype": "string",
    "formula": "IF { FIXED [Phone] : MAX([Resolved Lead]) } = 0 THEN "SSA Unresolved Lead"
ELSEIF { FIXED [Phone] : MAX([Resolved Lead]) } = 1 THEN "SSA Resolved Lead"
END",
    "name": "[Calculation_1467962419029331969]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Grade",
    "datatype": "string",
    "formula": "// Grade A
IF [qual_status] = 'all-steps' THEN 'Grade A'

// Grade B
ELSEIF 
    [qual_status] IN ('fiveyrwrk-disqual','outofwrk-disqual','doc-disqual')
    AND [Calculation_1133007210553765896] = 1
THEN 'Grade B'

// Grade C
ELSEIF 
    [qual_status] <> 'age-disqual'
    AND NOT [Stage3 Response] IN ('Less than 2 years', 'Between 2 and 4 years')
    AND [Stage1 Response] <> 'Social Security Disability (SSD) Benefits'
    AND [Stage6 Response] = 'Not working'
THEN 'Grade C'

// Grade D
ELSEIF 
    // 1) Not age-disqual, Stage3 NOT in those two, Stage1 not SSD, Stage6 ≠ Not working, disqual ≤ 1
    (
      [qual_status] <> 'age-disqual'
      AND NOT [Stage3 Response] IN ('Less than 2 years', 'Between 2 and 4 years')
      AND [Stage1 Response] <> 'Social Security Disability (SSD) Benefits'
      AND [Stage6 Response] <> 'Not working'
      AND [Calculation_1133007210553765896] <= 1
    )
    // 2) Not age-disqual, Stage3 in those two, Qual Status = outofwrk-disqual
    OR
    (
      [qual_status] <> 'age-disqual'
      AND [Stage3 Response] IN ('Less than 2 years', 'Between 2 and 4 years')
      AND [qual_status] = 'outofwrk-disqual'
    )
    // 3) Not age-disqual, Stage3 in those two, Qual Status ≠ outofwrk-disqual, Stage7 = Yes
    OR
    (
      [qual_status] <> 'age-disqual'
      AND [Stage3 Response] IN ('Less than 2 years', 'Between 2 and 4 years')
      AND [qual_status] <> 'outofwrk-disqual'
      AND [Stage7 Response] = 'Yes'
    )
THEN 'Grade D'

// Rest (including age-disqual or anything else)
ELSE 'Rest'
END",
    "name": "[Calculation_7573084309404708864]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Dial R",
    "datatype": "string",
    "formula": "IF  [Called Count] < 4 then "<=3" 
elseif [Called Count] < 8 then "4-7"
elseif [Called Count] < 11 then "8-10"
elseif [Called Count] < 16 then "11-15"
elseif [Called Count] < 20 then "16-19"
elseif [Called Count] < 26 then "20-25"
elseif [Called Count] < 31 then "25-30"
elseif [Called Count] < 36 then "30-35"
else "35+" 
END",
    "name": "[Calculation_847802666706034688]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Dial R (detail)",
    "datatype": "string",
    "formula": "STR([Called Count])",
    "name": "[Calculation_847802666706186241]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Date Bucket",
    "datatype": "string",
    "formula": ""day"",
    "name": "[Parameter 1]",
    "role": "measure",
    "type": "nominal",
  },
  {
    "caption": "Start Date",
    "datatype": "date",
    "formula": "#2025-07-30#",
    "name": "[Parameter 5]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "End Date",
    "datatype": "date",
    "formula": "#2025-08-27#",
    "name": "[Parameter 6]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Show Source",
    "datatype": "string",
    "formula": ""1"",
    "name": "[Phone (copy)_1255659924007981058]",
    "role": "measure",
    "type": "nominal",
  },
  {
    "caption": "TTW Grade",
    "datatype": "string",
    "formula": "IF [ttw_qualstatus] = 'ttw-qualified' then 'Grade A'
ELSEIF  [ttw_qualstatus] = 'ttw-nonqualified' and [TTW Explore Work Form] = 'yes' THEN 'Grade B'
ELSEIF [ttw_qualstatus] = 'ttw-nonqualified' and [TTW Explore Work Form] != 'yes' THEN 'Grade C'
ELSEIF ISNULL([ttw_qualstatus]) and [Stage3 Response] = 'Between 2 and 4 years' then 'Grade D'
ELSE 'Rest'
END",
    "name": "[Calculation_1006061976934187009]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "20hrs Disqual",
    "datatype": "integer",
    "formula": "IF [Stage6 Response] = "More than 20 hours per week" THEN 1 ELSE 0 END",
    "name": "[Calculation_1133007210546622464]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Age Disqual",
    "datatype": "integer",
    "formula": "IF INT([Age]) < 40 OR INT([Age]) > 62 THEN 1 ELSE 0 END",
    "name": "[Calculation_1133007210553298946]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Attorney Disqual",
    "datatype": "integer",
    "formula": "IF [Stage5 Response] = "Yes" THEN 1 ELSE 0 END",
    "name": "[Calculation_1133007210553425923]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Ben Disqual",
    "datatype": "integer",
    "formula": "IF IFNULL([Stage1 Response], "") != "I am not receiving any disability benefits (SSD or SSI)"
THEN 1 ELSE 0 END",
    "name": "[Calculation_1133007210553487364]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Doctor Visit Disqual",
    "datatype": "integer",
    "formula": "IF [Stage4 Response] = "No" THEN 1 ELSE 0 END",
    "name": "[Calculation_1133007210553540613]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Five Year Work Disqual",
    "datatype": "integer",
    "formula": "IF [Stage3 Response] = "Less than 2 years"
OR [Stage3 Response] = "Between 2 and 4 years"
THEN 1 ELSE 0 END",
    "name": "[Calculation_1133007210553618438]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Out of Work Disqual",
    "datatype": "integer",
    "formula": "IF [Stage2 Response] = "No" THEN 1 ELSE 0 END",
    "name": "[Calculation_1133007210553663495]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "# of Disqual",
    "datatype": "integer",
    "formula": "ZN([Calculation_1133007210553487364]) +
ZN([Calculation_1133007210553663495]) +
ZN([Calculation_1133007210553618438]) +
ZN([Calculation_1133007210553540613]) +
ZN([Calculation_1133007210553425923]) +
ZN([Calculation_1133007210546622464]) +
ZN([Calculation_1133007210553298946])",
    "name": "[Calculation_1133007210553765896]",
    "role": "dimension",
    "type": "ordinal",
  },
  {
    "caption": "Unresolved SSA Leads",
    "datatype": "string",
    "formula": "IF { FIXED [Phone] : MAX([Resolved Lead]) } = 0 THEN "SSA Unresolved Lead"
ELSEIF { FIXED [Phone] : MAX([Resolved Lead]) } = 1 THEN "SSA Resolved Lead"
END",
    "name": "[Calculation_1467962419029331969]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "RET Time ",
    "datatype": "datetime",
    "formula": "DATETIME([RET Time])",
    "name": "[Calculation_2490912847470878721]",
    "role": "dimension",
    "type": "ordinal",
  },
  {
    "caption": "Sl No",
    "datatype": "integer",
    "formula": "Index()",
    "name": "[Calculation_2490912847471489026]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "RET Date",
    "datatype": "string",
    "formula": "//Updated Date: 2 June 2022
//Updated By: Sree
//Description: Calculation to apply date bucket

CASE [Parameters].[Parameter 1]
WHEN 'year' THEN str(datepart('year', [Calculation_2490912847470878721]))
WHEN 'quarter' THEN "Q" + str(datepart('quarter', [Calculation_2490912847470878721])) + " " + str(datepart('year', [Calculation_2490912847470878721]))
WHEN 'month' THEN str(datepart('month', [Calculation_2490912847470878721])) + "-" + str(datepart('year', [Calculation_2490912847470878721]))
WHEN 'day' THEN str(datepart('day', [Calculation_2490912847470878721]))+ "-" + str(DATENAME('month', [Calculation_2490912847470878721]))+ "-" + str(datepart('year', [Calculation_2490912847470878721]))
WHEN 'week' THEN "W" + str(datepart('week', [Calculation_2490912847470878721])-1) + "-" + str(datepart('year', [Calculation_2490912847470878721]))
WHEN "hour" THEN str(DATETRUNC('hour', [Calculation_2490912847470878721]))
WHEN "minute" THEN str(DATETRUNC('minute', [Calculation_2490912847470878721]))
END",
    "name": "[Calculation_2490912847471951875]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Grade",
    "datatype": "string",
    "formula": "// Grade A
IF [qual_status] = 'all-steps' THEN 'Grade A'

// Grade B
ELSEIF 
    [qual_status] IN ('fiveyrwrk-disqual','outofwrk-disqual','doc-disqual')
    AND [Calculation_1133007210553765896] = 1
THEN 'Grade B'

// Grade C
ELSEIF 
    [qual_status] <> 'age-disqual'
    AND NOT [Stage3 Response] IN ('Less than 2 years', 'Between 2 and 4 years')
    AND [Stage1 Response] <> 'Social Security Disability (SSD) Benefits'
    AND [Stage6 Response] = 'Not working'
THEN 'Grade C'

// Grade D
ELSEIF 
    // 1) Not age-disqual, Stage3 NOT in those two, Stage1 not SSD, Stage6 ≠ Not working, disqual ≤ 1
    (
      [qual_status] <> 'age-disqual'
      AND NOT [Stage3 Response] IN ('Less than 2 years', 'Between 2 and 4 years')
      AND [Stage1 Response] <> 'Social Security Disability (SSD) Benefits'
      AND [Stage6 Response] <> 'Not working'
      AND [Calculation_1133007210553765896] <= 1
    )
    // 2) Not age-disqual, Stage3 in those two, Qual Status = outofwrk-disqual
    OR
    (
      [qual_status] <> 'age-disqual'
      AND [Stage3 Response] IN ('Less than 2 years', 'Between 2 and 4 years')
      AND [qual_status] = 'outofwrk-disqual'
    )
    // 3) Not age-disqual, Stage3 in those two, Qual Status ≠ outofwrk-disqual, Stage7 = Yes
    OR
    (
      [qual_status] <> 'age-disqual'
      AND [Stage3 Response] IN ('Less than 2 years', 'Between 2 and 4 years')
      AND [qual_status] <> 'outofwrk-disqual'
      AND [Stage7 Response] = 'Yes'
    )
THEN 'Grade D'

// Rest (including age-disqual or anything else)
ELSE 'Rest'
END",
    "name": "[Calculation_7573084309404708864]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Today-28",
    "datatype": "date",
    "formula": "//Updated Date: 18 May 2022
//Updated By: Manish
//Description: Going back 28 days from today

({MAX(today()-28)})",
    "name": "[Calculation_767300790172184597]",
    "role": "dimension",
    "type": "ordinal",
  },
  {
    "caption": "Dial R",
    "datatype": "string",
    "formula": "IF  [Called Count] < 4 then "<=3" 
elseif [Called Count] < 8 then "4-7"
elseif [Called Count] < 11 then "8-10"
elseif [Called Count] < 16 then "11-15"
elseif [Called Count] < 20 then "16-19"
elseif [Called Count] < 26 then "20-25"
elseif [Called Count] < 31 then "25-30"
elseif [Called Count] < 36 then "30-35"
else "35+" 
END",
    "name": "[Calculation_847802666706034688]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Dial R (detail)",
    "datatype": "string",
    "formula": "STR([Called Count])",
    "name": "[Calculation_847802666706186241]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Max Date",
    "datatype": "date",
    "formula": "//Updated Date: 18 May 2022
//Updated By: Manish
//Description: Calculating max of todays date for including it in the default values of end date

{MAX(today())}",
    "name": "[Calculation_882424053213511680]",
    "role": "dimension",
    "type": "ordinal",
  },
  {
    "caption": "Date Filter for RET Time",
    "datatype": "boolean",
    "formula": "//Updated Date: 03 June 2022
//Updated By: Nithin
//Description: Filtering data based on RET 

DATE([Calculation_2490912847470878721])>=[Parameters].[Parameter 5] AND DATE([Calculation_2490912847470878721])<=[Parameters].[Parameter 6]",
    "name": "[Date Filter (copy)_5762144658223964161]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Source ",
    "datatype": "string",
    "formula": "CASE [Parameters].[Phone (copy)_1255659924007981058]
WHEN "0" THEN "Agg"
WHEN "1" THEN [Source]
END",
    "name": "[Phone (copy)_1255659924007964673]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Helper Date",
    "datatype": "string",
    "formula": ""default"",
    "name": "[Parameter 11]",
    "role": "measure",
    "type": "nominal",
  },
  {
    "caption": "Date Bucket",
    "datatype": "string",
    "formula": ""day"",
    "name": "[Parameter 1]",
    "role": "measure",
    "type": "nominal",
  },
  {
    "caption": "Start Date",
    "datatype": "date",
    "formula": "#2025-07-30#",
    "name": "[Parameter 5]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "End Date",
    "datatype": "date",
    "formula": "#2025-08-27#",
    "name": "[Parameter 6]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "TTW Grade",
    "datatype": "string",
    "formula": "IF [ttw_qualstatus] = 'ttw-qualified' then 'Grade A'
ELSEIF  [ttw_qualstatus] = 'ttw-nonqualified' and [TTW Explore Work Form] = 'yes' THEN 'Grade B'
ELSEIF [ttw_qualstatus] = 'ttw-nonqualified' and [TTW Explore Work Form] != 'yes' THEN 'Grade C'
ELSEIF ISNULL([ttw_qualstatus]) and [Stage3 Response] = 'Between 2 and 4 years' then 'Grade D'
ELSE 'Rest'
END",
    "name": "[Calculation_1006061976934187009]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "20hrs Disqual",
    "datatype": "integer",
    "formula": "IF [Stage6 Response] = "More than 20 hours per week" THEN 1 ELSE 0 END",
    "name": "[Calculation_1133007210546622464]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Age Disqual",
    "datatype": "integer",
    "formula": "IF INT([Age]) < 40 OR INT([Age]) > 62 THEN 1 ELSE 0 END",
    "name": "[Calculation_1133007210553298946]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Attorney Disqual",
    "datatype": "integer",
    "formula": "IF [Stage5 Response] = "Yes" THEN 1 ELSE 0 END",
    "name": "[Calculation_1133007210553425923]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Ben Disqual",
    "datatype": "integer",
    "formula": "IF IFNULL([Stage1 Response], "") != "I am not receiving any disability benefits (SSD or SSI)"
THEN 1 ELSE 0 END",
    "name": "[Calculation_1133007210553487364]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Doctor Visit Disqual",
    "datatype": "integer",
    "formula": "IF [Stage4 Response] = "No" THEN 1 ELSE 0 END",
    "name": "[Calculation_1133007210553540613]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Five Year Work Disqual",
    "datatype": "integer",
    "formula": "IF [Stage3 Response] = "Less than 2 years"
OR [Stage3 Response] = "Between 2 and 4 years"
THEN 1 ELSE 0 END",
    "name": "[Calculation_1133007210553618438]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Out of Work Disqual",
    "datatype": "integer",
    "formula": "IF [Stage2 Response] = "No" THEN 1 ELSE 0 END",
    "name": "[Calculation_1133007210553663495]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "# of Disqual",
    "datatype": "integer",
    "formula": "ZN([Calculation_1133007210553487364]) +
ZN([Calculation_1133007210553663495]) +
ZN([Calculation_1133007210553618438]) +
ZN([Calculation_1133007210553540613]) +
ZN([Calculation_1133007210553425923]) +
ZN([Calculation_1133007210546622464]) +
ZN([Calculation_1133007210553298946])",
    "name": "[Calculation_1133007210553765896]",
    "role": "dimension",
    "type": "ordinal",
  },
  {
    "caption": "Unresolved SSA Leads",
    "datatype": "string",
    "formula": "IF { FIXED [Phone] : MAX([Resolved Lead]) } = 0 THEN "SSA Unresolved Lead"
ELSEIF { FIXED [Phone] : MAX([Resolved Lead]) } = 1 THEN "SSA Resolved Lead"
END",
    "name": "[Calculation_1467962419029331969]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Post Date ",
    "datatype": "datetime",
    "formula": "//Updated Date: 18 May 2022
//Updated By: Manish
//Description: Formula to calculate UTC date

DATEADD("hour",0,[Post Date])",
    "name": "[Calculation_1916563181826678784]",
    "role": "dimension",
    "type": "ordinal",
  },
  {
    "caption": "Data Updated On",
    "datatype": "datetime",
    "formula": "{fixed :max([Post Date])}",
    "name": "[Calculation_2010857255412854784]",
    "role": "dimension",
    "type": "ordinal",
  },
  {
    "caption": "% Scrub ",
    "datatype": "real",
    "formula": "//Updated Date: 18 May 2022
//Updated By: Manish
//Description: Calculating the percentage of scrub rejected

[Scrub Accept (copy)_7975100929064427530]/([Calculation_7975100929064054793]+[Scrub Accept (copy)_7975100929064427530])",
    "name": "[Calculation_2120632528679034884]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Grade",
    "datatype": "string",
    "formula": "// Grade A
IF [qual_status] = 'all-steps' THEN 'Grade A'

// Grade B
ELSEIF 
    [qual_status] IN ('fiveyrwrk-disqual','outofwrk-disqual','doc-disqual')
    AND [Calculation_1133007210553765896] = 1
THEN 'Grade B'

// Grade C
ELSEIF 
    [qual_status] <> 'age-disqual'
    AND NOT [Stage3 Response] IN ('Less than 2 years', 'Between 2 and 4 years')
    AND [Stage1 Response] <> 'Social Security Disability (SSD) Benefits'
    AND [Stage6 Response] = 'Not working'
THEN 'Grade C'

// Grade D
ELSEIF 
    // 1) Not age-disqual, Stage3 NOT in those two, Stage1 not SSD, Stage6 ≠ Not working, disqual ≤ 1
    (
      [qual_status] <> 'age-disqual'
      AND NOT [Stage3 Response] IN ('Less than 2 years', 'Between 2 and 4 years')
      AND [Stage1 Response] <> 'Social Security Disability (SSD) Benefits'
      AND [Stage6 Response] <> 'Not working'
      AND [Calculation_1133007210553765896] <= 1
    )
    // 2) Not age-disqual, Stage3 in those two, Qual Status = outofwrk-disqual
    OR
    (
      [qual_status] <> 'age-disqual'
      AND [Stage3 Response] IN ('Less than 2 years', 'Between 2 and 4 years')
      AND [qual_status] = 'outofwrk-disqual'
    )
    // 3) Not age-disqual, Stage3 in those two, Qual Status ≠ outofwrk-disqual, Stage7 = Yes
    OR
    (
      [qual_status] <> 'age-disqual'
      AND [Stage3 Response] IN ('Less than 2 years', 'Between 2 and 4 years')
      AND [qual_status] <> 'outofwrk-disqual'
      AND [Stage7 Response] = 'Yes'
    )
THEN 'Grade D'

// Rest (including age-disqual or anything else)
ELSE 'Rest'
END",
    "name": "[Calculation_7573084309404708864]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Today-28",
    "datatype": "date",
    "formula": "//Updated Date: 18 May 2022
//Updated By: Manish
//Description: Going back 28 days from today

({MAX(today()-28)})",
    "name": "[Calculation_767300790172184597]",
    "role": "dimension",
    "type": "ordinal",
  },
  {
    "caption": "Time-Source-Subid",
    "datatype": "string",
    "formula": "//Updated Date: 18 May 2022
//Updated By: Manish
//Description: Changing the data type to string of Time-Source-Subid column

STR([Date])+'-'+[Source]+'-'+[Sub Id]",
    "name": "[Calculation_7746824680808361990]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Scrub Accept",
    "datatype": "integer",
    "formula": "//Updated Date: 18 May 2022
//Updated By: Manish
//Description: Calculating the unique count of user id when outcome is initialised

COUNTD(IF [Outcome]='initialized' THEN [User Id] END)",
    "name": "[Calculation_7975100929064054793]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Date Filter",
    "datatype": "boolean",
    "formula": "//Updated Date: 18 May 2022
//Updated By: Manish
//Description: Filtering data based on date

IF [Parameters].[Parameter 11] = 'default'
THEN [Date]>=[Parameters].[Parameter 5] AND [Date]<=[Parameters].[Parameter 6]
ELSEIF [Parameters].[Parameter 11] = 'weekly'
THEN [Date] >= TODAY()-8 AND [Date] <= TODAY()-1
END",
    "name": "[Calculation_843580506575679492]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Dial R",
    "datatype": "string",
    "formula": "IF  [Called Count] < 4 then "<=3" 
elseif [Called Count] < 8 then "4-7"
elseif [Called Count] < 11 then "8-10"
elseif [Called Count] < 16 then "11-15"
elseif [Called Count] < 20 then "16-19"
elseif [Called Count] < 26 then "20-25"
elseif [Called Count] < 31 then "25-30"
elseif [Called Count] < 36 then "30-35"
else "35+" 
END",
    "name": "[Calculation_847802666706034688]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Dial R (detail)",
    "datatype": "string",
    "formula": "STR([Called Count])",
    "name": "[Calculation_847802666706186241]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Max Date",
    "datatype": "date",
    "formula": "//Updated Date: 18 May 2022
//Updated By: Manish
//Description: Calculating max of todays date for including it in the default values of end date

{MAX(today())}",
    "name": "[Calculation_882424053213511680]",
    "role": "dimension",
    "type": "ordinal",
  },
  {
    "caption": "Post Date  ",
    "datatype": "string",
    "formula": "//Updated Date: 18 May 2022
//Updated By: Manish
//Description: Calculation to apply date bucket

CASE [Parameters].[Parameter 1]
WHEN 'year' THEN str(datepart('year', [Calculation_1916563181826678784]))
WHEN 'quarter' THEN "Q" + str(datepart('quarter', [Calculation_1916563181826678784])) + " " + str(datepart('year', [Calculation_1916563181826678784]))
WHEN 'month' THEN str(datepart('month', [Calculation_1916563181826678784])) + "-" + str(datepart('year', [Calculation_1916563181826678784]))
WHEN 'day' THEN str(DATENAME('month', [Calculation_1916563181826678784]))+ "-" +str(datepart('day', [Calculation_1916563181826678784]))+ "-" + str(datepart('year', [Calculation_1916563181826678784]))
WHEN 'week' THEN "W" + str(datepart('week', [Calculation_1916563181826678784])) + "-" + str(datepart('year', [Calculation_1916563181826678784]))
WHEN "hour" THEN str(DATETRUNC('hour', [Calculation_1916563181826678784]))
WHEN "minute" THEN str(DATETRUNC('minute', [Calculation_1916563181826678784]))
END",
    "name": "[Calculation_97320012552925214]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Source - Date",
    "datatype": "string",
    "formula": "//Updated Date: 18 May 2022
//Updated By: Manish//Description: Calculating max of todays date for including it in the default values of end date
//Description: Concatinating source and date column

[Source]+":"+[Calculation_97320012552925214]",
    "name": "[Calculation_99712551088799768]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Source-Subid",
    "datatype": "string",
    "formula": "//Updated Date: 18 May 2022
//Updated By: Manish//Description: Calculating max of todays date for including it in the default values of end date
//Description: Concatinating source and subid column

[Source]+" : "+[Sub Id]",
    "name": "[Calculation_99712551105503258]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Scrub Rejected",
    "datatype": "integer",
    "formula": "//Updated Date: 18 May 2022
//Updated By: Manish
//Description: Calculating the unique count of user id when outcome is rejected

COUNTD(IF [Outcome]='rejected' THEN [User Id] END)",
    "name": "[Scrub Accept (copy)_7975100929064427530]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Helper Date",
    "datatype": "string",
    "formula": ""default"",
    "name": "[Parameter 11]",
    "role": "measure",
    "type": "nominal",
  },
  {
    "caption": "Start Date",
    "datatype": "date",
    "formula": "#2025-07-30#",
    "name": "[Parameter 5]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "End Date",
    "datatype": "date",
    "formula": "#2025-08-27#",
    "name": "[Parameter 6]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "TTW Grade",
    "datatype": "string",
    "formula": "IF [ttw_qualstatus] = 'ttw-qualified' then 'Grade A'
ELSEIF  [ttw_qualstatus] = 'ttw-nonqualified' and [TTW Explore Work Form] = 'yes' THEN 'Grade B'
ELSEIF [ttw_qualstatus] = 'ttw-nonqualified' and [TTW Explore Work Form] != 'yes' THEN 'Grade C'
ELSEIF ISNULL([ttw_qualstatus]) and [Stage3 Response] = 'Between 2 and 4 years' then 'Grade D'
ELSE 'Rest'
END",
    "name": "[Calculation_1006061976934187009]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "20hrs Disqual",
    "datatype": "integer",
    "formula": "IF [Stage6 Response] = "More than 20 hours per week" THEN 1 ELSE 0 END",
    "name": "[Calculation_1133007210546622464]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Age Disqual",
    "datatype": "integer",
    "formula": "IF INT([Age]) < 40 OR INT([Age]) > 62 THEN 1 ELSE 0 END",
    "name": "[Calculation_1133007210553298946]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Attorney Disqual",
    "datatype": "integer",
    "formula": "IF [Stage5 Response] = "Yes" THEN 1 ELSE 0 END",
    "name": "[Calculation_1133007210553425923]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Ben Disqual",
    "datatype": "integer",
    "formula": "IF IFNULL([Stage1 Response], "") != "I am not receiving any disability benefits (SSD or SSI)"
THEN 1 ELSE 0 END",
    "name": "[Calculation_1133007210553487364]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Doctor Visit Disqual",
    "datatype": "integer",
    "formula": "IF [Stage4 Response] = "No" THEN 1 ELSE 0 END",
    "name": "[Calculation_1133007210553540613]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Five Year Work Disqual",
    "datatype": "integer",
    "formula": "IF [Stage3 Response] = "Less than 2 years"
OR [Stage3 Response] = "Between 2 and 4 years"
THEN 1 ELSE 0 END",
    "name": "[Calculation_1133007210553618438]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Out of Work Disqual",
    "datatype": "integer",
    "formula": "IF [Stage2 Response] = "No" THEN 1 ELSE 0 END",
    "name": "[Calculation_1133007210553663495]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "# of Disqual",
    "datatype": "integer",
    "formula": "ZN([Calculation_1133007210553487364]) +
ZN([Calculation_1133007210553663495]) +
ZN([Calculation_1133007210553618438]) +
ZN([Calculation_1133007210553540613]) +
ZN([Calculation_1133007210553425923]) +
ZN([Calculation_1133007210546622464]) +
ZN([Calculation_1133007210553298946])",
    "name": "[Calculation_1133007210553765896]",
    "role": "dimension",
    "type": "ordinal",
  },
  {
    "caption": "Unresolved SSA Leads",
    "datatype": "string",
    "formula": "IF { FIXED [Phone] : MAX([Resolved Lead]) } = 0 THEN "SSA Unresolved Lead"
ELSEIF { FIXED [Phone] : MAX([Resolved Lead]) } = 1 THEN "SSA Resolved Lead"
END",
    "name": "[Calculation_1467962419029331969]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "CTC Lead Flag",
    "datatype": "string",
    "formula": "if [CTC Lead] = 1 then "Yes" else "No" END",
    "name": "[Calculation_1880252886088871936]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Lead Sell Type",
    "datatype": "string",
    "formula": "if contains([Transfer Info Label],'CXER') then 'Sold: Call' 
elseif 
contains([sgmt],'ql-leadbuy') or 
contains([ATA Work],'ql-leadbuy')
then 'Sold: Lead'
else 'Internal'
end",
    "name": "[Calculation_3435894714053935109]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Time to Call (Minute)",
    "datatype": "real",
    "formula": "IF [Calculation_1880252886088871936] = 'Yes'
THEN ROUND(([CTC Time] - [Post Date]) * 24 * 60, 2)
END",
    "name": "[Calculation_499055157752631296]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Time to Call Bucket",
    "datatype": "string",
    "formula": "IF  [Calculation_499055157752631296] < 0
THEN '<0 Mins'
ELSEIF [Calculation_499055157752631296] <= 2 AND [Calculation_499055157752631296] >= 0
THEN '0-2 Mins'
ELSEIF [Calculation_499055157752631296] <= 5 AND [Calculation_499055157752631296] > 0
THEN '2-5 Mins'
ELSEIF [Calculation_499055157752631296] <= 10 AND [Calculation_499055157752631296] > 0
THEN '5-10 Mins'
ELSEIF [Calculation_499055157752631296] <= 30 AND [Calculation_499055157752631296] > 0 
THEN '10-30 Mins'
ELSEIF [Calculation_499055157752631296] <= 60 AND [Calculation_499055157752631296] > 0
THEN '30Mins-1 Hour'
ELSEIF [Calculation_499055157752631296] <= 300 AND [Calculation_499055157752631296] > 0
THEN '1-5 Hours'
ELSEIF [Calculation_499055157752631296] <= 600 AND [Calculation_499055157752631296] > 0
THEN '5-10 Hours'
ELSEIF [Calculation_499055157752631296] <= 1440 AND [Calculation_499055157752631296] > 0
THEN '10-24 Hours'
ELSEIF [Calculation_499055157752631296] <= 4320 AND [Calculation_499055157752631296] > 0
THEN '24-72 Hours'
ELSEIF [Calculation_499055157752631296] > 4320 AND [Calculation_499055157752631296] > 0
THEN '>72 Hours'
END",
    "name": "[Calculation_499055157754740737]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Grade",
    "datatype": "string",
    "formula": "// Grade A
IF [qual_status] = 'all-steps' THEN 'Grade A'

// Grade B
ELSEIF 
    [qual_status] IN ('fiveyrwrk-disqual','outofwrk-disqual','doc-disqual')
    AND [Calculation_1133007210553765896] = 1
THEN 'Grade B'

// Grade C
ELSEIF 
    [qual_status] <> 'age-disqual'
    AND NOT [Stage3 Response] IN ('Less than 2 years', 'Between 2 and 4 years')
    AND [Stage1 Response] <> 'Social Security Disability (SSD) Benefits'
    AND [Stage6 Response] = 'Not working'
THEN 'Grade C'

// Grade D
ELSEIF 
    // 1) Not age-disqual, Stage3 NOT in those two, Stage1 not SSD, Stage6 ≠ Not working, disqual ≤ 1
    (
      [qual_status] <> 'age-disqual'
      AND NOT [Stage3 Response] IN ('Less than 2 years', 'Between 2 and 4 years')
      AND [Stage1 Response] <> 'Social Security Disability (SSD) Benefits'
      AND [Stage6 Response] <> 'Not working'
      AND [Calculation_1133007210553765896] <= 1
    )
    // 2) Not age-disqual, Stage3 in those two, Qual Status = outofwrk-disqual
    OR
    (
      [qual_status] <> 'age-disqual'
      AND [Stage3 Response] IN ('Less than 2 years', 'Between 2 and 4 years')
      AND [qual_status] = 'outofwrk-disqual'
    )
    // 3) Not age-disqual, Stage3 in those two, Qual Status ≠ outofwrk-disqual, Stage7 = Yes
    OR
    (
      [qual_status] <> 'age-disqual'
      AND [Stage3 Response] IN ('Less than 2 years', 'Between 2 and 4 years')
      AND [qual_status] <> 'outofwrk-disqual'
      AND [Stage7 Response] = 'Yes'
    )
THEN 'Grade D'

// Rest (including age-disqual or anything else)
ELSE 'Rest'
END",
    "name": "[Calculation_7573084309404708864]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Today-28",
    "datatype": "date",
    "formula": "//Updated Date: 18 May 2022
//Updated By: Manish
//Description: Going back 28 days from today

({MAX(today()-28)})",
    "name": "[Calculation_767300790172184597]",
    "role": "dimension",
    "type": "ordinal",
  },
  {
    "caption": "Date Filter",
    "datatype": "boolean",
    "formula": "//Updated Date: 18 May 2022
//Updated By: Manish
//Description: Filtering data based on date

IF [Parameters].[Parameter 11] = 'default'
THEN [Date]>=[Parameters].[Parameter 5] AND [Date]<=[Parameters].[Parameter 6]
ELSEIF [Parameters].[Parameter 11] = 'weekly'
THEN [Date] >= TODAY()-8 AND [Date] <= TODAY()-1
END",
    "name": "[Calculation_843580506575679492]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Dial R",
    "datatype": "string",
    "formula": "IF  [Called Count] < 4 then "<=3" 
elseif [Called Count] < 8 then "4-7"
elseif [Called Count] < 11 then "8-10"
elseif [Called Count] < 16 then "11-15"
elseif [Called Count] < 20 then "16-19"
elseif [Called Count] < 26 then "20-25"
elseif [Called Count] < 31 then "25-30"
elseif [Called Count] < 36 then "30-35"
else "35+" 
END",
    "name": "[Calculation_847802666706034688]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Dial R (detail)",
    "datatype": "string",
    "formula": "STR([Called Count])",
    "name": "[Calculation_847802666706186241]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Max Date",
    "datatype": "date",
    "formula": "//Updated Date: 18 May 2022
//Updated By: Manish
//Description: Calculating max of todays date for including it in the default values of end date

{MAX(today())}",
    "name": "[Calculation_882424053213511680]",
    "role": "dimension",
    "type": "ordinal",
  },
  {
    "caption": "20hrs Disqual",
    "datatype": "integer",
    "formula": "IF [Stage6 Response] = "More than 20 hours per week" THEN 1 ELSE 0 END",
    "name": "[Calculation_1133007210546622464]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Age Disqual",
    "datatype": "integer",
    "formula": "IF INT([Age]) < 40 OR INT([Age]) > 62 THEN 1 ELSE 0 END",
    "name": "[Calculation_1133007210553298946]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Attorney Disqual",
    "datatype": "integer",
    "formula": "IF [Stage5 Response] = "Yes" THEN 1 ELSE 0 END",
    "name": "[Calculation_1133007210553425923]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Ben Disqual",
    "datatype": "integer",
    "formula": "IF IFNULL([Stage1 Response], "") != "I am not receiving any disability benefits (SSD or SSI)"
THEN 1 ELSE 0 END",
    "name": "[Calculation_1133007210553487364]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Doctor Visit Disqual",
    "datatype": "integer",
    "formula": "IF [Stage4 Response] = "No" THEN 1 ELSE 0 END",
    "name": "[Calculation_1133007210553540613]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Five Year Work Disqual",
    "datatype": "integer",
    "formula": "IF [Stage3 Response] = "Less than 2 years"
OR [Stage3 Response] = "Between 2 and 4 years"
THEN 1 ELSE 0 END",
    "name": "[Calculation_1133007210553618438]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Out of Work Disqual",
    "datatype": "integer",
    "formula": "IF [Stage2 Response] = "No" THEN 1 ELSE 0 END",
    "name": "[Calculation_1133007210553663495]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "# of Disqual",
    "datatype": "integer",
    "formula": "ZN([Calculation_1133007210553487364]) +
ZN([Calculation_1133007210553663495]) +
ZN([Calculation_1133007210553618438]) +
ZN([Calculation_1133007210553540613]) +
ZN([Calculation_1133007210553425923]) +
ZN([Calculation_1133007210546622464]) +
ZN([Calculation_1133007210553298946])",
    "name": "[Calculation_1133007210553765896]",
    "role": "dimension",
    "type": "ordinal",
  },
  {
    "caption": "Unresolved SSA Leads",
    "datatype": "string",
    "formula": "IF { FIXED [Phone] : MAX([Resolved Lead]) } = 0 THEN "SSA Unresolved Lead"
ELSEIF { FIXED [Phone] : MAX([Resolved Lead]) } = 1 THEN "SSA Resolved Lead"
END",
    "name": "[Calculation_1467962419029331969]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Grade",
    "datatype": "string",
    "formula": "// Grade A
IF [qual_status] = 'all-steps' THEN 'Grade A'

// Grade B
ELSEIF 
    [qual_status] IN ('fiveyrwrk-disqual','outofwrk-disqual','doc-disqual')
    AND [Calculation_1133007210553765896] = 1
THEN 'Grade B'

// Grade C
ELSEIF 
    [qual_status] <> 'age-disqual'
    AND NOT [Stage3 Response] IN ('Less than 2 years', 'Between 2 and 4 years')
    AND [Stage1 Response] <> 'Social Security Disability (SSD) Benefits'
    AND [Stage6 Response] = 'Not working'
THEN 'Grade C'

// Grade D
ELSEIF 
    // 1) Not age-disqual, Stage3 NOT in those two, Stage1 not SSD, Stage6 ≠ Not working, disqual ≤ 1
    (
      [qual_status] <> 'age-disqual'
      AND NOT [Stage3 Response] IN ('Less than 2 years', 'Between 2 and 4 years')
      AND [Stage1 Response] <> 'Social Security Disability (SSD) Benefits'
      AND [Stage6 Response] <> 'Not working'
      AND [Calculation_1133007210553765896] <= 1
    )
    // 2) Not age-disqual, Stage3 in those two, Qual Status = outofwrk-disqual
    OR
    (
      [qual_status] <> 'age-disqual'
      AND [Stage3 Response] IN ('Less than 2 years', 'Between 2 and 4 years')
      AND [qual_status] = 'outofwrk-disqual'
    )
    // 3) Not age-disqual, Stage3 in those two, Qual Status ≠ outofwrk-disqual, Stage7 = Yes
    OR
    (
      [qual_status] <> 'age-disqual'
      AND [Stage3 Response] IN ('Less than 2 years', 'Between 2 and 4 years')
      AND [qual_status] <> 'outofwrk-disqual'
      AND [Stage7 Response] = 'Yes'
    )
THEN 'Grade D'

// Rest (including age-disqual or anything else)
ELSE 'Rest'
END",
    "name": "[Calculation_7573084309404708864]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Dial R",
    "datatype": "string",
    "formula": "IF  [Called Count] < 4 then "<=3" 
elseif [Called Count] < 8 then "4-7"
elseif [Called Count] < 11 then "8-10"
elseif [Called Count] < 16 then "11-15"
elseif [Called Count] < 20 then "16-19"
elseif [Called Count] < 26 then "20-25"
elseif [Called Count] < 31 then "25-30"
elseif [Called Count] < 36 then "30-35"
else "35+" 
END",
    "name": "[Calculation_847802666706034688]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Dial R (detail)",
    "datatype": "string",
    "formula": "STR([Called Count])",
    "name": "[Calculation_847802666706186241]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "TTW Grade",
    "datatype": "string",
    "formula": "IF [ttw_qualstatus] = 'ttw-qualified' then 'Grade A'
ELSEIF  [ttw_qualstatus] = 'ttw-nonqualified' and [TTW Explore Work Form] = 'yes' THEN 'Grade B'
ELSEIF [ttw_qualstatus] = 'ttw-nonqualified' and [TTW Explore Work Form] != 'yes' THEN 'Grade C'
ELSEIF ISNULL([ttw_qualstatus]) and [Stage3 Response] = 'Between 2 and 4 years' then 'Grade D'
ELSE 'Rest'
END",
    "name": "[Calculation_1006061976934187009]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "20hrs Disqual",
    "datatype": "integer",
    "formula": "IF [Stage6 Response] = "More than 20 hours per week" THEN 1 ELSE 0 END",
    "name": "[Calculation_1133007210546622464]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Age Disqual",
    "datatype": "integer",
    "formula": "IF INT([Age]) < 40 OR INT([Age]) > 62 THEN 1 ELSE 0 END",
    "name": "[Calculation_1133007210553298946]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Attorney Disqual",
    "datatype": "integer",
    "formula": "IF [Stage5 Response] = "Yes" THEN 1 ELSE 0 END",
    "name": "[Calculation_1133007210553425923]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Ben Disqual",
    "datatype": "integer",
    "formula": "IF IFNULL([Stage1 Response], "") != "I am not receiving any disability benefits (SSD or SSI)"
THEN 1 ELSE 0 END",
    "name": "[Calculation_1133007210553487364]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Doctor Visit Disqual",
    "datatype": "integer",
    "formula": "IF [Stage4 Response] = "No" THEN 1 ELSE 0 END",
    "name": "[Calculation_1133007210553540613]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Five Year Work Disqual",
    "datatype": "integer",
    "formula": "IF [Stage3 Response] = "Less than 2 years"
OR [Stage3 Response] = "Between 2 and 4 years"
THEN 1 ELSE 0 END",
    "name": "[Calculation_1133007210553618438]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Out of Work Disqual",
    "datatype": "integer",
    "formula": "IF [Stage2 Response] = "No" THEN 1 ELSE 0 END",
    "name": "[Calculation_1133007210553663495]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "# of Disqual",
    "datatype": "integer",
    "formula": "ZN([Calculation_1133007210553487364]) +
ZN([Calculation_1133007210553663495]) +
ZN([Calculation_1133007210553618438]) +
ZN([Calculation_1133007210553540613]) +
ZN([Calculation_1133007210553425923]) +
ZN([Calculation_1133007210546622464]) +
ZN([Calculation_1133007210553298946])",
    "name": "[Calculation_1133007210553765896]",
    "role": "dimension",
    "type": "ordinal",
  },
  {
    "caption": "Unresolved SSA Leads",
    "datatype": "string",
    "formula": "IF { FIXED [Phone] : MAX([Resolved Lead]) } = 0 THEN "SSA Unresolved Lead"
ELSEIF { FIXED [Phone] : MAX([Resolved Lead]) } = 1 THEN "SSA Resolved Lead"
END",
    "name": "[Calculation_1467962419029331969]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "rowid",
    "datatype": "integer",
    "formula": "INDEX()",
    "name": "[Calculation_2146317124280909824]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Date Str of Post Date",
    "datatype": "string",
    "formula": "//Updated Date: 18 May 2022
//Updated By: Manish
//Description: Extracting the date part of post time

LEFT(str([Calculation_8176144444085592065]),10)",
    "name": "[Calculation_4794996655180886018]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Grade",
    "datatype": "string",
    "formula": "// Grade A
IF [qual_status] = 'all-steps' THEN 'Grade A'

// Grade B
ELSEIF 
    [qual_status] IN ('fiveyrwrk-disqual','outofwrk-disqual','doc-disqual')
    AND [Calculation_1133007210553765896] = 1
THEN 'Grade B'

// Grade C
ELSEIF 
    [qual_status] <> 'age-disqual'
    AND NOT [Stage3 Response] IN ('Less than 2 years', 'Between 2 and 4 years')
    AND [Stage1 Response] <> 'Social Security Disability (SSD) Benefits'
    AND [Stage6 Response] = 'Not working'
THEN 'Grade C'

// Grade D
ELSEIF 
    // 1) Not age-disqual, Stage3 NOT in those two, Stage1 not SSD, Stage6 ≠ Not working, disqual ≤ 1
    (
      [qual_status] <> 'age-disqual'
      AND NOT [Stage3 Response] IN ('Less than 2 years', 'Between 2 and 4 years')
      AND [Stage1 Response] <> 'Social Security Disability (SSD) Benefits'
      AND [Stage6 Response] <> 'Not working'
      AND [Calculation_1133007210553765896] <= 1
    )
    // 2) Not age-disqual, Stage3 in those two, Qual Status = outofwrk-disqual
    OR
    (
      [qual_status] <> 'age-disqual'
      AND [Stage3 Response] IN ('Less than 2 years', 'Between 2 and 4 years')
      AND [qual_status] = 'outofwrk-disqual'
    )
    // 3) Not age-disqual, Stage3 in those two, Qual Status ≠ outofwrk-disqual, Stage7 = Yes
    OR
    (
      [qual_status] <> 'age-disqual'
      AND [Stage3 Response] IN ('Less than 2 years', 'Between 2 and 4 years')
      AND [qual_status] <> 'outofwrk-disqual'
      AND [Stage7 Response] = 'Yes'
    )
THEN 'Grade D'

// Rest (including age-disqual or anything else)
ELSE 'Rest'
END",
    "name": "[Calculation_7573084309404708864]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Day of Post Date (Copy)",
    "datatype": "date",
    "formula": "//Updated Date: 18 May 2022
//Updated By: Manish
//Description: Formula to include date conversion from UTC to PT

DATE(DATEADD("hour",0,[Post Date]))",
    "name": "[Calculation_8176144444085592065]",
    "role": "dimension",
    "type": "ordinal",
  },
  {
    "caption": "Phone (w/o area code)",
    "datatype": "string",
    "formula": "//Updated Date: 18 May 2022
//Updated By: Manish
//Description: Removing the area code from phone numbers

MID([Phone],4)",
    "name": "[Calculation_8176144444085837826]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Dial R",
    "datatype": "string",
    "formula": "IF  [Called Count] < 4 then "<=3" 
elseif [Called Count] < 8 then "4-7"
elseif [Called Count] < 11 then "8-10"
elseif [Called Count] < 16 then "11-15"
elseif [Called Count] < 20 then "16-19"
elseif [Called Count] < 26 then "20-25"
elseif [Called Count] < 31 then "25-30"
elseif [Called Count] < 36 then "30-35"
else "35+" 
END",
    "name": "[Calculation_847802666706034688]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Dial R (detail)",
    "datatype": "string",
    "formula": "STR([Called Count])",
    "name": "[Calculation_847802666706186241]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "TTW Grade",
    "datatype": "string",
    "formula": "IF [ttw_qualstatus] = 'ttw-qualified' then 'Grade A'
ELSEIF  [ttw_qualstatus] = 'ttw-nonqualified' and [TTW Explore Work Form] = 'yes' THEN 'Grade B'
ELSEIF [ttw_qualstatus] = 'ttw-nonqualified' and [TTW Explore Work Form] != 'yes' THEN 'Grade C'
ELSEIF ISNULL([ttw_qualstatus]) and [Stage3 Response] = 'Between 2 and 4 years' then 'Grade D'
ELSE 'Rest'
END",
    "name": "[Calculation_1006061976934187009]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "20hrs Disqual",
    "datatype": "integer",
    "formula": "IF [Stage6 Response] = "More than 20 hours per week" THEN 1 ELSE 0 END",
    "name": "[Calculation_1133007210546622464]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Age Disqual",
    "datatype": "integer",
    "formula": "IF INT([Age]) < 40 OR INT([Age]) > 62 THEN 1 ELSE 0 END",
    "name": "[Calculation_1133007210553298946]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Attorney Disqual",
    "datatype": "integer",
    "formula": "IF [Stage5 Response] = "Yes" THEN 1 ELSE 0 END",
    "name": "[Calculation_1133007210553425923]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Ben Disqual",
    "datatype": "integer",
    "formula": "IF IFNULL([Stage1 Response], "") != "I am not receiving any disability benefits (SSD or SSI)"
THEN 1 ELSE 0 END",
    "name": "[Calculation_1133007210553487364]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Doctor Visit Disqual",
    "datatype": "integer",
    "formula": "IF [Stage4 Response] = "No" THEN 1 ELSE 0 END",
    "name": "[Calculation_1133007210553540613]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Five Year Work Disqual",
    "datatype": "integer",
    "formula": "IF [Stage3 Response] = "Less than 2 years"
OR [Stage3 Response] = "Between 2 and 4 years"
THEN 1 ELSE 0 END",
    "name": "[Calculation_1133007210553618438]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Out of Work Disqual",
    "datatype": "integer",
    "formula": "IF [Stage2 Response] = "No" THEN 1 ELSE 0 END",
    "name": "[Calculation_1133007210553663495]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "# of Disqual",
    "datatype": "integer",
    "formula": "ZN([Calculation_1133007210553487364]) +
ZN([Calculation_1133007210553663495]) +
ZN([Calculation_1133007210553618438]) +
ZN([Calculation_1133007210553540613]) +
ZN([Calculation_1133007210553425923]) +
ZN([Calculation_1133007210546622464]) +
ZN([Calculation_1133007210553298946])",
    "name": "[Calculation_1133007210553765896]",
    "role": "dimension",
    "type": "ordinal",
  },
  {
    "caption": "Unresolved SSA Leads",
    "datatype": "string",
    "formula": "IF { FIXED [Phone] : MAX([Resolved Lead]) } = 0 THEN "SSA Unresolved Lead"
ELSEIF { FIXED [Phone] : MAX([Resolved Lead]) } = 1 THEN "SSA Resolved Lead"
END",
    "name": "[Calculation_1467962419029331969]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "rowid",
    "datatype": "integer",
    "formula": "INDEX()",
    "name": "[Calculation_2146317124280909824]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Date Str of Post Date",
    "datatype": "string",
    "formula": "//Updated Date: 18 May 2022
//Updated By: Manish
//Description: Extracting the date part of post time

LEFT(str([Calculation_8176144444085592065]),10)",
    "name": "[Calculation_4794996655180886018]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Grade",
    "datatype": "string",
    "formula": "// Grade A
IF [qual_status] = 'all-steps' THEN 'Grade A'

// Grade B
ELSEIF 
    [qual_status] IN ('fiveyrwrk-disqual','outofwrk-disqual','doc-disqual')
    AND [Calculation_1133007210553765896] = 1
THEN 'Grade B'

// Grade C
ELSEIF 
    [qual_status] <> 'age-disqual'
    AND NOT [Stage3 Response] IN ('Less than 2 years', 'Between 2 and 4 years')
    AND [Stage1 Response] <> 'Social Security Disability (SSD) Benefits'
    AND [Stage6 Response] = 'Not working'
THEN 'Grade C'

// Grade D
ELSEIF 
    // 1) Not age-disqual, Stage3 NOT in those two, Stage1 not SSD, Stage6 ≠ Not working, disqual ≤ 1
    (
      [qual_status] <> 'age-disqual'
      AND NOT [Stage3 Response] IN ('Less than 2 years', 'Between 2 and 4 years')
      AND [Stage1 Response] <> 'Social Security Disability (SSD) Benefits'
      AND [Stage6 Response] <> 'Not working'
      AND [Calculation_1133007210553765896] <= 1
    )
    // 2) Not age-disqual, Stage3 in those two, Qual Status = outofwrk-disqual
    OR
    (
      [qual_status] <> 'age-disqual'
      AND [Stage3 Response] IN ('Less than 2 years', 'Between 2 and 4 years')
      AND [qual_status] = 'outofwrk-disqual'
    )
    // 3) Not age-disqual, Stage3 in those two, Qual Status ≠ outofwrk-disqual, Stage7 = Yes
    OR
    (
      [qual_status] <> 'age-disqual'
      AND [Stage3 Response] IN ('Less than 2 years', 'Between 2 and 4 years')
      AND [qual_status] <> 'outofwrk-disqual'
      AND [Stage7 Response] = 'Yes'
    )
THEN 'Grade D'

// Rest (including age-disqual or anything else)
ELSE 'Rest'
END",
    "name": "[Calculation_7573084309404708864]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Day of Post Date (Copy)",
    "datatype": "date",
    "formula": "//Updated Date: 18 May 2022
//Updated By: Manish
//Description: Formula to include date conversion from UTC to PT

DATE(DATEADD("hour",0,[Post Date]))",
    "name": "[Calculation_8176144444085592065]",
    "role": "dimension",
    "type": "ordinal",
  },
  {
    "caption": "Phone (w/o area code)",
    "datatype": "string",
    "formula": "//Updated Date: 18 May 2022
//Updated By: Manish
//Description: Removing the area code from phone numbers

MID([Phone],4)",
    "name": "[Calculation_8176144444085837826]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Dial R",
    "datatype": "string",
    "formula": "IF  [Called Count] < 4 then "<=3" 
elseif [Called Count] < 8 then "4-7"
elseif [Called Count] < 11 then "8-10"
elseif [Called Count] < 16 then "11-15"
elseif [Called Count] < 20 then "16-19"
elseif [Called Count] < 26 then "20-25"
elseif [Called Count] < 31 then "25-30"
elseif [Called Count] < 36 then "30-35"
else "35+" 
END",
    "name": "[Calculation_847802666706034688]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Dial R (detail)",
    "datatype": "string",
    "formula": "STR([Called Count])",
    "name": "[Calculation_847802666706186241]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Helper Date",
    "datatype": "string",
    "formula": ""default"",
    "name": "[Parameter 11]",
    "role": "measure",
    "type": "nominal",
  },
  {
    "caption": "User Identifier",
    "datatype": "integer",
    "formula": "0",
    "name": "[Parameter 12]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Date Bucket",
    "datatype": "string",
    "formula": ""day"",
    "name": "[Parameter 1]",
    "role": "measure",
    "type": "nominal",
  },
  {
    "caption": "Start Date",
    "datatype": "date",
    "formula": "#2025-07-30#",
    "name": "[Parameter 5]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "End Date",
    "datatype": "date",
    "formula": "#2025-08-27#",
    "name": "[Parameter 6]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "TTW Grade",
    "datatype": "string",
    "formula": "IF [ttw_qualstatus] = 'ttw-qualified' then 'Grade A'
ELSEIF  [ttw_qualstatus] = 'ttw-nonqualified' and [TTW Explore Work Form] = 'yes' THEN 'Grade B'
ELSEIF [ttw_qualstatus] = 'ttw-nonqualified' and [TTW Explore Work Form] != 'yes' THEN 'Grade C'
ELSEIF ISNULL([ttw_qualstatus]) and [Stage3 Response] = 'Between 2 and 4 years' then 'Grade D'
ELSE 'Rest'
END",
    "name": "[Calculation_1006061976934187009]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "20hrs Disqual",
    "datatype": "integer",
    "formula": "IF [Stage6 Response] = "More than 20 hours per week" THEN 1 ELSE 0 END",
    "name": "[Calculation_1133007210546622464]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Age Disqual",
    "datatype": "integer",
    "formula": "IF INT([Age]) < 40 OR INT([Age]) > 62 THEN 1 ELSE 0 END",
    "name": "[Calculation_1133007210553298946]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Attorney Disqual",
    "datatype": "integer",
    "formula": "IF [Stage5 Response] = "Yes" THEN 1 ELSE 0 END",
    "name": "[Calculation_1133007210553425923]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Ben Disqual",
    "datatype": "integer",
    "formula": "IF IFNULL([Stage1 Response], "") != "I am not receiving any disability benefits (SSD or SSI)"
THEN 1 ELSE 0 END",
    "name": "[Calculation_1133007210553487364]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Doctor Visit Disqual",
    "datatype": "integer",
    "formula": "IF [Stage4 Response] = "No" THEN 1 ELSE 0 END",
    "name": "[Calculation_1133007210553540613]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Five Year Work Disqual",
    "datatype": "integer",
    "formula": "IF [Stage3 Response] = "Less than 2 years"
OR [Stage3 Response] = "Between 2 and 4 years"
THEN 1 ELSE 0 END",
    "name": "[Calculation_1133007210553618438]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Out of Work Disqual",
    "datatype": "integer",
    "formula": "IF [Stage2 Response] = "No" THEN 1 ELSE 0 END",
    "name": "[Calculation_1133007210553663495]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "# of Disqual",
    "datatype": "integer",
    "formula": "ZN([Calculation_1133007210553487364]) +
ZN([Calculation_1133007210553663495]) +
ZN([Calculation_1133007210553618438]) +
ZN([Calculation_1133007210553540613]) +
ZN([Calculation_1133007210553425923]) +
ZN([Calculation_1133007210546622464]) +
ZN([Calculation_1133007210553298946])",
    "name": "[Calculation_1133007210553765896]",
    "role": "dimension",
    "type": "ordinal",
  },
  {
    "caption": "Unresolved SSA Leads",
    "datatype": "string",
    "formula": "IF { FIXED [Phone] : MAX([Resolved Lead]) } = 0 THEN "SSA Unresolved Lead"
ELSEIF { FIXED [Phone] : MAX([Resolved Lead]) } = 1 THEN "SSA Resolved Lead"
END",
    "name": "[Calculation_1467962419029331969]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Post Date ",
    "datatype": "datetime",
    "formula": "//Updated Date: 18 May 2022
//Updated By: Manish
//Description: Formula to calculate UTC date

DATEADD("hour",0,[Post Date])",
    "name": "[Calculation_1916563181826678784]",
    "role": "dimension",
    "type": "ordinal",
  },
  {
    "caption": "Data Updated On",
    "datatype": "datetime",
    "formula": "{fixed :max([Post Date])}",
    "name": "[Calculation_2010857255412854784]",
    "role": "dimension",
    "type": "ordinal",
  },
  {
    "caption": "Grade",
    "datatype": "string",
    "formula": "// Grade A
IF [qual_status] = 'all-steps' THEN 'Grade A'

// Grade B
ELSEIF 
    [qual_status] IN ('fiveyrwrk-disqual','outofwrk-disqual','doc-disqual')
    AND [Calculation_1133007210553765896] = 1
THEN 'Grade B'

// Grade C
ELSEIF 
    [qual_status] <> 'age-disqual'
    AND NOT [Stage3 Response] IN ('Less than 2 years', 'Between 2 and 4 years')
    AND [Stage1 Response] <> 'Social Security Disability (SSD) Benefits'
    AND [Stage6 Response] = 'Not working'
THEN 'Grade C'

// Grade D
ELSEIF 
    // 1) Not age-disqual, Stage3 NOT in those two, Stage1 not SSD, Stage6 ≠ Not working, disqual ≤ 1
    (
      [qual_status] <> 'age-disqual'
      AND NOT [Stage3 Response] IN ('Less than 2 years', 'Between 2 and 4 years')
      AND [Stage1 Response] <> 'Social Security Disability (SSD) Benefits'
      AND [Stage6 Response] <> 'Not working'
      AND [Calculation_1133007210553765896] <= 1
    )
    // 2) Not age-disqual, Stage3 in those two, Qual Status = outofwrk-disqual
    OR
    (
      [qual_status] <> 'age-disqual'
      AND [Stage3 Response] IN ('Less than 2 years', 'Between 2 and 4 years')
      AND [qual_status] = 'outofwrk-disqual'
    )
    // 3) Not age-disqual, Stage3 in those two, Qual Status ≠ outofwrk-disqual, Stage7 = Yes
    OR
    (
      [qual_status] <> 'age-disqual'
      AND [Stage3 Response] IN ('Less than 2 years', 'Between 2 and 4 years')
      AND [qual_status] <> 'outofwrk-disqual'
      AND [Stage7 Response] = 'Yes'
    )
THEN 'Grade D'

// Rest (including age-disqual or anything else)
ELSE 'Rest'
END",
    "name": "[Calculation_7573084309404708864]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Today-28",
    "datatype": "date",
    "formula": "//Updated Date: 18 May 2022
//Updated By: Manish
//Description: Going back 28 days from today

({MAX(today()-28)})",
    "name": "[Calculation_767300790172184597]",
    "role": "dimension",
    "type": "ordinal",
  },
  {
    "caption": "Time-Source-Subid",
    "datatype": "string",
    "formula": "//Updated Date: 18 May 2022
//Updated By: Manish
//Description: Changing the data type to string of Time-Source-Subid column

STR([Date])+'-'+[Source]+'-'+[Sub Id]",
    "name": "[Calculation_7746824680808361990]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Date Filter",
    "datatype": "boolean",
    "formula": "//Updated Date: 18 May 2022
//Updated By: Manish
//Description: Filtering data based on date

IF [Parameters].[Parameter 11] = 'default'
THEN [Date]>=[Parameters].[Parameter 5] AND [Date]<=[Parameters].[Parameter 6]
ELSEIF [Parameters].[Parameter 11] = 'weekly'
THEN [Date] >= TODAY()-8 AND [Date] <= TODAY()-1
END",
    "name": "[Calculation_843580506575679492]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Dial R",
    "datatype": "string",
    "formula": "IF  [Called Count] < 4 then "<=3" 
elseif [Called Count] < 8 then "4-7"
elseif [Called Count] < 11 then "8-10"
elseif [Called Count] < 16 then "11-15"
elseif [Called Count] < 20 then "16-19"
elseif [Called Count] < 26 then "20-25"
elseif [Called Count] < 31 then "25-30"
elseif [Called Count] < 36 then "30-35"
else "35+" 
END",
    "name": "[Calculation_847802666706034688]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Dial R (detail)",
    "datatype": "string",
    "formula": "STR([Called Count])",
    "name": "[Calculation_847802666706186241]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Max Date",
    "datatype": "date",
    "formula": "//Updated Date: 18 May 2022
//Updated By: Manish
//Description: Calculating max of todays date for including it in the default values of end date

{MAX(today())}",
    "name": "[Calculation_882424053213511680]",
    "role": "dimension",
    "type": "ordinal",
  },
  {
    "caption": "User Identifier",
    "datatype": "string",
    "formula": "IF [Parameters].[Parameter 12] = 0 THEN [User Id]
ELSEIF [Parameters].[Parameter 12] = 1 THEN [Phone]
END",
    "name": "[Calculation_906349454594166784]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Post Date  ",
    "datatype": "string",
    "formula": "//Updated Date: 18 May 2022
//Updated By: Manish
//Description: Calculation to apply date bucket

CASE [Parameters].[Parameter 1]
WHEN 'year' THEN str(datepart('year', [Calculation_1916563181826678784]))
WHEN 'quarter' THEN "Q" + str(datepart('quarter', [Calculation_1916563181826678784])) + " " + str(datepart('year', [Calculation_1916563181826678784]))
WHEN 'month' THEN str(datepart('month', [Calculation_1916563181826678784])) + "-" + str(datepart('year', [Calculation_1916563181826678784]))
WHEN 'day' THEN str(DATENAME('month', [Calculation_1916563181826678784]))+ "-" +str(datepart('day', [Calculation_1916563181826678784]))+ "-" + str(datepart('year', [Calculation_1916563181826678784]))
WHEN 'week' THEN "W" + str(datepart('week', [Calculation_1916563181826678784])) + "-" + str(datepart('year', [Calculation_1916563181826678784]))
WHEN "hour" THEN str(DATETRUNC('hour', [Calculation_1916563181826678784]))
WHEN "minute" THEN str(DATETRUNC('minute', [Calculation_1916563181826678784]))
END",
    "name": "[Calculation_97320012552925214]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "TF present",
    "datatype": "integer",
    "formula": "//Updated Date: 18 May 2022
//Updated By: Manish//Description: Calculating max of todays date for including it in the default values of end date
//Description: Checking if trusted form link is present or not

If len([Trusted Form])>0 then 1
else 0
end",
    "name": "[Calculation_97320012555014180]",
    "role": "dimension",
    "type": "ordinal",
  },
  {
    "caption": "Posted #",
    "datatype": "integer",
    "formula": "//Updated Date: 18 May 2022
//Updated By: Manish
//Description: Calculating the sum of user id wrt to source

countd([Calculation_906349454594166784])",
    "name": "[Calculation_99712551082803223]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Source - Date",
    "datatype": "string",
    "formula": "//Updated Date: 18 May 2022
//Updated By: Manish//Description: Calculating max of todays date for including it in the default values of end date
//Description: Concatinating source and date column

[Source]+":"+[Calculation_97320012552925214]",
    "name": "[Calculation_99712551088799768]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Source-Subid",
    "datatype": "string",
    "formula": "//Updated Date: 18 May 2022
//Updated By: Manish//Description: Calculating max of todays date for including it in the default values of end date
//Description: Concatinating source and subid column

[Source]+" : "+[Sub Id]",
    "name": "[Calculation_99712551105503258]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Helper Date",
    "datatype": "string",
    "formula": ""default"",
    "name": "[Parameter 11]",
    "role": "measure",
    "type": "nominal",
  },
  {
    "caption": "User Identifier",
    "datatype": "integer",
    "formula": "0",
    "name": "[Parameter 12]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Date Bucket",
    "datatype": "string",
    "formula": ""day"",
    "name": "[Parameter 1]",
    "role": "measure",
    "type": "nominal",
  },
  {
    "caption": "Start Date",
    "datatype": "date",
    "formula": "#2025-07-30#",
    "name": "[Parameter 5]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "End Date",
    "datatype": "date",
    "formula": "#2025-08-27#",
    "name": "[Parameter 6]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "TTW Grade",
    "datatype": "string",
    "formula": "IF [ttw_qualstatus] = 'ttw-qualified' then 'Grade A'
ELSEIF  [ttw_qualstatus] = 'ttw-nonqualified' and [TTW Explore Work Form] = 'yes' THEN 'Grade B'
ELSEIF [ttw_qualstatus] = 'ttw-nonqualified' and [TTW Explore Work Form] != 'yes' THEN 'Grade C'
ELSEIF ISNULL([ttw_qualstatus]) and [Stage3 Response] = 'Between 2 and 4 years' then 'Grade D'
ELSE 'Rest'
END",
    "name": "[Calculation_1006061976934187009]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "20hrs Disqual",
    "datatype": "integer",
    "formula": "IF [Stage6 Response] = "More than 20 hours per week" THEN 1 ELSE 0 END",
    "name": "[Calculation_1133007210546622464]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Age Disqual",
    "datatype": "integer",
    "formula": "IF INT([Age]) < 40 OR INT([Age]) > 62 THEN 1 ELSE 0 END",
    "name": "[Calculation_1133007210553298946]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Attorney Disqual",
    "datatype": "integer",
    "formula": "IF [Stage5 Response] = "Yes" THEN 1 ELSE 0 END",
    "name": "[Calculation_1133007210553425923]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Ben Disqual",
    "datatype": "integer",
    "formula": "IF IFNULL([Stage1 Response], "") != "I am not receiving any disability benefits (SSD or SSI)"
THEN 1 ELSE 0 END",
    "name": "[Calculation_1133007210553487364]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Doctor Visit Disqual",
    "datatype": "integer",
    "formula": "IF [Stage4 Response] = "No" THEN 1 ELSE 0 END",
    "name": "[Calculation_1133007210553540613]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Five Year Work Disqual",
    "datatype": "integer",
    "formula": "IF [Stage3 Response] = "Less than 2 years"
OR [Stage3 Response] = "Between 2 and 4 years"
THEN 1 ELSE 0 END",
    "name": "[Calculation_1133007210553618438]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Out of Work Disqual",
    "datatype": "integer",
    "formula": "IF [Stage2 Response] = "No" THEN 1 ELSE 0 END",
    "name": "[Calculation_1133007210553663495]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "# of Disqual",
    "datatype": "integer",
    "formula": "ZN([Calculation_1133007210553487364]) +
ZN([Calculation_1133007210553663495]) +
ZN([Calculation_1133007210553618438]) +
ZN([Calculation_1133007210553540613]) +
ZN([Calculation_1133007210553425923]) +
ZN([Calculation_1133007210546622464]) +
ZN([Calculation_1133007210553298946])",
    "name": "[Calculation_1133007210553765896]",
    "role": "dimension",
    "type": "ordinal",
  },
  {
    "caption": "Unresolved SSA Leads",
    "datatype": "string",
    "formula": "IF { FIXED [Phone] : MAX([Resolved Lead]) } = 0 THEN "SSA Unresolved Lead"
ELSEIF { FIXED [Phone] : MAX([Resolved Lead]) } = 1 THEN "SSA Resolved Lead"
END",
    "name": "[Calculation_1467962419029331969]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Post Date ",
    "datatype": "datetime",
    "formula": "//Updated Date: 18 May 2022
//Updated By: Manish
//Description: Formula to calculate UTC date

DATEADD("hour",0,[Post Date])",
    "name": "[Calculation_1916563181826678784]",
    "role": "dimension",
    "type": "ordinal",
  },
  {
    "caption": "Data Updated On",
    "datatype": "datetime",
    "formula": "{fixed :max([Post Date])}",
    "name": "[Calculation_2010857255412854784]",
    "role": "dimension",
    "type": "ordinal",
  },
  {
    "caption": "Grade",
    "datatype": "string",
    "formula": "// Grade A
IF [qual_status] = 'all-steps' THEN 'Grade A'

// Grade B
ELSEIF 
    [qual_status] IN ('fiveyrwrk-disqual','outofwrk-disqual','doc-disqual')
    AND [Calculation_1133007210553765896] = 1
THEN 'Grade B'

// Grade C
ELSEIF 
    [qual_status] <> 'age-disqual'
    AND NOT [Stage3 Response] IN ('Less than 2 years', 'Between 2 and 4 years')
    AND [Stage1 Response] <> 'Social Security Disability (SSD) Benefits'
    AND [Stage6 Response] = 'Not working'
THEN 'Grade C'

// Grade D
ELSEIF 
    // 1) Not age-disqual, Stage3 NOT in those two, Stage1 not SSD, Stage6 ≠ Not working, disqual ≤ 1
    (
      [qual_status] <> 'age-disqual'
      AND NOT [Stage3 Response] IN ('Less than 2 years', 'Between 2 and 4 years')
      AND [Stage1 Response] <> 'Social Security Disability (SSD) Benefits'
      AND [Stage6 Response] <> 'Not working'
      AND [Calculation_1133007210553765896] <= 1
    )
    // 2) Not age-disqual, Stage3 in those two, Qual Status = outofwrk-disqual
    OR
    (
      [qual_status] <> 'age-disqual'
      AND [Stage3 Response] IN ('Less than 2 years', 'Between 2 and 4 years')
      AND [qual_status] = 'outofwrk-disqual'
    )
    // 3) Not age-disqual, Stage3 in those two, Qual Status ≠ outofwrk-disqual, Stage7 = Yes
    OR
    (
      [qual_status] <> 'age-disqual'
      AND [Stage3 Response] IN ('Less than 2 years', 'Between 2 and 4 years')
      AND [qual_status] <> 'outofwrk-disqual'
      AND [Stage7 Response] = 'Yes'
    )
THEN 'Grade D'

// Rest (including age-disqual or anything else)
ELSE 'Rest'
END",
    "name": "[Calculation_7573084309404708864]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Today-28",
    "datatype": "date",
    "formula": "//Updated Date: 18 May 2022
//Updated By: Manish
//Description: Going back 28 days from today

({MAX(today()-28)})",
    "name": "[Calculation_767300790172184597]",
    "role": "dimension",
    "type": "ordinal",
  },
  {
    "caption": "Time-Source-Subid",
    "datatype": "string",
    "formula": "//Updated Date: 18 May 2022
//Updated By: Manish
//Description: Changing the data type to string of Time-Source-Subid column

STR([Date])+'-'+[Source]+'-'+[Sub Id]",
    "name": "[Calculation_7746824680808361990]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Date Filter",
    "datatype": "boolean",
    "formula": "//Updated Date: 18 May 2022
//Updated By: Manish
//Description: Filtering data based on date

IF [Parameters].[Parameter 11] = 'default'
THEN [Date]>=[Parameters].[Parameter 5] AND [Date]<=[Parameters].[Parameter 6]
ELSEIF [Parameters].[Parameter 11] = 'weekly'
THEN [Date] >= TODAY()-8 AND [Date] <= TODAY()-1
END",
    "name": "[Calculation_843580506575679492]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Dial R",
    "datatype": "string",
    "formula": "IF  [Called Count] < 4 then "<=3" 
elseif [Called Count] < 8 then "4-7"
elseif [Called Count] < 11 then "8-10"
elseif [Called Count] < 16 then "11-15"
elseif [Called Count] < 20 then "16-19"
elseif [Called Count] < 26 then "20-25"
elseif [Called Count] < 31 then "25-30"
elseif [Called Count] < 36 then "30-35"
else "35+" 
END",
    "name": "[Calculation_847802666706034688]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Dial R (detail)",
    "datatype": "string",
    "formula": "STR([Called Count])",
    "name": "[Calculation_847802666706186241]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Max Date",
    "datatype": "date",
    "formula": "//Updated Date: 18 May 2022
//Updated By: Manish
//Description: Calculating max of todays date for including it in the default values of end date

{MAX(today())}",
    "name": "[Calculation_882424053213511680]",
    "role": "dimension",
    "type": "ordinal",
  },
  {
    "caption": "User Identifier",
    "datatype": "string",
    "formula": "IF [Parameters].[Parameter 12] = 0 THEN [User Id]
ELSEIF [Parameters].[Parameter 12] = 1 THEN [Phone]
END",
    "name": "[Calculation_906349454594166784]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Post Date  ",
    "datatype": "string",
    "formula": "//Updated Date: 18 May 2022
//Updated By: Manish
//Description: Calculation to apply date bucket

CASE [Parameters].[Parameter 1]
WHEN 'year' THEN str(datepart('year', [Calculation_1916563181826678784]))
WHEN 'quarter' THEN "Q" + str(datepart('quarter', [Calculation_1916563181826678784])) + " " + str(datepart('year', [Calculation_1916563181826678784]))
WHEN 'month' THEN str(datepart('month', [Calculation_1916563181826678784])) + "-" + str(datepart('year', [Calculation_1916563181826678784]))
WHEN 'day' THEN str(DATENAME('month', [Calculation_1916563181826678784]))+ "-" +str(datepart('day', [Calculation_1916563181826678784]))+ "-" + str(datepart('year', [Calculation_1916563181826678784]))
WHEN 'week' THEN "W" + str(datepart('week', [Calculation_1916563181826678784])) + "-" + str(datepart('year', [Calculation_1916563181826678784]))
WHEN "hour" THEN str(DATETRUNC('hour', [Calculation_1916563181826678784]))
WHEN "minute" THEN str(DATETRUNC('minute', [Calculation_1916563181826678784]))
END",
    "name": "[Calculation_97320012552925214]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "TF URL Valid",
    "datatype": "integer",
    "formula": "//Updated Date: 18 May 2022
//Updated By: Manish
//Description: Checking if the tf link is valid or not

if MID([Trusted Form],1,29)='https://cert.trustedform.com/'
AND len([Trusted Form])>29 then 1
else 0
end",
    "name": "[Calculation_97320012555231269]",
    "role": "dimension",
    "type": "ordinal",
  },
  {
    "caption": "Posted #",
    "datatype": "integer",
    "formula": "//Updated Date: 18 May 2022
//Updated By: Manish
//Description: Calculating the sum of user id wrt to source

countd([Calculation_906349454594166784])",
    "name": "[Calculation_99712551082803223]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Source - Date",
    "datatype": "string",
    "formula": "//Updated Date: 18 May 2022
//Updated By: Manish//Description: Calculating max of todays date for including it in the default values of end date
//Description: Concatinating source and date column

[Source]+":"+[Calculation_97320012552925214]",
    "name": "[Calculation_99712551088799768]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Source-Subid",
    "datatype": "string",
    "formula": "//Updated Date: 18 May 2022
//Updated By: Manish//Description: Calculating max of todays date for including it in the default values of end date
//Description: Concatinating source and subid column

[Source]+" : "+[Sub Id]",
    "name": "[Calculation_99712551105503258]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Helper Date",
    "datatype": "string",
    "formula": ""default"",
    "name": "[Parameter 11]",
    "role": "measure",
    "type": "nominal",
  },
  {
    "caption": "Start Date",
    "datatype": "date",
    "formula": "#2025-07-30#",
    "name": "[Parameter 5]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "End Date",
    "datatype": "date",
    "formula": "#2025-08-27#",
    "name": "[Parameter 6]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "TTW Grade",
    "datatype": "string",
    "formula": "IF [ttw_qualstatus] = 'ttw-qualified' then 'Grade A'
ELSEIF  [ttw_qualstatus] = 'ttw-nonqualified' and [TTW Explore Work Form] = 'yes' THEN 'Grade B'
ELSEIF [ttw_qualstatus] = 'ttw-nonqualified' and [TTW Explore Work Form] != 'yes' THEN 'Grade C'
ELSEIF ISNULL([ttw_qualstatus]) and [Stage3 Response] = 'Between 2 and 4 years' then 'Grade D'
ELSE 'Rest'
END",
    "name": "[Calculation_1006061976934187009]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "20hrs Disqual",
    "datatype": "integer",
    "formula": "IF [Stage6 Response] = "More than 20 hours per week" THEN 1 ELSE 0 END",
    "name": "[Calculation_1133007210546622464]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Age Disqual",
    "datatype": "integer",
    "formula": "IF INT([Age]) < 40 OR INT([Age]) > 62 THEN 1 ELSE 0 END",
    "name": "[Calculation_1133007210553298946]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Attorney Disqual",
    "datatype": "integer",
    "formula": "IF [Stage5 Response] = "Yes" THEN 1 ELSE 0 END",
    "name": "[Calculation_1133007210553425923]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Ben Disqual",
    "datatype": "integer",
    "formula": "IF IFNULL([Stage1 Response], "") != "I am not receiving any disability benefits (SSD or SSI)"
THEN 1 ELSE 0 END",
    "name": "[Calculation_1133007210553487364]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Doctor Visit Disqual",
    "datatype": "integer",
    "formula": "IF [Stage4 Response] = "No" THEN 1 ELSE 0 END",
    "name": "[Calculation_1133007210553540613]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Five Year Work Disqual",
    "datatype": "integer",
    "formula": "IF [Stage3 Response] = "Less than 2 years"
OR [Stage3 Response] = "Between 2 and 4 years"
THEN 1 ELSE 0 END",
    "name": "[Calculation_1133007210553618438]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Out of Work Disqual",
    "datatype": "integer",
    "formula": "IF [Stage2 Response] = "No" THEN 1 ELSE 0 END",
    "name": "[Calculation_1133007210553663495]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "# of Disqual",
    "datatype": "integer",
    "formula": "ZN([Calculation_1133007210553487364]) +
ZN([Calculation_1133007210553663495]) +
ZN([Calculation_1133007210553618438]) +
ZN([Calculation_1133007210553540613]) +
ZN([Calculation_1133007210553425923]) +
ZN([Calculation_1133007210546622464]) +
ZN([Calculation_1133007210553298946])",
    "name": "[Calculation_1133007210553765896]",
    "role": "dimension",
    "type": "ordinal",
  },
  {
    "caption": "Unresolved SSA Leads",
    "datatype": "string",
    "formula": "IF { FIXED [Phone] : MAX([Resolved Lead]) } = 0 THEN "SSA Unresolved Lead"
ELSEIF { FIXED [Phone] : MAX([Resolved Lead]) } = 1 THEN "SSA Resolved Lead"
END",
    "name": "[Calculation_1467962419029331969]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Post Date ",
    "datatype": "datetime",
    "formula": "//Updated Date: 18 May 2022
//Updated By: Manish
//Description: Formula to calculate UTC date

DATEADD("hour",0,[Post Date])",
    "name": "[Calculation_1916563181826678784]",
    "role": "dimension",
    "type": "ordinal",
  },
  {
    "caption": "Data Updated On",
    "datatype": "datetime",
    "formula": "{fixed :max([Post Date])}",
    "name": "[Calculation_2010857255412854784]",
    "role": "dimension",
    "type": "ordinal",
  },
  {
    "caption": "Sl No",
    "datatype": "integer",
    "formula": "Index()",
    "name": "[Calculation_2490912847471489026]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "WEB Filter",
    "datatype": "boolean",
    "formula": "if isnull([User Id (WEB)]) then FALSE else TRUE end",
    "name": "[Calculation_4158652048189837312]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Site Source Filter",
    "datatype": "boolean",
    "formula": "if isnull([Site Source]) OR [Site Source] = "" then FALSE else TRUE end",
    "name": "[Calculation_4158652048200994819]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Grade",
    "datatype": "string",
    "formula": "// Grade A
IF [qual_status] = 'all-steps' THEN 'Grade A'

// Grade B
ELSEIF 
    [qual_status] IN ('fiveyrwrk-disqual','outofwrk-disqual','doc-disqual')
    AND [Calculation_1133007210553765896] = 1
THEN 'Grade B'

// Grade C
ELSEIF 
    [qual_status] <> 'age-disqual'
    AND NOT [Stage3 Response] IN ('Less than 2 years', 'Between 2 and 4 years')
    AND [Stage1 Response] <> 'Social Security Disability (SSD) Benefits'
    AND [Stage6 Response] = 'Not working'
THEN 'Grade C'

// Grade D
ELSEIF 
    // 1) Not age-disqual, Stage3 NOT in those two, Stage1 not SSD, Stage6 ≠ Not working, disqual ≤ 1
    (
      [qual_status] <> 'age-disqual'
      AND NOT [Stage3 Response] IN ('Less than 2 years', 'Between 2 and 4 years')
      AND [Stage1 Response] <> 'Social Security Disability (SSD) Benefits'
      AND [Stage6 Response] <> 'Not working'
      AND [Calculation_1133007210553765896] <= 1
    )
    // 2) Not age-disqual, Stage3 in those two, Qual Status = outofwrk-disqual
    OR
    (
      [qual_status] <> 'age-disqual'
      AND [Stage3 Response] IN ('Less than 2 years', 'Between 2 and 4 years')
      AND [qual_status] = 'outofwrk-disqual'
    )
    // 3) Not age-disqual, Stage3 in those two, Qual Status ≠ outofwrk-disqual, Stage7 = Yes
    OR
    (
      [qual_status] <> 'age-disqual'
      AND [Stage3 Response] IN ('Less than 2 years', 'Between 2 and 4 years')
      AND [qual_status] <> 'outofwrk-disqual'
      AND [Stage7 Response] = 'Yes'
    )
THEN 'Grade D'

// Rest (including age-disqual or anything else)
ELSE 'Rest'
END",
    "name": "[Calculation_7573084309404708864]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Today-28",
    "datatype": "date",
    "formula": "//Updated Date: 18 May 2022
//Updated By: Manish
//Description: Going back 28 days from today

({MAX(today()-28)})",
    "name": "[Calculation_767300790172184597]",
    "role": "dimension",
    "type": "ordinal",
  },
  {
    "caption": "Date Filter",
    "datatype": "boolean",
    "formula": "//Updated Date: 18 May 2022
//Updated By: Manish
//Description: Filtering data based on date

IF [Parameters].[Parameter 11] = 'default'
THEN [Date]>=[Parameters].[Parameter 5] AND [Date]<=[Parameters].[Parameter 6]
ELSEIF [Parameters].[Parameter 11] = 'weekly'
THEN [Date] >= TODAY()-8 AND [Date] <= TODAY()-1
END",
    "name": "[Calculation_843580506575679492]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Dial R",
    "datatype": "string",
    "formula": "IF  [Called Count] < 4 then "<=3" 
elseif [Called Count] < 8 then "4-7"
elseif [Called Count] < 11 then "8-10"
elseif [Called Count] < 16 then "11-15"
elseif [Called Count] < 20 then "16-19"
elseif [Called Count] < 26 then "20-25"
elseif [Called Count] < 31 then "25-30"
elseif [Called Count] < 36 then "30-35"
else "35+" 
END",
    "name": "[Calculation_847802666706034688]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Dial R (detail)",
    "datatype": "string",
    "formula": "STR([Called Count])",
    "name": "[Calculation_847802666706186241]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Max Date",
    "datatype": "date",
    "formula": "//Updated Date: 18 May 2022
//Updated By: Manish
//Description: Calculating max of todays date for including it in the default values of end date

{MAX(today())}",
    "name": "[Calculation_882424053213511680]",
    "role": "dimension",
    "type": "ordinal",
  },
  {
    "caption": "Helper Date",
    "datatype": "string",
    "formula": ""default"",
    "name": "[Parameter 11]",
    "role": "measure",
    "type": "nominal",
  },
  {
    "caption": "User Identifier",
    "datatype": "integer",
    "formula": "0",
    "name": "[Parameter 12]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Date Bucket",
    "datatype": "string",
    "formula": ""day"",
    "name": "[Parameter 1]",
    "role": "measure",
    "type": "nominal",
  },
  {
    "caption": "Start Date",
    "datatype": "date",
    "formula": "#2025-07-30#",
    "name": "[Parameter 5]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "End Date",
    "datatype": "date",
    "formula": "#2025-08-27#",
    "name": "[Parameter 6]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Show Source",
    "datatype": "string",
    "formula": ""1"",
    "name": "[Phone (copy)_1255659924007981058]",
    "role": "measure",
    "type": "nominal",
  },
  {
    "caption": "Show Site Source",
    "datatype": "string",
    "formula": ""0"",
    "name": "[Show Source (copy)_3999970530356424704]",
    "role": "measure",
    "type": "nominal",
  },
  {
    "caption": "TTW Grade",
    "datatype": "string",
    "formula": "IF [ttw_qualstatus] = 'ttw-qualified' then 'Grade A'
ELSEIF  [ttw_qualstatus] = 'ttw-nonqualified' and [TTW Explore Work Form] = 'yes' THEN 'Grade B'
ELSEIF [ttw_qualstatus] = 'ttw-nonqualified' and [TTW Explore Work Form] != 'yes' THEN 'Grade C'
ELSEIF ISNULL([ttw_qualstatus]) and [Stage3 Response] = 'Between 2 and 4 years' then 'Grade D'
ELSE 'Rest'
END",
    "name": "[Calculation_1006061976934187009]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "20hrs Disqual",
    "datatype": "integer",
    "formula": "IF [Stage6 Response] = "More than 20 hours per week" THEN 1 ELSE 0 END",
    "name": "[Calculation_1133007210546622464]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Age Disqual",
    "datatype": "integer",
    "formula": "IF INT([Age]) < 40 OR INT([Age]) > 62 THEN 1 ELSE 0 END",
    "name": "[Calculation_1133007210553298946]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Attorney Disqual",
    "datatype": "integer",
    "formula": "IF [Stage5 Response] = "Yes" THEN 1 ELSE 0 END",
    "name": "[Calculation_1133007210553425923]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Ben Disqual",
    "datatype": "integer",
    "formula": "IF IFNULL([Stage1 Response], "") != "I am not receiving any disability benefits (SSD or SSI)"
THEN 1 ELSE 0 END",
    "name": "[Calculation_1133007210553487364]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Doctor Visit Disqual",
    "datatype": "integer",
    "formula": "IF [Stage4 Response] = "No" THEN 1 ELSE 0 END",
    "name": "[Calculation_1133007210553540613]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Five Year Work Disqual",
    "datatype": "integer",
    "formula": "IF [Stage3 Response] = "Less than 2 years"
OR [Stage3 Response] = "Between 2 and 4 years"
THEN 1 ELSE 0 END",
    "name": "[Calculation_1133007210553618438]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Out of Work Disqual",
    "datatype": "integer",
    "formula": "IF [Stage2 Response] = "No" THEN 1 ELSE 0 END",
    "name": "[Calculation_1133007210553663495]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "# of Disqual",
    "datatype": "integer",
    "formula": "ZN([Calculation_1133007210553487364]) +
ZN([Calculation_1133007210553663495]) +
ZN([Calculation_1133007210553618438]) +
ZN([Calculation_1133007210553540613]) +
ZN([Calculation_1133007210553425923]) +
ZN([Calculation_1133007210546622464]) +
ZN([Calculation_1133007210553298946])",
    "name": "[Calculation_1133007210553765896]",
    "role": "dimension",
    "type": "ordinal",
  },
  {
    "caption": "Unresolved SSA Leads",
    "datatype": "string",
    "formula": "IF { FIXED [Phone] : MAX([Resolved Lead]) } = 0 THEN "SSA Unresolved Lead"
ELSEIF { FIXED [Phone] : MAX([Resolved Lead]) } = 1 THEN "SSA Resolved Lead"
END",
    "name": "[Calculation_1467962419029331969]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Post Date ",
    "datatype": "datetime",
    "formula": "//Updated Date: 18 May 2022
//Updated By: Manish
//Description: Formula to calculate UTC date

DATEADD("hour",0,[Post Date])",
    "name": "[Calculation_1916563181826678784]",
    "role": "dimension",
    "type": "ordinal",
  },
  {
    "caption": "Data Updated On",
    "datatype": "datetime",
    "formula": "{fixed :max([Post Date])}",
    "name": "[Calculation_2010857255412854784]",
    "role": "dimension",
    "type": "ordinal",
  },
  {
    "caption": "Site Source ",
    "datatype": "string",
    "formula": "If [Parameters].[Show Source (copy)_3999970530356424704] = "1" then [Site Source]
else "Agg" end",
    "name": "[Calculation_3999970530356551681]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "WEB Filter",
    "datatype": "boolean",
    "formula": "if isnull([User Id (WEB)]) then FALSE else TRUE end",
    "name": "[Calculation_4158652048189837312]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "APRET (WEB)",
    "datatype": "integer",
    "formula": "if isnull([ Status (AGT)]) then 0 else 1 end",
    "name": "[Calculation_4158652048191238145]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Conv % ",
    "datatype": "real",
    "formula": "sum([Calculation_4158652048191238145])/[Calculation_99712551082803223]",
    "name": "[Calculation_4158652048191483906]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Site Source Filter",
    "datatype": "boolean",
    "formula": "if isnull([Site Source]) OR [Site Source] = "" then FALSE else TRUE end",
    "name": "[Calculation_4158652048200994819]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Grade",
    "datatype": "string",
    "formula": "// Grade A
IF [qual_status] = 'all-steps' THEN 'Grade A'

// Grade B
ELSEIF 
    [qual_status] IN ('fiveyrwrk-disqual','outofwrk-disqual','doc-disqual')
    AND [Calculation_1133007210553765896] = 1
THEN 'Grade B'

// Grade C
ELSEIF 
    [qual_status] <> 'age-disqual'
    AND NOT [Stage3 Response] IN ('Less than 2 years', 'Between 2 and 4 years')
    AND [Stage1 Response] <> 'Social Security Disability (SSD) Benefits'
    AND [Stage6 Response] = 'Not working'
THEN 'Grade C'

// Grade D
ELSEIF 
    // 1) Not age-disqual, Stage3 NOT in those two, Stage1 not SSD, Stage6 ≠ Not working, disqual ≤ 1
    (
      [qual_status] <> 'age-disqual'
      AND NOT [Stage3 Response] IN ('Less than 2 years', 'Between 2 and 4 years')
      AND [Stage1 Response] <> 'Social Security Disability (SSD) Benefits'
      AND [Stage6 Response] <> 'Not working'
      AND [Calculation_1133007210553765896] <= 1
    )
    // 2) Not age-disqual, Stage3 in those two, Qual Status = outofwrk-disqual
    OR
    (
      [qual_status] <> 'age-disqual'
      AND [Stage3 Response] IN ('Less than 2 years', 'Between 2 and 4 years')
      AND [qual_status] = 'outofwrk-disqual'
    )
    // 3) Not age-disqual, Stage3 in those two, Qual Status ≠ outofwrk-disqual, Stage7 = Yes
    OR
    (
      [qual_status] <> 'age-disqual'
      AND [Stage3 Response] IN ('Less than 2 years', 'Between 2 and 4 years')
      AND [qual_status] <> 'outofwrk-disqual'
      AND [Stage7 Response] = 'Yes'
    )
THEN 'Grade D'

// Rest (including age-disqual or anything else)
ELSE 'Rest'
END",
    "name": "[Calculation_7573084309404708864]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Today-28",
    "datatype": "date",
    "formula": "//Updated Date: 18 May 2022
//Updated By: Manish
//Description: Going back 28 days from today

({MAX(today()-28)})",
    "name": "[Calculation_767300790172184597]",
    "role": "dimension",
    "type": "ordinal",
  },
  {
    "caption": "Date Filter",
    "datatype": "boolean",
    "formula": "//Updated Date: 18 May 2022
//Updated By: Manish
//Description: Filtering data based on date

IF [Parameters].[Parameter 11] = 'default'
THEN [Date]>=[Parameters].[Parameter 5] AND [Date]<=[Parameters].[Parameter 6]
ELSEIF [Parameters].[Parameter 11] = 'weekly'
THEN [Date] >= TODAY()-8 AND [Date] <= TODAY()-1
END",
    "name": "[Calculation_843580506575679492]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Dial R",
    "datatype": "string",
    "formula": "IF  [Called Count] < 4 then "<=3" 
elseif [Called Count] < 8 then "4-7"
elseif [Called Count] < 11 then "8-10"
elseif [Called Count] < 16 then "11-15"
elseif [Called Count] < 20 then "16-19"
elseif [Called Count] < 26 then "20-25"
elseif [Called Count] < 31 then "25-30"
elseif [Called Count] < 36 then "30-35"
else "35+" 
END",
    "name": "[Calculation_847802666706034688]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Dial R (detail)",
    "datatype": "string",
    "formula": "STR([Called Count])",
    "name": "[Calculation_847802666706186241]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Max Date",
    "datatype": "date",
    "formula": "//Updated Date: 18 May 2022
//Updated By: Manish
//Description: Calculating max of todays date for including it in the default values of end date

{MAX(today())}",
    "name": "[Calculation_882424053213511680]",
    "role": "dimension",
    "type": "ordinal",
  },
  {
    "caption": "User Identifier",
    "datatype": "string",
    "formula": "IF [Parameters].[Parameter 12] = 0 THEN [User Id]
ELSEIF [Parameters].[Parameter 12] = 1 THEN [Phone]
END",
    "name": "[Calculation_906349454594166784]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Post Date  ",
    "datatype": "string",
    "formula": "//Updated Date: 18 May 2022
//Updated By: Manish
//Description: Calculation to apply date bucket

CASE [Parameters].[Parameter 1]
WHEN 'year' THEN str(datepart('year', [Calculation_1916563181826678784]))
WHEN 'quarter' THEN "Q" + str(datepart('quarter', [Calculation_1916563181826678784])) + " " + str(datepart('year', [Calculation_1916563181826678784]))
WHEN 'month' THEN str(datepart('month', [Calculation_1916563181826678784])) + "-" + str(datepart('year', [Calculation_1916563181826678784]))
WHEN 'day' THEN str(DATENAME('month', [Calculation_1916563181826678784]))+ "-" +str(datepart('day', [Calculation_1916563181826678784]))+ "-" + str(datepart('year', [Calculation_1916563181826678784]))
WHEN 'week' THEN "W" + str(datepart('week', [Calculation_1916563181826678784])) + "-" + str(datepart('year', [Calculation_1916563181826678784]))
WHEN "hour" THEN str(DATETRUNC('hour', [Calculation_1916563181826678784]))
WHEN "minute" THEN str(DATETRUNC('minute', [Calculation_1916563181826678784]))
END",
    "name": "[Calculation_97320012552925214]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Posted #",
    "datatype": "integer",
    "formula": "//Updated Date: 18 May 2022
//Updated By: Manish
//Description: Calculating the sum of user id wrt to source

countd([Calculation_906349454594166784])",
    "name": "[Calculation_99712551082803223]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Source ",
    "datatype": "string",
    "formula": "CASE [Parameters].[Phone (copy)_1255659924007981058]
WHEN "0" THEN "Agg"
WHEN "1" THEN [Source]
END",
    "name": "[Phone (copy)_1255659924007964673]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Date Bucket",
    "datatype": "string",
    "formula": ""day"",
    "name": "[Parameter 1]",
    "role": "measure",
    "type": "nominal",
  },
  {
    "caption": "Start Date",
    "datatype": "date",
    "formula": "#2025-07-30#",
    "name": "[Parameter 5]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "End Date",
    "datatype": "date",
    "formula": "#2025-08-27#",
    "name": "[Parameter 6]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Show Source",
    "datatype": "string",
    "formula": ""1"",
    "name": "[Phone (copy)_1255659924007981058]",
    "role": "measure",
    "type": "nominal",
  },
  {
    "caption": "Hour of Day",
    "datatype": "string",
    "formula": "IF LEN(STR(DATEPART('hour', [Calculation_1916563181826678784]))) = 1
THEN "0" + STR(DATEPART('hour', [Calculation_1916563181826678784]))
ELSE STR(DATEPART('hour', [Calculation_1916563181826678784]))
END",
    "name": "[Calculation_1113233589182521344]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Unresolved SSA Leads",
    "datatype": "string",
    "formula": "IF { FIXED [Phone] : MAX([Resolved Lead]) } = 0 THEN "SSA Unresolved Lead"
ELSEIF { FIXED [Phone] : MAX([Resolved Lead]) } = 1 THEN "SSA Resolved Lead"
END",
    "name": "[Calculation_1467962419029331969]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Leads Age",
    "datatype": "integer",
    "formula": "If (DATEDIFF('day',[Calculation_767300790176440343],TODAY()))>=0 Then 
(DATEDIFF('day',[Calculation_767300790176440343],TODAY()))
ELSE 0
END",
    "name": "[Calculation_1621014427239342104]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "CZ Post Hour Group",
    "datatype": "string",
    "formula": "IF DATEPART('hour', [Post Date]) >= 0 AND DATEPART('hour', [Post Date]) < 6 THEN 'Pre CC Hours'
ELSEIF DATEPART('hour', [Post Date]) >= 6 AND DATEPART('hour', [Post Date]) < 16 THEN 'CC Hours'
ELSEIF DATEPART('hour', [Post Date]) >= 16 AND DATEPART('hour', [Post Date]) < 24 THEN 'Post CC Hours'
END",
    "name": "[Calculation_1880252886125215747]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Dial R",
    "datatype": "string",
    "formula": "IF  [Called Count] < 4 then "<=3" 
elseif [Called Count] < 8 then "4-7"
elseif [Called Count] < 11 then "8-10"
elseif [Called Count] < 16 then "11-15"
elseif [Called Count] < 20 then "16-19"
elseif [Called Count] < 26 then "20-25"
elseif [Called Count] < 31 then "25-30"
elseif [Called Count] < 36 then "30-35"
else "35+" 
END",
    "name": "[Calculation_847802666706034688]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Dial R (detail)",
    "datatype": "string",
    "formula": "STR([Called Count])",
    "name": "[Calculation_847802666706186241]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "D1",
    "datatype": "integer",
    "formula": "0",
    "name": "[Parameter 10]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Date Bucket",
    "datatype": "string",
    "formula": ""day"",
    "name": "[Parameter 1]",
    "role": "measure",
    "type": "nominal",
  },
  {
    "caption": "Start Date",
    "datatype": "date",
    "formula": "#2025-07-30#",
    "name": "[Parameter 5]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "End Date",
    "datatype": "date",
    "formula": "#2025-08-27#",
    "name": "[Parameter 6]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Hour of Day",
    "datatype": "string",
    "formula": "IF LEN(STR(DATEPART('hour', [Calculation_1916563181826678784]))) = 1
THEN "0" + STR(DATEPART('hour', [Calculation_1916563181826678784]))
ELSE STR(DATEPART('hour', [Calculation_1916563181826678784]))
END",
    "name": "[Calculation_1113233589182521344]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "CZ Post Hour Group",
    "datatype": "string",
    "formula": "IF DATEPART('hour', [Post Date]) >= 0 AND DATEPART('hour', [Post Date]) < 6 THEN 'Pre CC Hours'
ELSEIF DATEPART('hour', [Post Date]) >= 6 AND DATEPART('hour', [Post Date]) < 16 THEN 'CC Hours'
ELSEIF DATEPART('hour', [Post Date]) >= 16 AND DATEPART('hour', [Post Date]) < 24 THEN 'Post CC Hours'
END",
    "name": "[Calculation_1880252886125215747]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "BLA Status",
    "datatype": "string",
    "formula": "IF [bla_blacklisted] = 'true' THEN 'Blacklisted'
ELSEIF [bla_blacklisted] = 'false' THEN 'Passed'
ELSE NULL
END",
    "name": "[Calculation_6374000853565702144]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Date Bucket",
    "datatype": "string",
    "formula": ""day"",
    "name": "[Parameter 1]",
    "role": "measure",
    "type": "nominal",
  },
  {
    "caption": "Start Date",
    "datatype": "date",
    "formula": "#2025-07-30#",
    "name": "[Parameter 5]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "End Date",
    "datatype": "date",
    "formula": "#2025-08-27#",
    "name": "[Parameter 6]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Start Date",
    "datatype": "date",
    "formula": "#2025-07-30#",
    "name": "[Parameter 5]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "End Date",
    "datatype": "date",
    "formula": "#2025-08-27#",
    "name": "[Parameter 6]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Hour of Day",
    "datatype": "string",
    "formula": "IF LEN(STR(DATEPART('hour', [Calculation_1916563181826678784]))) = 1
THEN "0" + STR(DATEPART('hour', [Calculation_1916563181826678784]))
ELSE STR(DATEPART('hour', [Calculation_1916563181826678784]))
END",
    "name": "[Calculation_1113233589182521344]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "CZ Post Hour Group",
    "datatype": "string",
    "formula": "IF DATEPART('hour', [Post Date]) >= 0 AND DATEPART('hour', [Post Date]) < 6 THEN 'Pre CC Hours'
ELSEIF DATEPART('hour', [Post Date]) >= 6 AND DATEPART('hour', [Post Date]) < 16 THEN 'CC Hours'
ELSEIF DATEPART('hour', [Post Date]) >= 16 AND DATEPART('hour', [Post Date]) < 24 THEN 'Post CC Hours'
END",
    "name": "[Calculation_1880252886125215747]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Status For Context Filter",
    "datatype": "string",
    "formula": "[Status]",
    "name": "[Status (copy)_1621014427209760791]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Date 1",
    "datatype": "string",
    "formula": ""quarter"",
    "name": "[Parameter 1 1]",
    "role": "measure",
    "type": "nominal",
  },
  {
    "caption": "Start Date",
    "datatype": "date",
    "formula": "#2025-07-30#",
    "name": "[Parameter 5]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "End Date",
    "datatype": "date",
    "formula": "#2025-08-27#",
    "name": "[Parameter 6]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Show Source",
    "datatype": "string",
    "formula": ""1"",
    "name": "[Phone (copy)_1255659924007981058]",
    "role": "measure",
    "type": "nominal",
  },
  {
    "caption": "Start Date",
    "datatype": "date",
    "formula": "#2025-07-30#",
    "name": "[Parameter 5]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "End Date",
    "datatype": "date",
    "formula": "#2025-08-27#",
    "name": "[Parameter 6]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "D2",
    "datatype": "integer",
    "formula": "0",
    "name": "[D1 (copy 2)_1113233589196361731]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "D3",
    "datatype": "integer",
    "formula": "0",
    "name": "[D1 (copy 3)_1113233589196374020]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "D5",
    "datatype": "integer",
    "formula": "0",
    "name": "[D1 (copy) (copy)_1113233589196361730]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "D4",
    "datatype": "integer",
    "formula": "0",
    "name": "[D1 (copy)_1113233589196333057]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "D1",
    "datatype": "integer",
    "formula": "0",
    "name": "[Parameter 10]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Date Bucket",
    "datatype": "string",
    "formula": ""day"",
    "name": "[Parameter 1]",
    "role": "measure",
    "type": "nominal",
  },
  {
    "caption": "5% Cutoff",
    "datatype": "real",
    "formula": "0.2",
    "name": "[Parameter 3]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Min Threshold",
    "datatype": "integer",
    "formula": "2",
    "name": "[Parameter 4]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Start Date",
    "datatype": "date",
    "formula": "#2025-07-30#",
    "name": "[Parameter 5]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "End Date",
    "datatype": "date",
    "formula": "#2025-08-27#",
    "name": "[Parameter 6]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Hour of Day",
    "datatype": "string",
    "formula": "IF LEN(STR(DATEPART('hour', [Calculation_1916563181826678784]))) = 1
THEN "0" + STR(DATEPART('hour', [Calculation_1916563181826678784]))
ELSE STR(DATEPART('hour', [Calculation_1916563181826678784]))
END",
    "name": "[Calculation_1113233589182521344]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Month - Year",
    "datatype": "string",
    "formula": "DATENAME('month',[Post Date])+' '+ STR(YEAR([Post Date]))",
    "name": "[Calculation_1232578966341357571]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "CZ Post Hour Group",
    "datatype": "string",
    "formula": "IF DATEPART('hour', [Post Date]) >= 0 AND DATEPART('hour', [Post Date]) < 6 THEN 'Pre CC Hours'
ELSEIF DATEPART('hour', [Post Date]) >= 6 AND DATEPART('hour', [Post Date]) < 16 THEN 'CC Hours'
ELSEIF DATEPART('hour', [Post Date]) >= 16 AND DATEPART('hour', [Post Date]) < 24 THEN 'Post CC Hours'
END",
    "name": "[Calculation_1880252886125215747]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Grade",
    "datatype": "string",
    "formula": "// Grade A
IF [qual_status] = 'all-steps' THEN 'Grade A'

// Grade B
ELSEIF 
    [qual_status] IN ('fiveyrwrk-disqual','outofwrk-disqual','doc-disqual')
    AND [Calculation_1133007210553765896] = 1
THEN 'Grade B'

// Grade C
ELSEIF 
    [qual_status] <> 'age-disqual'
    AND NOT [Stage3 Response] IN ('Less than 2 years', 'Between 2 and 4 years')
    AND [Stage1 Response] <> 'Social Security Disability (SSD) Benefits'
    AND [Stage6 Response] = 'Not working'
THEN 'Grade C'

// Grade D
ELSEIF 
    // 1) Not age-disqual, Stage3 NOT in those two, Stage1 not SSD, Stage6 ≠ Not working, disqual ≤ 1
    (
      [qual_status] <> 'age-disqual'
      AND NOT [Stage3 Response] IN ('Less than 2 years', 'Between 2 and 4 years')
      AND [Stage1 Response] <> 'Social Security Disability (SSD) Benefits'
      AND [Stage6 Response] <> 'Not working'
      AND [Calculation_1133007210553765896] <= 1
    )
    // 2) Not age-disqual, Stage3 in those two, Qual Status = outofwrk-disqual
    OR
    (
      [qual_status] <> 'age-disqual'
      AND [Stage3 Response] IN ('Less than 2 years', 'Between 2 and 4 years')
      AND [qual_status] = 'outofwrk-disqual'
    )
    // 3) Not age-disqual, Stage3 in those two, Qual Status ≠ outofwrk-disqual, Stage7 = Yes
    OR
    (
      [qual_status] <> 'age-disqual'
      AND [Stage3 Response] IN ('Less than 2 years', 'Between 2 and 4 years')
      AND [qual_status] <> 'outofwrk-disqual'
      AND [Stage7 Response] = 'Yes'
    )
THEN 'Grade D'

// Rest (including age-disqual or anything else)
ELSE 'Rest'
END",
    "name": "[Calculation_7573084309404708864]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Alt. Branding",
    "datatype": "string",
    "formula": "If int(Right([Phone],2))<30 and [Calculation_5872834692856524810]= 'Live' then 'Yes' else 'No' End",
    "name": "[Calculation_935059914517495808]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Age Exclusions",
    "datatype": "string",
    "formula": "[Age Range]",
    "name": "[age range (copy)_99712551094624281]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "End Date Comp",
    "datatype": "date",
    "formula": "#2025-08-20#",
    "name": "[End Date (copy)_1152077103892365314]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Start Date",
    "datatype": "date",
    "formula": "#2025-07-30#",
    "name": "[Parameter 5]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "End Date",
    "datatype": "date",
    "formula": "#2025-08-27#",
    "name": "[Parameter 6]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Lead vs Spend",
    "datatype": "string",
    "formula": ""1"",
    "name": "[Parameter 8]",
    "role": "measure",
    "type": "nominal",
  },
  {
    "caption": "Start Date Comp",
    "datatype": "date",
    "formula": "#2025-08-20#",
    "name": "[Start Date (copy)_1152077103891697665]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Start Date",
    "datatype": "date",
    "formula": "#2025-07-30#",
    "name": "[Parameter 5]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "End Date",
    "datatype": "date",
    "formula": "#2025-08-27#",
    "name": "[Parameter 6]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Date Selected",
    "datatype": "string",
    "formula": ""Post Date"",
    "name": "[Parameter 9]",
    "role": "measure",
    "type": "nominal",
  },
  {
    "caption": "Show Source",
    "datatype": "string",
    "formula": ""1"",
    "name": "[Phone (copy)_1255659924007981058]",
    "role": "measure",
    "type": "nominal",
  },
  {
    "caption": "Hour of Day",
    "datatype": "string",
    "formula": "IF LEN(STR(DATEPART('hour', [Calculation_1916563181826678784]))) = 1
THEN "0" + STR(DATEPART('hour', [Calculation_1916563181826678784]))
ELSE STR(DATEPART('hour', [Calculation_1916563181826678784]))
END",
    "name": "[Calculation_1113233589182521344]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "CZ Post Hour Group",
    "datatype": "string",
    "formula": "IF DATEPART('hour', [Post Date]) >= 0 AND DATEPART('hour', [Post Date]) < 6 THEN 'Pre CC Hours'
ELSEIF DATEPART('hour', [Post Date]) >= 6 AND DATEPART('hour', [Post Date]) < 16 THEN 'CC Hours'
ELSEIF DATEPART('hour', [Post Date]) >= 16 AND DATEPART('hour', [Post Date]) < 24 THEN 'Post CC Hours'
END",
    "name": "[Calculation_1880252886125215747]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Start Date",
    "datatype": "date",
    "formula": "#2025-07-30#",
    "name": "[Parameter 5]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "End Date",
    "datatype": "date",
    "formula": "#2025-08-27#",
    "name": "[Parameter 6]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Hour of Day",
    "datatype": "string",
    "formula": "IF LEN(STR(DATEPART('hour', [Calculation_1916563181826678784]))) = 1
THEN "0" + STR(DATEPART('hour', [Calculation_1916563181826678784]))
ELSE STR(DATEPART('hour', [Calculation_1916563181826678784]))
END",
    "name": "[Calculation_1113233589182521344]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "CZ Post Hour Group",
    "datatype": "string",
    "formula": "IF DATEPART('hour', [Post Date]) >= 0 AND DATEPART('hour', [Post Date]) < 6 THEN 'Pre CC Hours'
ELSEIF DATEPART('hour', [Post Date]) >= 6 AND DATEPART('hour', [Post Date]) < 16 THEN 'CC Hours'
ELSEIF DATEPART('hour', [Post Date]) >= 16 AND DATEPART('hour', [Post Date]) < 24 THEN 'Post CC Hours'
END",
    "name": "[Calculation_1880252886125215747]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Missing Fields",
    "datatype": "string",
    "formula": ""All"",
    "name": "[Parameter 7]",
    "role": "measure",
    "type": "nominal",
  },
  {
    "caption": "Start Date",
    "datatype": "date",
    "formula": "#2025-07-30#",
    "name": "[Parameter 5]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "End Date",
    "datatype": "date",
    "formula": "#2025-08-27#",
    "name": "[Parameter 6]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Posted Wk2",
    "datatype": "integer",
    "formula": "({include [Sub Id]: countD(if [Date]< dateadd('day',-7,datetrunc('week',today(),'sunday')) then [User Id] end)})",
    "name": "[Last Week Leads (copy)_535928404290809858]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Start Date",
    "datatype": "date",
    "formula": "#2025-07-30#",
    "name": "[Parameter 5]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "End Date",
    "datatype": "date",
    "formula": "#2025-08-27#",
    "name": "[Parameter 6]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Date Bucket",
    "datatype": "string",
    "formula": ""day"",
    "name": "[Parameter 1]",
    "role": "measure",
    "type": "nominal",
  },
  {
    "caption": "Start Date",
    "datatype": "date",
    "formula": "#2025-07-30#",
    "name": "[Parameter 5]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "End Date",
    "datatype": "date",
    "formula": "#2025-08-27#",
    "name": "[Parameter 6]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Subid",
    "datatype": "string",
    "formula": ""0"",
    "name": "[Phone (copy)_1255659924008312836]",
    "role": "measure",
    "type": "nominal",
  },
  {
    "caption": "Hour of Day",
    "datatype": "string",
    "formula": "IF LEN(STR(DATEPART('hour', [Calculation_1916563181826678784]))) = 1
THEN "0" + STR(DATEPART('hour', [Calculation_1916563181826678784]))
ELSE STR(DATEPART('hour', [Calculation_1916563181826678784]))
END",
    "name": "[Calculation_1113233589182521344]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "CZ Post Hour Group",
    "datatype": "string",
    "formula": "IF DATEPART('hour', [Post Date]) >= 0 AND DATEPART('hour', [Post Date]) < 6 THEN 'Pre CC Hours'
ELSEIF DATEPART('hour', [Post Date]) >= 6 AND DATEPART('hour', [Post Date]) < 16 THEN 'CC Hours'
ELSEIF DATEPART('hour', [Post Date]) >= 16 AND DATEPART('hour', [Post Date]) < 24 THEN 'Post CC Hours'
END",
    "name": "[Calculation_1880252886125215747]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Project Type",
    "datatype": "string",
    "formula": "IF CONTAINS([CZ Project Name],'Aged') THEN 'Aged'
ELSE 'Live' END",
    "name": "[Calculation_5872834692856524810]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Alt. Branding",
    "datatype": "string",
    "formula": "If int(Right([Phone],2))<30 and [Calculation_5872834692856524810]= 'Live' then 'Yes' else 'No' End",
    "name": "[Calculation_935059914517495808]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "D2",
    "datatype": "integer",
    "formula": "0",
    "name": "[D1 (copy 2)_1113233589196361731]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "D3",
    "datatype": "integer",
    "formula": "0",
    "name": "[D1 (copy 3)_1113233589196374020]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "D5",
    "datatype": "integer",
    "formula": "0",
    "name": "[D1 (copy) (copy)_1113233589196361730]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "D4",
    "datatype": "integer",
    "formula": "0",
    "name": "[D1 (copy)_1113233589196333057]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "D1",
    "datatype": "integer",
    "formula": "0",
    "name": "[Parameter 10]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "User Identifier",
    "datatype": "integer",
    "formula": "0",
    "name": "[Parameter 12]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Date Bucket",
    "datatype": "string",
    "formula": ""day"",
    "name": "[Parameter 1]",
    "role": "measure",
    "type": "nominal",
  },
  {
    "caption": "Start Date",
    "datatype": "date",
    "formula": "#2025-07-30#",
    "name": "[Parameter 5]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "End Date",
    "datatype": "date",
    "formula": "#2025-08-27#",
    "name": "[Parameter 6]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "TTW Grade",
    "datatype": "string",
    "formula": "IF [ttw_qualstatus] = 'ttw-qualified' then 'Grade A'
ELSEIF  [ttw_qualstatus] = 'ttw-nonqualified' and [TTW Explore Work Form] = 'yes' THEN 'Grade B'
ELSEIF [ttw_qualstatus] = 'ttw-nonqualified' and [TTW Explore Work Form] != 'yes' THEN 'Grade C'
ELSEIF ISNULL([ttw_qualstatus]) and [Stage3 Response] = 'Between 2 and 4 years' then 'Grade D'
ELSE 'Rest'
END",
    "name": "[Calculation_1006061976934187009]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Hour of Day",
    "datatype": "string",
    "formula": "IF LEN(STR(DATEPART('hour', [Calculation_1916563181826678784]))) = 1
THEN "0" + STR(DATEPART('hour', [Calculation_1916563181826678784]))
ELSE STR(DATEPART('hour', [Calculation_1916563181826678784]))
END",
    "name": "[Calculation_1113233589182521344]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "# of Disqual",
    "datatype": "integer",
    "formula": "ZN([Calculation_1133007210553487364]) +
ZN([Calculation_1133007210553663495]) +
ZN([Calculation_1133007210553618438]) +
ZN([Calculation_1133007210553540613]) +
ZN([Calculation_1133007210553425923]) +
ZN([Calculation_1133007210546622464]) +
ZN([Calculation_1133007210553298946])",
    "name": "[Calculation_1133007210553765896]",
    "role": "dimension",
    "type": "ordinal",
  },
  {
    "caption": "Levine States ",
    "datatype": "string",
    "formula": "IF ISNULL([Levine States]) THEN 'Other'
ELSE [Levine States] END",
    "name": "[Calculation_1277614987429064704]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "DP Leak",
    "datatype": "string",
    "formula": "IF CONTAINS([clientname], 'disabilitypath')
AND [Calculation_7573084309404708864] in ('Grade A', 'Grade B')
THEN 'Yes'
ELSE 'No'
END",
    "name": "[Calculation_1460573688699854848]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "CTC Lead Flag",
    "datatype": "string",
    "formula": "if [CTC Lead] = 1 then "Yes" else "No" END",
    "name": "[Calculation_1880252886088871936]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "CZ Post Hour Group",
    "datatype": "string",
    "formula": "IF DATEPART('hour', [Post Date]) >= 0 AND DATEPART('hour', [Post Date]) < 6 THEN 'Pre CC Hours'
ELSEIF DATEPART('hour', [Post Date]) >= 6 AND DATEPART('hour', [Post Date]) < 16 THEN 'CC Hours'
ELSEIF DATEPART('hour', [Post Date]) >= 16 AND DATEPART('hour', [Post Date]) < 24 THEN 'Post CC Hours'
END",
    "name": "[Calculation_1880252886125215747]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Lead Sell Type",
    "datatype": "string",
    "formula": "if contains([Transfer Info Label],'CXER') then 'Sold: Call' 
elseif 
contains([sgmt],'ql-leadbuy') or 
contains([ATA Work],'ql-leadbuy')
then 'Sold: Lead'
else 'Internal'
end",
    "name": "[Calculation_3435894714053935109]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Seg4 Cohort",
    "datatype": "string",
    "formula": "LOWER(IFNULL([seg4_cohort], [Calculation_4531465651676315649]))",
    "name": "[Calculation_4531465651676438530]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Time to Call Bucket",
    "datatype": "string",
    "formula": "IF  [Calculation_499055157752631296] < 0
THEN '<0 Mins'
ELSEIF [Calculation_499055157752631296] <= 2 AND [Calculation_499055157752631296] >= 0
THEN '0-2 Mins'
ELSEIF [Calculation_499055157752631296] <= 5 AND [Calculation_499055157752631296] > 0
THEN '2-5 Mins'
ELSEIF [Calculation_499055157752631296] <= 10 AND [Calculation_499055157752631296] > 0
THEN '5-10 Mins'
ELSEIF [Calculation_499055157752631296] <= 30 AND [Calculation_499055157752631296] > 0 
THEN '10-30 Mins'
ELSEIF [Calculation_499055157752631296] <= 60 AND [Calculation_499055157752631296] > 0
THEN '30Mins-1 Hour'
ELSEIF [Calculation_499055157752631296] <= 300 AND [Calculation_499055157752631296] > 0
THEN '1-5 Hours'
ELSEIF [Calculation_499055157752631296] <= 600 AND [Calculation_499055157752631296] > 0
THEN '5-10 Hours'
ELSEIF [Calculation_499055157752631296] <= 1440 AND [Calculation_499055157752631296] > 0
THEN '10-24 Hours'
ELSEIF [Calculation_499055157752631296] <= 4320 AND [Calculation_499055157752631296] > 0
THEN '24-72 Hours'
ELSEIF [Calculation_499055157752631296] > 4320 AND [Calculation_499055157752631296] > 0
THEN '>72 Hours'
END",
    "name": "[Calculation_499055157754740737]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Project Type",
    "datatype": "string",
    "formula": "IF CONTAINS([CZ Project Name],'Aged') THEN 'Aged'
ELSE 'Live' END",
    "name": "[Calculation_5872834692856524810]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Grade",
    "datatype": "string",
    "formula": "// Grade A
IF [qual_status] = 'all-steps' THEN 'Grade A'

// Grade B
ELSEIF 
    [qual_status] IN ('fiveyrwrk-disqual','outofwrk-disqual','doc-disqual')
    AND [Calculation_1133007210553765896] = 1
THEN 'Grade B'

// Grade C
ELSEIF 
    [qual_status] <> 'age-disqual'
    AND NOT [Stage3 Response] IN ('Less than 2 years', 'Between 2 and 4 years')
    AND [Stage1 Response] <> 'Social Security Disability (SSD) Benefits'
    AND [Stage6 Response] = 'Not working'
THEN 'Grade C'

// Grade D
ELSEIF 
    // 1) Not age-disqual, Stage3 NOT in those two, Stage1 not SSD, Stage6 ≠ Not working, disqual ≤ 1
    (
      [qual_status] <> 'age-disqual'
      AND NOT [Stage3 Response] IN ('Less than 2 years', 'Between 2 and 4 years')
      AND [Stage1 Response] <> 'Social Security Disability (SSD) Benefits'
      AND [Stage6 Response] <> 'Not working'
      AND [Calculation_1133007210553765896] <= 1
    )
    // 2) Not age-disqual, Stage3 in those two, Qual Status = outofwrk-disqual
    OR
    (
      [qual_status] <> 'age-disqual'
      AND [Stage3 Response] IN ('Less than 2 years', 'Between 2 and 4 years')
      AND [qual_status] = 'outofwrk-disqual'
    )
    // 3) Not age-disqual, Stage3 in those two, Qual Status ≠ outofwrk-disqual, Stage7 = Yes
    OR
    (
      [qual_status] <> 'age-disqual'
      AND [Stage3 Response] IN ('Less than 2 years', 'Between 2 and 4 years')
      AND [qual_status] <> 'outofwrk-disqual'
      AND [Stage7 Response] = 'Yes'
    )
THEN 'Grade D'

// Rest (including age-disqual or anything else)
ELSE 'Rest'
END",
    "name": "[Calculation_7573084309404708864]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "SSD Age Range",
    "datatype": "string",
    "formula": "IF DATE([Calculation_1916563181826678784]) >= #18/08/2025#
THEN
    IF INT([Age]) < 40 THEN "U40"
    ELSEIF INT([Age]) >= 40 AND INT([Age]) <= 49 THEN "40 - 49"
	ELSEIF INT([Age]) >= 50 AND INT([Age]) <= 54 THEN "50 - 54"
    ELSEIF INT([Age]) >= 55 AND INT([Age]) <= 63 THEN "55 - 63"
    ELSEIF INT([Age]) >= 64 THEN "O64+"
    END
ELSEIF INT([Age]) < 40 THEN "*U40"
ELSEIF INT([Age]) >= 40 AND INT([Age]) <= 48 THEN "*40-48"
ELSEIF INT([Age]) = 49 THEN "*49"
ELSEIF INT([Age]) >= 50 AND INT([Age]) <= 62 THEN "*50-62"
ELSEIF INT([Age]) >= 63 THEN "*O63+" 
END",
    "name": "[Calculation_7690318609259716608]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Alt. Branding",
    "datatype": "string",
    "formula": "If int(Right([Phone],2))<30 and [Calculation_5872834692856524810]= 'Live' then 'Yes' else 'No' End",
    "name": "[Calculation_935059914517495808]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Duplicate Rejects",
    "datatype": "string",
    "formula": "if [Outcome]='rejected' and { FIXED [Phone], [Outcome]: COUNTD([User Id])}>1 then 'Yes' else 'No' end",
    "name": "[Calculation_943222690415542272]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Vici Post Delay (Days)",
    "datatype": "integer",
    "formula": "DATEDIFF('day', [Post Date], [Entry Time])",
    "name": "[Calculation_989947527401095169]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "State Exclusions",
    "datatype": "string",
    "formula": "[State]",
    "name": "[state (copy)_2399292755821703168]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Date Bucket",
    "datatype": "string",
    "formula": ""day"",
    "name": "[Parameter 1]",
    "role": "measure",
    "type": "nominal",
  },
  {
    "caption": "Start Date",
    "datatype": "date",
    "formula": "#2025-07-30#",
    "name": "[Parameter 5]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "End Date",
    "datatype": "date",
    "formula": "#2025-08-27#",
    "name": "[Parameter 6]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Show Source",
    "datatype": "string",
    "formula": ""1"",
    "name": "[Phone (copy)_1255659924007981058]",
    "role": "measure",
    "type": "nominal",
  },
  {
    "caption": "Show Site Source",
    "datatype": "string",
    "formula": ""0"",
    "name": "[Show Source (copy)_3999970530356424704]",
    "role": "measure",
    "type": "nominal",
  },
  {
    "caption": "D2",
    "datatype": "integer",
    "formula": "0",
    "name": "[D1 (copy 2)_1113233589196361731]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "D3",
    "datatype": "integer",
    "formula": "0",
    "name": "[D1 (copy 3)_1113233589196374020]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "D5",
    "datatype": "integer",
    "formula": "0",
    "name": "[D1 (copy) (copy)_1113233589196361730]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "D4",
    "datatype": "integer",
    "formula": "0",
    "name": "[D1 (copy)_1113233589196333057]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "D1",
    "datatype": "integer",
    "formula": "0",
    "name": "[Parameter 10]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "User Identifier",
    "datatype": "integer",
    "formula": "0",
    "name": "[Parameter 12]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Date Bucket",
    "datatype": "string",
    "formula": ""day"",
    "name": "[Parameter 1]",
    "role": "measure",
    "type": "nominal",
  },
  {
    "caption": "Start Date",
    "datatype": "date",
    "formula": "#2025-07-30#",
    "name": "[Parameter 5]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "End Date",
    "datatype": "date",
    "formula": "#2025-08-27#",
    "name": "[Parameter 6]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "Hour of Day",
    "datatype": "string",
    "formula": "IF LEN(STR(DATEPART('hour', [Calculation_1916563181826678784]))) = 1
THEN "0" + STR(DATEPART('hour', [Calculation_1916563181826678784]))
ELSE STR(DATEPART('hour', [Calculation_1916563181826678784]))
END",
    "name": "[Calculation_1113233589182521344]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "# of Disqual",
    "datatype": "integer",
    "formula": "ZN([Calculation_1133007210553487364]) +
ZN([Calculation_1133007210553663495]) +
ZN([Calculation_1133007210553618438]) +
ZN([Calculation_1133007210553540613]) +
ZN([Calculation_1133007210553425923]) +
ZN([Calculation_1133007210546622464]) +
ZN([Calculation_1133007210553298946])",
    "name": "[Calculation_1133007210553765896]",
    "role": "dimension",
    "type": "ordinal",
  },
  {
    "caption": "Levine States ",
    "datatype": "string",
    "formula": "IF ISNULL([Levine States]) THEN 'Other'
ELSE [Levine States] END",
    "name": "[Calculation_1277614987429064704]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "DP Leak",
    "datatype": "string",
    "formula": "IF CONTAINS([clientname], 'disabilitypath')
AND [Calculation_7573084309404708864] in ('Grade A', 'Grade B')
THEN 'Yes'
ELSE 'No'
END",
    "name": "[Calculation_1460573688699854848]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "CTC Lead Flag",
    "datatype": "string",
    "formula": "if [CTC Lead] = 1 then "Yes" else "No" END",
    "name": "[Calculation_1880252886088871936]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "CZ Post Hour Group",
    "datatype": "string",
    "formula": "IF DATEPART('hour', [Post Date]) >= 0 AND DATEPART('hour', [Post Date]) < 6 THEN 'Pre CC Hours'
ELSEIF DATEPART('hour', [Post Date]) >= 6 AND DATEPART('hour', [Post Date]) < 16 THEN 'CC Hours'
ELSEIF DATEPART('hour', [Post Date]) >= 16 AND DATEPART('hour', [Post Date]) < 24 THEN 'Post CC Hours'
END",
    "name": "[Calculation_1880252886125215747]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Lead Sell Type",
    "datatype": "string",
    "formula": "if contains([Transfer Info Label],'CXER') then 'Sold: Call' 
elseif 
contains([sgmt],'ql-leadbuy') or 
contains([ATA Work],'ql-leadbuy')
then 'Sold: Lead'
else 'Internal'
end",
    "name": "[Calculation_3435894714053935109]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Seg4 Cohort",
    "datatype": "string",
    "formula": "LOWER(IFNULL([seg4_cohort], [Calculation_4531465651676315649]))",
    "name": "[Calculation_4531465651676438530]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Time to Call Bucket",
    "datatype": "string",
    "formula": "IF  [Calculation_499055157752631296] < 0
THEN '<0 Mins'
ELSEIF [Calculation_499055157752631296] <= 2 AND [Calculation_499055157752631296] >= 0
THEN '0-2 Mins'
ELSEIF [Calculation_499055157752631296] <= 5 AND [Calculation_499055157752631296] > 0
THEN '2-5 Mins'
ELSEIF [Calculation_499055157752631296] <= 10 AND [Calculation_499055157752631296] > 0
THEN '5-10 Mins'
ELSEIF [Calculation_499055157752631296] <= 30 AND [Calculation_499055157752631296] > 0 
THEN '10-30 Mins'
ELSEIF [Calculation_499055157752631296] <= 60 AND [Calculation_499055157752631296] > 0
THEN '30Mins-1 Hour'
ELSEIF [Calculation_499055157752631296] <= 300 AND [Calculation_499055157752631296] > 0
THEN '1-5 Hours'
ELSEIF [Calculation_499055157752631296] <= 600 AND [Calculation_499055157752631296] > 0
THEN '5-10 Hours'
ELSEIF [Calculation_499055157752631296] <= 1440 AND [Calculation_499055157752631296] > 0
THEN '10-24 Hours'
ELSEIF [Calculation_499055157752631296] <= 4320 AND [Calculation_499055157752631296] > 0
THEN '24-72 Hours'
ELSEIF [Calculation_499055157752631296] > 4320 AND [Calculation_499055157752631296] > 0
THEN '>72 Hours'
END",
    "name": "[Calculation_499055157754740737]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Project Type",
    "datatype": "string",
    "formula": "IF CONTAINS([CZ Project Name],'Aged') THEN 'Aged'
ELSE 'Live' END",
    "name": "[Calculation_5872834692856524810]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Grade",
    "datatype": "string",
    "formula": "// Grade A
IF [qual_status] = 'all-steps' THEN 'Grade A'

// Grade B
ELSEIF 
    [qual_status] IN ('fiveyrwrk-disqual','outofwrk-disqual','doc-disqual')
    AND [Calculation_1133007210553765896] = 1
THEN 'Grade B'

// Grade C
ELSEIF 
    [qual_status] <> 'age-disqual'
    AND NOT [Stage3 Response] IN ('Less than 2 years', 'Between 2 and 4 years')
    AND [Stage1 Response] <> 'Social Security Disability (SSD) Benefits'
    AND [Stage6 Response] = 'Not working'
THEN 'Grade C'

// Grade D
ELSEIF 
    // 1) Not age-disqual, Stage3 NOT in those two, Stage1 not SSD, Stage6 ≠ Not working, disqual ≤ 1
    (
      [qual_status] <> 'age-disqual'
      AND NOT [Stage3 Response] IN ('Less than 2 years', 'Between 2 and 4 years')
      AND [Stage1 Response] <> 'Social Security Disability (SSD) Benefits'
      AND [Stage6 Response] <> 'Not working'
      AND [Calculation_1133007210553765896] <= 1
    )
    // 2) Not age-disqual, Stage3 in those two, Qual Status = outofwrk-disqual
    OR
    (
      [qual_status] <> 'age-disqual'
      AND [Stage3 Response] IN ('Less than 2 years', 'Between 2 and 4 years')
      AND [qual_status] = 'outofwrk-disqual'
    )
    // 3) Not age-disqual, Stage3 in those two, Qual Status ≠ outofwrk-disqual, Stage7 = Yes
    OR
    (
      [qual_status] <> 'age-disqual'
      AND [Stage3 Response] IN ('Less than 2 years', 'Between 2 and 4 years')
      AND [qual_status] <> 'outofwrk-disqual'
      AND [Stage7 Response] = 'Yes'
    )
THEN 'Grade D'

// Rest (including age-disqual or anything else)
ELSE 'Rest'
END",
    "name": "[Calculation_7573084309404708864]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "SSD Age Range",
    "datatype": "string",
    "formula": "IF DATE([Calculation_1916563181826678784]) >= #18/08/2025#
THEN
    IF INT([Age]) < 40 THEN "U40"
    ELSEIF INT([Age]) >= 40 AND INT([Age]) <= 49 THEN "40 - 49"
	ELSEIF INT([Age]) >= 50 AND INT([Age]) <= 54 THEN "50 - 54"
    ELSEIF INT([Age]) >= 55 AND INT([Age]) <= 63 THEN "55 - 63"
    ELSEIF INT([Age]) >= 64 THEN "O64+"
    END
ELSEIF INT([Age]) < 40 THEN "*U40"
ELSEIF INT([Age]) >= 40 AND INT([Age]) <= 48 THEN "*40-48"
ELSEIF INT([Age]) = 49 THEN "*49"
ELSEIF INT([Age]) >= 50 AND INT([Age]) <= 62 THEN "*50-62"
ELSEIF INT([Age]) >= 63 THEN "*O63+" 
END",
    "name": "[Calculation_7690318609259716608]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Alt. Branding",
    "datatype": "string",
    "formula": "If int(Right([Phone],2))<30 and [Calculation_5872834692856524810]= 'Live' then 'Yes' else 'No' End",
    "name": "[Calculation_935059914517495808]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Duplicate Rejects",
    "datatype": "string",
    "formula": "if [Outcome]='rejected' and { FIXED [Phone], [Outcome]: COUNTD([User Id])}>1 then 'Yes' else 'No' end",
    "name": "[Calculation_943222690415542272]",
    "role": "dimension",
    "type": "nominal",
  },
  {
    "caption": "Vici Post Delay (Days)",
    "datatype": "integer",
    "formula": "DATEDIFF('day', [Post Date], [Entry Time])",
    "name": "[Calculation_989947527401095169]",
    "role": "measure",
    "type": "quantitative",
  },
  {
    "caption": "State Exclusions",
    "datatype": "string",
    "formula": "[State]",
    "name": "[state (copy)_2399292755821703168]",
    "role": "dimension",
    "type": "nominal",
  },
]
`;
